var TP=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var cq=TP((xq,pd)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();var za=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bf(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function MP(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var U1={exports:{}},Ef={},z1={exports:{}},Ge={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rc=Symbol.for("react.element"),_P=Symbol.for("react.portal"),OP=Symbol.for("react.fragment"),IP=Symbol.for("react.strict_mode"),xP=Symbol.for("react.profiler"),AP=Symbol.for("react.provider"),PP=Symbol.for("react.context"),HP=Symbol.for("react.forward_ref"),DP=Symbol.for("react.suspense"),kP=Symbol.for("react.memo"),NP=Symbol.for("react.lazy"),wR=Symbol.iterator;function LP(n){return n===null||typeof n!="object"?null:(n=wR&&n[wR]||n["@@iterator"],typeof n=="function"?n:null)}var Y1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},j1=Object.assign,G1={};function ea(n,e,t){this.props=n,this.context=e,this.refs=G1,this.updater=t||Y1}ea.prototype.isReactComponent={};ea.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};ea.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function K1(){}K1.prototype=ea.prototype;function ry(n,e,t){this.props=n,this.context=e,this.refs=G1,this.updater=t||Y1}var sy=ry.prototype=new K1;sy.constructor=ry;j1(sy,ea.prototype);sy.isPureReactComponent=!0;var CR=Array.isArray,X1=Object.prototype.hasOwnProperty,oy={current:null},q1={key:!0,ref:!0,__self:!0,__source:!0};function Q1(n,e,t){var r,s={},o=null,i=null;if(e!=null)for(r in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(o=""+e.key),e)X1.call(e,r)&&!q1.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=t;else if(1<l){for(var a=Array(l),u=0;u<l;u++)a[u]=arguments[u+2];s.children=a}if(n&&n.defaultProps)for(r in l=n.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:rc,type:n,key:o,ref:i,props:s,_owner:oy.current}}function FP(n,e){return{$$typeof:rc,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function iy(n){return typeof n=="object"&&n!==null&&n.$$typeof===rc}function VP(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var yR=/\/+/g;function qg(n,e){return typeof n=="object"&&n!==null&&n.key!=null?VP(""+n.key):e.toString(36)}function zh(n,e,t,r,s){var o=typeof n;(o==="undefined"||o==="boolean")&&(n=null);var i=!1;if(n===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(n.$$typeof){case rc:case _P:i=!0}}if(i)return i=n,s=s(i),n=r===""?"."+qg(i,0):r,CR(s)?(t="",n!=null&&(t=n.replace(yR,"$&/")+"/"),zh(s,e,t,"",function(u){return u})):s!=null&&(iy(s)&&(s=FP(s,t+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(yR,"$&/")+"/")+n)),e.push(s)),1;if(i=0,r=r===""?".":r+":",CR(n))for(var l=0;l<n.length;l++){o=n[l];var a=r+qg(o,l);i+=zh(o,e,t,a,s)}else if(a=LP(n),typeof a=="function")for(n=a.call(n),l=0;!(o=n.next()).done;)o=o.value,a=r+qg(o,l++),i+=zh(o,e,t,a,s);else if(o==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function Hc(n,e,t){if(n==null)return n;var r=[],s=0;return zh(n,r,"","",function(o){return e.call(t,o,s++)}),r}function $P(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var On={current:null},Yh={transition:null},BP={ReactCurrentDispatcher:On,ReactCurrentBatchConfig:Yh,ReactCurrentOwner:oy};function Z1(){throw Error("act(...) is not supported in production builds of React.")}Ge.Children={map:Hc,forEach:function(n,e,t){Hc(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Hc(n,function(){e++}),e},toArray:function(n){return Hc(n,function(e){return e})||[]},only:function(n){if(!iy(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Ge.Component=ea;Ge.Fragment=OP;Ge.Profiler=xP;Ge.PureComponent=ry;Ge.StrictMode=IP;Ge.Suspense=DP;Ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BP;Ge.act=Z1;Ge.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=j1({},n.props),s=n.key,o=n.ref,i=n._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,i=oy.current),e.key!==void 0&&(s=""+e.key),n.type&&n.type.defaultProps)var l=n.type.defaultProps;for(a in e)X1.call(e,a)&&!q1.hasOwnProperty(a)&&(r[a]=e[a]===void 0&&l!==void 0?l[a]:e[a])}var a=arguments.length-2;if(a===1)r.children=t;else if(1<a){l=Array(a);for(var u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:rc,type:n.type,key:s,ref:o,props:r,_owner:i}};Ge.createContext=function(n){return n={$$typeof:PP,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:AP,_context:n},n.Consumer=n};Ge.createElement=Q1;Ge.createFactory=function(n){var e=Q1.bind(null,n);return e.type=n,e};Ge.createRef=function(){return{current:null}};Ge.forwardRef=function(n){return{$$typeof:HP,render:n}};Ge.isValidElement=iy;Ge.lazy=function(n){return{$$typeof:NP,_payload:{_status:-1,_result:n},_init:$P}};Ge.memo=function(n,e){return{$$typeof:kP,type:n,compare:e===void 0?null:e}};Ge.startTransition=function(n){var e=Yh.transition;Yh.transition={};try{n()}finally{Yh.transition=e}};Ge.unstable_act=Z1;Ge.useCallback=function(n,e){return On.current.useCallback(n,e)};Ge.useContext=function(n){return On.current.useContext(n)};Ge.useDebugValue=function(){};Ge.useDeferredValue=function(n){return On.current.useDeferredValue(n)};Ge.useEffect=function(n,e){return On.current.useEffect(n,e)};Ge.useId=function(){return On.current.useId()};Ge.useImperativeHandle=function(n,e,t){return On.current.useImperativeHandle(n,e,t)};Ge.useInsertionEffect=function(n,e){return On.current.useInsertionEffect(n,e)};Ge.useLayoutEffect=function(n,e){return On.current.useLayoutEffect(n,e)};Ge.useMemo=function(n,e){return On.current.useMemo(n,e)};Ge.useReducer=function(n,e,t){return On.current.useReducer(n,e,t)};Ge.useRef=function(n){return On.current.useRef(n)};Ge.useState=function(n){return On.current.useState(n)};Ge.useSyncExternalStore=function(n,e,t){return On.current.useSyncExternalStore(n,e,t)};Ge.useTransition=function(){return On.current.useTransition()};Ge.version="18.3.1";z1.exports=Ge;var vu=z1.exports;const $t=bf(vu);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WP=vu,UP=Symbol.for("react.element"),zP=Symbol.for("react.fragment"),YP=Object.prototype.hasOwnProperty,jP=WP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,GP={key:!0,ref:!0,__self:!0,__source:!0};function J1(n,e,t){var r,s={},o=null,i=null;t!==void 0&&(o=""+t),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(i=e.ref);for(r in e)YP.call(e,r)&&!GP.hasOwnProperty(r)&&(s[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:UP,type:n,key:o,ref:i,props:s,_owner:jP.current}}Ef.Fragment=zP;Ef.jsx=J1;Ef.jsxs=J1;U1.exports=Ef;var ao=U1.exports,gw={},eM={exports:{}},Jn={},tM={exports:{}},nM={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(E,h){var g=E.length;E.push(h);e:for(;0<g;){var C=g-1>>>1,_=E[C];if(0<s(_,h))E[C]=h,E[g]=_,g=C;else break e}}function t(E){return E.length===0?null:E[0]}function r(E){if(E.length===0)return null;var h=E[0],g=E.pop();if(g!==h){E[0]=g;e:for(var C=0,_=E.length,O=_>>>1;C<O;){var A=2*(C+1)-1,W=E[A],z=A+1,K=E[z];if(0>s(W,g))z<_&&0>s(K,W)?(E[C]=K,E[z]=g,C=z):(E[C]=W,E[A]=g,C=A);else if(z<_&&0>s(K,g))E[C]=K,E[z]=g,C=z;else break e}}return h}function s(E,h){var g=E.sortIndex-h.sortIndex;return g!==0?g:E.id-h.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var i=Date,l=i.now();n.unstable_now=function(){return i.now()-l}}var a=[],u=[],c=1,d=null,f=3,m=!1,p=!1,w=!1,M=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(E){for(var h=t(u);h!==null;){if(h.callback===null)r(u);else if(h.startTime<=E)r(u),h.sortIndex=h.expirationTime,e(a,h);else break;h=t(u)}}function R(E){if(w=!1,v(E),!p)if(t(a)!==null)p=!0,Ue(I);else{var h=t(u);h!==null&&Me(R,h.startTime-E)}}function I(E,h){p=!1,w&&(w=!1,S(j),j=-1),m=!0;var g=f;try{for(v(h),d=t(a);d!==null&&(!(d.expirationTime>h)||E&&!te());){var C=d.callback;if(typeof C=="function"){d.callback=null,f=d.priorityLevel;var _=C(d.expirationTime<=h);h=n.unstable_now(),typeof _=="function"?d.callback=_:d===t(a)&&r(a),v(h)}else r(a);d=t(a)}if(d!==null)var O=!0;else{var A=t(u);A!==null&&Me(R,A.startTime-h),O=!1}return O}finally{d=null,f=g,m=!1}}var F=!1,L=null,j=-1,X=5,G=-1;function te(){return!(n.unstable_now()-G<X)}function ie(){if(L!==null){var E=n.unstable_now();G=E;var h=!0;try{h=L(!0,E)}finally{h?le():(F=!1,L=null)}}else F=!1}var le;if(typeof y=="function")le=function(){y(ie)};else if(typeof MessageChannel<"u"){var me=new MessageChannel,Te=me.port2;me.port1.onmessage=ie,le=function(){Te.postMessage(null)}}else le=function(){M(ie,0)};function Ue(E){L=E,F||(F=!0,le())}function Me(E,h){j=M(function(){E(n.unstable_now())},h)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(E){E.callback=null},n.unstable_continueExecution=function(){p||m||(p=!0,Ue(I))},n.unstable_forceFrameRate=function(E){0>E||125<E?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):X=0<E?Math.floor(1e3/E):5},n.unstable_getCurrentPriorityLevel=function(){return f},n.unstable_getFirstCallbackNode=function(){return t(a)},n.unstable_next=function(E){switch(f){case 1:case 2:case 3:var h=3;break;default:h=f}var g=f;f=h;try{return E()}finally{f=g}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(E,h){switch(E){case 1:case 2:case 3:case 4:case 5:break;default:E=3}var g=f;f=E;try{return h()}finally{f=g}},n.unstable_scheduleCallback=function(E,h,g){var C=n.unstable_now();switch(typeof g=="object"&&g!==null?(g=g.delay,g=typeof g=="number"&&0<g?C+g:C):g=C,E){case 1:var _=-1;break;case 2:_=250;break;case 5:_=1073741823;break;case 4:_=1e4;break;default:_=5e3}return _=g+_,E={id:c++,callback:h,priorityLevel:E,startTime:g,expirationTime:_,sortIndex:-1},g>C?(E.sortIndex=g,e(u,E),t(a)===null&&E===t(u)&&(w?(S(j),j=-1):w=!0,Me(R,g-C))):(E.sortIndex=_,e(a,E),p||m||(p=!0,Ue(I))),E},n.unstable_shouldYield=te,n.unstable_wrapCallback=function(E){var h=f;return function(){var g=f;f=h;try{return E.apply(this,arguments)}finally{f=g}}}})(nM);tM.exports=nM;var KP=tM.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XP=vu,Zn=KP;function ne(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var rM=new Set,Su={};function Ai(n,e){Fl(n,e),Fl(n+"Capture",e)}function Fl(n,e){for(Su[n]=e,n=0;n<e.length;n++)rM.add(e[n])}var Vs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),mw=Object.prototype.hasOwnProperty,qP=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,vR={},SR={};function QP(n){return mw.call(SR,n)?!0:mw.call(vR,n)?!1:qP.test(n)?SR[n]=!0:(vR[n]=!0,!1)}function ZP(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function JP(n,e,t,r){if(e===null||typeof e>"u"||ZP(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function In(n,e,t,r,s,o,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=o,this.removeEmptyString=i}var an={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){an[n]=new In(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];an[e]=new In(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){an[n]=new In(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){an[n]=new In(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){an[n]=new In(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){an[n]=new In(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){an[n]=new In(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){an[n]=new In(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){an[n]=new In(n,5,!1,n.toLowerCase(),null,!1,!1)});var ly=/[\-:]([a-z])/g;function ay(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(ly,ay);an[e]=new In(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(ly,ay);an[e]=new In(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(ly,ay);an[e]=new In(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){an[n]=new In(n,1,!1,n.toLowerCase(),null,!1,!1)});an.xlinkHref=new In("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){an[n]=new In(n,1,!1,n.toLowerCase(),null,!0,!0)});function uy(n,e,t,r){var s=an.hasOwnProperty(e)?an[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(JP(e,t,s,r)&&(t=null),r||s===null?QP(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):s.mustUseProperty?n[s.propertyName]=t===null?s.type===3?!1:"":t:(e=s.attributeName,r=s.attributeNamespace,t===null?n.removeAttribute(e):(s=s.type,t=s===3||s===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var Ys=XP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Dc=Symbol.for("react.element"),fl=Symbol.for("react.portal"),gl=Symbol.for("react.fragment"),cy=Symbol.for("react.strict_mode"),pw=Symbol.for("react.profiler"),sM=Symbol.for("react.provider"),oM=Symbol.for("react.context"),hy=Symbol.for("react.forward_ref"),ww=Symbol.for("react.suspense"),Cw=Symbol.for("react.suspense_list"),dy=Symbol.for("react.memo"),uo=Symbol.for("react.lazy"),iM=Symbol.for("react.offscreen"),RR=Symbol.iterator;function ma(n){return n===null||typeof n!="object"?null:(n=RR&&n[RR]||n["@@iterator"],typeof n=="function"?n:null)}var Ot=Object.assign,Qg;function Ya(n){if(Qg===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Qg=e&&e[1]||""}return`
`+Qg+n}var Zg=!1;function Jg(n,e){if(!n||Zg)return"";Zg=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){r=u}n.call(e.prototype)}else{try{throw Error()}catch(u){r=u}n()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),o=r.stack.split(`
`),i=s.length-1,l=o.length-1;1<=i&&0<=l&&s[i]!==o[l];)l--;for(;1<=i&&0<=l;i--,l--)if(s[i]!==o[l]){if(i!==1||l!==1)do if(i--,l--,0>l||s[i]!==o[l]){var a=`
`+s[i].replace(" at new "," at ");return n.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",n.displayName)),a}while(1<=i&&0<=l);break}}}finally{Zg=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Ya(n):""}function eH(n){switch(n.tag){case 5:return Ya(n.type);case 16:return Ya("Lazy");case 13:return Ya("Suspense");case 19:return Ya("SuspenseList");case 0:case 2:case 15:return n=Jg(n.type,!1),n;case 11:return n=Jg(n.type.render,!1),n;case 1:return n=Jg(n.type,!0),n;default:return""}}function yw(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case gl:return"Fragment";case fl:return"Portal";case pw:return"Profiler";case cy:return"StrictMode";case ww:return"Suspense";case Cw:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case oM:return(n.displayName||"Context")+".Consumer";case sM:return(n._context.displayName||"Context")+".Provider";case hy:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case dy:return e=n.displayName||null,e!==null?e:yw(n.type)||"Memo";case uo:e=n._payload,n=n._init;try{return yw(n(e))}catch{}}return null}function tH(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return yw(e);case 8:return e===cy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ho(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function lM(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function nH(n){var e=lM(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var s=t.get,o=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return s.call(this)},set:function(i){r=""+i,o.call(this,i)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function kc(n){n._valueTracker||(n._valueTracker=nH(n))}function aM(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=lM(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function wd(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function vw(n,e){var t=e.checked;return Ot({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function bR(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=Ho(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function uM(n,e){e=e.checked,e!=null&&uy(n,"checked",e,!1)}function Sw(n,e){uM(n,e);var t=Ho(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Rw(n,e.type,t):e.hasOwnProperty("defaultValue")&&Rw(n,e.type,Ho(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function ER(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Rw(n,e,t){(e!=="number"||wd(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var ja=Array.isArray;function Il(n,e,t,r){if(n=n.options,e){e={};for(var s=0;s<t.length;s++)e["$"+t[s]]=!0;for(t=0;t<n.length;t++)s=e.hasOwnProperty("$"+n[t].value),n[t].selected!==s&&(n[t].selected=s),s&&r&&(n[t].defaultSelected=!0)}else{for(t=""+Ho(t),e=null,s=0;s<n.length;s++){if(n[s].value===t){n[s].selected=!0,r&&(n[s].defaultSelected=!0);return}e!==null||n[s].disabled||(e=n[s])}e!==null&&(e.selected=!0)}}function bw(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ne(91));return Ot({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function TR(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(ne(92));if(ja(t)){if(1<t.length)throw Error(ne(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Ho(t)}}function cM(n,e){var t=Ho(e.value),r=Ho(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function MR(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function hM(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ew(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?hM(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Nc,dM=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,s){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,s)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Nc=Nc||document.createElement("div"),Nc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Nc.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Ru(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var Ja={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},rH=["Webkit","ms","Moz","O"];Object.keys(Ja).forEach(function(n){rH.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Ja[e]=Ja[n]})});function fM(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Ja.hasOwnProperty(n)&&Ja[n]?(""+e).trim():e+"px"}function gM(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,s=fM(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,s):n[t]=s}}var sH=Ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Tw(n,e){if(e){if(sH[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ne(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ne(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ne(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ne(62))}}function Mw(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _w=null;function fy(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Ow=null,xl=null,Al=null;function _R(n){if(n=ic(n)){if(typeof Ow!="function")throw Error(ne(280));var e=n.stateNode;e&&(e=If(e),Ow(n.stateNode,n.type,e))}}function mM(n){xl?Al?Al.push(n):Al=[n]:xl=n}function pM(){if(xl){var n=xl,e=Al;if(Al=xl=null,_R(n),e)for(n=0;n<e.length;n++)_R(e[n])}}function wM(n,e){return n(e)}function CM(){}var em=!1;function yM(n,e,t){if(em)return n(e,t);em=!0;try{return wM(n,e,t)}finally{em=!1,(xl!==null||Al!==null)&&(CM(),pM())}}function bu(n,e){var t=n.stateNode;if(t===null)return null;var r=If(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(ne(231,e,typeof t));return t}var Iw=!1;if(Vs)try{var pa={};Object.defineProperty(pa,"passive",{get:function(){Iw=!0}}),window.addEventListener("test",pa,pa),window.removeEventListener("test",pa,pa)}catch{Iw=!1}function oH(n,e,t,r,s,o,i,l,a){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(c){this.onError(c)}}var eu=!1,Cd=null,yd=!1,xw=null,iH={onError:function(n){eu=!0,Cd=n}};function lH(n,e,t,r,s,o,i,l,a){eu=!1,Cd=null,oH.apply(iH,arguments)}function aH(n,e,t,r,s,o,i,l,a){if(lH.apply(this,arguments),eu){if(eu){var u=Cd;eu=!1,Cd=null}else throw Error(ne(198));yd||(yd=!0,xw=u)}}function Pi(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function vM(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function OR(n){if(Pi(n)!==n)throw Error(ne(188))}function uH(n){var e=n.alternate;if(!e){if(e=Pi(n),e===null)throw Error(ne(188));return e!==n?null:n}for(var t=n,r=e;;){var s=t.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){t=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===t)return OR(s),n;if(o===r)return OR(s),e;o=o.sibling}throw Error(ne(188))}if(t.return!==r.return)t=s,r=o;else{for(var i=!1,l=s.child;l;){if(l===t){i=!0,t=s,r=o;break}if(l===r){i=!0,r=s,t=o;break}l=l.sibling}if(!i){for(l=o.child;l;){if(l===t){i=!0,t=o,r=s;break}if(l===r){i=!0,r=o,t=s;break}l=l.sibling}if(!i)throw Error(ne(189))}}if(t.alternate!==r)throw Error(ne(190))}if(t.tag!==3)throw Error(ne(188));return t.stateNode.current===t?n:e}function SM(n){return n=uH(n),n!==null?RM(n):null}function RM(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=RM(n);if(e!==null)return e;n=n.sibling}return null}var bM=Zn.unstable_scheduleCallback,IR=Zn.unstable_cancelCallback,cH=Zn.unstable_shouldYield,hH=Zn.unstable_requestPaint,Nt=Zn.unstable_now,dH=Zn.unstable_getCurrentPriorityLevel,gy=Zn.unstable_ImmediatePriority,EM=Zn.unstable_UserBlockingPriority,vd=Zn.unstable_NormalPriority,fH=Zn.unstable_LowPriority,TM=Zn.unstable_IdlePriority,Tf=null,ls=null;function gH(n){if(ls&&typeof ls.onCommitFiberRoot=="function")try{ls.onCommitFiberRoot(Tf,n,void 0,(n.current.flags&128)===128)}catch{}}var kr=Math.clz32?Math.clz32:wH,mH=Math.log,pH=Math.LN2;function wH(n){return n>>>=0,n===0?32:31-(mH(n)/pH|0)|0}var Lc=64,Fc=4194304;function Ga(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Sd(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,s=n.suspendedLanes,o=n.pingedLanes,i=t&268435455;if(i!==0){var l=i&~s;l!==0?r=Ga(l):(o&=i,o!==0&&(r=Ga(o)))}else i=t&~s,i!==0?r=Ga(i):o!==0&&(r=Ga(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,o=e&-e,s>=o||s===16&&(o&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-kr(e),s=1<<t,r|=n[t],e&=~s;return r}function CH(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yH(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,s=n.expirationTimes,o=n.pendingLanes;0<o;){var i=31-kr(o),l=1<<i,a=s[i];a===-1?(!(l&t)||l&r)&&(s[i]=CH(l,e)):a<=e&&(n.expiredLanes|=l),o&=~l}}function Aw(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function MM(){var n=Lc;return Lc<<=1,!(Lc&4194240)&&(Lc=64),n}function tm(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function sc(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-kr(e),n[e]=t}function vH(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var s=31-kr(t),o=1<<s;e[s]=0,r[s]=-1,n[s]=-1,t&=~o}}function my(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-kr(t),s=1<<r;s&e|n[r]&e&&(n[r]|=e),t&=~s}}var rt=0;function _M(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var OM,py,IM,xM,AM,Pw=!1,Vc=[],vo=null,So=null,Ro=null,Eu=new Map,Tu=new Map,ho=[],SH="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function xR(n,e){switch(n){case"focusin":case"focusout":vo=null;break;case"dragenter":case"dragleave":So=null;break;case"mouseover":case"mouseout":Ro=null;break;case"pointerover":case"pointerout":Eu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tu.delete(e.pointerId)}}function wa(n,e,t,r,s,o){return n===null||n.nativeEvent!==o?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},e!==null&&(e=ic(e),e!==null&&py(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),n)}function RH(n,e,t,r,s){switch(e){case"focusin":return vo=wa(vo,n,e,t,r,s),!0;case"dragenter":return So=wa(So,n,e,t,r,s),!0;case"mouseover":return Ro=wa(Ro,n,e,t,r,s),!0;case"pointerover":var o=s.pointerId;return Eu.set(o,wa(Eu.get(o)||null,n,e,t,r,s)),!0;case"gotpointercapture":return o=s.pointerId,Tu.set(o,wa(Tu.get(o)||null,n,e,t,r,s)),!0}return!1}function PM(n){var e=ai(n.target);if(e!==null){var t=Pi(e);if(t!==null){if(e=t.tag,e===13){if(e=vM(t),e!==null){n.blockedOn=e,AM(n.priority,function(){IM(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function jh(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Hw(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);_w=r,t.target.dispatchEvent(r),_w=null}else return e=ic(t),e!==null&&py(e),n.blockedOn=t,!1;e.shift()}return!0}function AR(n,e,t){jh(n)&&t.delete(e)}function bH(){Pw=!1,vo!==null&&jh(vo)&&(vo=null),So!==null&&jh(So)&&(So=null),Ro!==null&&jh(Ro)&&(Ro=null),Eu.forEach(AR),Tu.forEach(AR)}function Ca(n,e){n.blockedOn===e&&(n.blockedOn=null,Pw||(Pw=!0,Zn.unstable_scheduleCallback(Zn.unstable_NormalPriority,bH)))}function Mu(n){function e(s){return Ca(s,n)}if(0<Vc.length){Ca(Vc[0],n);for(var t=1;t<Vc.length;t++){var r=Vc[t];r.blockedOn===n&&(r.blockedOn=null)}}for(vo!==null&&Ca(vo,n),So!==null&&Ca(So,n),Ro!==null&&Ca(Ro,n),Eu.forEach(e),Tu.forEach(e),t=0;t<ho.length;t++)r=ho[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<ho.length&&(t=ho[0],t.blockedOn===null);)PM(t),t.blockedOn===null&&ho.shift()}var Pl=Ys.ReactCurrentBatchConfig,Rd=!0;function EH(n,e,t,r){var s=rt,o=Pl.transition;Pl.transition=null;try{rt=1,wy(n,e,t,r)}finally{rt=s,Pl.transition=o}}function TH(n,e,t,r){var s=rt,o=Pl.transition;Pl.transition=null;try{rt=4,wy(n,e,t,r)}finally{rt=s,Pl.transition=o}}function wy(n,e,t,r){if(Rd){var s=Hw(n,e,t,r);if(s===null)hm(n,e,r,bd,t),xR(n,r);else if(RH(s,n,e,t,r))r.stopPropagation();else if(xR(n,r),e&4&&-1<SH.indexOf(n)){for(;s!==null;){var o=ic(s);if(o!==null&&OM(o),o=Hw(n,e,t,r),o===null&&hm(n,e,r,bd,t),o===s)break;s=o}s!==null&&r.stopPropagation()}else hm(n,e,r,null,t)}}var bd=null;function Hw(n,e,t,r){if(bd=null,n=fy(r),n=ai(n),n!==null)if(e=Pi(n),e===null)n=null;else if(t=e.tag,t===13){if(n=vM(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return bd=n,null}function HM(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(dH()){case gy:return 1;case EM:return 4;case vd:case fH:return 16;case TM:return 536870912;default:return 16}default:return 16}}var mo=null,Cy=null,Gh=null;function DM(){if(Gh)return Gh;var n,e=Cy,t=e.length,r,s="value"in mo?mo.value:mo.textContent,o=s.length;for(n=0;n<t&&e[n]===s[n];n++);var i=t-n;for(r=1;r<=i&&e[t-r]===s[o-r];r++);return Gh=s.slice(n,1<r?1-r:void 0)}function Kh(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function $c(){return!0}function PR(){return!1}function er(n){function e(t,r,s,o,i){this._reactName=t,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var l in n)n.hasOwnProperty(l)&&(t=n[l],this[l]=t?t(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?$c:PR,this.isPropagationStopped=PR,this}return Ot(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=$c)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=$c)},persist:function(){},isPersistent:$c}),e}var ta={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},yy=er(ta),oc=Ot({},ta,{view:0,detail:0}),MH=er(oc),nm,rm,ya,Mf=Ot({},oc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vy,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==ya&&(ya&&n.type==="mousemove"?(nm=n.screenX-ya.screenX,rm=n.screenY-ya.screenY):rm=nm=0,ya=n),nm)},movementY:function(n){return"movementY"in n?n.movementY:rm}}),HR=er(Mf),_H=Ot({},Mf,{dataTransfer:0}),OH=er(_H),IH=Ot({},oc,{relatedTarget:0}),sm=er(IH),xH=Ot({},ta,{animationName:0,elapsedTime:0,pseudoElement:0}),AH=er(xH),PH=Ot({},ta,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),HH=er(PH),DH=Ot({},ta,{data:0}),DR=er(DH),kH={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},NH={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},LH={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function FH(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=LH[n])?!!e[n]:!1}function vy(){return FH}var VH=Ot({},oc,{key:function(n){if(n.key){var e=kH[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Kh(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?NH[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vy,charCode:function(n){return n.type==="keypress"?Kh(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Kh(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),$H=er(VH),BH=Ot({},Mf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),kR=er(BH),WH=Ot({},oc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vy}),UH=er(WH),zH=Ot({},ta,{propertyName:0,elapsedTime:0,pseudoElement:0}),YH=er(zH),jH=Ot({},Mf,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),GH=er(jH),KH=[9,13,27,32],Sy=Vs&&"CompositionEvent"in window,tu=null;Vs&&"documentMode"in document&&(tu=document.documentMode);var XH=Vs&&"TextEvent"in window&&!tu,kM=Vs&&(!Sy||tu&&8<tu&&11>=tu),NR=" ",LR=!1;function NM(n,e){switch(n){case"keyup":return KH.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function LM(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var ml=!1;function qH(n,e){switch(n){case"compositionend":return LM(e);case"keypress":return e.which!==32?null:(LR=!0,NR);case"textInput":return n=e.data,n===NR&&LR?null:n;default:return null}}function QH(n,e){if(ml)return n==="compositionend"||!Sy&&NM(n,e)?(n=DM(),Gh=Cy=mo=null,ml=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return kM&&e.locale!=="ko"?null:e.data;default:return null}}var ZH={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function FR(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!ZH[n.type]:e==="textarea"}function FM(n,e,t,r){mM(r),e=Ed(e,"onChange"),0<e.length&&(t=new yy("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var nu=null,_u=null;function JH(n){XM(n,0)}function _f(n){var e=Cl(n);if(aM(e))return n}function eD(n,e){if(n==="change")return e}var VM=!1;if(Vs){var om;if(Vs){var im="oninput"in document;if(!im){var VR=document.createElement("div");VR.setAttribute("oninput","return;"),im=typeof VR.oninput=="function"}om=im}else om=!1;VM=om&&(!document.documentMode||9<document.documentMode)}function $R(){nu&&(nu.detachEvent("onpropertychange",$M),_u=nu=null)}function $M(n){if(n.propertyName==="value"&&_f(_u)){var e=[];FM(e,_u,n,fy(n)),yM(JH,e)}}function tD(n,e,t){n==="focusin"?($R(),nu=e,_u=t,nu.attachEvent("onpropertychange",$M)):n==="focusout"&&$R()}function nD(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return _f(_u)}function rD(n,e){if(n==="click")return _f(e)}function sD(n,e){if(n==="input"||n==="change")return _f(e)}function oD(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Fr=typeof Object.is=="function"?Object.is:oD;function Ou(n,e){if(Fr(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var s=t[r];if(!mw.call(e,s)||!Fr(n[s],e[s]))return!1}return!0}function BR(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function WR(n,e){var t=BR(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=BR(t)}}function BM(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?BM(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function WM(){for(var n=window,e=wd();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=wd(n.document)}return e}function Ry(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function iD(n){var e=WM(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&BM(t.ownerDocument.documentElement,t)){if(r!==null&&Ry(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=t.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!n.extend&&o>r&&(s=r,r=o,o=s),s=WR(t,o);var i=WR(t,r);s&&i&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==i.node||n.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),o>r?(n.addRange(e),n.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var lD=Vs&&"documentMode"in document&&11>=document.documentMode,pl=null,Dw=null,ru=null,kw=!1;function UR(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;kw||pl==null||pl!==wd(r)||(r=pl,"selectionStart"in r&&Ry(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ru&&Ou(ru,r)||(ru=r,r=Ed(Dw,"onSelect"),0<r.length&&(e=new yy("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=pl)))}function Bc(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var wl={animationend:Bc("Animation","AnimationEnd"),animationiteration:Bc("Animation","AnimationIteration"),animationstart:Bc("Animation","AnimationStart"),transitionend:Bc("Transition","TransitionEnd")},lm={},UM={};Vs&&(UM=document.createElement("div").style,"AnimationEvent"in window||(delete wl.animationend.animation,delete wl.animationiteration.animation,delete wl.animationstart.animation),"TransitionEvent"in window||delete wl.transitionend.transition);function Of(n){if(lm[n])return lm[n];if(!wl[n])return n;var e=wl[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in UM)return lm[n]=e[t];return n}var zM=Of("animationend"),YM=Of("animationiteration"),jM=Of("animationstart"),GM=Of("transitionend"),KM=new Map,zR="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function No(n,e){KM.set(n,e),Ai(e,[n])}for(var am=0;am<zR.length;am++){var um=zR[am],aD=um.toLowerCase(),uD=um[0].toUpperCase()+um.slice(1);No(aD,"on"+uD)}No(zM,"onAnimationEnd");No(YM,"onAnimationIteration");No(jM,"onAnimationStart");No("dblclick","onDoubleClick");No("focusin","onFocus");No("focusout","onBlur");No(GM,"onTransitionEnd");Fl("onMouseEnter",["mouseout","mouseover"]);Fl("onMouseLeave",["mouseout","mouseover"]);Fl("onPointerEnter",["pointerout","pointerover"]);Fl("onPointerLeave",["pointerout","pointerover"]);Ai("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ai("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ai("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ai("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ai("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ai("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ka="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cD=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ka));function YR(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,aH(r,e,void 0,n),n.currentTarget=null}function XM(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],s=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var i=r.length-1;0<=i;i--){var l=r[i],a=l.instance,u=l.currentTarget;if(l=l.listener,a!==o&&s.isPropagationStopped())break e;YR(s,l,u),o=a}else for(i=0;i<r.length;i++){if(l=r[i],a=l.instance,u=l.currentTarget,l=l.listener,a!==o&&s.isPropagationStopped())break e;YR(s,l,u),o=a}}}if(yd)throw n=xw,yd=!1,xw=null,n}function mt(n,e){var t=e[$w];t===void 0&&(t=e[$w]=new Set);var r=n+"__bubble";t.has(r)||(qM(e,n,2,!1),t.add(r))}function cm(n,e,t){var r=0;e&&(r|=4),qM(t,n,r,e)}var Wc="_reactListening"+Math.random().toString(36).slice(2);function Iu(n){if(!n[Wc]){n[Wc]=!0,rM.forEach(function(t){t!=="selectionchange"&&(cD.has(t)||cm(t,!1,n),cm(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Wc]||(e[Wc]=!0,cm("selectionchange",!1,e))}}function qM(n,e,t,r){switch(HM(e)){case 1:var s=EH;break;case 4:s=TH;break;default:s=wy}t=s.bind(null,e,t,n),s=void 0,!Iw||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?n.addEventListener(e,t,{capture:!0,passive:s}):n.addEventListener(e,t,!0):s!==void 0?n.addEventListener(e,t,{passive:s}):n.addEventListener(e,t,!1)}function hm(n,e,t,r,s){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(i===4)for(i=r.return;i!==null;){var a=i.tag;if((a===3||a===4)&&(a=i.stateNode.containerInfo,a===s||a.nodeType===8&&a.parentNode===s))return;i=i.return}for(;l!==null;){if(i=ai(l),i===null)return;if(a=i.tag,a===5||a===6){r=o=i;continue e}l=l.parentNode}}r=r.return}yM(function(){var u=o,c=fy(t),d=[];e:{var f=KM.get(n);if(f!==void 0){var m=yy,p=n;switch(n){case"keypress":if(Kh(t)===0)break e;case"keydown":case"keyup":m=$H;break;case"focusin":p="focus",m=sm;break;case"focusout":p="blur",m=sm;break;case"beforeblur":case"afterblur":m=sm;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=HR;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=OH;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=UH;break;case zM:case YM:case jM:m=AH;break;case GM:m=YH;break;case"scroll":m=MH;break;case"wheel":m=GH;break;case"copy":case"cut":case"paste":m=HH;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=kR}var w=(e&4)!==0,M=!w&&n==="scroll",S=w?f!==null?f+"Capture":null:f;w=[];for(var y=u,v;y!==null;){v=y;var R=v.stateNode;if(v.tag===5&&R!==null&&(v=R,S!==null&&(R=bu(y,S),R!=null&&w.push(xu(y,R,v)))),M)break;y=y.return}0<w.length&&(f=new m(f,p,null,t,c),d.push({event:f,listeners:w}))}}if(!(e&7)){e:{if(f=n==="mouseover"||n==="pointerover",m=n==="mouseout"||n==="pointerout",f&&t!==_w&&(p=t.relatedTarget||t.fromElement)&&(ai(p)||p[$s]))break e;if((m||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,m?(p=t.relatedTarget||t.toElement,m=u,p=p?ai(p):null,p!==null&&(M=Pi(p),p!==M||p.tag!==5&&p.tag!==6)&&(p=null)):(m=null,p=u),m!==p)){if(w=HR,R="onMouseLeave",S="onMouseEnter",y="mouse",(n==="pointerout"||n==="pointerover")&&(w=kR,R="onPointerLeave",S="onPointerEnter",y="pointer"),M=m==null?f:Cl(m),v=p==null?f:Cl(p),f=new w(R,y+"leave",m,t,c),f.target=M,f.relatedTarget=v,R=null,ai(c)===u&&(w=new w(S,y+"enter",p,t,c),w.target=v,w.relatedTarget=M,R=w),M=R,m&&p)t:{for(w=m,S=p,y=0,v=w;v;v=Wi(v))y++;for(v=0,R=S;R;R=Wi(R))v++;for(;0<y-v;)w=Wi(w),y--;for(;0<v-y;)S=Wi(S),v--;for(;y--;){if(w===S||S!==null&&w===S.alternate)break t;w=Wi(w),S=Wi(S)}w=null}else w=null;m!==null&&jR(d,f,m,w,!1),p!==null&&M!==null&&jR(d,M,p,w,!0)}}e:{if(f=u?Cl(u):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var I=eD;else if(FR(f))if(VM)I=sD;else{I=nD;var F=tD}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(I=rD);if(I&&(I=I(n,u))){FM(d,I,t,c);break e}F&&F(n,f,u),n==="focusout"&&(F=f._wrapperState)&&F.controlled&&f.type==="number"&&Rw(f,"number",f.value)}switch(F=u?Cl(u):window,n){case"focusin":(FR(F)||F.contentEditable==="true")&&(pl=F,Dw=u,ru=null);break;case"focusout":ru=Dw=pl=null;break;case"mousedown":kw=!0;break;case"contextmenu":case"mouseup":case"dragend":kw=!1,UR(d,t,c);break;case"selectionchange":if(lD)break;case"keydown":case"keyup":UR(d,t,c)}var L;if(Sy)e:{switch(n){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else ml?NM(n,t)&&(j="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(j="onCompositionStart");j&&(kM&&t.locale!=="ko"&&(ml||j!=="onCompositionStart"?j==="onCompositionEnd"&&ml&&(L=DM()):(mo=c,Cy="value"in mo?mo.value:mo.textContent,ml=!0)),F=Ed(u,j),0<F.length&&(j=new DR(j,n,null,t,c),d.push({event:j,listeners:F}),L?j.data=L:(L=LM(t),L!==null&&(j.data=L)))),(L=XH?qH(n,t):QH(n,t))&&(u=Ed(u,"onBeforeInput"),0<u.length&&(c=new DR("onBeforeInput","beforeinput",null,t,c),d.push({event:c,listeners:u}),c.data=L))}XM(d,e)})}function xu(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Ed(n,e){for(var t=e+"Capture",r=[];n!==null;){var s=n,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=bu(n,t),o!=null&&r.unshift(xu(n,o,s)),o=bu(n,e),o!=null&&r.push(xu(n,o,s))),n=n.return}return r}function Wi(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function jR(n,e,t,r,s){for(var o=e._reactName,i=[];t!==null&&t!==r;){var l=t,a=l.alternate,u=l.stateNode;if(a!==null&&a===r)break;l.tag===5&&u!==null&&(l=u,s?(a=bu(t,o),a!=null&&i.unshift(xu(t,a,l))):s||(a=bu(t,o),a!=null&&i.push(xu(t,a,l)))),t=t.return}i.length!==0&&n.push({event:e,listeners:i})}var hD=/\r\n?/g,dD=/\u0000|\uFFFD/g;function GR(n){return(typeof n=="string"?n:""+n).replace(hD,`
`).replace(dD,"")}function Uc(n,e,t){if(e=GR(e),GR(n)!==e&&t)throw Error(ne(425))}function Td(){}var Nw=null,Lw=null;function Fw(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Vw=typeof setTimeout=="function"?setTimeout:void 0,fD=typeof clearTimeout=="function"?clearTimeout:void 0,KR=typeof Promise=="function"?Promise:void 0,gD=typeof queueMicrotask=="function"?queueMicrotask:typeof KR<"u"?function(n){return KR.resolve(null).then(n).catch(mD)}:Vw;function mD(n){setTimeout(function(){throw n})}function dm(n,e){var t=e,r=0;do{var s=t.nextSibling;if(n.removeChild(t),s&&s.nodeType===8)if(t=s.data,t==="/$"){if(r===0){n.removeChild(s),Mu(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=s}while(t);Mu(e)}function bo(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function XR(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var na=Math.random().toString(36).slice(2),rs="__reactFiber$"+na,Au="__reactProps$"+na,$s="__reactContainer$"+na,$w="__reactEvents$"+na,pD="__reactListeners$"+na,wD="__reactHandles$"+na;function ai(n){var e=n[rs];if(e)return e;for(var t=n.parentNode;t;){if(e=t[$s]||t[rs]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=XR(n);n!==null;){if(t=n[rs])return t;n=XR(n)}return e}n=t,t=n.parentNode}return null}function ic(n){return n=n[rs]||n[$s],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Cl(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(ne(33))}function If(n){return n[Au]||null}var Bw=[],yl=-1;function Lo(n){return{current:n}}function pt(n){0>yl||(n.current=Bw[yl],Bw[yl]=null,yl--)}function ht(n,e){yl++,Bw[yl]=n.current,n.current=e}var Do={},wn=Lo(Do),Vn=Lo(!1),vi=Do;function Vl(n,e){var t=n.type.contextTypes;if(!t)return Do;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in t)s[o]=e[o];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=s),s}function $n(n){return n=n.childContextTypes,n!=null}function Md(){pt(Vn),pt(wn)}function qR(n,e,t){if(wn.current!==Do)throw Error(ne(168));ht(wn,e),ht(Vn,t)}function QM(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(ne(108,tH(n)||"Unknown",s));return Ot({},t,r)}function _d(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Do,vi=wn.current,ht(wn,n),ht(Vn,Vn.current),!0}function QR(n,e,t){var r=n.stateNode;if(!r)throw Error(ne(169));t?(n=QM(n,e,vi),r.__reactInternalMemoizedMergedChildContext=n,pt(Vn),pt(wn),ht(wn,n)):pt(Vn),ht(Vn,t)}var xs=null,xf=!1,fm=!1;function ZM(n){xs===null?xs=[n]:xs.push(n)}function CD(n){xf=!0,ZM(n)}function Fo(){if(!fm&&xs!==null){fm=!0;var n=0,e=rt;try{var t=xs;for(rt=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}xs=null,xf=!1}catch(s){throw xs!==null&&(xs=xs.slice(n+1)),bM(gy,Fo),s}finally{rt=e,fm=!1}}return null}var vl=[],Sl=0,Od=null,Id=0,cr=[],hr=0,Si=null,As=1,Ps="";function oi(n,e){vl[Sl++]=Id,vl[Sl++]=Od,Od=n,Id=e}function JM(n,e,t){cr[hr++]=As,cr[hr++]=Ps,cr[hr++]=Si,Si=n;var r=As;n=Ps;var s=32-kr(r)-1;r&=~(1<<s),t+=1;var o=32-kr(e)+s;if(30<o){var i=s-s%5;o=(r&(1<<i)-1).toString(32),r>>=i,s-=i,As=1<<32-kr(e)+s|t<<s|r,Ps=o+n}else As=1<<o|t<<s|r,Ps=n}function by(n){n.return!==null&&(oi(n,1),JM(n,1,0))}function Ey(n){for(;n===Od;)Od=vl[--Sl],vl[Sl]=null,Id=vl[--Sl],vl[Sl]=null;for(;n===Si;)Si=cr[--hr],cr[hr]=null,Ps=cr[--hr],cr[hr]=null,As=cr[--hr],cr[hr]=null}var Qn=null,Xn=null,St=!1,Pr=null;function e_(n,e){var t=fr(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function ZR(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Qn=n,Xn=bo(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Qn=n,Xn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Si!==null?{id:As,overflow:Ps}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=fr(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Qn=n,Xn=null,!0):!1;default:return!1}}function Ww(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Uw(n){if(St){var e=Xn;if(e){var t=e;if(!ZR(n,e)){if(Ww(n))throw Error(ne(418));e=bo(t.nextSibling);var r=Qn;e&&ZR(n,e)?e_(r,t):(n.flags=n.flags&-4097|2,St=!1,Qn=n)}}else{if(Ww(n))throw Error(ne(418));n.flags=n.flags&-4097|2,St=!1,Qn=n}}}function JR(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Qn=n}function zc(n){if(n!==Qn)return!1;if(!St)return JR(n),St=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!Fw(n.type,n.memoizedProps)),e&&(e=Xn)){if(Ww(n))throw t_(),Error(ne(418));for(;e;)e_(n,e),e=bo(e.nextSibling)}if(JR(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(ne(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Xn=bo(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Xn=null}}else Xn=Qn?bo(n.stateNode.nextSibling):null;return!0}function t_(){for(var n=Xn;n;)n=bo(n.nextSibling)}function $l(){Xn=Qn=null,St=!1}function Ty(n){Pr===null?Pr=[n]:Pr.push(n)}var yD=Ys.ReactCurrentBatchConfig;function va(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(ne(309));var r=t.stateNode}if(!r)throw Error(ne(147,n));var s=r,o=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(i){var l=s.refs;i===null?delete l[o]:l[o]=i},e._stringRef=o,e)}if(typeof n!="string")throw Error(ne(284));if(!t._owner)throw Error(ne(290,n))}return n}function Yc(n,e){throw n=Object.prototype.toString.call(e),Error(ne(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function eb(n){var e=n._init;return e(n._payload)}function n_(n){function e(S,y){if(n){var v=S.deletions;v===null?(S.deletions=[y],S.flags|=16):v.push(y)}}function t(S,y){if(!n)return null;for(;y!==null;)e(S,y),y=y.sibling;return null}function r(S,y){for(S=new Map;y!==null;)y.key!==null?S.set(y.key,y):S.set(y.index,y),y=y.sibling;return S}function s(S,y){return S=_o(S,y),S.index=0,S.sibling=null,S}function o(S,y,v){return S.index=v,n?(v=S.alternate,v!==null?(v=v.index,v<y?(S.flags|=2,y):v):(S.flags|=2,y)):(S.flags|=1048576,y)}function i(S){return n&&S.alternate===null&&(S.flags|=2),S}function l(S,y,v,R){return y===null||y.tag!==6?(y=vm(v,S.mode,R),y.return=S,y):(y=s(y,v),y.return=S,y)}function a(S,y,v,R){var I=v.type;return I===gl?c(S,y,v.props.children,R,v.key):y!==null&&(y.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===uo&&eb(I)===y.type)?(R=s(y,v.props),R.ref=va(S,y,v),R.return=S,R):(R=td(v.type,v.key,v.props,null,S.mode,R),R.ref=va(S,y,v),R.return=S,R)}function u(S,y,v,R){return y===null||y.tag!==4||y.stateNode.containerInfo!==v.containerInfo||y.stateNode.implementation!==v.implementation?(y=Sm(v,S.mode,R),y.return=S,y):(y=s(y,v.children||[]),y.return=S,y)}function c(S,y,v,R,I){return y===null||y.tag!==7?(y=pi(v,S.mode,R,I),y.return=S,y):(y=s(y,v),y.return=S,y)}function d(S,y,v){if(typeof y=="string"&&y!==""||typeof y=="number")return y=vm(""+y,S.mode,v),y.return=S,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Dc:return v=td(y.type,y.key,y.props,null,S.mode,v),v.ref=va(S,null,y),v.return=S,v;case fl:return y=Sm(y,S.mode,v),y.return=S,y;case uo:var R=y._init;return d(S,R(y._payload),v)}if(ja(y)||ma(y))return y=pi(y,S.mode,v,null),y.return=S,y;Yc(S,y)}return null}function f(S,y,v,R){var I=y!==null?y.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return I!==null?null:l(S,y,""+v,R);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Dc:return v.key===I?a(S,y,v,R):null;case fl:return v.key===I?u(S,y,v,R):null;case uo:return I=v._init,f(S,y,I(v._payload),R)}if(ja(v)||ma(v))return I!==null?null:c(S,y,v,R,null);Yc(S,v)}return null}function m(S,y,v,R,I){if(typeof R=="string"&&R!==""||typeof R=="number")return S=S.get(v)||null,l(y,S,""+R,I);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case Dc:return S=S.get(R.key===null?v:R.key)||null,a(y,S,R,I);case fl:return S=S.get(R.key===null?v:R.key)||null,u(y,S,R,I);case uo:var F=R._init;return m(S,y,v,F(R._payload),I)}if(ja(R)||ma(R))return S=S.get(v)||null,c(y,S,R,I,null);Yc(y,R)}return null}function p(S,y,v,R){for(var I=null,F=null,L=y,j=y=0,X=null;L!==null&&j<v.length;j++){L.index>j?(X=L,L=null):X=L.sibling;var G=f(S,L,v[j],R);if(G===null){L===null&&(L=X);break}n&&L&&G.alternate===null&&e(S,L),y=o(G,y,j),F===null?I=G:F.sibling=G,F=G,L=X}if(j===v.length)return t(S,L),St&&oi(S,j),I;if(L===null){for(;j<v.length;j++)L=d(S,v[j],R),L!==null&&(y=o(L,y,j),F===null?I=L:F.sibling=L,F=L);return St&&oi(S,j),I}for(L=r(S,L);j<v.length;j++)X=m(L,S,j,v[j],R),X!==null&&(n&&X.alternate!==null&&L.delete(X.key===null?j:X.key),y=o(X,y,j),F===null?I=X:F.sibling=X,F=X);return n&&L.forEach(function(te){return e(S,te)}),St&&oi(S,j),I}function w(S,y,v,R){var I=ma(v);if(typeof I!="function")throw Error(ne(150));if(v=I.call(v),v==null)throw Error(ne(151));for(var F=I=null,L=y,j=y=0,X=null,G=v.next();L!==null&&!G.done;j++,G=v.next()){L.index>j?(X=L,L=null):X=L.sibling;var te=f(S,L,G.value,R);if(te===null){L===null&&(L=X);break}n&&L&&te.alternate===null&&e(S,L),y=o(te,y,j),F===null?I=te:F.sibling=te,F=te,L=X}if(G.done)return t(S,L),St&&oi(S,j),I;if(L===null){for(;!G.done;j++,G=v.next())G=d(S,G.value,R),G!==null&&(y=o(G,y,j),F===null?I=G:F.sibling=G,F=G);return St&&oi(S,j),I}for(L=r(S,L);!G.done;j++,G=v.next())G=m(L,S,j,G.value,R),G!==null&&(n&&G.alternate!==null&&L.delete(G.key===null?j:G.key),y=o(G,y,j),F===null?I=G:F.sibling=G,F=G);return n&&L.forEach(function(ie){return e(S,ie)}),St&&oi(S,j),I}function M(S,y,v,R){if(typeof v=="object"&&v!==null&&v.type===gl&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Dc:e:{for(var I=v.key,F=y;F!==null;){if(F.key===I){if(I=v.type,I===gl){if(F.tag===7){t(S,F.sibling),y=s(F,v.props.children),y.return=S,S=y;break e}}else if(F.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===uo&&eb(I)===F.type){t(S,F.sibling),y=s(F,v.props),y.ref=va(S,F,v),y.return=S,S=y;break e}t(S,F);break}else e(S,F);F=F.sibling}v.type===gl?(y=pi(v.props.children,S.mode,R,v.key),y.return=S,S=y):(R=td(v.type,v.key,v.props,null,S.mode,R),R.ref=va(S,y,v),R.return=S,S=R)}return i(S);case fl:e:{for(F=v.key;y!==null;){if(y.key===F)if(y.tag===4&&y.stateNode.containerInfo===v.containerInfo&&y.stateNode.implementation===v.implementation){t(S,y.sibling),y=s(y,v.children||[]),y.return=S,S=y;break e}else{t(S,y);break}else e(S,y);y=y.sibling}y=Sm(v,S.mode,R),y.return=S,S=y}return i(S);case uo:return F=v._init,M(S,y,F(v._payload),R)}if(ja(v))return p(S,y,v,R);if(ma(v))return w(S,y,v,R);Yc(S,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,y!==null&&y.tag===6?(t(S,y.sibling),y=s(y,v),y.return=S,S=y):(t(S,y),y=vm(v,S.mode,R),y.return=S,S=y),i(S)):t(S,y)}return M}var Bl=n_(!0),r_=n_(!1),xd=Lo(null),Ad=null,Rl=null,My=null;function _y(){My=Rl=Ad=null}function Oy(n){var e=xd.current;pt(xd),n._currentValue=e}function zw(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function Hl(n,e){Ad=n,My=Rl=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Ln=!0),n.firstContext=null)}function mr(n){var e=n._currentValue;if(My!==n)if(n={context:n,memoizedValue:e,next:null},Rl===null){if(Ad===null)throw Error(ne(308));Rl=n,Ad.dependencies={lanes:0,firstContext:n}}else Rl=Rl.next=n;return e}var ui=null;function Iy(n){ui===null?ui=[n]:ui.push(n)}function s_(n,e,t,r){var s=e.interleaved;return s===null?(t.next=t,Iy(e)):(t.next=s.next,s.next=t),e.interleaved=t,Bs(n,r)}function Bs(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var co=!1;function xy(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function o_(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Ns(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Eo(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,qe&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Bs(n,t)}return s=r.interleaved,s===null?(e.next=e,Iy(r)):(e.next=s.next,s.next=e),r.interleaved=e,Bs(n,t)}function Xh(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,my(n,t)}}function tb(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var s=null,o=null;if(t=t.firstBaseUpdate,t!==null){do{var i={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};o===null?s=o=i:o=o.next=i,t=t.next}while(t!==null);o===null?s=o=e:o=o.next=e}else s=o=e;t={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Pd(n,e,t,r){var s=n.updateQueue;co=!1;var o=s.firstBaseUpdate,i=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var a=l,u=a.next;a.next=null,i===null?o=u:i.next=u,i=a;var c=n.alternate;c!==null&&(c=c.updateQueue,l=c.lastBaseUpdate,l!==i&&(l===null?c.firstBaseUpdate=u:l.next=u,c.lastBaseUpdate=a))}if(o!==null){var d=s.baseState;i=0,c=u=a=null,l=o;do{var f=l.lane,m=l.eventTime;if((r&f)===f){c!==null&&(c=c.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var p=n,w=l;switch(f=e,m=t,w.tag){case 1:if(p=w.payload,typeof p=="function"){d=p.call(m,d,f);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=w.payload,f=typeof p=="function"?p.call(m,d,f):p,f==null)break e;d=Ot({},d,f);break e;case 2:co=!0}}l.callback!==null&&l.lane!==0&&(n.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else m={eventTime:m,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},c===null?(u=c=m,a=d):c=c.next=m,i|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(c===null&&(a=d),s.baseState=a,s.firstBaseUpdate=u,s.lastBaseUpdate=c,e=s.shared.interleaved,e!==null){s=e;do i|=s.lane,s=s.next;while(s!==e)}else o===null&&(s.shared.lanes=0);bi|=i,n.lanes=i,n.memoizedState=d}}function nb(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],s=r.callback;if(s!==null){if(r.callback=null,r=t,typeof s!="function")throw Error(ne(191,s));s.call(r)}}}var lc={},as=Lo(lc),Pu=Lo(lc),Hu=Lo(lc);function ci(n){if(n===lc)throw Error(ne(174));return n}function Ay(n,e){switch(ht(Hu,e),ht(Pu,n),ht(as,lc),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Ew(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Ew(e,n)}pt(as),ht(as,e)}function Wl(){pt(as),pt(Pu),pt(Hu)}function i_(n){ci(Hu.current);var e=ci(as.current),t=Ew(e,n.type);e!==t&&(ht(Pu,n),ht(as,t))}function Py(n){Pu.current===n&&(pt(as),pt(Pu))}var bt=Lo(0);function Hd(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var gm=[];function Hy(){for(var n=0;n<gm.length;n++)gm[n]._workInProgressVersionPrimary=null;gm.length=0}var qh=Ys.ReactCurrentDispatcher,mm=Ys.ReactCurrentBatchConfig,Ri=0,Mt=null,jt=null,Zt=null,Dd=!1,su=!1,Du=0,vD=0;function hn(){throw Error(ne(321))}function Dy(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Fr(n[t],e[t]))return!1;return!0}function ky(n,e,t,r,s,o){if(Ri=o,Mt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,qh.current=n===null||n.memoizedState===null?ED:TD,n=t(r,s),su){o=0;do{if(su=!1,Du=0,25<=o)throw Error(ne(301));o+=1,Zt=jt=null,e.updateQueue=null,qh.current=MD,n=t(r,s)}while(su)}if(qh.current=kd,e=jt!==null&&jt.next!==null,Ri=0,Zt=jt=Mt=null,Dd=!1,e)throw Error(ne(300));return n}function Ny(){var n=Du!==0;return Du=0,n}function Jr(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zt===null?Mt.memoizedState=Zt=n:Zt=Zt.next=n,Zt}function pr(){if(jt===null){var n=Mt.alternate;n=n!==null?n.memoizedState:null}else n=jt.next;var e=Zt===null?Mt.memoizedState:Zt.next;if(e!==null)Zt=e,jt=n;else{if(n===null)throw Error(ne(310));jt=n,n={memoizedState:jt.memoizedState,baseState:jt.baseState,baseQueue:jt.baseQueue,queue:jt.queue,next:null},Zt===null?Mt.memoizedState=Zt=n:Zt=Zt.next=n}return Zt}function ku(n,e){return typeof e=="function"?e(n):e}function pm(n){var e=pr(),t=e.queue;if(t===null)throw Error(ne(311));t.lastRenderedReducer=n;var r=jt,s=r.baseQueue,o=t.pending;if(o!==null){if(s!==null){var i=s.next;s.next=o.next,o.next=i}r.baseQueue=s=o,t.pending=null}if(s!==null){o=s.next,r=r.baseState;var l=i=null,a=null,u=o;do{var c=u.lane;if((Ri&c)===c)a!==null&&(a=a.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:n(r,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};a===null?(l=a=d,i=r):a=a.next=d,Mt.lanes|=c,bi|=c}u=u.next}while(u!==null&&u!==o);a===null?i=r:a.next=l,Fr(r,e.memoizedState)||(Ln=!0),e.memoizedState=r,e.baseState=i,e.baseQueue=a,t.lastRenderedState=r}if(n=t.interleaved,n!==null){s=n;do o=s.lane,Mt.lanes|=o,bi|=o,s=s.next;while(s!==n)}else s===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function wm(n){var e=pr(),t=e.queue;if(t===null)throw Error(ne(311));t.lastRenderedReducer=n;var r=t.dispatch,s=t.pending,o=e.memoizedState;if(s!==null){t.pending=null;var i=s=s.next;do o=n(o,i.action),i=i.next;while(i!==s);Fr(o,e.memoizedState)||(Ln=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),t.lastRenderedState=o}return[o,r]}function l_(){}function a_(n,e){var t=Mt,r=pr(),s=e(),o=!Fr(r.memoizedState,s);if(o&&(r.memoizedState=s,Ln=!0),r=r.queue,Ly(h_.bind(null,t,r,n),[n]),r.getSnapshot!==e||o||Zt!==null&&Zt.memoizedState.tag&1){if(t.flags|=2048,Nu(9,c_.bind(null,t,r,s,e),void 0,null),Jt===null)throw Error(ne(349));Ri&30||u_(t,e,s)}return s}function u_(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Mt.updateQueue,e===null?(e={lastEffect:null,stores:null},Mt.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function c_(n,e,t,r){e.value=t,e.getSnapshot=r,d_(e)&&f_(n)}function h_(n,e,t){return t(function(){d_(e)&&f_(n)})}function d_(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Fr(n,t)}catch{return!0}}function f_(n){var e=Bs(n,1);e!==null&&Nr(e,n,1,-1)}function rb(n){var e=Jr();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ku,lastRenderedState:n},e.queue=n,n=n.dispatch=bD.bind(null,Mt,n),[e.memoizedState,n]}function Nu(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=Mt.updateQueue,e===null?(e={lastEffect:null,stores:null},Mt.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function g_(){return pr().memoizedState}function Qh(n,e,t,r){var s=Jr();Mt.flags|=n,s.memoizedState=Nu(1|e,t,void 0,r===void 0?null:r)}function Af(n,e,t,r){var s=pr();r=r===void 0?null:r;var o=void 0;if(jt!==null){var i=jt.memoizedState;if(o=i.destroy,r!==null&&Dy(r,i.deps)){s.memoizedState=Nu(e,t,o,r);return}}Mt.flags|=n,s.memoizedState=Nu(1|e,t,o,r)}function sb(n,e){return Qh(8390656,8,n,e)}function Ly(n,e){return Af(2048,8,n,e)}function m_(n,e){return Af(4,2,n,e)}function p_(n,e){return Af(4,4,n,e)}function w_(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function C_(n,e,t){return t=t!=null?t.concat([n]):null,Af(4,4,w_.bind(null,e,n),t)}function Fy(){}function y_(n,e){var t=pr();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&Dy(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function v_(n,e){var t=pr();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&Dy(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function S_(n,e,t){return Ri&21?(Fr(t,e)||(t=MM(),Mt.lanes|=t,bi|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Ln=!0),n.memoizedState=t)}function SD(n,e){var t=rt;rt=t!==0&&4>t?t:4,n(!0);var r=mm.transition;mm.transition={};try{n(!1),e()}finally{rt=t,mm.transition=r}}function R_(){return pr().memoizedState}function RD(n,e,t){var r=Mo(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},b_(n))E_(e,t);else if(t=s_(n,e,t,r),t!==null){var s=Tn();Nr(t,n,r,s),T_(t,e,r)}}function bD(n,e,t){var r=Mo(n),s={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(b_(n))E_(e,s);else{var o=n.alternate;if(n.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var i=e.lastRenderedState,l=o(i,t);if(s.hasEagerState=!0,s.eagerState=l,Fr(l,i)){var a=e.interleaved;a===null?(s.next=s,Iy(e)):(s.next=a.next,a.next=s),e.interleaved=s;return}}catch{}finally{}t=s_(n,e,s,r),t!==null&&(s=Tn(),Nr(t,n,r,s),T_(t,e,r))}}function b_(n){var e=n.alternate;return n===Mt||e!==null&&e===Mt}function E_(n,e){su=Dd=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function T_(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,my(n,t)}}var kd={readContext:mr,useCallback:hn,useContext:hn,useEffect:hn,useImperativeHandle:hn,useInsertionEffect:hn,useLayoutEffect:hn,useMemo:hn,useReducer:hn,useRef:hn,useState:hn,useDebugValue:hn,useDeferredValue:hn,useTransition:hn,useMutableSource:hn,useSyncExternalStore:hn,useId:hn,unstable_isNewReconciler:!1},ED={readContext:mr,useCallback:function(n,e){return Jr().memoizedState=[n,e===void 0?null:e],n},useContext:mr,useEffect:sb,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Qh(4194308,4,w_.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Qh(4194308,4,n,e)},useInsertionEffect:function(n,e){return Qh(4,2,n,e)},useMemo:function(n,e){var t=Jr();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=Jr();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=RD.bind(null,Mt,n),[r.memoizedState,n]},useRef:function(n){var e=Jr();return n={current:n},e.memoizedState=n},useState:rb,useDebugValue:Fy,useDeferredValue:function(n){return Jr().memoizedState=n},useTransition:function(){var n=rb(!1),e=n[0];return n=SD.bind(null,n[1]),Jr().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=Mt,s=Jr();if(St){if(t===void 0)throw Error(ne(407));t=t()}else{if(t=e(),Jt===null)throw Error(ne(349));Ri&30||u_(r,e,t)}s.memoizedState=t;var o={value:t,getSnapshot:e};return s.queue=o,sb(h_.bind(null,r,o,n),[n]),r.flags|=2048,Nu(9,c_.bind(null,r,o,t,e),void 0,null),t},useId:function(){var n=Jr(),e=Jt.identifierPrefix;if(St){var t=Ps,r=As;t=(r&~(1<<32-kr(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Du++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=vD++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},TD={readContext:mr,useCallback:y_,useContext:mr,useEffect:Ly,useImperativeHandle:C_,useInsertionEffect:m_,useLayoutEffect:p_,useMemo:v_,useReducer:pm,useRef:g_,useState:function(){return pm(ku)},useDebugValue:Fy,useDeferredValue:function(n){var e=pr();return S_(e,jt.memoizedState,n)},useTransition:function(){var n=pm(ku)[0],e=pr().memoizedState;return[n,e]},useMutableSource:l_,useSyncExternalStore:a_,useId:R_,unstable_isNewReconciler:!1},MD={readContext:mr,useCallback:y_,useContext:mr,useEffect:Ly,useImperativeHandle:C_,useInsertionEffect:m_,useLayoutEffect:p_,useMemo:v_,useReducer:wm,useRef:g_,useState:function(){return wm(ku)},useDebugValue:Fy,useDeferredValue:function(n){var e=pr();return jt===null?e.memoizedState=n:S_(e,jt.memoizedState,n)},useTransition:function(){var n=wm(ku)[0],e=pr().memoizedState;return[n,e]},useMutableSource:l_,useSyncExternalStore:a_,useId:R_,unstable_isNewReconciler:!1};function xr(n,e){if(n&&n.defaultProps){e=Ot({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function Yw(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:Ot({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var Pf={isMounted:function(n){return(n=n._reactInternals)?Pi(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=Tn(),s=Mo(n),o=Ns(r,s);o.payload=e,t!=null&&(o.callback=t),e=Eo(n,o,s),e!==null&&(Nr(e,n,s,r),Xh(e,n,s))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=Tn(),s=Mo(n),o=Ns(r,s);o.tag=1,o.payload=e,t!=null&&(o.callback=t),e=Eo(n,o,s),e!==null&&(Nr(e,n,s,r),Xh(e,n,s))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Tn(),r=Mo(n),s=Ns(t,r);s.tag=2,e!=null&&(s.callback=e),e=Eo(n,s,r),e!==null&&(Nr(e,n,r,t),Xh(e,n,r))}};function ob(n,e,t,r,s,o,i){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,o,i):e.prototype&&e.prototype.isPureReactComponent?!Ou(t,r)||!Ou(s,o):!0}function M_(n,e,t){var r=!1,s=Do,o=e.contextType;return typeof o=="object"&&o!==null?o=mr(o):(s=$n(e)?vi:wn.current,r=e.contextTypes,o=(r=r!=null)?Vl(n,s):Do),e=new e(t,o),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Pf,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=s,n.__reactInternalMemoizedMaskedChildContext=o),e}function ib(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&Pf.enqueueReplaceState(e,e.state,null)}function jw(n,e,t,r){var s=n.stateNode;s.props=t,s.state=n.memoizedState,s.refs={},xy(n);var o=e.contextType;typeof o=="object"&&o!==null?s.context=mr(o):(o=$n(e)?vi:wn.current,s.context=Vl(n,o)),s.state=n.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Yw(n,e,o,t),s.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Pf.enqueueReplaceState(s,s.state,null),Pd(n,t,s,r),s.state=n.memoizedState),typeof s.componentDidMount=="function"&&(n.flags|=4194308)}function Ul(n,e){try{var t="",r=e;do t+=eH(r),r=r.return;while(r);var s=t}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:n,source:e,stack:s,digest:null}}function Cm(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function Gw(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var _D=typeof WeakMap=="function"?WeakMap:Map;function __(n,e,t){t=Ns(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){Ld||(Ld=!0,rC=r),Gw(n,e)},t}function O_(n,e,t){t=Ns(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;t.payload=function(){return r(s)},t.callback=function(){Gw(n,e)}}var o=n.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(t.callback=function(){Gw(n,e),typeof r!="function"&&(To===null?To=new Set([this]):To.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),t}function lb(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new _D;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(t)||(s.add(t),n=BD.bind(null,n,e,t),e.then(n,n))}function ab(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function ub(n,e,t,r,s){return n.mode&1?(n.flags|=65536,n.lanes=s,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Ns(-1,1),e.tag=2,Eo(t,e,1))),t.lanes|=1),n)}var OD=Ys.ReactCurrentOwner,Ln=!1;function En(n,e,t,r){e.child=n===null?r_(e,null,t,r):Bl(e,n.child,t,r)}function cb(n,e,t,r,s){t=t.render;var o=e.ref;return Hl(e,s),r=ky(n,e,t,r,o,s),t=Ny(),n!==null&&!Ln?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,Ws(n,e,s)):(St&&t&&by(e),e.flags|=1,En(n,e,r,s),e.child)}function hb(n,e,t,r,s){if(n===null){var o=t.type;return typeof o=="function"&&!jy(o)&&o.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=o,I_(n,e,o,r,s)):(n=td(t.type,null,r,e,e.mode,s),n.ref=e.ref,n.return=e,e.child=n)}if(o=n.child,!(n.lanes&s)){var i=o.memoizedProps;if(t=t.compare,t=t!==null?t:Ou,t(i,r)&&n.ref===e.ref)return Ws(n,e,s)}return e.flags|=1,n=_o(o,r),n.ref=e.ref,n.return=e,e.child=n}function I_(n,e,t,r,s){if(n!==null){var o=n.memoizedProps;if(Ou(o,r)&&n.ref===e.ref)if(Ln=!1,e.pendingProps=r=o,(n.lanes&s)!==0)n.flags&131072&&(Ln=!0);else return e.lanes=n.lanes,Ws(n,e,s)}return Kw(n,e,t,r,s)}function x_(n,e,t){var r=e.pendingProps,s=r.children,o=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ht(El,Gn),Gn|=t;else{if(!(t&1073741824))return n=o!==null?o.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,ht(El,Gn),Gn|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:t,ht(El,Gn),Gn|=r}else o!==null?(r=o.baseLanes|t,e.memoizedState=null):r=t,ht(El,Gn),Gn|=r;return En(n,e,s,t),e.child}function A_(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Kw(n,e,t,r,s){var o=$n(t)?vi:wn.current;return o=Vl(e,o),Hl(e,s),t=ky(n,e,t,r,o,s),r=Ny(),n!==null&&!Ln?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,Ws(n,e,s)):(St&&r&&by(e),e.flags|=1,En(n,e,t,s),e.child)}function db(n,e,t,r,s){if($n(t)){var o=!0;_d(e)}else o=!1;if(Hl(e,s),e.stateNode===null)Zh(n,e),M_(e,t,r),jw(e,t,r,s),r=!0;else if(n===null){var i=e.stateNode,l=e.memoizedProps;i.props=l;var a=i.context,u=t.contextType;typeof u=="object"&&u!==null?u=mr(u):(u=$n(t)?vi:wn.current,u=Vl(e,u));var c=t.getDerivedStateFromProps,d=typeof c=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==r||a!==u)&&ib(e,i,r,u),co=!1;var f=e.memoizedState;i.state=f,Pd(e,r,i,s),a=e.memoizedState,l!==r||f!==a||Vn.current||co?(typeof c=="function"&&(Yw(e,t,c,r),a=e.memoizedState),(l=co||ob(e,t,l,r,f,a,u))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=a),i.props=r,i.state=a,i.context=u,r=l):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{i=e.stateNode,o_(n,e),l=e.memoizedProps,u=e.type===e.elementType?l:xr(e.type,l),i.props=u,d=e.pendingProps,f=i.context,a=t.contextType,typeof a=="object"&&a!==null?a=mr(a):(a=$n(t)?vi:wn.current,a=Vl(e,a));var m=t.getDerivedStateFromProps;(c=typeof m=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==d||f!==a)&&ib(e,i,r,a),co=!1,f=e.memoizedState,i.state=f,Pd(e,r,i,s);var p=e.memoizedState;l!==d||f!==p||Vn.current||co?(typeof m=="function"&&(Yw(e,t,m,r),p=e.memoizedState),(u=co||ob(e,t,u,r,f,p,a)||!1)?(c||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,p,a),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,p,a)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),i.props=r,i.state=p,i.context=a,r=u):(typeof i.componentDidUpdate!="function"||l===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),r=!1)}return Xw(n,e,t,r,o,s)}function Xw(n,e,t,r,s,o){A_(n,e);var i=(e.flags&128)!==0;if(!r&&!i)return s&&QR(e,t,!1),Ws(n,e,o);r=e.stateNode,OD.current=e;var l=i&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&i?(e.child=Bl(e,n.child,null,o),e.child=Bl(e,null,l,o)):En(n,e,l,o),e.memoizedState=r.state,s&&QR(e,t,!0),e.child}function P_(n){var e=n.stateNode;e.pendingContext?qR(n,e.pendingContext,e.pendingContext!==e.context):e.context&&qR(n,e.context,!1),Ay(n,e.containerInfo)}function fb(n,e,t,r,s){return $l(),Ty(s),e.flags|=256,En(n,e,t,r),e.child}var qw={dehydrated:null,treeContext:null,retryLane:0};function Qw(n){return{baseLanes:n,cachePool:null,transitions:null}}function H_(n,e,t){var r=e.pendingProps,s=bt.current,o=!1,i=(e.flags&128)!==0,l;if((l=i)||(l=n!==null&&n.memoizedState===null?!1:(s&2)!==0),l?(o=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(s|=1),ht(bt,s&1),n===null)return Uw(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=r.children,n=r.fallback,o?(r=e.mode,o=e.child,i={mode:"hidden",children:i},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=kf(i,r,0,null),n=pi(n,r,t,null),o.return=e,n.return=e,o.sibling=n,e.child=o,e.child.memoizedState=Qw(t),e.memoizedState=qw,n):Vy(e,i));if(s=n.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return ID(n,e,i,r,l,s,t);if(o){o=r.fallback,i=e.mode,s=n.child,l=s.sibling;var a={mode:"hidden",children:r.children};return!(i&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=a,e.deletions=null):(r=_o(s,a),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?o=_o(l,o):(o=pi(o,i,t,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,i=n.child.memoizedState,i=i===null?Qw(t):{baseLanes:i.baseLanes|t,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=n.childLanes&~t,e.memoizedState=qw,r}return o=n.child,n=o.sibling,r=_o(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function Vy(n,e){return e=kf({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function jc(n,e,t,r){return r!==null&&Ty(r),Bl(e,n.child,null,t),n=Vy(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function ID(n,e,t,r,s,o,i){if(t)return e.flags&256?(e.flags&=-257,r=Cm(Error(ne(422))),jc(n,e,i,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(o=r.fallback,s=e.mode,r=kf({mode:"visible",children:r.children},s,0,null),o=pi(o,s,i,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&Bl(e,n.child,null,i),e.child.memoizedState=Qw(i),e.memoizedState=qw,o);if(!(e.mode&1))return jc(n,e,i,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,o=Error(ne(419)),r=Cm(o,r,void 0),jc(n,e,i,r)}if(l=(i&n.childLanes)!==0,Ln||l){if(r=Jt,r!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|i)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,Bs(n,s),Nr(r,n,s,-1))}return Yy(),r=Cm(Error(ne(421))),jc(n,e,i,r)}return s.data==="$?"?(e.flags|=128,e.child=n.child,e=WD.bind(null,n),s._reactRetry=e,null):(n=o.treeContext,Xn=bo(s.nextSibling),Qn=e,St=!0,Pr=null,n!==null&&(cr[hr++]=As,cr[hr++]=Ps,cr[hr++]=Si,As=n.id,Ps=n.overflow,Si=e),e=Vy(e,r.children),e.flags|=4096,e)}function gb(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),zw(n.return,e,t)}function ym(n,e,t,r,s){var o=n.memoizedState;o===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=t,o.tailMode=s)}function D_(n,e,t){var r=e.pendingProps,s=r.revealOrder,o=r.tail;if(En(n,e,r.children,t),r=bt.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&gb(n,t,e);else if(n.tag===19)gb(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(ht(bt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(t=e.child,s=null;t!==null;)n=t.alternate,n!==null&&Hd(n)===null&&(s=t),t=t.sibling;t=s,t===null?(s=e.child,e.child=null):(s=t.sibling,t.sibling=null),ym(e,!1,s,t,o);break;case"backwards":for(t=null,s=e.child,e.child=null;s!==null;){if(n=s.alternate,n!==null&&Hd(n)===null){e.child=s;break}n=s.sibling,s.sibling=t,t=s,s=n}ym(e,!0,t,null,o);break;case"together":ym(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Zh(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Ws(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),bi|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(ne(153));if(e.child!==null){for(n=e.child,t=_o(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=_o(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function xD(n,e,t){switch(e.tag){case 3:P_(e),$l();break;case 5:i_(e);break;case 1:$n(e.type)&&_d(e);break;case 4:Ay(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;ht(xd,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ht(bt,bt.current&1),e.flags|=128,null):t&e.child.childLanes?H_(n,e,t):(ht(bt,bt.current&1),n=Ws(n,e,t),n!==null?n.sibling:null);ht(bt,bt.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return D_(n,e,t);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ht(bt,bt.current),r)break;return null;case 22:case 23:return e.lanes=0,x_(n,e,t)}return Ws(n,e,t)}var k_,Zw,N_,L_;k_=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Zw=function(){};N_=function(n,e,t,r){var s=n.memoizedProps;if(s!==r){n=e.stateNode,ci(as.current);var o=null;switch(t){case"input":s=vw(n,s),r=vw(n,r),o=[];break;case"select":s=Ot({},s,{value:void 0}),r=Ot({},r,{value:void 0}),o=[];break;case"textarea":s=bw(n,s),r=bw(n,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=Td)}Tw(t,r);var i;t=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(i in l)l.hasOwnProperty(i)&&(t||(t={}),t[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Su.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var a=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&a!==l&&(a!=null||l!=null))if(u==="style")if(l){for(i in l)!l.hasOwnProperty(i)||a&&a.hasOwnProperty(i)||(t||(t={}),t[i]="");for(i in a)a.hasOwnProperty(i)&&l[i]!==a[i]&&(t||(t={}),t[i]=a[i])}else t||(o||(o=[]),o.push(u,t)),t=a;else u==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,l=l?l.__html:void 0,a!=null&&l!==a&&(o=o||[]).push(u,a)):u==="children"?typeof a!="string"&&typeof a!="number"||(o=o||[]).push(u,""+a):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Su.hasOwnProperty(u)?(a!=null&&u==="onScroll"&&mt("scroll",n),o||l===a||(o=[])):(o=o||[]).push(u,a))}t&&(o=o||[]).push("style",t);var u=o;(e.updateQueue=u)&&(e.flags|=4)}};L_=function(n,e,t,r){t!==r&&(e.flags|=4)};function Sa(n,e){if(!St)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function dn(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=n,s=s.sibling;else for(s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=n,s=s.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function AD(n,e,t){var r=e.pendingProps;switch(Ey(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dn(e),null;case 1:return $n(e.type)&&Md(),dn(e),null;case 3:return r=e.stateNode,Wl(),pt(Vn),pt(wn),Hy(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(zc(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Pr!==null&&(iC(Pr),Pr=null))),Zw(n,e),dn(e),null;case 5:Py(e);var s=ci(Hu.current);if(t=e.type,n!==null&&e.stateNode!=null)N_(n,e,t,r,s),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ne(166));return dn(e),null}if(n=ci(as.current),zc(e)){r=e.stateNode,t=e.type;var o=e.memoizedProps;switch(r[rs]=e,r[Au]=o,n=(e.mode&1)!==0,t){case"dialog":mt("cancel",r),mt("close",r);break;case"iframe":case"object":case"embed":mt("load",r);break;case"video":case"audio":for(s=0;s<Ka.length;s++)mt(Ka[s],r);break;case"source":mt("error",r);break;case"img":case"image":case"link":mt("error",r),mt("load",r);break;case"details":mt("toggle",r);break;case"input":bR(r,o),mt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},mt("invalid",r);break;case"textarea":TR(r,o),mt("invalid",r)}Tw(t,o),s=null;for(var i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="children"?typeof l=="string"?r.textContent!==l&&(o.suppressHydrationWarning!==!0&&Uc(r.textContent,l,n),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&Uc(r.textContent,l,n),s=["children",""+l]):Su.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&mt("scroll",r)}switch(t){case"input":kc(r),ER(r,o,!0);break;case"textarea":kc(r),MR(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Td)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=hM(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=i.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=i.createElement(t,{is:r.is}):(n=i.createElement(t),t==="select"&&(i=n,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):n=i.createElementNS(n,t),n[rs]=e,n[Au]=r,k_(n,e,!1,!1),e.stateNode=n;e:{switch(i=Mw(t,r),t){case"dialog":mt("cancel",n),mt("close",n),s=r;break;case"iframe":case"object":case"embed":mt("load",n),s=r;break;case"video":case"audio":for(s=0;s<Ka.length;s++)mt(Ka[s],n);s=r;break;case"source":mt("error",n),s=r;break;case"img":case"image":case"link":mt("error",n),mt("load",n),s=r;break;case"details":mt("toggle",n),s=r;break;case"input":bR(n,r),s=vw(n,r),mt("invalid",n);break;case"option":s=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},s=Ot({},r,{value:void 0}),mt("invalid",n);break;case"textarea":TR(n,r),s=bw(n,r),mt("invalid",n);break;default:s=r}Tw(t,s),l=s;for(o in l)if(l.hasOwnProperty(o)){var a=l[o];o==="style"?gM(n,a):o==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&dM(n,a)):o==="children"?typeof a=="string"?(t!=="textarea"||a!=="")&&Ru(n,a):typeof a=="number"&&Ru(n,""+a):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Su.hasOwnProperty(o)?a!=null&&o==="onScroll"&&mt("scroll",n):a!=null&&uy(n,o,a,i))}switch(t){case"input":kc(n),ER(n,r,!1);break;case"textarea":kc(n),MR(n);break;case"option":r.value!=null&&n.setAttribute("value",""+Ho(r.value));break;case"select":n.multiple=!!r.multiple,o=r.value,o!=null?Il(n,!!r.multiple,o,!1):r.defaultValue!=null&&Il(n,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(n.onclick=Td)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return dn(e),null;case 6:if(n&&e.stateNode!=null)L_(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ne(166));if(t=ci(Hu.current),ci(as.current),zc(e)){if(r=e.stateNode,t=e.memoizedProps,r[rs]=e,(o=r.nodeValue!==t)&&(n=Qn,n!==null))switch(n.tag){case 3:Uc(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Uc(r.nodeValue,t,(n.mode&1)!==0)}o&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[rs]=e,e.stateNode=r}return dn(e),null;case 13:if(pt(bt),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(St&&Xn!==null&&e.mode&1&&!(e.flags&128))t_(),$l(),e.flags|=98560,o=!1;else if(o=zc(e),r!==null&&r.dehydrated!==null){if(n===null){if(!o)throw Error(ne(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(ne(317));o[rs]=e}else $l(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;dn(e),o=!1}else Pr!==null&&(iC(Pr),Pr=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||bt.current&1?Gt===0&&(Gt=3):Yy())),e.updateQueue!==null&&(e.flags|=4),dn(e),null);case 4:return Wl(),Zw(n,e),n===null&&Iu(e.stateNode.containerInfo),dn(e),null;case 10:return Oy(e.type._context),dn(e),null;case 17:return $n(e.type)&&Md(),dn(e),null;case 19:if(pt(bt),o=e.memoizedState,o===null)return dn(e),null;if(r=(e.flags&128)!==0,i=o.rendering,i===null)if(r)Sa(o,!1);else{if(Gt!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(i=Hd(n),i!==null){for(e.flags|=128,Sa(o,!1),r=i.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)o=t,n=r,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=n,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,n=i.dependencies,o.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return ht(bt,bt.current&1|2),e.child}n=n.sibling}o.tail!==null&&Nt()>zl&&(e.flags|=128,r=!0,Sa(o,!1),e.lanes=4194304)}else{if(!r)if(n=Hd(i),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Sa(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!St)return dn(e),null}else 2*Nt()-o.renderingStartTime>zl&&t!==1073741824&&(e.flags|=128,r=!0,Sa(o,!1),e.lanes=4194304);o.isBackwards?(i.sibling=e.child,e.child=i):(t=o.last,t!==null?t.sibling=i:e.child=i,o.last=i)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Nt(),e.sibling=null,t=bt.current,ht(bt,r?t&1|2:t&1),e):(dn(e),null);case 22:case 23:return zy(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Gn&1073741824&&(dn(e),e.subtreeFlags&6&&(e.flags|=8192)):dn(e),null;case 24:return null;case 25:return null}throw Error(ne(156,e.tag))}function PD(n,e){switch(Ey(e),e.tag){case 1:return $n(e.type)&&Md(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Wl(),pt(Vn),pt(wn),Hy(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Py(e),null;case 13:if(pt(bt),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(ne(340));$l()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return pt(bt),null;case 4:return Wl(),null;case 10:return Oy(e.type._context),null;case 22:case 23:return zy(),null;case 24:return null;default:return null}}var Gc=!1,gn=!1,HD=typeof WeakSet=="function"?WeakSet:Set,ge=null;function bl(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Pt(n,e,r)}else t.current=null}function Jw(n,e,t){try{t()}catch(r){Pt(n,e,r)}}var mb=!1;function DD(n,e){if(Nw=Rd,n=WM(),Ry(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{t.nodeType,o.nodeType}catch{t=null;break e}var i=0,l=-1,a=-1,u=0,c=0,d=n,f=null;t:for(;;){for(var m;d!==t||s!==0&&d.nodeType!==3||(l=i+s),d!==o||r!==0&&d.nodeType!==3||(a=i+r),d.nodeType===3&&(i+=d.nodeValue.length),(m=d.firstChild)!==null;)f=d,d=m;for(;;){if(d===n)break t;if(f===t&&++u===s&&(l=i),f===o&&++c===r&&(a=i),(m=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=m}t=l===-1||a===-1?null:{start:l,end:a}}else t=null}t=t||{start:0,end:0}}else t=null;for(Lw={focusedElem:n,selectionRange:t},Rd=!1,ge=e;ge!==null;)if(e=ge,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,ge=n;else for(;ge!==null;){e=ge;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var w=p.memoizedProps,M=p.memoizedState,S=e.stateNode,y=S.getSnapshotBeforeUpdate(e.elementType===e.type?w:xr(e.type,w),M);S.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ne(163))}}catch(R){Pt(e,e.return,R)}if(n=e.sibling,n!==null){n.return=e.return,ge=n;break}ge=e.return}return p=mb,mb=!1,p}function ou(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&n)===n){var o=s.destroy;s.destroy=void 0,o!==void 0&&Jw(e,t,o)}s=s.next}while(s!==r)}}function Hf(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function eC(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function F_(n){var e=n.alternate;e!==null&&(n.alternate=null,F_(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[rs],delete e[Au],delete e[$w],delete e[pD],delete e[wD])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function V_(n){return n.tag===5||n.tag===3||n.tag===4}function pb(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||V_(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function tC(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Td));else if(r!==4&&(n=n.child,n!==null))for(tC(n,e,t),n=n.sibling;n!==null;)tC(n,e,t),n=n.sibling}function nC(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(nC(n,e,t),n=n.sibling;n!==null;)nC(n,e,t),n=n.sibling}var on=null,Ar=!1;function Qs(n,e,t){for(t=t.child;t!==null;)$_(n,e,t),t=t.sibling}function $_(n,e,t){if(ls&&typeof ls.onCommitFiberUnmount=="function")try{ls.onCommitFiberUnmount(Tf,t)}catch{}switch(t.tag){case 5:gn||bl(t,e);case 6:var r=on,s=Ar;on=null,Qs(n,e,t),on=r,Ar=s,on!==null&&(Ar?(n=on,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):on.removeChild(t.stateNode));break;case 18:on!==null&&(Ar?(n=on,t=t.stateNode,n.nodeType===8?dm(n.parentNode,t):n.nodeType===1&&dm(n,t),Mu(n)):dm(on,t.stateNode));break;case 4:r=on,s=Ar,on=t.stateNode.containerInfo,Ar=!0,Qs(n,e,t),on=r,Ar=s;break;case 0:case 11:case 14:case 15:if(!gn&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&Jw(t,e,i),s=s.next}while(s!==r)}Qs(n,e,t);break;case 1:if(!gn&&(bl(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(l){Pt(t,e,l)}Qs(n,e,t);break;case 21:Qs(n,e,t);break;case 22:t.mode&1?(gn=(r=gn)||t.memoizedState!==null,Qs(n,e,t),gn=r):Qs(n,e,t);break;default:Qs(n,e,t)}}function wb(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new HD),e.forEach(function(r){var s=UD.bind(null,n,r);t.has(r)||(t.add(r),r.then(s,s))})}}function Tr(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var s=t[r];try{var o=n,i=e,l=i;e:for(;l!==null;){switch(l.tag){case 5:on=l.stateNode,Ar=!1;break e;case 3:on=l.stateNode.containerInfo,Ar=!0;break e;case 4:on=l.stateNode.containerInfo,Ar=!0;break e}l=l.return}if(on===null)throw Error(ne(160));$_(o,i,s),on=null,Ar=!1;var a=s.alternate;a!==null&&(a.return=null),s.return=null}catch(u){Pt(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)B_(e,n),e=e.sibling}function B_(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Tr(e,n),Wr(n),r&4){try{ou(3,n,n.return),Hf(3,n)}catch(w){Pt(n,n.return,w)}try{ou(5,n,n.return)}catch(w){Pt(n,n.return,w)}}break;case 1:Tr(e,n),Wr(n),r&512&&t!==null&&bl(t,t.return);break;case 5:if(Tr(e,n),Wr(n),r&512&&t!==null&&bl(t,t.return),n.flags&32){var s=n.stateNode;try{Ru(s,"")}catch(w){Pt(n,n.return,w)}}if(r&4&&(s=n.stateNode,s!=null)){var o=n.memoizedProps,i=t!==null?t.memoizedProps:o,l=n.type,a=n.updateQueue;if(n.updateQueue=null,a!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&uM(s,o),Mw(l,i);var u=Mw(l,o);for(i=0;i<a.length;i+=2){var c=a[i],d=a[i+1];c==="style"?gM(s,d):c==="dangerouslySetInnerHTML"?dM(s,d):c==="children"?Ru(s,d):uy(s,c,d,u)}switch(l){case"input":Sw(s,o);break;case"textarea":cM(s,o);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var m=o.value;m!=null?Il(s,!!o.multiple,m,!1):f!==!!o.multiple&&(o.defaultValue!=null?Il(s,!!o.multiple,o.defaultValue,!0):Il(s,!!o.multiple,o.multiple?[]:"",!1))}s[Au]=o}catch(w){Pt(n,n.return,w)}}break;case 6:if(Tr(e,n),Wr(n),r&4){if(n.stateNode===null)throw Error(ne(162));s=n.stateNode,o=n.memoizedProps;try{s.nodeValue=o}catch(w){Pt(n,n.return,w)}}break;case 3:if(Tr(e,n),Wr(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{Mu(e.containerInfo)}catch(w){Pt(n,n.return,w)}break;case 4:Tr(e,n),Wr(n);break;case 13:Tr(e,n),Wr(n),s=n.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(Wy=Nt())),r&4&&wb(n);break;case 22:if(c=t!==null&&t.memoizedState!==null,n.mode&1?(gn=(u=gn)||c,Tr(e,n),gn=u):Tr(e,n),Wr(n),r&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!c&&n.mode&1)for(ge=n,c=n.child;c!==null;){for(d=ge=c;ge!==null;){switch(f=ge,m=f.child,f.tag){case 0:case 11:case 14:case 15:ou(4,f,f.return);break;case 1:bl(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,t=f.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(w){Pt(r,t,w)}}break;case 5:bl(f,f.return);break;case 22:if(f.memoizedState!==null){yb(d);continue}}m!==null?(m.return=f,ge=m):yb(d)}c=c.sibling}e:for(c=null,d=n;;){if(d.tag===5){if(c===null){c=d;try{s=d.stateNode,u?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=d.stateNode,a=d.memoizedProps.style,i=a!=null&&a.hasOwnProperty("display")?a.display:null,l.style.display=fM("display",i))}catch(w){Pt(n,n.return,w)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(w){Pt(n,n.return,w)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===n)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===n)break e;for(;d.sibling===null;){if(d.return===null||d.return===n)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Tr(e,n),Wr(n),r&4&&wb(n);break;case 21:break;default:Tr(e,n),Wr(n)}}function Wr(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(V_(t)){var r=t;break e}t=t.return}throw Error(ne(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Ru(s,""),r.flags&=-33);var o=pb(n);nC(n,o,s);break;case 3:case 4:var i=r.stateNode.containerInfo,l=pb(n);tC(n,l,i);break;default:throw Error(ne(161))}}catch(a){Pt(n,n.return,a)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function kD(n,e,t){ge=n,W_(n)}function W_(n,e,t){for(var r=(n.mode&1)!==0;ge!==null;){var s=ge,o=s.child;if(s.tag===22&&r){var i=s.memoizedState!==null||Gc;if(!i){var l=s.alternate,a=l!==null&&l.memoizedState!==null||gn;l=Gc;var u=gn;if(Gc=i,(gn=a)&&!u)for(ge=s;ge!==null;)i=ge,a=i.child,i.tag===22&&i.memoizedState!==null?vb(s):a!==null?(a.return=i,ge=a):vb(s);for(;o!==null;)ge=o,W_(o),o=o.sibling;ge=s,Gc=l,gn=u}Cb(n)}else s.subtreeFlags&8772&&o!==null?(o.return=s,ge=o):Cb(n)}}function Cb(n){for(;ge!==null;){var e=ge;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:gn||Hf(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!gn)if(t===null)r.componentDidMount();else{var s=e.elementType===e.type?t.memoizedProps:xr(e.type,t.memoizedProps);r.componentDidUpdate(s,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&nb(e,o,r);break;case 3:var i=e.updateQueue;if(i!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}nb(e,i,t)}break;case 5:var l=e.stateNode;if(t===null&&e.flags&4){t=l;var a=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&t.focus();break;case"img":a.src&&(t.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&Mu(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ne(163))}gn||e.flags&512&&eC(e)}catch(f){Pt(e,e.return,f)}}if(e===n){ge=null;break}if(t=e.sibling,t!==null){t.return=e.return,ge=t;break}ge=e.return}}function yb(n){for(;ge!==null;){var e=ge;if(e===n){ge=null;break}var t=e.sibling;if(t!==null){t.return=e.return,ge=t;break}ge=e.return}}function vb(n){for(;ge!==null;){var e=ge;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Hf(4,e)}catch(a){Pt(e,t,a)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(a){Pt(e,s,a)}}var o=e.return;try{eC(e)}catch(a){Pt(e,o,a)}break;case 5:var i=e.return;try{eC(e)}catch(a){Pt(e,i,a)}}}catch(a){Pt(e,e.return,a)}if(e===n){ge=null;break}var l=e.sibling;if(l!==null){l.return=e.return,ge=l;break}ge=e.return}}var ND=Math.ceil,Nd=Ys.ReactCurrentDispatcher,$y=Ys.ReactCurrentOwner,gr=Ys.ReactCurrentBatchConfig,qe=0,Jt=null,Bt=null,ln=0,Gn=0,El=Lo(0),Gt=0,Lu=null,bi=0,Df=0,By=0,iu=null,kn=null,Wy=0,zl=1/0,_s=null,Ld=!1,rC=null,To=null,Kc=!1,po=null,Fd=0,lu=0,sC=null,Jh=-1,ed=0;function Tn(){return qe&6?Nt():Jh!==-1?Jh:Jh=Nt()}function Mo(n){return n.mode&1?qe&2&&ln!==0?ln&-ln:yD.transition!==null?(ed===0&&(ed=MM()),ed):(n=rt,n!==0||(n=window.event,n=n===void 0?16:HM(n.type)),n):1}function Nr(n,e,t,r){if(50<lu)throw lu=0,sC=null,Error(ne(185));sc(n,t,r),(!(qe&2)||n!==Jt)&&(n===Jt&&(!(qe&2)&&(Df|=t),Gt===4&&fo(n,ln)),Bn(n,r),t===1&&qe===0&&!(e.mode&1)&&(zl=Nt()+500,xf&&Fo()))}function Bn(n,e){var t=n.callbackNode;yH(n,e);var r=Sd(n,n===Jt?ln:0);if(r===0)t!==null&&IR(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&IR(t),e===1)n.tag===0?CD(Sb.bind(null,n)):ZM(Sb.bind(null,n)),gD(function(){!(qe&6)&&Fo()}),t=null;else{switch(_M(r)){case 1:t=gy;break;case 4:t=EM;break;case 16:t=vd;break;case 536870912:t=TM;break;default:t=vd}t=q_(t,U_.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function U_(n,e){if(Jh=-1,ed=0,qe&6)throw Error(ne(327));var t=n.callbackNode;if(Dl()&&n.callbackNode!==t)return null;var r=Sd(n,n===Jt?ln:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=Vd(n,r);else{e=r;var s=qe;qe|=2;var o=Y_();(Jt!==n||ln!==e)&&(_s=null,zl=Nt()+500,mi(n,e));do try{VD();break}catch(l){z_(n,l)}while(!0);_y(),Nd.current=o,qe=s,Bt!==null?e=0:(Jt=null,ln=0,e=Gt)}if(e!==0){if(e===2&&(s=Aw(n),s!==0&&(r=s,e=oC(n,s))),e===1)throw t=Lu,mi(n,0),fo(n,r),Bn(n,Nt()),t;if(e===6)fo(n,r);else{if(s=n.current.alternate,!(r&30)&&!LD(s)&&(e=Vd(n,r),e===2&&(o=Aw(n),o!==0&&(r=o,e=oC(n,o))),e===1))throw t=Lu,mi(n,0),fo(n,r),Bn(n,Nt()),t;switch(n.finishedWork=s,n.finishedLanes=r,e){case 0:case 1:throw Error(ne(345));case 2:ii(n,kn,_s);break;case 3:if(fo(n,r),(r&130023424)===r&&(e=Wy+500-Nt(),10<e)){if(Sd(n,0)!==0)break;if(s=n.suspendedLanes,(s&r)!==r){Tn(),n.pingedLanes|=n.suspendedLanes&s;break}n.timeoutHandle=Vw(ii.bind(null,n,kn,_s),e);break}ii(n,kn,_s);break;case 4:if(fo(n,r),(r&4194240)===r)break;for(e=n.eventTimes,s=-1;0<r;){var i=31-kr(r);o=1<<i,i=e[i],i>s&&(s=i),r&=~o}if(r=s,r=Nt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ND(r/1960))-r,10<r){n.timeoutHandle=Vw(ii.bind(null,n,kn,_s),r);break}ii(n,kn,_s);break;case 5:ii(n,kn,_s);break;default:throw Error(ne(329))}}}return Bn(n,Nt()),n.callbackNode===t?U_.bind(null,n):null}function oC(n,e){var t=iu;return n.current.memoizedState.isDehydrated&&(mi(n,e).flags|=256),n=Vd(n,e),n!==2&&(e=kn,kn=t,e!==null&&iC(e)),n}function iC(n){kn===null?kn=n:kn.push.apply(kn,n)}function LD(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var s=t[r],o=s.getSnapshot;s=s.value;try{if(!Fr(o(),s))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function fo(n,e){for(e&=~By,e&=~Df,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-kr(e),r=1<<t;n[t]=-1,e&=~r}}function Sb(n){if(qe&6)throw Error(ne(327));Dl();var e=Sd(n,0);if(!(e&1))return Bn(n,Nt()),null;var t=Vd(n,e);if(n.tag!==0&&t===2){var r=Aw(n);r!==0&&(e=r,t=oC(n,r))}if(t===1)throw t=Lu,mi(n,0),fo(n,e),Bn(n,Nt()),t;if(t===6)throw Error(ne(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,ii(n,kn,_s),Bn(n,Nt()),null}function Uy(n,e){var t=qe;qe|=1;try{return n(e)}finally{qe=t,qe===0&&(zl=Nt()+500,xf&&Fo())}}function Ei(n){po!==null&&po.tag===0&&!(qe&6)&&Dl();var e=qe;qe|=1;var t=gr.transition,r=rt;try{if(gr.transition=null,rt=1,n)return n()}finally{rt=r,gr.transition=t,qe=e,!(qe&6)&&Fo()}}function zy(){Gn=El.current,pt(El)}function mi(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,fD(t)),Bt!==null)for(t=Bt.return;t!==null;){var r=t;switch(Ey(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Md();break;case 3:Wl(),pt(Vn),pt(wn),Hy();break;case 5:Py(r);break;case 4:Wl();break;case 13:pt(bt);break;case 19:pt(bt);break;case 10:Oy(r.type._context);break;case 22:case 23:zy()}t=t.return}if(Jt=n,Bt=n=_o(n.current,null),ln=Gn=e,Gt=0,Lu=null,By=Df=bi=0,kn=iu=null,ui!==null){for(e=0;e<ui.length;e++)if(t=ui[e],r=t.interleaved,r!==null){t.interleaved=null;var s=r.next,o=t.pending;if(o!==null){var i=o.next;o.next=s,r.next=i}t.pending=r}ui=null}return n}function z_(n,e){do{var t=Bt;try{if(_y(),qh.current=kd,Dd){for(var r=Mt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Dd=!1}if(Ri=0,Zt=jt=Mt=null,su=!1,Du=0,$y.current=null,t===null||t.return===null){Gt=1,Lu=e,Bt=null;break}e:{var o=n,i=t.return,l=t,a=e;if(e=ln,l.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var u=a,c=l,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var m=ab(i);if(m!==null){m.flags&=-257,ub(m,i,l,o,e),m.mode&1&&lb(o,u,e),e=m,a=u;var p=e.updateQueue;if(p===null){var w=new Set;w.add(a),e.updateQueue=w}else p.add(a);break e}else{if(!(e&1)){lb(o,u,e),Yy();break e}a=Error(ne(426))}}else if(St&&l.mode&1){var M=ab(i);if(M!==null){!(M.flags&65536)&&(M.flags|=256),ub(M,i,l,o,e),Ty(Ul(a,l));break e}}o=a=Ul(a,l),Gt!==4&&(Gt=2),iu===null?iu=[o]:iu.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var S=__(o,a,e);tb(o,S);break e;case 1:l=a;var y=o.type,v=o.stateNode;if(!(o.flags&128)&&(typeof y.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(To===null||!To.has(v)))){o.flags|=65536,e&=-e,o.lanes|=e;var R=O_(o,l,e);tb(o,R);break e}}o=o.return}while(o!==null)}G_(t)}catch(I){e=I,Bt===t&&t!==null&&(Bt=t=t.return);continue}break}while(!0)}function Y_(){var n=Nd.current;return Nd.current=kd,n===null?kd:n}function Yy(){(Gt===0||Gt===3||Gt===2)&&(Gt=4),Jt===null||!(bi&268435455)&&!(Df&268435455)||fo(Jt,ln)}function Vd(n,e){var t=qe;qe|=2;var r=Y_();(Jt!==n||ln!==e)&&(_s=null,mi(n,e));do try{FD();break}catch(s){z_(n,s)}while(!0);if(_y(),qe=t,Nd.current=r,Bt!==null)throw Error(ne(261));return Jt=null,ln=0,Gt}function FD(){for(;Bt!==null;)j_(Bt)}function VD(){for(;Bt!==null&&!cH();)j_(Bt)}function j_(n){var e=X_(n.alternate,n,Gn);n.memoizedProps=n.pendingProps,e===null?G_(n):Bt=e,$y.current=null}function G_(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=PD(t,e),t!==null){t.flags&=32767,Bt=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Gt=6,Bt=null;return}}else if(t=AD(t,e,Gn),t!==null){Bt=t;return}if(e=e.sibling,e!==null){Bt=e;return}Bt=e=n}while(e!==null);Gt===0&&(Gt=5)}function ii(n,e,t){var r=rt,s=gr.transition;try{gr.transition=null,rt=1,$D(n,e,t,r)}finally{gr.transition=s,rt=r}return null}function $D(n,e,t,r){do Dl();while(po!==null);if(qe&6)throw Error(ne(327));t=n.finishedWork;var s=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(ne(177));n.callbackNode=null,n.callbackPriority=0;var o=t.lanes|t.childLanes;if(vH(n,o),n===Jt&&(Bt=Jt=null,ln=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Kc||(Kc=!0,q_(vd,function(){return Dl(),null})),o=(t.flags&15990)!==0,t.subtreeFlags&15990||o){o=gr.transition,gr.transition=null;var i=rt;rt=1;var l=qe;qe|=4,$y.current=null,DD(n,t),B_(t,n),iD(Lw),Rd=!!Nw,Lw=Nw=null,n.current=t,kD(t),hH(),qe=l,rt=i,gr.transition=o}else n.current=t;if(Kc&&(Kc=!1,po=n,Fd=s),o=n.pendingLanes,o===0&&(To=null),gH(t.stateNode),Bn(n,Nt()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)s=e[t],r(s.value,{componentStack:s.stack,digest:s.digest});if(Ld)throw Ld=!1,n=rC,rC=null,n;return Fd&1&&n.tag!==0&&Dl(),o=n.pendingLanes,o&1?n===sC?lu++:(lu=0,sC=n):lu=0,Fo(),null}function Dl(){if(po!==null){var n=_M(Fd),e=gr.transition,t=rt;try{if(gr.transition=null,rt=16>n?16:n,po===null)var r=!1;else{if(n=po,po=null,Fd=0,qe&6)throw Error(ne(331));var s=qe;for(qe|=4,ge=n.current;ge!==null;){var o=ge,i=o.child;if(ge.flags&16){var l=o.deletions;if(l!==null){for(var a=0;a<l.length;a++){var u=l[a];for(ge=u;ge!==null;){var c=ge;switch(c.tag){case 0:case 11:case 15:ou(8,c,o)}var d=c.child;if(d!==null)d.return=c,ge=d;else for(;ge!==null;){c=ge;var f=c.sibling,m=c.return;if(F_(c),c===u){ge=null;break}if(f!==null){f.return=m,ge=f;break}ge=m}}}var p=o.alternate;if(p!==null){var w=p.child;if(w!==null){p.child=null;do{var M=w.sibling;w.sibling=null,w=M}while(w!==null)}}ge=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,ge=i;else e:for(;ge!==null;){if(o=ge,o.flags&2048)switch(o.tag){case 0:case 11:case 15:ou(9,o,o.return)}var S=o.sibling;if(S!==null){S.return=o.return,ge=S;break e}ge=o.return}}var y=n.current;for(ge=y;ge!==null;){i=ge;var v=i.child;if(i.subtreeFlags&2064&&v!==null)v.return=i,ge=v;else e:for(i=y;ge!==null;){if(l=ge,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Hf(9,l)}}catch(I){Pt(l,l.return,I)}if(l===i){ge=null;break e}var R=l.sibling;if(R!==null){R.return=l.return,ge=R;break e}ge=l.return}}if(qe=s,Fo(),ls&&typeof ls.onPostCommitFiberRoot=="function")try{ls.onPostCommitFiberRoot(Tf,n)}catch{}r=!0}return r}finally{rt=t,gr.transition=e}}return!1}function Rb(n,e,t){e=Ul(t,e),e=__(n,e,1),n=Eo(n,e,1),e=Tn(),n!==null&&(sc(n,1,e),Bn(n,e))}function Pt(n,e,t){if(n.tag===3)Rb(n,n,t);else for(;e!==null;){if(e.tag===3){Rb(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(To===null||!To.has(r))){n=Ul(t,n),n=O_(e,n,1),e=Eo(e,n,1),n=Tn(),e!==null&&(sc(e,1,n),Bn(e,n));break}}e=e.return}}function BD(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=Tn(),n.pingedLanes|=n.suspendedLanes&t,Jt===n&&(ln&t)===t&&(Gt===4||Gt===3&&(ln&130023424)===ln&&500>Nt()-Wy?mi(n,0):By|=t),Bn(n,e)}function K_(n,e){e===0&&(n.mode&1?(e=Fc,Fc<<=1,!(Fc&130023424)&&(Fc=4194304)):e=1);var t=Tn();n=Bs(n,e),n!==null&&(sc(n,e,t),Bn(n,t))}function WD(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),K_(n,t)}function UD(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,s=n.memoizedState;s!==null&&(t=s.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(ne(314))}r!==null&&r.delete(e),K_(n,t)}var X_;X_=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Vn.current)Ln=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Ln=!1,xD(n,e,t);Ln=!!(n.flags&131072)}else Ln=!1,St&&e.flags&1048576&&JM(e,Id,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Zh(n,e),n=e.pendingProps;var s=Vl(e,wn.current);Hl(e,t),s=ky(null,e,r,n,s,t);var o=Ny();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,$n(r)?(o=!0,_d(e)):o=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,xy(e),s.updater=Pf,e.stateNode=s,s._reactInternals=e,jw(e,r,n,t),e=Xw(null,e,r,!0,o,t)):(e.tag=0,St&&o&&by(e),En(null,e,s,t),e=e.child),e;case 16:r=e.elementType;e:{switch(Zh(n,e),n=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=YD(r),n=xr(r,n),s){case 0:e=Kw(null,e,r,n,t);break e;case 1:e=db(null,e,r,n,t);break e;case 11:e=cb(null,e,r,n,t);break e;case 14:e=hb(null,e,r,xr(r.type,n),t);break e}throw Error(ne(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xr(r,s),Kw(n,e,r,s,t);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xr(r,s),db(n,e,r,s,t);case 3:e:{if(P_(e),n===null)throw Error(ne(387));r=e.pendingProps,o=e.memoizedState,s=o.element,o_(n,e),Pd(e,r,null,t);var i=e.memoizedState;if(r=i.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){s=Ul(Error(ne(423)),e),e=fb(n,e,r,t,s);break e}else if(r!==s){s=Ul(Error(ne(424)),e),e=fb(n,e,r,t,s);break e}else for(Xn=bo(e.stateNode.containerInfo.firstChild),Qn=e,St=!0,Pr=null,t=r_(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if($l(),r===s){e=Ws(n,e,t);break e}En(n,e,r,t)}e=e.child}return e;case 5:return i_(e),n===null&&Uw(e),r=e.type,s=e.pendingProps,o=n!==null?n.memoizedProps:null,i=s.children,Fw(r,s)?i=null:o!==null&&Fw(r,o)&&(e.flags|=32),A_(n,e),En(n,e,i,t),e.child;case 6:return n===null&&Uw(e),null;case 13:return H_(n,e,t);case 4:return Ay(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=Bl(e,null,r,t):En(n,e,r,t),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xr(r,s),cb(n,e,r,s,t);case 7:return En(n,e,e.pendingProps,t),e.child;case 8:return En(n,e,e.pendingProps.children,t),e.child;case 12:return En(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,o=e.memoizedProps,i=s.value,ht(xd,r._currentValue),r._currentValue=i,o!==null)if(Fr(o.value,i)){if(o.children===s.children&&!Vn.current){e=Ws(n,e,t);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var l=o.dependencies;if(l!==null){i=o.child;for(var a=l.firstContext;a!==null;){if(a.context===r){if(o.tag===1){a=Ns(-1,t&-t),a.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?a.next=a:(a.next=c.next,c.next=a),u.pending=a}}o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),zw(o.return,t,e),l.lanes|=t;break}a=a.next}}else if(o.tag===10)i=o.type===e.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(ne(341));i.lanes|=t,l=i.alternate,l!==null&&(l.lanes|=t),zw(i,t,e),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===e){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}En(n,e,s.children,t),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Hl(e,t),s=mr(s),r=r(s),e.flags|=1,En(n,e,r,t),e.child;case 14:return r=e.type,s=xr(r,e.pendingProps),s=xr(r.type,s),hb(n,e,r,s,t);case 15:return I_(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xr(r,s),Zh(n,e),e.tag=1,$n(r)?(n=!0,_d(e)):n=!1,Hl(e,t),M_(e,r,s),jw(e,r,s,t),Xw(null,e,r,!0,n,t);case 19:return D_(n,e,t);case 22:return x_(n,e,t)}throw Error(ne(156,e.tag))};function q_(n,e){return bM(n,e)}function zD(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fr(n,e,t,r){return new zD(n,e,t,r)}function jy(n){return n=n.prototype,!(!n||!n.isReactComponent)}function YD(n){if(typeof n=="function")return jy(n)?1:0;if(n!=null){if(n=n.$$typeof,n===hy)return 11;if(n===dy)return 14}return 2}function _o(n,e){var t=n.alternate;return t===null?(t=fr(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function td(n,e,t,r,s,o){var i=2;if(r=n,typeof n=="function")jy(n)&&(i=1);else if(typeof n=="string")i=5;else e:switch(n){case gl:return pi(t.children,s,o,e);case cy:i=8,s|=8;break;case pw:return n=fr(12,t,e,s|2),n.elementType=pw,n.lanes=o,n;case ww:return n=fr(13,t,e,s),n.elementType=ww,n.lanes=o,n;case Cw:return n=fr(19,t,e,s),n.elementType=Cw,n.lanes=o,n;case iM:return kf(t,s,o,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case sM:i=10;break e;case oM:i=9;break e;case hy:i=11;break e;case dy:i=14;break e;case uo:i=16,r=null;break e}throw Error(ne(130,n==null?n:typeof n,""))}return e=fr(i,t,e,s),e.elementType=n,e.type=r,e.lanes=o,e}function pi(n,e,t,r){return n=fr(7,n,r,e),n.lanes=t,n}function kf(n,e,t,r){return n=fr(22,n,r,e),n.elementType=iM,n.lanes=t,n.stateNode={isHidden:!1},n}function vm(n,e,t){return n=fr(6,n,null,e),n.lanes=t,n}function Sm(n,e,t){return e=fr(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function jD(n,e,t,r,s){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=tm(0),this.expirationTimes=tm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tm(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Gy(n,e,t,r,s,o,i,l,a){return n=new jD(n,e,t,l,a),e===1?(e=1,o===!0&&(e|=8)):e=0,o=fr(3,null,null,e),n.current=o,o.stateNode=n,o.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},xy(o),n}function GD(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:fl,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function Q_(n){if(!n)return Do;n=n._reactInternals;e:{if(Pi(n)!==n||n.tag!==1)throw Error(ne(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if($n(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ne(171))}if(n.tag===1){var t=n.type;if($n(t))return QM(n,t,e)}return e}function Z_(n,e,t,r,s,o,i,l,a){return n=Gy(t,r,!0,n,s,o,i,l,a),n.context=Q_(null),t=n.current,r=Tn(),s=Mo(t),o=Ns(r,s),o.callback=e??null,Eo(t,o,s),n.current.lanes=s,sc(n,s,r),Bn(n,r),n}function Nf(n,e,t,r){var s=e.current,o=Tn(),i=Mo(s);return t=Q_(t),e.context===null?e.context=t:e.pendingContext=t,e=Ns(o,i),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=Eo(s,e,i),n!==null&&(Nr(n,s,i,o),Xh(n,s,i)),i}function $d(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function bb(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Ky(n,e){bb(n,e),(n=n.alternate)&&bb(n,e)}function KD(){return null}var J_=typeof reportError=="function"?reportError:function(n){console.error(n)};function Xy(n){this._internalRoot=n}Lf.prototype.render=Xy.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(ne(409));Nf(n,e,null,null)};Lf.prototype.unmount=Xy.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Ei(function(){Nf(null,n,null,null)}),e[$s]=null}};function Lf(n){this._internalRoot=n}Lf.prototype.unstable_scheduleHydration=function(n){if(n){var e=xM();n={blockedOn:null,target:n,priority:e};for(var t=0;t<ho.length&&e!==0&&e<ho[t].priority;t++);ho.splice(t,0,n),t===0&&PM(n)}};function qy(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Ff(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function Eb(){}function XD(n,e,t,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var u=$d(i);o.call(u)}}var i=Z_(e,r,n,0,null,!1,!1,"",Eb);return n._reactRootContainer=i,n[$s]=i.current,Iu(n.nodeType===8?n.parentNode:n),Ei(),i}for(;s=n.lastChild;)n.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=$d(a);l.call(u)}}var a=Gy(n,0,!1,null,null,!1,!1,"",Eb);return n._reactRootContainer=a,n[$s]=a.current,Iu(n.nodeType===8?n.parentNode:n),Ei(function(){Nf(e,a,t,r)}),a}function Vf(n,e,t,r,s){var o=t._reactRootContainer;if(o){var i=o;if(typeof s=="function"){var l=s;s=function(){var a=$d(i);l.call(a)}}Nf(e,i,n,s)}else i=XD(t,e,n,s,r);return $d(i)}OM=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Ga(e.pendingLanes);t!==0&&(my(e,t|1),Bn(e,Nt()),!(qe&6)&&(zl=Nt()+500,Fo()))}break;case 13:Ei(function(){var r=Bs(n,1);if(r!==null){var s=Tn();Nr(r,n,1,s)}}),Ky(n,1)}};py=function(n){if(n.tag===13){var e=Bs(n,134217728);if(e!==null){var t=Tn();Nr(e,n,134217728,t)}Ky(n,134217728)}};IM=function(n){if(n.tag===13){var e=Mo(n),t=Bs(n,e);if(t!==null){var r=Tn();Nr(t,n,e,r)}Ky(n,e)}};xM=function(){return rt};AM=function(n,e){var t=rt;try{return rt=n,e()}finally{rt=t}};Ow=function(n,e,t){switch(e){case"input":if(Sw(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var s=If(r);if(!s)throw Error(ne(90));aM(r),Sw(r,s)}}}break;case"textarea":cM(n,t);break;case"select":e=t.value,e!=null&&Il(n,!!t.multiple,e,!1)}};wM=Uy;CM=Ei;var qD={usingClientEntryPoint:!1,Events:[ic,Cl,If,mM,pM,Uy]},Ra={findFiberByHostInstance:ai,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},QD={bundleType:Ra.bundleType,version:Ra.version,rendererPackageName:Ra.rendererPackageName,rendererConfig:Ra.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ys.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=SM(n),n===null?null:n.stateNode},findFiberByHostInstance:Ra.findFiberByHostInstance||KD,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xc.isDisabled&&Xc.supportsFiber)try{Tf=Xc.inject(QD),ls=Xc}catch{}}Jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qD;Jn.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!qy(e))throw Error(ne(200));return GD(n,e,null,t)};Jn.createRoot=function(n,e){if(!qy(n))throw Error(ne(299));var t=!1,r="",s=J_;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Gy(n,1,!1,null,null,t,!1,r,s),n[$s]=e.current,Iu(n.nodeType===8?n.parentNode:n),new Xy(e)};Jn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(ne(188)):(n=Object.keys(n).join(","),Error(ne(268,n)));return n=SM(e),n=n===null?null:n.stateNode,n};Jn.flushSync=function(n){return Ei(n)};Jn.hydrate=function(n,e,t){if(!Ff(e))throw Error(ne(200));return Vf(null,n,e,!0,t)};Jn.hydrateRoot=function(n,e,t){if(!qy(n))throw Error(ne(405));var r=t!=null&&t.hydratedSources||null,s=!1,o="",i=J_;if(t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(o=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),e=Z_(e,null,n,1,t??null,s,!1,o,i),n[$s]=e.current,Iu(n),r)for(n=0;n<r.length;n++)t=r[n],s=t._getVersion,s=s(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,s]:e.mutableSourceEagerHydrationData.push(t,s);return new Lf(e)};Jn.render=function(n,e,t){if(!Ff(e))throw Error(ne(200));return Vf(null,n,e,!1,t)};Jn.unmountComponentAtNode=function(n){if(!Ff(n))throw Error(ne(40));return n._reactRootContainer?(Ei(function(){Vf(null,null,n,!1,function(){n._reactRootContainer=null,n[$s]=null})}),!0):!1};Jn.unstable_batchedUpdates=Uy;Jn.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!Ff(t))throw Error(ne(200));if(n==null||n._reactInternals===void 0)throw Error(ne(38));return Vf(n,e,t,!1,r)};Jn.version="18.3.1-next-f1338f8080-20240426";function eO(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(eO)}catch(n){console.error(n)}}eO(),eM.exports=Jn;var tO=eM.exports;const nO=bf(tO);var Tb=tO;gw.createRoot=Tb.createRoot,gw.hydrateRoot=Tb.hydrateRoot;var ba=function(n){return n&&n.Math===Math&&n},un=ba(typeof globalThis=="object"&&globalThis)||ba(typeof window=="object"&&window)||ba(typeof self=="object"&&self)||ba(typeof za=="object"&&za)||ba(typeof za=="object"&&za)||function(){return this}()||Function("return this")(),Qy={},vr=function(n){try{return!!n()}catch{return!0}},ZD=vr,fs=!ZD(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),JD=vr,$f=!JD(function(){var n=(function(){}).bind();return typeof n!="function"||n.hasOwnProperty("prototype")}),ek=$f,qc=Function.prototype.call,Bf=ek?qc.bind(qc):function(){return qc.apply(qc,arguments)},rO={},sO={}.propertyIsEnumerable,oO=Object.getOwnPropertyDescriptor,tk=oO&&!sO.call({1:2},1);rO.f=tk?function(e){var t=oO(this,e);return!!t&&t.enumerable}:sO;var Zy=function(n,e){return{enumerable:!(n&1),configurable:!(n&2),writable:!(n&4),value:e}},iO=$f,lO=Function.prototype,lC=lO.call,nk=iO&&lO.bind.bind(lC,lC),xn=iO?nk:function(n){return function(){return lC.apply(n,arguments)}},aO=xn,rk=aO({}.toString),sk=aO("".slice),ra=function(n){return sk(rk(n),8,-1)},ok=xn,ik=vr,lk=ra,Rm=Object,ak=ok("".split),uk=ik(function(){return!Rm("z").propertyIsEnumerable(0)})?function(n){return lk(n)==="String"?ak(n,""):Rm(n)}:Rm,uO=function(n){return n==null},ck=uO,hk=TypeError,Jy=function(n){if(ck(n))throw new hk("Can't call method on "+n);return n},dk=uk,fk=Jy,Wf=function(n){return dk(fk(n))},bm=typeof document=="object"&&document.all,Cn=typeof bm>"u"&&bm!==void 0?function(n){return typeof n=="function"||n===bm}:function(n){return typeof n=="function"},gk=Cn,js=function(n){return typeof n=="object"?n!==null:gk(n)},Em=un,mk=Cn,pk=function(n){return mk(n)?n:void 0},ac=function(n,e){return arguments.length<2?pk(Em[n]):Em[n]&&Em[n][e]},wk=xn,cO=wk({}.isPrototypeOf),Ck=un,Mb=Ck.navigator,_b=Mb&&Mb.userAgent,Uf=_b?String(_b):"",hO=un,Tm=Uf,Ob=hO.process,Ib=hO.Deno,xb=Ob&&Ob.versions||Ib&&Ib.version,Ab=xb&&xb.v8,Hr,Bd;Ab&&(Hr=Ab.split("."),Bd=Hr[0]>0&&Hr[0]<4?1:+(Hr[0]+Hr[1]));!Bd&&Tm&&(Hr=Tm.match(/Edge\/(\d+)/),(!Hr||Hr[1]>=74)&&(Hr=Tm.match(/Chrome\/(\d+)/),Hr&&(Bd=+Hr[1])));var yk=Bd,Pb=yk,vk=vr,Sk=un,Rk=Sk.String,ev=!!Object.getOwnPropertySymbols&&!vk(function(){var n=Symbol("symbol detection");return!Rk(n)||!(Object(n)instanceof Symbol)||!Symbol.sham&&Pb&&Pb<41}),bk=ev,dO=bk&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Ek=ac,Tk=Cn,Mk=cO,_k=dO,Ok=Object,tv=_k?function(n){return typeof n=="symbol"}:function(n){var e=Ek("Symbol");return Tk(e)&&Mk(e.prototype,Ok(n))},Ik=String,fO=function(n){try{return Ik(n)}catch{return"Object"}},xk=Cn,Ak=fO,Pk=TypeError,nv=function(n){if(xk(n))return n;throw new Pk(Ak(n)+" is not a function")},Hk=nv,Dk=uO,kk=function(n,e){var t=n[e];return Dk(t)?void 0:Hk(t)},Mm=Bf,_m=Cn,Om=js,Nk=TypeError,Lk=function(n,e){var t,r;if(e==="string"&&_m(t=n.toString)&&!Om(r=Mm(t,n))||_m(t=n.valueOf)&&!Om(r=Mm(t,n))||e!=="string"&&_m(t=n.toString)&&!Om(r=Mm(t,n)))return r;throw new Nk("Can't convert object to primitive value")},gO={exports:{}},Hb=un,Fk=Object.defineProperty,rv=function(n,e){try{Fk(Hb,n,{value:e,configurable:!0,writable:!0})}catch{Hb[n]=e}return e},Vk=un,$k=rv,Db="__core-js_shared__",kb=gO.exports=Vk[Db]||$k(Db,{});(kb.versions||(kb.versions=[])).push({version:"3.39.0",mode:"global",copyright:"© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.39.0/LICENSE",source:"https://github.com/zloirock/core-js"});var sv=gO.exports,Nb=sv,mO=function(n,e){return Nb[n]||(Nb[n]=e||{})},Bk=Jy,Wk=Object,zf=function(n){return Wk(Bk(n))},Uk=xn,zk=zf,Yk=Uk({}.hasOwnProperty),Gs=Object.hasOwn||function(e,t){return Yk(zk(e),t)},jk=xn,Gk=0,Kk=Math.random(),Xk=jk(1 .toString),pO=function(n){return"Symbol("+(n===void 0?"":n)+")_"+Xk(++Gk+Kk,36)},qk=un,Qk=mO,Lb=Gs,Zk=pO,Jk=ev,eN=dO,Tl=qk.Symbol,Im=Qk("wks"),tN=eN?Tl.for||Tl:Tl&&Tl.withoutSetter||Zk,Yf=function(n){return Lb(Im,n)||(Im[n]=Jk&&Lb(Tl,n)?Tl[n]:tN("Symbol."+n)),Im[n]},nN=Bf,Fb=js,Vb=tv,rN=kk,sN=Lk,oN=Yf,iN=TypeError,lN=oN("toPrimitive"),aN=function(n,e){if(!Fb(n)||Vb(n))return n;var t=rN(n,lN),r;if(t){if(e===void 0&&(e="default"),r=nN(t,n,e),!Fb(r)||Vb(r))return r;throw new iN("Can't convert object to primitive value")}return e===void 0&&(e="number"),sN(n,e)},uN=aN,cN=tv,wO=function(n){var e=uN(n,"string");return cN(e)?e:e+""},hN=un,$b=js,aC=hN.document,dN=$b(aC)&&$b(aC.createElement),ov=function(n){return dN?aC.createElement(n):{}},fN=fs,gN=vr,mN=ov,CO=!fN&&!gN(function(){return Object.defineProperty(mN("div"),"a",{get:function(){return 7}}).a!==7}),pN=fs,wN=Bf,CN=rO,yN=Zy,vN=Wf,SN=wO,RN=Gs,bN=CO,Bb=Object.getOwnPropertyDescriptor;Qy.f=pN?Bb:function(e,t){if(e=vN(e),t=SN(t),bN)try{return Bb(e,t)}catch{}if(RN(e,t))return yN(!wN(CN.f,e,t),e[t])};var Hi={},EN=fs,TN=vr,yO=EN&&TN(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),MN=js,_N=String,ON=TypeError,jf=function(n){if(MN(n))return n;throw new ON(_N(n)+" is not an object")},IN=fs,xN=CO,AN=yO,Qc=jf,Wb=wO,PN=TypeError,xm=Object.defineProperty,HN=Object.getOwnPropertyDescriptor,Am="enumerable",Pm="configurable",Hm="writable";Hi.f=IN?AN?function(e,t,r){if(Qc(e),t=Wb(t),Qc(r),typeof e=="function"&&t==="prototype"&&"value"in r&&Hm in r&&!r[Hm]){var s=HN(e,t);s&&s[Hm]&&(e[t]=r.value,r={configurable:Pm in r?r[Pm]:s[Pm],enumerable:Am in r?r[Am]:s[Am],writable:!1})}return xm(e,t,r)}:xm:function(e,t,r){if(Qc(e),t=Wb(t),Qc(r),xN)try{return xm(e,t,r)}catch{}if("get"in r||"set"in r)throw new PN("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var DN=fs,kN=Hi,NN=Zy,uc=DN?function(n,e,t){return kN.f(n,e,NN(1,t))}:function(n,e,t){return n[e]=t,n},vO={exports:{}},uC=fs,LN=Gs,SO=Function.prototype,FN=uC&&Object.getOwnPropertyDescriptor,iv=LN(SO,"name"),VN=iv&&(function(){}).name==="something",$N=iv&&(!uC||uC&&FN(SO,"name").configurable),BN={EXISTS:iv,PROPER:VN,CONFIGURABLE:$N},WN=xn,UN=Cn,cC=sv,zN=WN(Function.toString);UN(cC.inspectSource)||(cC.inspectSource=function(n){return zN(n)});var YN=cC.inspectSource,jN=un,GN=Cn,Ub=jN.WeakMap,KN=GN(Ub)&&/native code/.test(String(Ub)),XN=mO,qN=pO,zb=XN("keys"),RO=function(n){return zb[n]||(zb[n]=qN(n))},lv={},QN=KN,bO=un,ZN=js,JN=uc,Dm=Gs,km=sv,eL=RO,tL=lv,Yb="Object already initialized",hC=bO.TypeError,nL=bO.WeakMap,Wd,Fu,Ud,rL=function(n){return Ud(n)?Fu(n):Wd(n,{})},sL=function(n){return function(e){var t;if(!ZN(e)||(t=Fu(e)).type!==n)throw new hC("Incompatible receiver, "+n+" required");return t}};if(QN||km.state){var Ur=km.state||(km.state=new nL);Ur.get=Ur.get,Ur.has=Ur.has,Ur.set=Ur.set,Wd=function(n,e){if(Ur.has(n))throw new hC(Yb);return e.facade=n,Ur.set(n,e),e},Fu=function(n){return Ur.get(n)||{}},Ud=function(n){return Ur.has(n)}}else{var Ui=eL("state");tL[Ui]=!0,Wd=function(n,e){if(Dm(n,Ui))throw new hC(Yb);return e.facade=n,JN(n,Ui,e),e},Fu=function(n){return Dm(n,Ui)?n[Ui]:{}},Ud=function(n){return Dm(n,Ui)}}var oL={set:Wd,get:Fu,has:Ud,enforce:rL,getterFor:sL},av=xn,iL=vr,lL=Cn,Zc=Gs,dC=fs,aL=BN.CONFIGURABLE,uL=YN,EO=oL,cL=EO.enforce,hL=EO.get,jb=String,nd=Object.defineProperty,dL=av("".slice),fL=av("".replace),gL=av([].join),mL=dC&&!iL(function(){return nd(function(){},"length",{value:8}).length!==8}),pL=String(String).split("String"),wL=vO.exports=function(n,e,t){dL(jb(e),0,7)==="Symbol("&&(e="["+fL(jb(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),t&&t.getter&&(e="get "+e),t&&t.setter&&(e="set "+e),(!Zc(n,"name")||aL&&n.name!==e)&&(dC?nd(n,"name",{value:e,configurable:!0}):n.name=e),mL&&t&&Zc(t,"arity")&&n.length!==t.arity&&nd(n,"length",{value:t.arity});try{t&&Zc(t,"constructor")&&t.constructor?dC&&nd(n,"prototype",{writable:!1}):n.prototype&&(n.prototype=void 0)}catch{}var r=cL(n);return Zc(r,"source")||(r.source=gL(pL,typeof e=="string"?e:"")),n};Function.prototype.toString=wL(function(){return lL(this)&&hL(this).source||uL(this)},"toString");var CL=vO.exports,yL=Cn,vL=Hi,SL=CL,RL=rv,bL=function(n,e,t,r){r||(r={});var s=r.enumerable,o=r.name!==void 0?r.name:e;if(yL(t)&&SL(t,o,r),r.global)s?n[e]=t:RL(e,t);else{try{r.unsafe?n[e]&&(s=!0):delete n[e]}catch{}s?n[e]=t:vL.f(n,e,{value:t,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return n},TO={},EL=Math.ceil,TL=Math.floor,ML=Math.trunc||function(e){var t=+e;return(t>0?TL:EL)(t)},_L=ML,uv=function(n){var e=+n;return e!==e||e===0?0:_L(e)},OL=uv,IL=Math.max,xL=Math.min,AL=function(n,e){var t=OL(n);return t<0?IL(t+e,0):xL(t,e)},PL=uv,HL=Math.min,DL=function(n){var e=PL(n);return e>0?HL(e,9007199254740991):0},kL=DL,Gf=function(n){return kL(n.length)},NL=Wf,LL=AL,FL=Gf,Gb=function(n){return function(e,t,r){var s=NL(e),o=FL(s);if(o===0)return!n&&-1;var i=LL(r,o),l;if(n&&t!==t){for(;o>i;)if(l=s[i++],l!==l)return!0}else for(;o>i;i++)if((n||i in s)&&s[i]===t)return n||i||0;return!n&&-1}},VL={includes:Gb(!0),indexOf:Gb(!1)},$L=xn,Nm=Gs,BL=Wf,WL=VL.indexOf,UL=lv,Kb=$L([].push),MO=function(n,e){var t=BL(n),r=0,s=[],o;for(o in t)!Nm(UL,o)&&Nm(t,o)&&Kb(s,o);for(;e.length>r;)Nm(t,o=e[r++])&&(~WL(s,o)||Kb(s,o));return s},cv=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],zL=MO,YL=cv,jL=YL.concat("length","prototype");TO.f=Object.getOwnPropertyNames||function(e){return zL(e,jL)};var _O={};_O.f=Object.getOwnPropertySymbols;var GL=ac,KL=xn,XL=TO,qL=_O,QL=jf,ZL=KL([].concat),JL=GL("Reflect","ownKeys")||function(e){var t=XL.f(QL(e)),r=qL.f;return r?ZL(t,r(e)):t},Xb=Gs,eF=JL,tF=Qy,nF=Hi,OO=function(n,e,t){for(var r=eF(e),s=nF.f,o=tF.f,i=0;i<r.length;i++){var l=r[i];!Xb(n,l)&&!(t&&Xb(t,l))&&s(n,l,o(e,l))}},rF=vr,sF=Cn,oF=/#|\.prototype\./,cc=function(n,e){var t=lF[iF(n)];return t===uF?!0:t===aF?!1:sF(e)?rF(e):!!e},iF=cc.normalize=function(n){return String(n).replace(oF,".").toLowerCase()},lF=cc.data={},aF=cc.NATIVE="N",uF=cc.POLYFILL="P",cF=cc,Jc=un,hF=Qy.f,dF=uc,fF=bL,gF=rv,mF=OO,pF=cF,Di=function(n,e){var t=n.target,r=n.global,s=n.stat,o,i,l,a,u,c;if(r?i=Jc:s?i=Jc[t]||gF(t,{}):i=Jc[t]&&Jc[t].prototype,i)for(l in e){if(u=e[l],n.dontCallGetSet?(c=hF(i,l),a=c&&c.value):a=i[l],o=pF(r?l:t+(s?".":"#")+l,n.forced),!o&&a!==void 0){if(typeof u==typeof a)continue;mF(u,a)}(n.sham||a&&a.sham)&&dF(u,"sham",!0),fF(i,l,u,n)}},wF=ra,IO=Array.isArray||function(e){return wF(e)==="Array"},CF=fs,yF=IO,vF=TypeError,SF=Object.getOwnPropertyDescriptor,RF=CF&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(n){return n instanceof TypeError}}(),xO=RF?function(n,e){if(yF(n)&&!SF(n,"length").writable)throw new vF("Cannot set read only .length");return n.length=e}:function(n,e){return n.length=e},bF=TypeError,EF=9007199254740991,AO=function(n){if(n>EF)throw bF("Maximum allowed index exceeded");return n},TF=Di,MF=zf,_F=Gf,OF=xO,IF=AO,xF=vr,AF=xF(function(){return[].push.call({length:4294967296},1)!==4294967297}),PF=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(n){return n instanceof TypeError}},HF=AF||!PF();TF({target:"Array",proto:!0,arity:1,forced:HF},{push:function(e){var t=MF(this),r=_F(t),s=arguments.length;IF(r+s);for(var o=0;o<s;o++)t[r]=arguments[o],r++;return OF(t,r),r}});var DF=$f,PO=Function.prototype,qb=PO.apply,Qb=PO.call,Kf=typeof Reflect=="object"&&Reflect.apply||(DF?Qb.bind(qb):function(){return Qb.apply(qb,arguments)}),kF=xn,NF=nv,LF=function(n,e,t){try{return kF(NF(Object.getOwnPropertyDescriptor(n,e)[t]))}catch{}},FF=js,VF=function(n){return FF(n)||n===null},$F=VF,BF=String,WF=TypeError,UF=function(n){if($F(n))return n;throw new WF("Can't set "+BF(n)+" as a prototype")},zF=LF,YF=js,jF=Jy,GF=UF,HO=Object.setPrototypeOf||("__proto__"in{}?function(){var n=!1,e={},t;try{t=zF(Object.prototype,"__proto__","set"),t(e,[]),n=e instanceof Array}catch{}return function(s,o){return jF(s),GF(o),YF(s)&&(n?t(s,o):s.__proto__=o),s}}():void 0),KF=Hi.f,XF=function(n,e,t){t in n||KF(n,t,{configurable:!0,get:function(){return e[t]},set:function(r){e[t]=r}})},qF=Cn,QF=js,Zb=HO,ZF=function(n,e,t){var r,s;return Zb&&qF(r=e.constructor)&&r!==t&&QF(s=r.prototype)&&s!==t.prototype&&Zb(n,s),n},JF=Yf,eV=JF("toStringTag"),DO={};DO[eV]="z";var tV=String(DO)==="[object z]",nV=tV,rV=Cn,rd=ra,sV=Yf,oV=sV("toStringTag"),iV=Object,lV=rd(function(){return arguments}())==="Arguments",aV=function(n,e){try{return n[e]}catch{}},uV=nV?rd:function(n){var e,t,r;return n===void 0?"Undefined":n===null?"Null":typeof(t=aV(e=iV(n),oV))=="string"?t:lV?rd(e):(r=rd(e))==="Object"&&rV(e.callee)?"Arguments":r},cV=uV,hV=String,kO=function(n){if(cV(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return hV(n)},dV=kO,fV=function(n,e){return n===void 0?arguments.length<2?"":e:dV(n)},gV=js,mV=uc,pV=function(n,e){gV(e)&&"cause"in e&&mV(n,"cause",e.cause)},wV=xn,NO=Error,CV=wV("".replace),yV=function(n){return String(new NO(n).stack)}("zxcasd"),LO=/\n\s*at [^:]*:[^\n]*/,vV=LO.test(yV),SV=function(n,e){if(vV&&typeof n=="string"&&!NO.prepareStackTrace)for(;e--;)n=CV(n,LO,"");return n},RV=vr,bV=Zy,EV=!RV(function(){var n=new Error("a");return"stack"in n?(Object.defineProperty(n,"stack",bV(1,7)),n.stack!==7):!0}),TV=uc,MV=SV,_V=EV,Jb=Error.captureStackTrace,OV=function(n,e,t,r){_V&&(Jb?Jb(n,e):TV(n,"stack",MV(t,r)))},eE=ac,IV=Gs,tE=uc,xV=cO,nE=HO,rE=OO,sE=XF,AV=ZF,PV=fV,HV=pV,DV=OV,kV=fs,NV=function(n,e,t,r){var s="stackTraceLimit",o=r?2:1,i=n.split("."),l=i[i.length-1],a=eE.apply(null,i);if(a){var u=a.prototype;if(IV(u,"cause")&&delete u.cause,!t)return a;var c=eE("Error"),d=e(function(f,m){var p=PV(r?m:f,void 0),w=r?new a(f):new a;return p!==void 0&&tE(w,"message",p),DV(w,d,w.stack,2),this&&xV(u,this)&&AV(w,this,d),arguments.length>o&&HV(w,arguments[o]),w});d.prototype=u,l!=="Error"?nE?nE(d,c):rE(d,c,{name:!0}):kV&&s in a&&(sE(d,a,s),sE(d,a,"prepareStackTrace")),rE(d,a);try{u.name!==l&&tE(u,"name",l),u.constructor=d}catch{}return d}},FO=Di,LV=un,gs=Kf,VO=NV,fC="WebAssembly",oE=LV[fC],zd=new Error("e",{cause:7}).cause!==7,ki=function(n,e){var t={};t[n]=VO(n,e,zd),FO({global:!0,constructor:!0,arity:1,forced:zd},t)},hv=function(n,e){if(oE&&oE[n]){var t={};t[n]=VO(fC+"."+n,e,zd),FO({target:fC,stat:!0,constructor:!0,arity:1,forced:zd},t)}};ki("Error",function(n){return function(t){return gs(n,this,arguments)}});ki("EvalError",function(n){return function(t){return gs(n,this,arguments)}});ki("RangeError",function(n){return function(t){return gs(n,this,arguments)}});ki("ReferenceError",function(n){return function(t){return gs(n,this,arguments)}});ki("SyntaxError",function(n){return function(t){return gs(n,this,arguments)}});ki("TypeError",function(n){return function(t){return gs(n,this,arguments)}});ki("URIError",function(n){return function(t){return gs(n,this,arguments)}});hv("CompileError",function(n){return function(t){return gs(n,this,arguments)}});hv("LinkError",function(n){return function(t){return gs(n,this,arguments)}});hv("RuntimeError",function(n){return function(t){return gs(n,this,arguments)}});var FV=ra,VV=xn,$V=function(n){if(FV(n)==="Function")return VV(n)},iE=$V,BV=nv,WV=$f,UV=iE(iE.bind),zV=function(n,e){return BV(n),e===void 0?n:WV?UV(n,e):function(){return n.apply(e,arguments)}},YV=ac,$O=YV("document","documentElement"),jV=xn,dv=jV([].slice),GV=TypeError,BO=function(n,e){if(n<e)throw new GV("Not enough arguments");return n},KV=Uf,XV=/(?:ipad|iphone|ipod).*applewebkit/i.test(KV),Ea=un,qV=Uf,QV=ra,eh=function(n){return qV.slice(0,n.length)===n},WO=function(){return eh("Bun/")?"BUN":eh("Cloudflare-Workers")?"CLOUDFLARE":eh("Deno/")?"DENO":eh("Node.js/")?"NODE":Ea.Bun&&typeof Bun.version=="string"?"BUN":Ea.Deno&&typeof Deno.version=="object"?"DENO":QV(Ea.process)==="process"?"NODE":Ea.window&&Ea.document?"BROWSER":"REST"}(),ZV=WO,JV=ZV==="NODE",qn=un,e$=Kf,t$=zV,lE=Cn,n$=Gs,UO=vr,aE=$O,r$=dv,uE=ov,s$=BO,o$=XV,i$=JV,gC=qn.setImmediate,mC=qn.clearImmediate,l$=qn.process,Lm=qn.Dispatch,a$=qn.Function,cE=qn.MessageChannel,u$=qn.String,Fm=0,au={},hE="onreadystatechange",Vu,Uo,Vm,$m;UO(function(){Vu=qn.location});var fv=function(n){if(n$(au,n)){var e=au[n];delete au[n],e()}},Bm=function(n){return function(){fv(n)}},dE=function(n){fv(n.data)},fE=function(n){qn.postMessage(u$(n),Vu.protocol+"//"+Vu.host)};(!gC||!mC)&&(gC=function(e){s$(arguments.length,1);var t=lE(e)?e:a$(e),r=r$(arguments,1);return au[++Fm]=function(){e$(t,void 0,r)},Uo(Fm),Fm},mC=function(e){delete au[e]},i$?Uo=function(n){l$.nextTick(Bm(n))}:Lm&&Lm.now?Uo=function(n){Lm.now(Bm(n))}:cE&&!o$?(Vm=new cE,$m=Vm.port2,Vm.port1.onmessage=dE,Uo=t$($m.postMessage,$m)):qn.addEventListener&&lE(qn.postMessage)&&!qn.importScripts&&Vu&&Vu.protocol!=="file:"&&!UO(fE)?(Uo=fE,qn.addEventListener("message",dE,!1)):hE in uE("script")?Uo=function(n){aE.appendChild(uE("script"))[hE]=function(){aE.removeChild(this),fv(n)}}:Uo=function(n){setTimeout(Bm(n),0)});var zO={set:gC,clear:mC},c$=Di,h$=un,gE=zO.clear;c$({global:!0,bind:!0,enumerable:!0,forced:h$.clearImmediate!==gE},{clearImmediate:gE});var YO=un,d$=Kf,f$=Cn,g$=WO,m$=Uf,p$=dv,w$=BO,C$=YO.Function,y$=/MSIE .\./.test(m$)||g$==="BUN"&&function(){var n=YO.Bun.version.split(".");return n.length<3||n[0]==="0"&&(n[1]<3||n[1]==="3"&&n[2]==="0")}(),v$=function(n,e){var t=e?2:1;return y$?function(r,s){var o=w$(arguments.length,1)>t,i=f$(r)?r:C$(r),l=o?p$(arguments,t):[],a=o?function(){d$(i,this,l)}:i;return e?n(a,s):n(a)}:n},S$=Di,jO=un,mE=zO.set,R$=v$,pE=jO.setImmediate?R$(mE,!1):mE;S$({global:!0,bind:!0,enumerable:!0,forced:jO.setImmediate!==pE},{setImmediate:pE});/*! @license DOMPurify 2.5.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.5.7/LICENSE */function go(n){"@babel/helpers - typeof";return go=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},go(n)}function pC(n,e){return pC=Object.setPrototypeOf||function(r,s){return r.__proto__=s,r},pC(n,e)}function b$(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sd(n,e,t){return b$()?sd=Reflect.construct:sd=function(s,o,i){var l=[null];l.push.apply(l,o);var a=Function.bind.apply(s,l),u=new a;return i&&pC(u,i.prototype),u},sd.apply(null,arguments)}function Ir(n){return E$(n)||T$(n)||M$(n)||_$()}function E$(n){if(Array.isArray(n))return wC(n)}function T$(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function M$(n,e){if(n){if(typeof n=="string")return wC(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return wC(n,e)}}function wC(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function _$(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var O$=Object.hasOwnProperty,wE=Object.setPrototypeOf,I$=Object.isFrozen,x$=Object.getPrototypeOf,A$=Object.getOwnPropertyDescriptor,Mn=Object.freeze,wr=Object.seal,P$=Object.create,GO=typeof Reflect<"u"&&Reflect,Yd=GO.apply,CC=GO.construct;Yd||(Yd=function(e,t,r){return e.apply(t,r)});Mn||(Mn=function(e){return e});wr||(wr=function(e){return e});CC||(CC=function(e,t){return sd(e,Ir(t))});var H$=Cr(Array.prototype.forEach),CE=Cr(Array.prototype.pop),Ta=Cr(Array.prototype.push),od=Cr(String.prototype.toLowerCase),Wm=Cr(String.prototype.toString),yE=Cr(String.prototype.match),Mr=Cr(String.prototype.replace),D$=Cr(String.prototype.indexOf),k$=Cr(String.prototype.trim),sn=Cr(RegExp.prototype.test),Um=N$(TypeError);function Cr(n){return function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];return Yd(n,e,r)}}function N$(n){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return CC(n,t)}}function We(n,e,t){var r;t=(r=t)!==null&&r!==void 0?r:od,wE&&wE(n,null);for(var s=e.length;s--;){var o=e[s];if(typeof o=="string"){var i=t(o);i!==o&&(I$(e)||(e[s]=i),o=i)}n[o]=!0}return n}function zo(n){var e=P$(null),t;for(t in n)Yd(O$,n,[t])===!0&&(e[t]=n[t]);return e}function th(n,e){for(;n!==null;){var t=A$(n,e);if(t){if(t.get)return Cr(t.get);if(typeof t.value=="function")return Cr(t.value)}n=x$(n)}function r(s){return console.warn("fallback value for",s),null}return r}var vE=Mn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),zm=Mn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Ym=Mn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),L$=Mn(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),jm=Mn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),F$=Mn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),SE=Mn(["#text"]),RE=Mn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Gm=Mn(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),bE=Mn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),nh=Mn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),V$=wr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),$$=wr(/<%[\w\W]*|[\w\W]*%>/gm),B$=wr(/\${[\w\W]*}/gm),W$=wr(/^data-[\-\w.\u00B7-\uFFFF]/),U$=wr(/^aria-[\-\w]+$/),z$=wr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Y$=wr(/^(?:\w+script|data):/i),j$=wr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),G$=wr(/^html$/i),K$=wr(/^[a-z][.\w]*(-[.\w]+)+$/i),X$=function(){return typeof window>"u"?null:window},q$=function(e,t){if(go(e)!=="object"||typeof e.createPolicy!="function")return null;var r=null,s="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(s)&&(r=t.currentScript.getAttribute(s));var o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML:function(l){return l},createScriptURL:function(l){return l}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function KO(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:X$(),e=function(D){return KO(D)};if(e.version="2.5.7",e.removed=[],!n||!n.document||n.document.nodeType!==9)return e.isSupported=!1,e;var t=n.document,r=n.document,s=n.DocumentFragment,o=n.HTMLTemplateElement,i=n.Node,l=n.Element,a=n.NodeFilter,u=n.NamedNodeMap,c=u===void 0?n.NamedNodeMap||n.MozNamedAttrMap:u,d=n.HTMLFormElement,f=n.DOMParser,m=n.trustedTypes,p=l.prototype,w=th(p,"cloneNode"),M=th(p,"nextSibling"),S=th(p,"childNodes"),y=th(p,"parentNode");if(typeof o=="function"){var v=r.createElement("template");v.content&&v.content.ownerDocument&&(r=v.content.ownerDocument)}var R=q$(m,t),I=R?R.createHTML(""):"",F=r,L=F.implementation,j=F.createNodeIterator,X=F.createDocumentFragment,G=F.getElementsByTagName,te=t.importNode,ie={};try{ie=zo(r).documentMode?r.documentMode:{}}catch{}var le={};e.isSupported=typeof y=="function"&&L&&L.createHTMLDocument!==void 0&&ie!==9;var me=V$,Te=$$,Ue=B$,Me=W$,E=U$,h=Y$,g=j$,C=K$,_=z$,O=null,A=We({},[].concat(Ir(vE),Ir(zm),Ir(Ym),Ir(jm),Ir(SE))),W=null,z=We({},[].concat(Ir(RE),Ir(Gm),Ir(bE),Ir(nh))),K=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Z=null,Q=null,pe=!0,Ae=!0,Ee=!1,_e=!0,q=!1,je=!0,Ie=!1,be=!1,Pe=!1,ye=!1,b=!1,T=!1,x=!0,$=!1,H="user-content-",B=!0,N=!1,k={},U=null,V=We({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Y=null,oe=We({},["audio","video","img","source","image","track"]),de=null,ve=We({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),xe="http://www.w3.org/1998/Math/MathML",Ne="http://www.w3.org/2000/svg",Qe="http://www.w3.org/1999/xhtml",ke=Qe,Ze=!1,Vt=null,Bi=We({},[xe,Ne,Qe],Wm),Er,fa=["application/xhtml+xml","text/html"],rr="text/html",yt,zt=null,nn=r.createElement("form"),ft=function(D){return D instanceof RegExp||D instanceof Function},Gg=function(D){zt&&zt===D||((!D||go(D)!=="object")&&(D={}),D=zo(D),Er=fa.indexOf(D.PARSER_MEDIA_TYPE)===-1?Er=rr:Er=D.PARSER_MEDIA_TYPE,yt=Er==="application/xhtml+xml"?Wm:od,O="ALLOWED_TAGS"in D?We({},D.ALLOWED_TAGS,yt):A,W="ALLOWED_ATTR"in D?We({},D.ALLOWED_ATTR,yt):z,Vt="ALLOWED_NAMESPACES"in D?We({},D.ALLOWED_NAMESPACES,Wm):Bi,de="ADD_URI_SAFE_ATTR"in D?We(zo(ve),D.ADD_URI_SAFE_ATTR,yt):ve,Y="ADD_DATA_URI_TAGS"in D?We(zo(oe),D.ADD_DATA_URI_TAGS,yt):oe,U="FORBID_CONTENTS"in D?We({},D.FORBID_CONTENTS,yt):V,Z="FORBID_TAGS"in D?We({},D.FORBID_TAGS,yt):{},Q="FORBID_ATTR"in D?We({},D.FORBID_ATTR,yt):{},k="USE_PROFILES"in D?D.USE_PROFILES:!1,pe=D.ALLOW_ARIA_ATTR!==!1,Ae=D.ALLOW_DATA_ATTR!==!1,Ee=D.ALLOW_UNKNOWN_PROTOCOLS||!1,_e=D.ALLOW_SELF_CLOSE_IN_ATTR!==!1,q=D.SAFE_FOR_TEMPLATES||!1,je=D.SAFE_FOR_XML!==!1,Ie=D.WHOLE_DOCUMENT||!1,ye=D.RETURN_DOM||!1,b=D.RETURN_DOM_FRAGMENT||!1,T=D.RETURN_TRUSTED_TYPE||!1,Pe=D.FORCE_BODY||!1,x=D.SANITIZE_DOM!==!1,$=D.SANITIZE_NAMED_PROPS||!1,B=D.KEEP_CONTENT!==!1,N=D.IN_PLACE||!1,_=D.ALLOWED_URI_REGEXP||_,ke=D.NAMESPACE||Qe,K=D.CUSTOM_ELEMENT_HANDLING||{},D.CUSTOM_ELEMENT_HANDLING&&ft(D.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(K.tagNameCheck=D.CUSTOM_ELEMENT_HANDLING.tagNameCheck),D.CUSTOM_ELEMENT_HANDLING&&ft(D.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(K.attributeNameCheck=D.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),D.CUSTOM_ELEMENT_HANDLING&&typeof D.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(K.allowCustomizedBuiltInElements=D.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),q&&(Ae=!1),b&&(ye=!0),k&&(O=We({},Ir(SE)),W=[],k.html===!0&&(We(O,vE),We(W,RE)),k.svg===!0&&(We(O,zm),We(W,Gm),We(W,nh)),k.svgFilters===!0&&(We(O,Ym),We(W,Gm),We(W,nh)),k.mathMl===!0&&(We(O,jm),We(W,bE),We(W,nh))),D.ADD_TAGS&&(O===A&&(O=zo(O)),We(O,D.ADD_TAGS,yt)),D.ADD_ATTR&&(W===z&&(W=zo(W)),We(W,D.ADD_ATTR,yt)),D.ADD_URI_SAFE_ATTR&&We(de,D.ADD_URI_SAFE_ATTR,yt),D.FORBID_CONTENTS&&(U===V&&(U=zo(U)),We(U,D.FORBID_CONTENTS,yt)),B&&(O["#text"]=!0),Ie&&We(O,["html","head","body"]),O.table&&(We(O,["tbody"]),delete Z.tbody),Mn&&Mn(D),zt=D)},lR=We({},["mi","mo","mn","ms","mtext"]),aR=We({},["annotation-xml"]),RP=We({},["title","style","font","a","script"]),Ac=We({},zm);We(Ac,Ym),We(Ac,L$);var Kg=We({},jm);We(Kg,F$);var bP=function(D){var se=y(D);(!se||!se.tagName)&&(se={namespaceURI:ke,tagName:"template"});var ae=od(D.tagName),tt=od(se.tagName);return Vt[D.namespaceURI]?D.namespaceURI===Ne?se.namespaceURI===Qe?ae==="svg":se.namespaceURI===xe?ae==="svg"&&(tt==="annotation-xml"||lR[tt]):!!Ac[ae]:D.namespaceURI===xe?se.namespaceURI===Qe?ae==="math":se.namespaceURI===Ne?ae==="math"&&aR[tt]:!!Kg[ae]:D.namespaceURI===Qe?se.namespaceURI===Ne&&!aR[tt]||se.namespaceURI===xe&&!lR[tt]?!1:!Kg[ae]&&(RP[ae]||!Ac[ae]):!!(Er==="application/xhtml+xml"&&Vt[D.namespaceURI]):!1},sr=function(D){Ta(e.removed,{element:D});try{D.parentNode.removeChild(D)}catch{try{D.outerHTML=I}catch{D.remove()}}},Pc=function(D,se){try{Ta(e.removed,{attribute:se.getAttributeNode(D),from:se})}catch{Ta(e.removed,{attribute:null,from:se})}if(se.removeAttribute(D),D==="is"&&!W[D])if(ye||b)try{sr(se)}catch{}else try{se.setAttribute(D,"")}catch{}},uR=function(D){var se,ae;if(Pe)D="<remove></remove>"+D;else{var tt=yE(D,/^[\r\n\t ]+/);ae=tt&&tt[0]}Er==="application/xhtml+xml"&&ke===Qe&&(D='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+D+"</body></html>");var Hn=R?R.createHTML(D):D;if(ke===Qe)try{se=new f().parseFromString(Hn,Er)}catch{}if(!se||!se.documentElement){se=L.createDocument(ke,"template",null);try{se.documentElement.innerHTML=Ze?I:Hn}catch{}}var cn=se.body||se.documentElement;return D&&ae&&cn.insertBefore(r.createTextNode(ae),cn.childNodes[0]||null),ke===Qe?G.call(se,Ie?"html":"body")[0]:Ie?se.documentElement:cn},cR=function(D){return j.call(D.ownerDocument||D,D,a.SHOW_ELEMENT|a.SHOW_COMMENT|a.SHOW_TEXT|a.SHOW_PROCESSING_INSTRUCTION|a.SHOW_CDATA_SECTION,null,!1)},hR=function(D){return D instanceof d&&(typeof D.nodeName!="string"||typeof D.textContent!="string"||typeof D.removeChild!="function"||!(D.attributes instanceof c)||typeof D.removeAttribute!="function"||typeof D.setAttribute!="function"||typeof D.namespaceURI!="string"||typeof D.insertBefore!="function"||typeof D.hasChildNodes!="function")},ga=function(D){return go(i)==="object"?D instanceof i:D&&go(D)==="object"&&typeof D.nodeType=="number"&&typeof D.nodeName=="string"},ws=function(D,se,ae){le[D]&&H$(le[D],function(tt){tt.call(e,se,ae,zt)})},dR=function(D){var se;if(ws("beforeSanitizeElements",D,null),hR(D)||sn(/[\u0080-\uFFFF]/,D.nodeName))return sr(D),!0;var ae=yt(D.nodeName);if(ws("uponSanitizeElement",D,{tagName:ae,allowedTags:O}),D.hasChildNodes()&&!ga(D.firstElementChild)&&(!ga(D.content)||!ga(D.content.firstElementChild))&&sn(/<[/\w]/g,D.innerHTML)&&sn(/<[/\w]/g,D.textContent)||ae==="select"&&sn(/<template/i,D.innerHTML)||D.nodeType===7||je&&D.nodeType===8&&sn(/<[/\w]/g,D.data))return sr(D),!0;if(!O[ae]||Z[ae]){if(!Z[ae]&&gR(ae)&&(K.tagNameCheck instanceof RegExp&&sn(K.tagNameCheck,ae)||K.tagNameCheck instanceof Function&&K.tagNameCheck(ae)))return!1;if(B&&!U[ae]){var tt=y(D)||D.parentNode,Hn=S(D)||D.childNodes;if(Hn&&tt)for(var cn=Hn.length,rn=cn-1;rn>=0;--rn){var Wo=w(Hn[rn],!0);Wo.__removalCount=(D.__removalCount||0)+1,tt.insertBefore(Wo,M(D))}}return sr(D),!0}return D instanceof l&&!bP(D)||(ae==="noscript"||ae==="noembed"||ae==="noframes")&&sn(/<\/no(script|embed|frames)/i,D.innerHTML)?(sr(D),!0):(q&&D.nodeType===3&&(se=D.textContent,se=Mr(se,me," "),se=Mr(se,Te," "),se=Mr(se,Ue," "),D.textContent!==se&&(Ta(e.removed,{element:D.cloneNode()}),D.textContent=se)),ws("afterSanitizeElements",D,null),!1)},fR=function(D,se,ae){if(x&&(se==="id"||se==="name")&&(ae in r||ae in nn))return!1;if(!(Ae&&!Q[se]&&sn(Me,se))){if(!(pe&&sn(E,se))){if(!W[se]||Q[se]){if(!(gR(D)&&(K.tagNameCheck instanceof RegExp&&sn(K.tagNameCheck,D)||K.tagNameCheck instanceof Function&&K.tagNameCheck(D))&&(K.attributeNameCheck instanceof RegExp&&sn(K.attributeNameCheck,se)||K.attributeNameCheck instanceof Function&&K.attributeNameCheck(se))||se==="is"&&K.allowCustomizedBuiltInElements&&(K.tagNameCheck instanceof RegExp&&sn(K.tagNameCheck,ae)||K.tagNameCheck instanceof Function&&K.tagNameCheck(ae))))return!1}else if(!de[se]){if(!sn(_,Mr(ae,g,""))){if(!((se==="src"||se==="xlink:href"||se==="href")&&D!=="script"&&D$(ae,"data:")===0&&Y[D])){if(!(Ee&&!sn(h,Mr(ae,g,"")))){if(ae)return!1}}}}}}return!0},gR=function(D){return D!=="annotation-xml"&&yE(D,C)},mR=function(D){var se,ae,tt,Hn;ws("beforeSanitizeAttributes",D,null);var cn=D.attributes;if(cn){var rn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:W};for(Hn=cn.length;Hn--;){se=cn[Hn];var Wo=se,Yt=Wo.name,Xg=Wo.namespaceURI;if(ae=Yt==="value"?se.value:k$(se.value),tt=yt(Yt),rn.attrName=tt,rn.attrValue=ae,rn.keepAttr=!0,rn.forceKeepAttr=void 0,ws("uponSanitizeAttribute",D,rn),ae=rn.attrValue,!rn.forceKeepAttr&&(Pc(Yt,D),!!rn.keepAttr)){if(!_e&&sn(/\/>/i,ae)){Pc(Yt,D);continue}q&&(ae=Mr(ae,me," "),ae=Mr(ae,Te," "),ae=Mr(ae,Ue," "));var pR=yt(D.nodeName);if(fR(pR,tt,ae)){if($&&(tt==="id"||tt==="name")&&(Pc(Yt,D),ae=H+ae),je&&sn(/((--!?|])>)|<\/(style|title)/i,ae)){Pc(Yt,D);continue}if(R&&go(m)==="object"&&typeof m.getAttributeType=="function"&&!Xg)switch(m.getAttributeType(pR,tt)){case"TrustedHTML":{ae=R.createHTML(ae);break}case"TrustedScriptURL":{ae=R.createScriptURL(ae);break}}try{Xg?D.setAttributeNS(Xg,Yt,ae):D.setAttribute(Yt,ae),hR(D)?sr(D):CE(e.removed)}catch{}}}}ws("afterSanitizeAttributes",D,null)}},EP=function Se(D){var se,ae=cR(D);for(ws("beforeSanitizeShadowDOM",D,null);se=ae.nextNode();)ws("uponSanitizeShadowNode",se,null),!dR(se)&&(se.content instanceof s&&Se(se.content),mR(se));ws("afterSanitizeShadowDOM",D,null)};return e.sanitize=function(Se){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},se,ae,tt,Hn,cn;if(Ze=!Se,Ze&&(Se="<!-->"),typeof Se!="string"&&!ga(Se))if(typeof Se.toString=="function"){if(Se=Se.toString(),typeof Se!="string")throw Um("dirty is not a string, aborting")}else throw Um("toString is not a function");if(!e.isSupported){if(go(n.toStaticHTML)==="object"||typeof n.toStaticHTML=="function"){if(typeof Se=="string")return n.toStaticHTML(Se);if(ga(Se))return n.toStaticHTML(Se.outerHTML)}return Se}if(be||Gg(D),e.removed=[],typeof Se=="string"&&(N=!1),N){if(Se.nodeName){var rn=yt(Se.nodeName);if(!O[rn]||Z[rn])throw Um("root node is forbidden and cannot be sanitized in-place")}}else if(Se instanceof i)se=uR("<!---->"),ae=se.ownerDocument.importNode(Se,!0),ae.nodeType===1&&ae.nodeName==="BODY"||ae.nodeName==="HTML"?se=ae:se.appendChild(ae);else{if(!ye&&!q&&!Ie&&Se.indexOf("<")===-1)return R&&T?R.createHTML(Se):Se;if(se=uR(Se),!se)return ye?null:T?I:""}se&&Pe&&sr(se.firstChild);for(var Wo=cR(N?Se:se);tt=Wo.nextNode();)tt.nodeType===3&&tt===Hn||dR(tt)||(tt.content instanceof s&&EP(tt.content),mR(tt),Hn=tt);if(Hn=null,N)return Se;if(ye){if(b)for(cn=X.call(se.ownerDocument);se.firstChild;)cn.appendChild(se.firstChild);else cn=se;return(W.shadowroot||W.shadowrootmod)&&(cn=te.call(t,cn,!0)),cn}var Yt=Ie?se.outerHTML:se.innerHTML;return Ie&&O["!doctype"]&&se.ownerDocument&&se.ownerDocument.doctype&&se.ownerDocument.doctype.name&&sn(G$,se.ownerDocument.doctype.name)&&(Yt="<!DOCTYPE "+se.ownerDocument.doctype.name+`>
`+Yt),q&&(Yt=Mr(Yt,me," "),Yt=Mr(Yt,Te," "),Yt=Mr(Yt,Ue," ")),R&&T?R.createHTML(Yt):Yt},e.setConfig=function(Se){Gg(Se),be=!0},e.clearConfig=function(){zt=null,be=!1},e.isValidAttribute=function(Se,D,se){zt||Gg({});var ae=yt(Se),tt=yt(D);return fR(ae,tt,se)},e.addHook=function(Se,D){typeof D=="function"&&(le[Se]=le[Se]||[],Ta(le[Se],D))},e.removeHook=function(Se){if(le[Se])return CE(le[Se])},e.removeHooks=function(Se){le[Se]&&(le[Se]=[])},e.removeAllHooks=function(){le={}},e}var Q$=KO();//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var XO;function J(){return XO.apply(null,arguments)}function Z$(n){XO=n}function Vr(n){return n instanceof Array||Object.prototype.toString.call(n)==="[object Array]"}function wi(n){return n!=null&&Object.prototype.toString.call(n)==="[object Object]"}function Je(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function gv(n){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(n).length===0;var e;for(e in n)if(Je(n,e))return!1;return!0}function Dn(n){return n===void 0}function Us(n){return typeof n=="number"||Object.prototype.toString.call(n)==="[object Number]"}function hc(n){return n instanceof Date||Object.prototype.toString.call(n)==="[object Date]"}function qO(n,e){var t=[],r,s=n.length;for(r=0;r<s;++r)t.push(e(n[r],r));return t}function wo(n,e){for(var t in e)Je(e,t)&&(n[t]=e[t]);return Je(e,"toString")&&(n.toString=e.toString),Je(e,"valueOf")&&(n.valueOf=e.valueOf),n}function ms(n,e,t,r){return vI(n,e,t,r,!0).utc()}function J$(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Le(n){return n._pf==null&&(n._pf=J$()),n._pf}var yC;Array.prototype.some?yC=Array.prototype.some:yC=function(n){var e=Object(this),t=e.length>>>0,r;for(r=0;r<t;r++)if(r in e&&n.call(this,e[r],r,e))return!0;return!1};function mv(n){if(n._isValid==null){var e=Le(n),t=yC.call(e.parsedDateParts,function(s){return s!=null}),r=!isNaN(n._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&t);if(n._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(n))n._isValid=r;else return r}return n._isValid}function Xf(n){var e=ms(NaN);return n!=null?wo(Le(e),n):Le(e).userInvalidated=!0,e}var EE=J.momentProperties=[],Km=!1;function pv(n,e){var t,r,s,o=EE.length;if(Dn(e._isAMomentObject)||(n._isAMomentObject=e._isAMomentObject),Dn(e._i)||(n._i=e._i),Dn(e._f)||(n._f=e._f),Dn(e._l)||(n._l=e._l),Dn(e._strict)||(n._strict=e._strict),Dn(e._tzm)||(n._tzm=e._tzm),Dn(e._isUTC)||(n._isUTC=e._isUTC),Dn(e._offset)||(n._offset=e._offset),Dn(e._pf)||(n._pf=Le(e)),Dn(e._locale)||(n._locale=e._locale),o>0)for(t=0;t<o;t++)r=EE[t],s=e[r],Dn(s)||(n[r]=s);return n}function dc(n){pv(this,n),this._d=new Date(n._d!=null?n._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Km===!1&&(Km=!0,J.updateOffset(this),Km=!1)}function $r(n){return n instanceof dc||n!=null&&n._isAMomentObject!=null}function QO(n){J.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+n)}function Sr(n,e){var t=!0;return wo(function(){if(J.deprecationHandler!=null&&J.deprecationHandler(null,n),t){var r=[],s,o,i,l=arguments.length;for(o=0;o<l;o++){if(s="",typeof arguments[o]=="object"){s+=`
[`+o+"] ";for(i in arguments[0])Je(arguments[0],i)&&(s+=i+": "+arguments[0][i]+", ");s=s.slice(0,-2)}else s=arguments[o];r.push(s)}QO(n+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),t=!1}return e.apply(this,arguments)},e)}var TE={};function ZO(n,e){J.deprecationHandler!=null&&J.deprecationHandler(n,e),TE[n]||(QO(e),TE[n]=!0)}J.suppressDeprecationWarnings=!1;J.deprecationHandler=null;function ps(n){return typeof Function<"u"&&n instanceof Function||Object.prototype.toString.call(n)==="[object Function]"}function eB(n){var e,t;for(t in n)Je(n,t)&&(e=n[t],ps(e)?this[t]=e:this["_"+t]=e);this._config=n,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function vC(n,e){var t=wo({},n),r;for(r in e)Je(e,r)&&(wi(n[r])&&wi(e[r])?(t[r]={},wo(t[r],n[r]),wo(t[r],e[r])):e[r]!=null?t[r]=e[r]:delete t[r]);for(r in n)Je(n,r)&&!Je(e,r)&&wi(n[r])&&(t[r]=wo({},t[r]));return t}function wv(n){n!=null&&this.set(n)}var SC;Object.keys?SC=Object.keys:SC=function(n){var e,t=[];for(e in n)Je(n,e)&&t.push(e);return t};var tB={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function nB(n,e,t){var r=this._calendar[n]||this._calendar.sameElse;return ps(r)?r.call(e,t):r}function cs(n,e,t){var r=""+Math.abs(n),s=e-r.length,o=n>=0;return(o?t?"+":"":"-")+Math.pow(10,Math.max(0,s)).toString().substr(1)+r}var Cv=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,rh=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Xm={},kl={};function Re(n,e,t,r){var s=r;typeof r=="string"&&(s=function(){return this[r]()}),n&&(kl[n]=s),e&&(kl[e[0]]=function(){return cs(s.apply(this,arguments),e[1],e[2])}),t&&(kl[t]=function(){return this.localeData().ordinal(s.apply(this,arguments),n)})}function rB(n){return n.match(/\[[\s\S]/)?n.replace(/^\[|\]$/g,""):n.replace(/\\/g,"")}function sB(n){var e=n.match(Cv),t,r;for(t=0,r=e.length;t<r;t++)kl[e[t]]?e[t]=kl[e[t]]:e[t]=rB(e[t]);return function(s){var o="",i;for(i=0;i<r;i++)o+=ps(e[i])?e[i].call(s,n):e[i];return o}}function id(n,e){return n.isValid()?(e=JO(e,n.localeData()),Xm[e]=Xm[e]||sB(e),Xm[e](n)):n.localeData().invalidDate()}function JO(n,e){var t=5;function r(s){return e.longDateFormat(s)||s}for(rh.lastIndex=0;t>=0&&rh.test(n);)n=n.replace(rh,r),rh.lastIndex=0,t-=1;return n}var oB={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function iB(n){var e=this._longDateFormat[n],t=this._longDateFormat[n.toUpperCase()];return e||!t?e:(this._longDateFormat[n]=t.match(Cv).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[n])}var lB="Invalid date";function aB(){return this._invalidDate}var uB="%d",cB=/\d{1,2}/;function hB(n){return this._ordinal.replace("%d",n)}var dB={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function fB(n,e,t,r){var s=this._relativeTime[t];return ps(s)?s(n,e,t,r):s.replace(/%d/i,n)}function gB(n,e){var t=this._relativeTime[n>0?"future":"past"];return ps(t)?t(e):t.replace(/%s/i,e)}var uu={};function yn(n,e){var t=n.toLowerCase();uu[t]=uu[t+"s"]=uu[e]=n}function Rr(n){return typeof n=="string"?uu[n]||uu[n.toLowerCase()]:void 0}function yv(n){var e={},t,r;for(r in n)Je(n,r)&&(t=Rr(r),t&&(e[t]=n[r]));return e}var eI={};function vn(n,e){eI[n]=e}function mB(n){var e=[],t;for(t in n)Je(n,t)&&e.push({unit:t,priority:eI[t]});return e.sort(function(r,s){return r.priority-s.priority}),e}function qf(n){return n%4===0&&n%100!==0||n%400===0}function dr(n){return n<0?Math.ceil(n)||0:Math.floor(n)}function Ye(n){var e=+n,t=0;return e!==0&&isFinite(e)&&(t=dr(e)),t}function sa(n,e){return function(t){return t!=null?(tI(this,n,t),J.updateOffset(this,e),this):jd(this,n)}}function jd(n,e){return n.isValid()?n._d["get"+(n._isUTC?"UTC":"")+e]():NaN}function tI(n,e,t){n.isValid()&&!isNaN(t)&&(e==="FullYear"&&qf(n.year())&&n.month()===1&&n.date()===29?(t=Ye(t),n._d["set"+(n._isUTC?"UTC":"")+e](t,n.month(),ng(t,n.month()))):n._d["set"+(n._isUTC?"UTC":"")+e](t))}function pB(n){return n=Rr(n),ps(this[n])?this[n]():this}function wB(n,e){if(typeof n=="object"){n=yv(n);var t=mB(n),r,s=t.length;for(r=0;r<s;r++)this[t[r].unit](n[t[r].unit])}else if(n=Rr(n),ps(this[n]))return this[n](e);return this}var nI=/\d/,tr=/\d\d/,rI=/\d{3}/,vv=/\d{4}/,Qf=/[+-]?\d{6}/,Ct=/\d\d?/,sI=/\d\d\d\d?/,oI=/\d\d\d\d\d\d?/,Zf=/\d{1,3}/,Sv=/\d{1,4}/,Jf=/[+-]?\d{1,6}/,oa=/\d+/,eg=/[+-]?\d+/,CB=/Z|[+-]\d\d:?\d\d/gi,tg=/Z|[+-]\d\d(?::?\d\d)?/gi,yB=/[+-]?\d+(\.\d{1,3})?/,fc=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Gd;Gd={};function fe(n,e,t){Gd[n]=ps(e)?e:function(r,s){return r&&t?t:e}}function vB(n,e){return Je(Gd,n)?Gd[n](e._strict,e._locale):new RegExp(SB(n))}function SB(n){return Kn(n.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,r,s,o){return t||r||s||o}))}function Kn(n){return n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var RC={};function it(n,e){var t,r=e,s;for(typeof n=="string"&&(n=[n]),Us(e)&&(r=function(o,i){i[e]=Ye(o)}),s=n.length,t=0;t<s;t++)RC[n[t]]=r}function gc(n,e){it(n,function(t,r,s,o){s._w=s._w||{},e(t,s._w,s,o)})}function RB(n,e,t){e!=null&&Je(RC,n)&&RC[n](e,t._a,t,n)}var pn=0,Hs=1,ss=2,Kt=3,Dr=4,Ds=5,hi=6,bB=7,EB=8;function TB(n,e){return(n%e+e)%e}var kt;Array.prototype.indexOf?kt=Array.prototype.indexOf:kt=function(n){var e;for(e=0;e<this.length;++e)if(this[e]===n)return e;return-1};function ng(n,e){if(isNaN(n)||isNaN(e))return NaN;var t=TB(e,12);return n+=(e-t)/12,t===1?qf(n)?29:28:31-t%7%2}Re("M",["MM",2],"Mo",function(){return this.month()+1});Re("MMM",0,0,function(n){return this.localeData().monthsShort(this,n)});Re("MMMM",0,0,function(n){return this.localeData().months(this,n)});yn("month","M");vn("month",8);fe("M",Ct);fe("MM",Ct,tr);fe("MMM",function(n,e){return e.monthsShortRegex(n)});fe("MMMM",function(n,e){return e.monthsRegex(n)});it(["M","MM"],function(n,e){e[Hs]=Ye(n)-1});it(["MMM","MMMM"],function(n,e,t,r){var s=t._locale.monthsParse(n,r,t._strict);s!=null?e[Hs]=s:Le(t).invalidMonth=n});var MB="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),iI="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),lI=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,_B=fc,OB=fc;function IB(n,e){return n?Vr(this._months)?this._months[n.month()]:this._months[(this._months.isFormat||lI).test(e)?"format":"standalone"][n.month()]:Vr(this._months)?this._months:this._months.standalone}function xB(n,e){return n?Vr(this._monthsShort)?this._monthsShort[n.month()]:this._monthsShort[lI.test(e)?"format":"standalone"][n.month()]:Vr(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function AB(n,e,t){var r,s,o,i=n.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=ms([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return t?e==="MMM"?(s=kt.call(this._shortMonthsParse,i),s!==-1?s:null):(s=kt.call(this._longMonthsParse,i),s!==-1?s:null):e==="MMM"?(s=kt.call(this._shortMonthsParse,i),s!==-1?s:(s=kt.call(this._longMonthsParse,i),s!==-1?s:null)):(s=kt.call(this._longMonthsParse,i),s!==-1?s:(s=kt.call(this._shortMonthsParse,i),s!==-1?s:null))}function PB(n,e,t){var r,s,o;if(this._monthsParseExact)return AB.call(this,n,e,t);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(s=ms([2e3,r]),t&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(s,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(s,"").replace(".","")+"$","i")),!t&&!this._monthsParse[r]&&(o="^"+this.months(s,"")+"|^"+this.monthsShort(s,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),t&&e==="MMMM"&&this._longMonthsParse[r].test(n))return r;if(t&&e==="MMM"&&this._shortMonthsParse[r].test(n))return r;if(!t&&this._monthsParse[r].test(n))return r}}function aI(n,e){var t;if(!n.isValid())return n;if(typeof e=="string"){if(/^\d+$/.test(e))e=Ye(e);else if(e=n.localeData().monthsParse(e),!Us(e))return n}return t=Math.min(n.date(),ng(n.year(),e)),n._d["set"+(n._isUTC?"UTC":"")+"Month"](e,t),n}function uI(n){return n!=null?(aI(this,n),J.updateOffset(this,!0),this):jd(this,"Month")}function HB(){return ng(this.year(),this.month())}function DB(n){return this._monthsParseExact?(Je(this,"_monthsRegex")||cI.call(this),n?this._monthsShortStrictRegex:this._monthsShortRegex):(Je(this,"_monthsShortRegex")||(this._monthsShortRegex=_B),this._monthsShortStrictRegex&&n?this._monthsShortStrictRegex:this._monthsShortRegex)}function kB(n){return this._monthsParseExact?(Je(this,"_monthsRegex")||cI.call(this),n?this._monthsStrictRegex:this._monthsRegex):(Je(this,"_monthsRegex")||(this._monthsRegex=OB),this._monthsStrictRegex&&n?this._monthsStrictRegex:this._monthsRegex)}function cI(){function n(i,l){return l.length-i.length}var e=[],t=[],r=[],s,o;for(s=0;s<12;s++)o=ms([2e3,s]),e.push(this.monthsShort(o,"")),t.push(this.months(o,"")),r.push(this.months(o,"")),r.push(this.monthsShort(o,""));for(e.sort(n),t.sort(n),r.sort(n),s=0;s<12;s++)e[s]=Kn(e[s]),t[s]=Kn(t[s]);for(s=0;s<24;s++)r[s]=Kn(r[s]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}Re("Y",0,0,function(){var n=this.year();return n<=9999?cs(n,4):"+"+n});Re(0,["YY",2],0,function(){return this.year()%100});Re(0,["YYYY",4],0,"year");Re(0,["YYYYY",5],0,"year");Re(0,["YYYYYY",6,!0],0,"year");yn("year","y");vn("year",1);fe("Y",eg);fe("YY",Ct,tr);fe("YYYY",Sv,vv);fe("YYYYY",Jf,Qf);fe("YYYYYY",Jf,Qf);it(["YYYYY","YYYYYY"],pn);it("YYYY",function(n,e){e[pn]=n.length===2?J.parseTwoDigitYear(n):Ye(n)});it("YY",function(n,e){e[pn]=J.parseTwoDigitYear(n)});it("Y",function(n,e){e[pn]=parseInt(n,10)});function cu(n){return qf(n)?366:365}J.parseTwoDigitYear=function(n){return Ye(n)+(Ye(n)>68?1900:2e3)};var hI=sa("FullYear",!0);function NB(){return qf(this.year())}function LB(n,e,t,r,s,o,i){var l;return n<100&&n>=0?(l=new Date(n+400,e,t,r,s,o,i),isFinite(l.getFullYear())&&l.setFullYear(n)):l=new Date(n,e,t,r,s,o,i),l}function $u(n){var e,t;return n<100&&n>=0?(t=Array.prototype.slice.call(arguments),t[0]=n+400,e=new Date(Date.UTC.apply(null,t)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(n)):e=new Date(Date.UTC.apply(null,arguments)),e}function Kd(n,e,t){var r=7+e-t,s=(7+$u(n,0,r).getUTCDay()-e)%7;return-s+r-1}function dI(n,e,t,r,s){var o=(7+t-r)%7,i=Kd(n,r,s),l=1+7*(e-1)+o+i,a,u;return l<=0?(a=n-1,u=cu(a)+l):l>cu(n)?(a=n+1,u=l-cu(n)):(a=n,u=l),{year:a,dayOfYear:u}}function Bu(n,e,t){var r=Kd(n.year(),e,t),s=Math.floor((n.dayOfYear()-r-1)/7)+1,o,i;return s<1?(i=n.year()-1,o=s+Ls(i,e,t)):s>Ls(n.year(),e,t)?(o=s-Ls(n.year(),e,t),i=n.year()+1):(i=n.year(),o=s),{week:o,year:i}}function Ls(n,e,t){var r=Kd(n,e,t),s=Kd(n+1,e,t);return(cu(n)-r+s)/7}Re("w",["ww",2],"wo","week");Re("W",["WW",2],"Wo","isoWeek");yn("week","w");yn("isoWeek","W");vn("week",5);vn("isoWeek",5);fe("w",Ct);fe("ww",Ct,tr);fe("W",Ct);fe("WW",Ct,tr);gc(["w","ww","W","WW"],function(n,e,t,r){e[r.substr(0,1)]=Ye(n)});function FB(n){return Bu(n,this._week.dow,this._week.doy).week}var VB={dow:0,doy:6};function $B(){return this._week.dow}function BB(){return this._week.doy}function WB(n){var e=this.localeData().week(this);return n==null?e:this.add((n-e)*7,"d")}function UB(n){var e=Bu(this,1,4).week;return n==null?e:this.add((n-e)*7,"d")}Re("d",0,"do","day");Re("dd",0,0,function(n){return this.localeData().weekdaysMin(this,n)});Re("ddd",0,0,function(n){return this.localeData().weekdaysShort(this,n)});Re("dddd",0,0,function(n){return this.localeData().weekdays(this,n)});Re("e",0,0,"weekday");Re("E",0,0,"isoWeekday");yn("day","d");yn("weekday","e");yn("isoWeekday","E");vn("day",11);vn("weekday",11);vn("isoWeekday",11);fe("d",Ct);fe("e",Ct);fe("E",Ct);fe("dd",function(n,e){return e.weekdaysMinRegex(n)});fe("ddd",function(n,e){return e.weekdaysShortRegex(n)});fe("dddd",function(n,e){return e.weekdaysRegex(n)});gc(["dd","ddd","dddd"],function(n,e,t,r){var s=t._locale.weekdaysParse(n,r,t._strict);s!=null?e.d=s:Le(t).invalidWeekday=n});gc(["d","e","E"],function(n,e,t,r){e[r]=Ye(n)});function zB(n,e){return typeof n!="string"?n:isNaN(n)?(n=e.weekdaysParse(n),typeof n=="number"?n:null):parseInt(n,10)}function YB(n,e){return typeof n=="string"?e.weekdaysParse(n)%7||7:isNaN(n)?null:n}function Rv(n,e){return n.slice(e,7).concat(n.slice(0,e))}var jB="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),fI="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),GB="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),KB=fc,XB=fc,qB=fc;function QB(n,e){var t=Vr(this._weekdays)?this._weekdays:this._weekdays[n&&n!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return n===!0?Rv(t,this._week.dow):n?t[n.day()]:t}function ZB(n){return n===!0?Rv(this._weekdaysShort,this._week.dow):n?this._weekdaysShort[n.day()]:this._weekdaysShort}function JB(n){return n===!0?Rv(this._weekdaysMin,this._week.dow):n?this._weekdaysMin[n.day()]:this._weekdaysMin}function eW(n,e,t){var r,s,o,i=n.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=ms([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return t?e==="dddd"?(s=kt.call(this._weekdaysParse,i),s!==-1?s:null):e==="ddd"?(s=kt.call(this._shortWeekdaysParse,i),s!==-1?s:null):(s=kt.call(this._minWeekdaysParse,i),s!==-1?s:null):e==="dddd"?(s=kt.call(this._weekdaysParse,i),s!==-1||(s=kt.call(this._shortWeekdaysParse,i),s!==-1)?s:(s=kt.call(this._minWeekdaysParse,i),s!==-1?s:null)):e==="ddd"?(s=kt.call(this._shortWeekdaysParse,i),s!==-1||(s=kt.call(this._weekdaysParse,i),s!==-1)?s:(s=kt.call(this._minWeekdaysParse,i),s!==-1?s:null)):(s=kt.call(this._minWeekdaysParse,i),s!==-1||(s=kt.call(this._weekdaysParse,i),s!==-1)?s:(s=kt.call(this._shortWeekdaysParse,i),s!==-1?s:null))}function tW(n,e,t){var r,s,o;if(this._weekdaysParseExact)return eW.call(this,n,e,t);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(s=ms([2e3,1]).day(r),t&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(s,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(s,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(s,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(s,"")+"|^"+this.weekdaysShort(s,"")+"|^"+this.weekdaysMin(s,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),t&&e==="dddd"&&this._fullWeekdaysParse[r].test(n))return r;if(t&&e==="ddd"&&this._shortWeekdaysParse[r].test(n))return r;if(t&&e==="dd"&&this._minWeekdaysParse[r].test(n))return r;if(!t&&this._weekdaysParse[r].test(n))return r}}function nW(n){if(!this.isValid())return n!=null?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return n!=null?(n=zB(n,this.localeData()),this.add(n-e,"d")):e}function rW(n){if(!this.isValid())return n!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return n==null?e:this.add(n-e,"d")}function sW(n){if(!this.isValid())return n!=null?this:NaN;if(n!=null){var e=YB(n,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function oW(n){return this._weekdaysParseExact?(Je(this,"_weekdaysRegex")||bv.call(this),n?this._weekdaysStrictRegex:this._weekdaysRegex):(Je(this,"_weekdaysRegex")||(this._weekdaysRegex=KB),this._weekdaysStrictRegex&&n?this._weekdaysStrictRegex:this._weekdaysRegex)}function iW(n){return this._weekdaysParseExact?(Je(this,"_weekdaysRegex")||bv.call(this),n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Je(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=XB),this._weekdaysShortStrictRegex&&n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function lW(n){return this._weekdaysParseExact?(Je(this,"_weekdaysRegex")||bv.call(this),n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Je(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=qB),this._weekdaysMinStrictRegex&&n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function bv(){function n(c,d){return d.length-c.length}var e=[],t=[],r=[],s=[],o,i,l,a,u;for(o=0;o<7;o++)i=ms([2e3,1]).day(o),l=Kn(this.weekdaysMin(i,"")),a=Kn(this.weekdaysShort(i,"")),u=Kn(this.weekdays(i,"")),e.push(l),t.push(a),r.push(u),s.push(l),s.push(a),s.push(u);e.sort(n),t.sort(n),r.sort(n),s.sort(n),this._weekdaysRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Ev(){return this.hours()%12||12}function aW(){return this.hours()||24}Re("H",["HH",2],0,"hour");Re("h",["hh",2],0,Ev);Re("k",["kk",2],0,aW);Re("hmm",0,0,function(){return""+Ev.apply(this)+cs(this.minutes(),2)});Re("hmmss",0,0,function(){return""+Ev.apply(this)+cs(this.minutes(),2)+cs(this.seconds(),2)});Re("Hmm",0,0,function(){return""+this.hours()+cs(this.minutes(),2)});Re("Hmmss",0,0,function(){return""+this.hours()+cs(this.minutes(),2)+cs(this.seconds(),2)});function gI(n,e){Re(n,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}gI("a",!0);gI("A",!1);yn("hour","h");vn("hour",13);function mI(n,e){return e._meridiemParse}fe("a",mI);fe("A",mI);fe("H",Ct);fe("h",Ct);fe("k",Ct);fe("HH",Ct,tr);fe("hh",Ct,tr);fe("kk",Ct,tr);fe("hmm",sI);fe("hmmss",oI);fe("Hmm",sI);fe("Hmmss",oI);it(["H","HH"],Kt);it(["k","kk"],function(n,e,t){var r=Ye(n);e[Kt]=r===24?0:r});it(["a","A"],function(n,e,t){t._isPm=t._locale.isPM(n),t._meridiem=n});it(["h","hh"],function(n,e,t){e[Kt]=Ye(n),Le(t).bigHour=!0});it("hmm",function(n,e,t){var r=n.length-2;e[Kt]=Ye(n.substr(0,r)),e[Dr]=Ye(n.substr(r)),Le(t).bigHour=!0});it("hmmss",function(n,e,t){var r=n.length-4,s=n.length-2;e[Kt]=Ye(n.substr(0,r)),e[Dr]=Ye(n.substr(r,2)),e[Ds]=Ye(n.substr(s)),Le(t).bigHour=!0});it("Hmm",function(n,e,t){var r=n.length-2;e[Kt]=Ye(n.substr(0,r)),e[Dr]=Ye(n.substr(r))});it("Hmmss",function(n,e,t){var r=n.length-4,s=n.length-2;e[Kt]=Ye(n.substr(0,r)),e[Dr]=Ye(n.substr(r,2)),e[Ds]=Ye(n.substr(s))});function uW(n){return(n+"").toLowerCase().charAt(0)==="p"}var cW=/[ap]\.?m?\.?/i,hW=sa("Hours",!0);function dW(n,e,t){return n>11?t?"pm":"PM":t?"am":"AM"}var pI={calendar:tB,longDateFormat:oB,invalidDate:lB,ordinal:uB,dayOfMonthOrdinalParse:cB,relativeTime:dB,months:MB,monthsShort:iI,week:VB,weekdays:jB,weekdaysMin:GB,weekdaysShort:fI,meridiemParse:cW},vt={},Ma={},Wu;function fW(n,e){var t,r=Math.min(n.length,e.length);for(t=0;t<r;t+=1)if(n[t]!==e[t])return t;return r}function ME(n){return n&&n.toLowerCase().replace("_","-")}function gW(n){for(var e=0,t,r,s,o;e<n.length;){for(o=ME(n[e]).split("-"),t=o.length,r=ME(n[e+1]),r=r?r.split("-"):null;t>0;){if(s=rg(o.slice(0,t).join("-")),s)return s;if(r&&r.length>=t&&fW(o,r)>=t-1)break;t--}e++}return Wu}function mW(n){return n.match("^[^/\\\\]*$")!=null}function rg(n){var e=null,t;if(vt[n]===void 0&&typeof pd<"u"&&pd&&pd.exports&&mW(n))try{e=Wu._abbr,t=require,t("./locale/"+n),Oo(e)}catch{vt[n]=null}return vt[n]}function Oo(n,e){var t;return n&&(Dn(e)?t=Ks(n):t=Tv(n,e),t?Wu=t:typeof console<"u"&&console.warn&&console.warn("Locale "+n+" not found. Did you forget to load it?")),Wu._abbr}function Tv(n,e){if(e!==null){var t,r=pI;if(e.abbr=n,vt[n]!=null)ZO("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=vt[n]._config;else if(e.parentLocale!=null)if(vt[e.parentLocale]!=null)r=vt[e.parentLocale]._config;else if(t=rg(e.parentLocale),t!=null)r=t._config;else return Ma[e.parentLocale]||(Ma[e.parentLocale]=[]),Ma[e.parentLocale].push({name:n,config:e}),null;return vt[n]=new wv(vC(r,e)),Ma[n]&&Ma[n].forEach(function(s){Tv(s.name,s.config)}),Oo(n),vt[n]}else return delete vt[n],null}function pW(n,e){if(e!=null){var t,r,s=pI;vt[n]!=null&&vt[n].parentLocale!=null?vt[n].set(vC(vt[n]._config,e)):(r=rg(n),r!=null&&(s=r._config),e=vC(s,e),r==null&&(e.abbr=n),t=new wv(e),t.parentLocale=vt[n],vt[n]=t),Oo(n)}else vt[n]!=null&&(vt[n].parentLocale!=null?(vt[n]=vt[n].parentLocale,n===Oo()&&Oo(n)):vt[n]!=null&&delete vt[n]);return vt[n]}function Ks(n){var e;if(n&&n._locale&&n._locale._abbr&&(n=n._locale._abbr),!n)return Wu;if(!Vr(n)){if(e=rg(n),e)return e;n=[n]}return gW(n)}function wW(){return SC(vt)}function Mv(n){var e,t=n._a;return t&&Le(n).overflow===-2&&(e=t[Hs]<0||t[Hs]>11?Hs:t[ss]<1||t[ss]>ng(t[pn],t[Hs])?ss:t[Kt]<0||t[Kt]>24||t[Kt]===24&&(t[Dr]!==0||t[Ds]!==0||t[hi]!==0)?Kt:t[Dr]<0||t[Dr]>59?Dr:t[Ds]<0||t[Ds]>59?Ds:t[hi]<0||t[hi]>999?hi:-1,Le(n)._overflowDayOfYear&&(e<pn||e>ss)&&(e=ss),Le(n)._overflowWeeks&&e===-1&&(e=bB),Le(n)._overflowWeekday&&e===-1&&(e=EB),Le(n).overflow=e),n}var CW=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,yW=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,vW=/Z|[+-]\d\d(?::?\d\d)?/,sh=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],qm=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],SW=/^\/?Date\((-?\d+)/i,RW=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,bW={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function wI(n){var e,t,r=n._i,s=CW.exec(r)||yW.exec(r),o,i,l,a,u=sh.length,c=qm.length;if(s){for(Le(n).iso=!0,e=0,t=u;e<t;e++)if(sh[e][1].exec(s[1])){i=sh[e][0],o=sh[e][2]!==!1;break}if(i==null){n._isValid=!1;return}if(s[3]){for(e=0,t=c;e<t;e++)if(qm[e][1].exec(s[3])){l=(s[2]||" ")+qm[e][0];break}if(l==null){n._isValid=!1;return}}if(!o&&l!=null){n._isValid=!1;return}if(s[4])if(vW.exec(s[4]))a="Z";else{n._isValid=!1;return}n._f=i+(l||"")+(a||""),Ov(n)}else n._isValid=!1}function EW(n,e,t,r,s,o){var i=[TW(n),iI.indexOf(e),parseInt(t,10),parseInt(r,10),parseInt(s,10)];return o&&i.push(parseInt(o,10)),i}function TW(n){var e=parseInt(n,10);return e<=49?2e3+e:e<=999?1900+e:e}function MW(n){return n.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function _W(n,e,t){if(n){var r=fI.indexOf(n),s=new Date(e[0],e[1],e[2]).getDay();if(r!==s)return Le(t).weekdayMismatch=!0,t._isValid=!1,!1}return!0}function OW(n,e,t){if(n)return bW[n];if(e)return 0;var r=parseInt(t,10),s=r%100,o=(r-s)/100;return o*60+s}function CI(n){var e=RW.exec(MW(n._i)),t;if(e){if(t=EW(e[4],e[3],e[2],e[5],e[6],e[7]),!_W(e[1],t,n))return;n._a=t,n._tzm=OW(e[8],e[9],e[10]),n._d=$u.apply(null,n._a),n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm),Le(n).rfc2822=!0}else n._isValid=!1}function IW(n){var e=SW.exec(n._i);if(e!==null){n._d=new Date(+e[1]);return}if(wI(n),n._isValid===!1)delete n._isValid;else return;if(CI(n),n._isValid===!1)delete n._isValid;else return;n._strict?n._isValid=!1:J.createFromInputFallback(n)}J.createFromInputFallback=Sr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(n){n._d=new Date(n._i+(n._useUTC?" UTC":""))});function hl(n,e,t){return n??e??t}function xW(n){var e=new Date(J.now());return n._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function _v(n){var e,t,r=[],s,o,i;if(!n._d){for(s=xW(n),n._w&&n._a[ss]==null&&n._a[Hs]==null&&AW(n),n._dayOfYear!=null&&(i=hl(n._a[pn],s[pn]),(n._dayOfYear>cu(i)||n._dayOfYear===0)&&(Le(n)._overflowDayOfYear=!0),t=$u(i,0,n._dayOfYear),n._a[Hs]=t.getUTCMonth(),n._a[ss]=t.getUTCDate()),e=0;e<3&&n._a[e]==null;++e)n._a[e]=r[e]=s[e];for(;e<7;e++)n._a[e]=r[e]=n._a[e]==null?e===2?1:0:n._a[e];n._a[Kt]===24&&n._a[Dr]===0&&n._a[Ds]===0&&n._a[hi]===0&&(n._nextDay=!0,n._a[Kt]=0),n._d=(n._useUTC?$u:LB).apply(null,r),o=n._useUTC?n._d.getUTCDay():n._d.getDay(),n._tzm!=null&&n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm),n._nextDay&&(n._a[Kt]=24),n._w&&typeof n._w.d<"u"&&n._w.d!==o&&(Le(n).weekdayMismatch=!0)}}function AW(n){var e,t,r,s,o,i,l,a,u;e=n._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,i=4,t=hl(e.GG,n._a[pn],Bu(wt(),1,4).year),r=hl(e.W,1),s=hl(e.E,1),(s<1||s>7)&&(a=!0)):(o=n._locale._week.dow,i=n._locale._week.doy,u=Bu(wt(),o,i),t=hl(e.gg,n._a[pn],u.year),r=hl(e.w,u.week),e.d!=null?(s=e.d,(s<0||s>6)&&(a=!0)):e.e!=null?(s=e.e+o,(e.e<0||e.e>6)&&(a=!0)):s=o),r<1||r>Ls(t,o,i)?Le(n)._overflowWeeks=!0:a!=null?Le(n)._overflowWeekday=!0:(l=dI(t,r,s,o,i),n._a[pn]=l.year,n._dayOfYear=l.dayOfYear)}J.ISO_8601=function(){};J.RFC_2822=function(){};function Ov(n){if(n._f===J.ISO_8601){wI(n);return}if(n._f===J.RFC_2822){CI(n);return}n._a=[],Le(n).empty=!0;var e=""+n._i,t,r,s,o,i,l=e.length,a=0,u,c;for(s=JO(n._f,n._locale).match(Cv)||[],c=s.length,t=0;t<c;t++)o=s[t],r=(e.match(vB(o,n))||[])[0],r&&(i=e.substr(0,e.indexOf(r)),i.length>0&&Le(n).unusedInput.push(i),e=e.slice(e.indexOf(r)+r.length),a+=r.length),kl[o]?(r?Le(n).empty=!1:Le(n).unusedTokens.push(o),RB(o,r,n)):n._strict&&!r&&Le(n).unusedTokens.push(o);Le(n).charsLeftOver=l-a,e.length>0&&Le(n).unusedInput.push(e),n._a[Kt]<=12&&Le(n).bigHour===!0&&n._a[Kt]>0&&(Le(n).bigHour=void 0),Le(n).parsedDateParts=n._a.slice(0),Le(n).meridiem=n._meridiem,n._a[Kt]=PW(n._locale,n._a[Kt],n._meridiem),u=Le(n).era,u!==null&&(n._a[pn]=n._locale.erasConvertYear(u,n._a[pn])),_v(n),Mv(n)}function PW(n,e,t){var r;return t==null?e:n.meridiemHour!=null?n.meridiemHour(e,t):(n.isPM!=null&&(r=n.isPM(t),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function HW(n){var e,t,r,s,o,i,l=!1,a=n._f.length;if(a===0){Le(n).invalidFormat=!0,n._d=new Date(NaN);return}for(s=0;s<a;s++)o=0,i=!1,e=pv({},n),n._useUTC!=null&&(e._useUTC=n._useUTC),e._f=n._f[s],Ov(e),mv(e)&&(i=!0),o+=Le(e).charsLeftOver,o+=Le(e).unusedTokens.length*10,Le(e).score=o,l?o<r&&(r=o,t=e):(r==null||o<r||i)&&(r=o,t=e,i&&(l=!0));wo(n,t||e)}function DW(n){if(!n._d){var e=yv(n._i),t=e.day===void 0?e.date:e.day;n._a=qO([e.year,e.month,t,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),_v(n)}}function kW(n){var e=new dc(Mv(yI(n)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function yI(n){var e=n._i,t=n._f;return n._locale=n._locale||Ks(n._l),e===null||t===void 0&&e===""?Xf({nullInput:!0}):(typeof e=="string"&&(n._i=e=n._locale.preparse(e)),$r(e)?new dc(Mv(e)):(hc(e)?n._d=e:Vr(t)?HW(n):t?Ov(n):NW(n),mv(n)||(n._d=null),n))}function NW(n){var e=n._i;Dn(e)?n._d=new Date(J.now()):hc(e)?n._d=new Date(e.valueOf()):typeof e=="string"?IW(n):Vr(e)?(n._a=qO(e.slice(0),function(t){return parseInt(t,10)}),_v(n)):wi(e)?DW(n):Us(e)?n._d=new Date(e):J.createFromInputFallback(n)}function vI(n,e,t,r,s){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(t===!0||t===!1)&&(r=t,t=void 0),(wi(n)&&gv(n)||Vr(n)&&n.length===0)&&(n=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=s,o._l=t,o._i=n,o._f=e,o._strict=r,kW(o)}function wt(n,e,t,r){return vI(n,e,t,r,!1)}var LW=Sr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=wt.apply(null,arguments);return this.isValid()&&n.isValid()?n<this?this:n:Xf()}),FW=Sr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=wt.apply(null,arguments);return this.isValid()&&n.isValid()?n>this?this:n:Xf()});function SI(n,e){var t,r;if(e.length===1&&Vr(e[0])&&(e=e[0]),!e.length)return wt();for(t=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][n](t))&&(t=e[r]);return t}function VW(){var n=[].slice.call(arguments,0);return SI("isBefore",n)}function $W(){var n=[].slice.call(arguments,0);return SI("isAfter",n)}var BW=function(){return Date.now?Date.now():+new Date},_a=["year","quarter","month","week","day","hour","minute","second","millisecond"];function WW(n){var e,t=!1,r,s=_a.length;for(e in n)if(Je(n,e)&&!(kt.call(_a,e)!==-1&&(n[e]==null||!isNaN(n[e]))))return!1;for(r=0;r<s;++r)if(n[_a[r]]){if(t)return!1;parseFloat(n[_a[r]])!==Ye(n[_a[r]])&&(t=!0)}return!0}function UW(){return this._isValid}function zW(){return Br(NaN)}function sg(n){var e=yv(n),t=e.year||0,r=e.quarter||0,s=e.month||0,o=e.week||e.isoWeek||0,i=e.day||0,l=e.hour||0,a=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=WW(e),this._milliseconds=+c+u*1e3+a*6e4+l*1e3*60*60,this._days=+i+o*7,this._months=+s+r*3+t*12,this._data={},this._locale=Ks(),this._bubble()}function ld(n){return n instanceof sg}function bC(n){return n<0?Math.round(-1*n)*-1:Math.round(n)}function YW(n,e,t){var r=Math.min(n.length,e.length),s=Math.abs(n.length-e.length),o=0,i;for(i=0;i<r;i++)Ye(n[i])!==Ye(e[i])&&o++;return o+s}function RI(n,e){Re(n,0,0,function(){var t=this.utcOffset(),r="+";return t<0&&(t=-t,r="-"),r+cs(~~(t/60),2)+e+cs(~~t%60,2)})}RI("Z",":");RI("ZZ","");fe("Z",tg);fe("ZZ",tg);it(["Z","ZZ"],function(n,e,t){t._useUTC=!0,t._tzm=Iv(tg,n)});var jW=/([\+\-]|\d\d)/gi;function Iv(n,e){var t=(e||"").match(n),r,s,o;return t===null?null:(r=t[t.length-1]||[],s=(r+"").match(jW)||["-",0,0],o=+(s[1]*60)+Ye(s[2]),o===0?0:s[0]==="+"?o:-o)}function xv(n,e){var t,r;return e._isUTC?(t=e.clone(),r=($r(n)||hc(n)?n.valueOf():wt(n).valueOf())-t.valueOf(),t._d.setTime(t._d.valueOf()+r),J.updateOffset(t,!1),t):wt(n).local()}function EC(n){return-Math.round(n._d.getTimezoneOffset())}J.updateOffset=function(){};function GW(n,e,t){var r=this._offset||0,s;if(!this.isValid())return n!=null?this:NaN;if(n!=null){if(typeof n=="string"){if(n=Iv(tg,n),n===null)return this}else Math.abs(n)<16&&!t&&(n=n*60);return!this._isUTC&&e&&(s=EC(this)),this._offset=n,this._isUTC=!0,s!=null&&this.add(s,"m"),r!==n&&(!e||this._changeInProgress?TI(this,Br(n-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,J.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:EC(this)}function KW(n,e){return n!=null?(typeof n!="string"&&(n=-n),this.utcOffset(n,e),this):-this.utcOffset()}function XW(n){return this.utcOffset(0,n)}function qW(n){return this._isUTC&&(this.utcOffset(0,n),this._isUTC=!1,n&&this.subtract(EC(this),"m")),this}function QW(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var n=Iv(CB,this._i);n!=null?this.utcOffset(n):this.utcOffset(0,!0)}return this}function ZW(n){return this.isValid()?(n=n?wt(n).utcOffset():0,(this.utcOffset()-n)%60===0):!1}function JW(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function e2(){if(!Dn(this._isDSTShifted))return this._isDSTShifted;var n={},e;return pv(n,this),n=yI(n),n._a?(e=n._isUTC?ms(n._a):wt(n._a),this._isDSTShifted=this.isValid()&&YW(n._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function t2(){return this.isValid()?!this._isUTC:!1}function n2(){return this.isValid()?this._isUTC:!1}function bI(){return this.isValid()?this._isUTC&&this._offset===0:!1}var r2=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,s2=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Br(n,e){var t=n,r=null,s,o,i;return ld(n)?t={ms:n._milliseconds,d:n._days,M:n._months}:Us(n)||!isNaN(+n)?(t={},e?t[e]=+n:t.milliseconds=+n):(r=r2.exec(n))?(s=r[1]==="-"?-1:1,t={y:0,d:Ye(r[ss])*s,h:Ye(r[Kt])*s,m:Ye(r[Dr])*s,s:Ye(r[Ds])*s,ms:Ye(bC(r[hi]*1e3))*s}):(r=s2.exec(n))?(s=r[1]==="-"?-1:1,t={y:Yo(r[2],s),M:Yo(r[3],s),w:Yo(r[4],s),d:Yo(r[5],s),h:Yo(r[6],s),m:Yo(r[7],s),s:Yo(r[8],s)}):t==null?t={}:typeof t=="object"&&("from"in t||"to"in t)&&(i=o2(wt(t.from),wt(t.to)),t={},t.ms=i.milliseconds,t.M=i.months),o=new sg(t),ld(n)&&Je(n,"_locale")&&(o._locale=n._locale),ld(n)&&Je(n,"_isValid")&&(o._isValid=n._isValid),o}Br.fn=sg.prototype;Br.invalid=zW;function Yo(n,e){var t=n&&parseFloat(n.replace(",","."));return(isNaN(t)?0:t)*e}function _E(n,e){var t={};return t.months=e.month()-n.month()+(e.year()-n.year())*12,n.clone().add(t.months,"M").isAfter(e)&&--t.months,t.milliseconds=+e-+n.clone().add(t.months,"M"),t}function o2(n,e){var t;return n.isValid()&&e.isValid()?(e=xv(e,n),n.isBefore(e)?t=_E(n,e):(t=_E(e,n),t.milliseconds=-t.milliseconds,t.months=-t.months),t):{milliseconds:0,months:0}}function EI(n,e){return function(t,r){var s,o;return r!==null&&!isNaN(+r)&&(ZO(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=t,t=r,r=o),s=Br(t,r),TI(this,s,n),this}}function TI(n,e,t,r){var s=e._milliseconds,o=bC(e._days),i=bC(e._months);n.isValid()&&(r=r??!0,i&&aI(n,jd(n,"Month")+i*t),o&&tI(n,"Date",jd(n,"Date")+o*t),s&&n._d.setTime(n._d.valueOf()+s*t),r&&J.updateOffset(n,o||i))}var i2=EI(1,"add"),l2=EI(-1,"subtract");function MI(n){return typeof n=="string"||n instanceof String}function a2(n){return $r(n)||hc(n)||MI(n)||Us(n)||c2(n)||u2(n)||n===null||n===void 0}function u2(n){var e=wi(n)&&!gv(n),t=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],s,o,i=r.length;for(s=0;s<i;s+=1)o=r[s],t=t||Je(n,o);return e&&t}function c2(n){var e=Vr(n),t=!1;return e&&(t=n.filter(function(r){return!Us(r)&&MI(n)}).length===0),e&&t}function h2(n){var e=wi(n)&&!gv(n),t=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],s,o;for(s=0;s<r.length;s+=1)o=r[s],t=t||Je(n,o);return e&&t}function d2(n,e){var t=n.diff(e,"days",!0);return t<-6?"sameElse":t<-1?"lastWeek":t<0?"lastDay":t<1?"sameDay":t<2?"nextDay":t<7?"nextWeek":"sameElse"}function f2(n,e){arguments.length===1&&(arguments[0]?a2(arguments[0])?(n=arguments[0],e=void 0):h2(arguments[0])&&(e=arguments[0],n=void 0):(n=void 0,e=void 0));var t=n||wt(),r=xv(t,this).startOf("day"),s=J.calendarFormat(this,r)||"sameElse",o=e&&(ps(e[s])?e[s].call(this,t):e[s]);return this.format(o||this.localeData().calendar(s,this,wt(t)))}function g2(){return new dc(this)}function m2(n,e){var t=$r(n)?n:wt(n);return this.isValid()&&t.isValid()?(e=Rr(e)||"millisecond",e==="millisecond"?this.valueOf()>t.valueOf():t.valueOf()<this.clone().startOf(e).valueOf()):!1}function p2(n,e){var t=$r(n)?n:wt(n);return this.isValid()&&t.isValid()?(e=Rr(e)||"millisecond",e==="millisecond"?this.valueOf()<t.valueOf():this.clone().endOf(e).valueOf()<t.valueOf()):!1}function w2(n,e,t,r){var s=$r(n)?n:wt(n),o=$r(e)?e:wt(e);return this.isValid()&&s.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(s,t):!this.isBefore(s,t))&&(r[1]===")"?this.isBefore(o,t):!this.isAfter(o,t))):!1}function C2(n,e){var t=$r(n)?n:wt(n),r;return this.isValid()&&t.isValid()?(e=Rr(e)||"millisecond",e==="millisecond"?this.valueOf()===t.valueOf():(r=t.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function y2(n,e){return this.isSame(n,e)||this.isAfter(n,e)}function v2(n,e){return this.isSame(n,e)||this.isBefore(n,e)}function S2(n,e,t){var r,s,o;if(!this.isValid())return NaN;if(r=xv(n,this),!r.isValid())return NaN;switch(s=(r.utcOffset()-this.utcOffset())*6e4,e=Rr(e),e){case"year":o=ad(this,r)/12;break;case"month":o=ad(this,r);break;case"quarter":o=ad(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-s)/864e5;break;case"week":o=(this-r-s)/6048e5;break;default:o=this-r}return t?o:dr(o)}function ad(n,e){if(n.date()<e.date())return-ad(e,n);var t=(e.year()-n.year())*12+(e.month()-n.month()),r=n.clone().add(t,"months"),s,o;return e-r<0?(s=n.clone().add(t-1,"months"),o=(e-r)/(r-s)):(s=n.clone().add(t+1,"months"),o=(e-r)/(s-r)),-(t+o)||0}J.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";J.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function R2(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function b2(n){if(!this.isValid())return null;var e=n!==!0,t=e?this.clone().utc():this;return t.year()<0||t.year()>9999?id(t,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):ps(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",id(t,"Z")):id(t,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function E2(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var n="moment",e="",t,r,s,o;return this.isLocal()||(n=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),t="["+n+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",s="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(t+r+s+o)}function T2(n){n||(n=this.isUtc()?J.defaultFormatUtc:J.defaultFormat);var e=id(this,n);return this.localeData().postformat(e)}function M2(n,e){return this.isValid()&&($r(n)&&n.isValid()||wt(n).isValid())?Br({to:this,from:n}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function _2(n){return this.from(wt(),n)}function O2(n,e){return this.isValid()&&($r(n)&&n.isValid()||wt(n).isValid())?Br({from:this,to:n}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function I2(n){return this.to(wt(),n)}function _I(n){var e;return n===void 0?this._locale._abbr:(e=Ks(n),e!=null&&(this._locale=e),this)}var OI=Sr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(n){return n===void 0?this.localeData():this.locale(n)});function II(){return this._locale}var Xd=1e3,Nl=60*Xd,qd=60*Nl,xI=(365*400+97)*24*qd;function Ll(n,e){return(n%e+e)%e}function AI(n,e,t){return n<100&&n>=0?new Date(n+400,e,t)-xI:new Date(n,e,t).valueOf()}function PI(n,e,t){return n<100&&n>=0?Date.UTC(n+400,e,t)-xI:Date.UTC(n,e,t)}function x2(n){var e,t;if(n=Rr(n),n===void 0||n==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?PI:AI,n){case"year":e=t(this.year(),0,1);break;case"quarter":e=t(this.year(),this.month()-this.month()%3,1);break;case"month":e=t(this.year(),this.month(),1);break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=t(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Ll(e+(this._isUTC?0:this.utcOffset()*Nl),qd);break;case"minute":e=this._d.valueOf(),e-=Ll(e,Nl);break;case"second":e=this._d.valueOf(),e-=Ll(e,Xd);break}return this._d.setTime(e),J.updateOffset(this,!0),this}function A2(n){var e,t;if(n=Rr(n),n===void 0||n==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?PI:AI,n){case"year":e=t(this.year()+1,0,1)-1;break;case"quarter":e=t(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=t(this.year(),this.month()+1,1)-1;break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=t(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=qd-Ll(e+(this._isUTC?0:this.utcOffset()*Nl),qd)-1;break;case"minute":e=this._d.valueOf(),e+=Nl-Ll(e,Nl)-1;break;case"second":e=this._d.valueOf(),e+=Xd-Ll(e,Xd)-1;break}return this._d.setTime(e),J.updateOffset(this,!0),this}function P2(){return this._d.valueOf()-(this._offset||0)*6e4}function H2(){return Math.floor(this.valueOf()/1e3)}function D2(){return new Date(this.valueOf())}function k2(){var n=this;return[n.year(),n.month(),n.date(),n.hour(),n.minute(),n.second(),n.millisecond()]}function N2(){var n=this;return{years:n.year(),months:n.month(),date:n.date(),hours:n.hours(),minutes:n.minutes(),seconds:n.seconds(),milliseconds:n.milliseconds()}}function L2(){return this.isValid()?this.toISOString():null}function F2(){return mv(this)}function V2(){return wo({},Le(this))}function $2(){return Le(this).overflow}function B2(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Re("N",0,0,"eraAbbr");Re("NN",0,0,"eraAbbr");Re("NNN",0,0,"eraAbbr");Re("NNNN",0,0,"eraName");Re("NNNNN",0,0,"eraNarrow");Re("y",["y",1],"yo","eraYear");Re("y",["yy",2],0,"eraYear");Re("y",["yyy",3],0,"eraYear");Re("y",["yyyy",4],0,"eraYear");fe("N",Av);fe("NN",Av);fe("NNN",Av);fe("NNNN",Z2);fe("NNNNN",J2);it(["N","NN","NNN","NNNN","NNNNN"],function(n,e,t,r){var s=t._locale.erasParse(n,r,t._strict);s?Le(t).era=s:Le(t).invalidEra=n});fe("y",oa);fe("yy",oa);fe("yyy",oa);fe("yyyy",oa);fe("yo",eU);it(["y","yy","yyy","yyyy"],pn);it(["yo"],function(n,e,t,r){var s;t._locale._eraYearOrdinalRegex&&(s=n.match(t._locale._eraYearOrdinalRegex)),t._locale.eraYearOrdinalParse?e[pn]=t._locale.eraYearOrdinalParse(n,s):e[pn]=parseInt(n,10)});function W2(n,e){var t,r,s,o=this._eras||Ks("en")._eras;for(t=0,r=o.length;t<r;++t){switch(typeof o[t].since){case"string":s=J(o[t].since).startOf("day"),o[t].since=s.valueOf();break}switch(typeof o[t].until){case"undefined":o[t].until=1/0;break;case"string":s=J(o[t].until).startOf("day").valueOf(),o[t].until=s.valueOf();break}}return o}function U2(n,e,t){var r,s,o=this.eras(),i,l,a;for(n=n.toUpperCase(),r=0,s=o.length;r<s;++r)if(i=o[r].name.toUpperCase(),l=o[r].abbr.toUpperCase(),a=o[r].narrow.toUpperCase(),t)switch(e){case"N":case"NN":case"NNN":if(l===n)return o[r];break;case"NNNN":if(i===n)return o[r];break;case"NNNNN":if(a===n)return o[r];break}else if([i,l,a].indexOf(n)>=0)return o[r]}function z2(n,e){var t=n.since<=n.until?1:-1;return e===void 0?J(n.since).year():J(n.since).year()+(e-n.offset)*t}function Y2(){var n,e,t,r=this.localeData().eras();for(n=0,e=r.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),r[n].since<=t&&t<=r[n].until||r[n].until<=t&&t<=r[n].since)return r[n].name;return""}function j2(){var n,e,t,r=this.localeData().eras();for(n=0,e=r.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),r[n].since<=t&&t<=r[n].until||r[n].until<=t&&t<=r[n].since)return r[n].narrow;return""}function G2(){var n,e,t,r=this.localeData().eras();for(n=0,e=r.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),r[n].since<=t&&t<=r[n].until||r[n].until<=t&&t<=r[n].since)return r[n].abbr;return""}function K2(){var n,e,t,r,s=this.localeData().eras();for(n=0,e=s.length;n<e;++n)if(t=s[n].since<=s[n].until?1:-1,r=this.clone().startOf("day").valueOf(),s[n].since<=r&&r<=s[n].until||s[n].until<=r&&r<=s[n].since)return(this.year()-J(s[n].since).year())*t+s[n].offset;return this.year()}function X2(n){return Je(this,"_erasNameRegex")||Pv.call(this),n?this._erasNameRegex:this._erasRegex}function q2(n){return Je(this,"_erasAbbrRegex")||Pv.call(this),n?this._erasAbbrRegex:this._erasRegex}function Q2(n){return Je(this,"_erasNarrowRegex")||Pv.call(this),n?this._erasNarrowRegex:this._erasRegex}function Av(n,e){return e.erasAbbrRegex(n)}function Z2(n,e){return e.erasNameRegex(n)}function J2(n,e){return e.erasNarrowRegex(n)}function eU(n,e){return e._eraYearOrdinalRegex||oa}function Pv(){var n=[],e=[],t=[],r=[],s,o,i=this.eras();for(s=0,o=i.length;s<o;++s)e.push(Kn(i[s].name)),n.push(Kn(i[s].abbr)),t.push(Kn(i[s].narrow)),r.push(Kn(i[s].name)),r.push(Kn(i[s].abbr)),r.push(Kn(i[s].narrow));this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+t.join("|")+")","i")}Re(0,["gg",2],0,function(){return this.weekYear()%100});Re(0,["GG",2],0,function(){return this.isoWeekYear()%100});function og(n,e){Re(0,[n,n.length],0,e)}og("gggg","weekYear");og("ggggg","weekYear");og("GGGG","isoWeekYear");og("GGGGG","isoWeekYear");yn("weekYear","gg");yn("isoWeekYear","GG");vn("weekYear",1);vn("isoWeekYear",1);fe("G",eg);fe("g",eg);fe("GG",Ct,tr);fe("gg",Ct,tr);fe("GGGG",Sv,vv);fe("gggg",Sv,vv);fe("GGGGG",Jf,Qf);fe("ggggg",Jf,Qf);gc(["gggg","ggggg","GGGG","GGGGG"],function(n,e,t,r){e[r.substr(0,2)]=Ye(n)});gc(["gg","GG"],function(n,e,t,r){e[r]=J.parseTwoDigitYear(n)});function tU(n){return HI.call(this,n,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function nU(n){return HI.call(this,n,this.isoWeek(),this.isoWeekday(),1,4)}function rU(){return Ls(this.year(),1,4)}function sU(){return Ls(this.isoWeekYear(),1,4)}function oU(){var n=this.localeData()._week;return Ls(this.year(),n.dow,n.doy)}function iU(){var n=this.localeData()._week;return Ls(this.weekYear(),n.dow,n.doy)}function HI(n,e,t,r,s){var o;return n==null?Bu(this,r,s).year:(o=Ls(n,r,s),e>o&&(e=o),lU.call(this,n,e,t,r,s))}function lU(n,e,t,r,s){var o=dI(n,e,t,r,s),i=$u(o.year,0,o.dayOfYear);return this.year(i.getUTCFullYear()),this.month(i.getUTCMonth()),this.date(i.getUTCDate()),this}Re("Q",0,"Qo","quarter");yn("quarter","Q");vn("quarter",7);fe("Q",nI);it("Q",function(n,e){e[Hs]=(Ye(n)-1)*3});function aU(n){return n==null?Math.ceil((this.month()+1)/3):this.month((n-1)*3+this.month()%3)}Re("D",["DD",2],"Do","date");yn("date","D");vn("date",9);fe("D",Ct);fe("DD",Ct,tr);fe("Do",function(n,e){return n?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});it(["D","DD"],ss);it("Do",function(n,e){e[ss]=Ye(n.match(Ct)[0])});var DI=sa("Date",!0);Re("DDD",["DDDD",3],"DDDo","dayOfYear");yn("dayOfYear","DDD");vn("dayOfYear",4);fe("DDD",Zf);fe("DDDD",rI);it(["DDD","DDDD"],function(n,e,t){t._dayOfYear=Ye(n)});function uU(n){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return n==null?e:this.add(n-e,"d")}Re("m",["mm",2],0,"minute");yn("minute","m");vn("minute",14);fe("m",Ct);fe("mm",Ct,tr);it(["m","mm"],Dr);var cU=sa("Minutes",!1);Re("s",["ss",2],0,"second");yn("second","s");vn("second",15);fe("s",Ct);fe("ss",Ct,tr);it(["s","ss"],Ds);var hU=sa("Seconds",!1);Re("S",0,0,function(){return~~(this.millisecond()/100)});Re(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Re(0,["SSS",3],0,"millisecond");Re(0,["SSSS",4],0,function(){return this.millisecond()*10});Re(0,["SSSSS",5],0,function(){return this.millisecond()*100});Re(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Re(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Re(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Re(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});yn("millisecond","ms");vn("millisecond",16);fe("S",Zf,nI);fe("SS",Zf,tr);fe("SSS",Zf,rI);var Co,kI;for(Co="SSSS";Co.length<=9;Co+="S")fe(Co,oa);function dU(n,e){e[hi]=Ye(("0."+n)*1e3)}for(Co="S";Co.length<=9;Co+="S")it(Co,dU);kI=sa("Milliseconds",!1);Re("z",0,0,"zoneAbbr");Re("zz",0,0,"zoneName");function fU(){return this._isUTC?"UTC":""}function gU(){return this._isUTC?"Coordinated Universal Time":""}var re=dc.prototype;re.add=i2;re.calendar=f2;re.clone=g2;re.diff=S2;re.endOf=A2;re.format=T2;re.from=M2;re.fromNow=_2;re.to=O2;re.toNow=I2;re.get=pB;re.invalidAt=$2;re.isAfter=m2;re.isBefore=p2;re.isBetween=w2;re.isSame=C2;re.isSameOrAfter=y2;re.isSameOrBefore=v2;re.isValid=F2;re.lang=OI;re.locale=_I;re.localeData=II;re.max=FW;re.min=LW;re.parsingFlags=V2;re.set=wB;re.startOf=x2;re.subtract=l2;re.toArray=k2;re.toObject=N2;re.toDate=D2;re.toISOString=b2;re.inspect=E2;typeof Symbol<"u"&&Symbol.for!=null&&(re[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});re.toJSON=L2;re.toString=R2;re.unix=H2;re.valueOf=P2;re.creationData=B2;re.eraName=Y2;re.eraNarrow=j2;re.eraAbbr=G2;re.eraYear=K2;re.year=hI;re.isLeapYear=NB;re.weekYear=tU;re.isoWeekYear=nU;re.quarter=re.quarters=aU;re.month=uI;re.daysInMonth=HB;re.week=re.weeks=WB;re.isoWeek=re.isoWeeks=UB;re.weeksInYear=oU;re.weeksInWeekYear=iU;re.isoWeeksInYear=rU;re.isoWeeksInISOWeekYear=sU;re.date=DI;re.day=re.days=nW;re.weekday=rW;re.isoWeekday=sW;re.dayOfYear=uU;re.hour=re.hours=hW;re.minute=re.minutes=cU;re.second=re.seconds=hU;re.millisecond=re.milliseconds=kI;re.utcOffset=GW;re.utc=XW;re.local=qW;re.parseZone=QW;re.hasAlignedHourOffset=ZW;re.isDST=JW;re.isLocal=t2;re.isUtcOffset=n2;re.isUtc=bI;re.isUTC=bI;re.zoneAbbr=fU;re.zoneName=gU;re.dates=Sr("dates accessor is deprecated. Use date instead.",DI);re.months=Sr("months accessor is deprecated. Use month instead",uI);re.years=Sr("years accessor is deprecated. Use year instead",hI);re.zone=Sr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",KW);re.isDSTShifted=Sr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",e2);function mU(n){return wt(n*1e3)}function pU(){return wt.apply(null,arguments).parseZone()}function NI(n){return n}var et=wv.prototype;et.calendar=nB;et.longDateFormat=iB;et.invalidDate=aB;et.ordinal=hB;et.preparse=NI;et.postformat=NI;et.relativeTime=fB;et.pastFuture=gB;et.set=eB;et.eras=W2;et.erasParse=U2;et.erasConvertYear=z2;et.erasAbbrRegex=q2;et.erasNameRegex=X2;et.erasNarrowRegex=Q2;et.months=IB;et.monthsShort=xB;et.monthsParse=PB;et.monthsRegex=kB;et.monthsShortRegex=DB;et.week=FB;et.firstDayOfYear=BB;et.firstDayOfWeek=$B;et.weekdays=QB;et.weekdaysMin=JB;et.weekdaysShort=ZB;et.weekdaysParse=tW;et.weekdaysRegex=oW;et.weekdaysShortRegex=iW;et.weekdaysMinRegex=lW;et.isPM=uW;et.meridiem=dW;function Qd(n,e,t,r){var s=Ks(),o=ms().set(r,e);return s[t](o,n)}function LI(n,e,t){if(Us(n)&&(e=n,n=void 0),n=n||"",e!=null)return Qd(n,e,t,"month");var r,s=[];for(r=0;r<12;r++)s[r]=Qd(n,r,t,"month");return s}function Hv(n,e,t,r){typeof n=="boolean"?(Us(e)&&(t=e,e=void 0),e=e||""):(e=n,t=e,n=!1,Us(e)&&(t=e,e=void 0),e=e||"");var s=Ks(),o=n?s._week.dow:0,i,l=[];if(t!=null)return Qd(e,(t+o)%7,r,"day");for(i=0;i<7;i++)l[i]=Qd(e,(i+o)%7,r,"day");return l}function wU(n,e){return LI(n,e,"months")}function CU(n,e){return LI(n,e,"monthsShort")}function yU(n,e,t){return Hv(n,e,t,"weekdays")}function vU(n,e,t){return Hv(n,e,t,"weekdaysShort")}function SU(n,e,t){return Hv(n,e,t,"weekdaysMin")}Oo("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(n){var e=n%10,t=Ye(n%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return n+t}});J.lang=Sr("moment.lang is deprecated. Use moment.locale instead.",Oo);J.langData=Sr("moment.langData is deprecated. Use moment.localeData instead.",Ks);var Cs=Math.abs;function RU(){var n=this._data;return this._milliseconds=Cs(this._milliseconds),this._days=Cs(this._days),this._months=Cs(this._months),n.milliseconds=Cs(n.milliseconds),n.seconds=Cs(n.seconds),n.minutes=Cs(n.minutes),n.hours=Cs(n.hours),n.months=Cs(n.months),n.years=Cs(n.years),this}function FI(n,e,t,r){var s=Br(e,t);return n._milliseconds+=r*s._milliseconds,n._days+=r*s._days,n._months+=r*s._months,n._bubble()}function bU(n,e){return FI(this,n,e,1)}function EU(n,e){return FI(this,n,e,-1)}function OE(n){return n<0?Math.floor(n):Math.ceil(n)}function TU(){var n=this._milliseconds,e=this._days,t=this._months,r=this._data,s,o,i,l,a;return n>=0&&e>=0&&t>=0||n<=0&&e<=0&&t<=0||(n+=OE(TC(t)+e)*864e5,e=0,t=0),r.milliseconds=n%1e3,s=dr(n/1e3),r.seconds=s%60,o=dr(s/60),r.minutes=o%60,i=dr(o/60),r.hours=i%24,e+=dr(i/24),a=dr(VI(e)),t+=a,e-=OE(TC(a)),l=dr(t/12),t%=12,r.days=e,r.months=t,r.years=l,this}function VI(n){return n*4800/146097}function TC(n){return n*146097/4800}function MU(n){if(!this.isValid())return NaN;var e,t,r=this._milliseconds;if(n=Rr(n),n==="month"||n==="quarter"||n==="year")switch(e=this._days+r/864e5,t=this._months+VI(e),n){case"month":return t;case"quarter":return t/3;case"year":return t/12}else switch(e=this._days+Math.round(TC(this._months)),n){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+n)}}function _U(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+Ye(this._months/12)*31536e6:NaN}function Xs(n){return function(){return this.as(n)}}var OU=Xs("ms"),IU=Xs("s"),xU=Xs("m"),AU=Xs("h"),PU=Xs("d"),HU=Xs("w"),DU=Xs("M"),kU=Xs("Q"),NU=Xs("y");function LU(){return Br(this)}function FU(n){return n=Rr(n),this.isValid()?this[n+"s"]():NaN}function Ni(n){return function(){return this.isValid()?this._data[n]:NaN}}var VU=Ni("milliseconds"),$U=Ni("seconds"),BU=Ni("minutes"),WU=Ni("hours"),UU=Ni("days"),zU=Ni("months"),YU=Ni("years");function jU(){return dr(this.days()/7)}var Os=Math.round,Ml={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function GU(n,e,t,r,s){return s.relativeTime(e||1,!!t,n,r)}function KU(n,e,t,r){var s=Br(n).abs(),o=Os(s.as("s")),i=Os(s.as("m")),l=Os(s.as("h")),a=Os(s.as("d")),u=Os(s.as("M")),c=Os(s.as("w")),d=Os(s.as("y")),f=o<=t.ss&&["s",o]||o<t.s&&["ss",o]||i<=1&&["m"]||i<t.m&&["mm",i]||l<=1&&["h"]||l<t.h&&["hh",l]||a<=1&&["d"]||a<t.d&&["dd",a];return t.w!=null&&(f=f||c<=1&&["w"]||c<t.w&&["ww",c]),f=f||u<=1&&["M"]||u<t.M&&["MM",u]||d<=1&&["y"]||["yy",d],f[2]=e,f[3]=+n>0,f[4]=r,GU.apply(null,f)}function XU(n){return n===void 0?Os:typeof n=="function"?(Os=n,!0):!1}function qU(n,e){return Ml[n]===void 0?!1:e===void 0?Ml[n]:(Ml[n]=e,n==="s"&&(Ml.ss=e-1),!0)}function QU(n,e){if(!this.isValid())return this.localeData().invalidDate();var t=!1,r=Ml,s,o;return typeof n=="object"&&(e=n,n=!1),typeof n=="boolean"&&(t=n),typeof e=="object"&&(r=Object.assign({},Ml,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),s=this.localeData(),o=KU(this,!t,r,s),t&&(o=s.pastFuture(+this,o)),s.postformat(o)}var Qm=Math.abs;function zi(n){return(n>0)-(n<0)||+n}function ig(){if(!this.isValid())return this.localeData().invalidDate();var n=Qm(this._milliseconds)/1e3,e=Qm(this._days),t=Qm(this._months),r,s,o,i,l=this.asSeconds(),a,u,c,d;return l?(r=dr(n/60),s=dr(r/60),n%=60,r%=60,o=dr(t/12),t%=12,i=n?n.toFixed(3).replace(/\.?0+$/,""):"",a=l<0?"-":"",u=zi(this._months)!==zi(l)?"-":"",c=zi(this._days)!==zi(l)?"-":"",d=zi(this._milliseconds)!==zi(l)?"-":"",a+"P"+(o?u+o+"Y":"")+(t?u+t+"M":"")+(e?c+e+"D":"")+(s||r||n?"T":"")+(s?d+s+"H":"")+(r?d+r+"M":"")+(n?d+i+"S":"")):"P0D"}var Ke=sg.prototype;Ke.isValid=UW;Ke.abs=RU;Ke.add=bU;Ke.subtract=EU;Ke.as=MU;Ke.asMilliseconds=OU;Ke.asSeconds=IU;Ke.asMinutes=xU;Ke.asHours=AU;Ke.asDays=PU;Ke.asWeeks=HU;Ke.asMonths=DU;Ke.asQuarters=kU;Ke.asYears=NU;Ke.valueOf=_U;Ke._bubble=TU;Ke.clone=LU;Ke.get=FU;Ke.milliseconds=VU;Ke.seconds=$U;Ke.minutes=BU;Ke.hours=WU;Ke.days=UU;Ke.weeks=jU;Ke.months=zU;Ke.years=YU;Ke.humanize=QU;Ke.toISOString=ig;Ke.toString=ig;Ke.toJSON=ig;Ke.locale=_I;Ke.localeData=II;Ke.toIsoString=Sr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",ig);Ke.lang=OI;Re("X",0,0,"unix");Re("x",0,0,"valueOf");fe("x",eg);fe("X",yB);it("X",function(n,e,t){t._d=new Date(parseFloat(n)*1e3)});it("x",function(n,e,t){t._d=new Date(Ye(n))});//! moment.js
J.version="2.29.4";Z$(wt);J.fn=re;J.min=VW;J.max=$W;J.now=BW;J.utc=ms;J.unix=mU;J.months=wU;J.isDate=hc;J.locale=Oo;J.invalid=Xf;J.duration=Br;J.isMoment=$r;J.weekdays=yU;J.parseZone=pU;J.localeData=Ks;J.isDuration=ld;J.monthsShort=CU;J.weekdaysMin=SU;J.defineLocale=Tv;J.updateLocale=pW;J.locales=wW;J.weekdaysShort=vU;J.normalizeUnits=Rr;J.relativeTimeRounding=XU;J.relativeTimeThreshold=qU;J.calendarFormat=d2;J.prototype=re;J.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const ZU=Object.freeze(Object.defineProperty({__proto__:null,default:J},Symbol.toStringTag,{value:"Module"}));function JU(n){const e=n.length;let t=0;for(;t<e;)n[t]=[n[t]],t+=1}function IE(n,e){const t=e.length;let r=0;for(;r<t;)n.push(e[r]),r+=1}function ud(n){const e=[];if(!n||n.length===0||!n[0]||n[0].length===0)return e;const t=n.length,r=n[0].length;for(let s=0;s<t;s++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][s]=n[s][o];return e}function Sn(n,e,t,r){let s=-1,o=n,i=t;Array.isArray(n)||(o=Array.from(n));const l=o.length;for(s+=1;s<l;)i=e(i,o[s],s,o),s+=1;return i}function yr(n,e){let t=0,r=n;Array.isArray(n)||(r=Array.from(n));const s=r.length,o=[];let i=-1;for(;t<s;){const l=r[t];e(l,t,r)&&(i+=1,o[i]=l),t+=1}return o}function Ve(n,e){let t=0,r=n;Array.isArray(n)||(r=Array.from(n));const s=r.length,o=[];let i=-1;for(;t<s;){const l=r[t];i+=1,o[i]=e(l,t,r),t+=1}return o}function P(n,e){let t=0,r=n;Array.isArray(n)||(r=Array.from(n));const s=r.length;for(;t<s&&e(r[t],t,r)!==!1;)t+=1;return n}function $I(n){const e=[];return P(n,t=>{e.indexOf(t)===-1&&e.push(t)}),e}function xE(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];const[r,...s]=[...e];let o=r;return P(s,i=>{o=o.filter(l=>!i.includes(l))}),o}function AE(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return n.split(e)}function ot(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return Sn(n,(o,i,l)=>{const a=i.replace(/\r?\n\s*/g,""),u=t[l]?t[l]:"";return o+a+u},"").trim()}function Lt(n){let e;switch(typeof n){case"string":case"number":e=`${n}`;break;case"object":e=n===null?"":n.toString();break;case"undefined":e="";break;default:e=n.toString();break}return e}function ue(n){return typeof n<"u"}function dt(n){return typeof n>"u"}function Xt(n){return n===null||n===""||dt(n)}function ez(n){return Object.prototype.toString.call(n)==="[object RegExp]"}const Xa="length",hu=n=>parseInt(n,16),PE=n=>parseInt(n,10),Zd=(n,e,t)=>n.substr(e,t),du=n=>n.codePointAt(0)-65,MC=n=>`${n}`.replace(/\-/g,""),tz=n=>hu(Zd(MC(n),hu("12"),du("F")))/(hu(Zd(MC(n),du("B"),~~![][Xa]))||9),nz=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let HE=!1;const DE={invalid:()=>ot`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:n=>{let{keyValidityDate:e,hotVersion:t}=n;return ot`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>ot`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},kE={invalid:()=>ot`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:n=>{let{keyValidityDate:e,hotVersion:t}=n;return ot`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>ot`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function rz(n,e){const t=!Xt(n),r=typeof n=="string"&&n.toLowerCase()==="non-commercial-and-evaluation",s="13.1.0";let o,i="invalid",l="invalid";n=MC(n||"");const a=sz(n);if(t||r||a)if(a){const u=J("31/08/2023","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),d=tz(n);o=J((d+1)*864e5,"x").format("MMMM DD, YYYY"),c>d?(i="expired",l="expired"):(i="valid",l="valid")}else r?(i="non_commercial",l="valid"):(i="invalid",l="invalid");else i="missing",l="missing";if(nz()&&(i="valid",l="valid"),!HE&&i!=="valid"&&(DE[i]({keyValidityDate:o,hotVersion:s})&&console[i==="non_commercial"?"info":"warn"](DE[i]({keyValidityDate:o,hotVersion:s})),HE=!0),l!=="valid"&&e.parentNode&&kE[l]({keyValidityDate:o,hotVersion:s})){const c=document.createElement("div");c.className="hot-display-license-info",c.innerHTML=kE[l]({keyValidityDate:o,hotVersion:s}),e.parentNode.insertBefore(c,e.nextSibling)}}function sz(n){let e=[][Xa],t=e;if(n[Xa]!==du("Z"))return!1;for(let r="",s="B<H4P+".split(""),o=du(s.shift());o;o=du(s.shift()||"A"))--o<""[Xa]?t=t|(PE(`${PE(hu(r)+(hu(Zd(n,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Zd(n,o,o?s[Xa]===1?9:8:6);return t===e}function Lr(n){return n[0].toUpperCase()+n.substr(1)}function BI(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+n()+n()}function WI(n){return/^([0-9][0-9]?%$)|(^100%$)/.test(n)}function UI(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${n}`.replace(/(?:\\)?\[([^[\]]+)]/g,(t,r)=>t.charAt(0)==="\\"?t.substr(1,t.length-1):e[r]===void 0?"":e[r])}function NE(n){return Dv(`${n}`,{ALLOWED_TAGS:[]})}function Dv(n,e){return Q$.sanitize(n,e)}function oz(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=-1,r=null,s=n;for(;s!==null;){if(t===e){r=s;break}s.host&&s.nodeType===Node.DOCUMENT_FRAGMENT_NODE?s=s.host:(t+=1,s=s.parentNode)}return r}function iz(n){return Object.getPrototypeOf(n.parent)&&n.frameElement}function Jd(n){return iz(n)&&n.parent}function Ci(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:s}=Node;let o=n;for(;o!=null&&o!==t;){const{nodeType:i,nodeName:l}=o;if(i===r&&(e.includes(l)||e.includes(o)))return o;const{host:a}=o;a&&i===s?o=a:o=o.parentNode}return null}function oh(n,e,t){const r=[];let s=n;for(;s&&(s=Ci(s,e,t),!(!s||t&&!t.contains(s)));)r.push(s),s.host&&s.nodeType===Node.DOCUMENT_FRAGMENT_NODE?s=s.host:s=s.parentNode;const o=r.length;return o?r[o-1]:null}function yi(n,e){let t=n.parentNode,r=[];for(typeof e=="string"?n.defaultView?r=Array.prototype.slice.call(n.querySelectorAll(e),0):r=Array.prototype.slice.call(n.ownerDocument.querySelectorAll(e),0):r.push(e);t!==null;){if(r.indexOf(t)>-1)return!0;t=t.parentNode}return!1}function lz(n){let e=0,t=n;if(t.previousSibling)for(;t=t.previousSibling;)e+=1;return e}function jo(n,e,t){const r=t.parentElement.querySelector(`.ht_clone_${n}`);return r?r.contains(e):null}function zI(n){return!n||!n.length?[]:n.filter(e=>!!e)}function Oe(n,e){return n.classList===void 0||typeof e!="string"||e===""?!1:n.classList.contains(e)}function ee(n,e){typeof e=="string"&&(e=e.split(" ")),e=zI(e),e.length>0&&n.classList.add(...e)}function He(n,e){typeof e=="string"&&(e=e.split(" ")),e=zI(e),e.length>0&&n.classList.remove(...e)}function YI(n){if(n.nodeType===3)n.parentNode.removeChild(n);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(n.nodeName)>-1){const e=n.childNodes;for(let t=e.length-1;t>=0;t--)YI(e[t])}}function hs(n){let e;for(;e=n.lastChild;)n.removeChild(e)}const az=/(<(.*)>|&(.*);)/;function ia(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;az.test(e)?n.innerHTML=t?Dv(e):e:Ti(n,e)}function Ti(n,e){const t=n.firstChild;t&&t.nodeType===3&&t.nextSibling===null?t.textContent=e:(hs(n),n.appendChild(n.ownerDocument.createTextNode(e)))}function Uu(n){const e=n.ownerDocument.documentElement;let t=n;for(;t!==e;){if(t===null)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(t.host){if(t.host.impl)return Uu(t.host.impl);if(t.host)return Uu(t.host);throw new Error("Lost in Web Components world")}else return!1;else if(t.style&&t.style.display==="none")return!1;t=t.parentNode}return!0}function Wt(n){const e=n.ownerDocument,t=e.defaultView,r=e.documentElement;let s=n,o,i,l;for(o=s.offsetLeft,i=s.offsetTop,l=s;(s=s.offsetParent)&&s!==e.body;)o+=s.offsetLeft,i+=s.offsetTop,l=s;return l&&l.style.position==="fixed"&&(o+=t.pageXOffset||r.scrollLeft,i+=t.pageYOffset||r.scrollTop),{left:o,top:i}}function zu(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Yl(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function ef(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n===e?zu(e):n.scrollTop}function _C(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n===e?Yl(e):n.scrollLeft}function tf(n){let e=n.ownerDocument,t=e?e.defaultView:void 0;e||(e=n.document?n.document:n,t=e.defaultView);const r=["auto","scroll"];let s=n.parentNode;for(;s&&s.style&&e.body!==s;){let{overflow:o,overflowX:i,overflowY:l}=s.style;if([o,i,l].includes("scroll"))return s;if({overflow:o,overflowX:i,overflowY:l}=t.getComputedStyle(s),r.includes(o)||r.includes(i)||r.includes(l)||s.clientHeight<=s.scrollHeight+1&&(r.includes(l)||r.includes(o))||s.clientWidth<=s.scrollWidth+1&&(r.includes(i)||r.includes(o)))return s;s=s.parentNode}return t}function jl(n){const e=n.ownerDocument,t=e.defaultView;let r=n.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const s=Mi(r,t),o=["scroll","hidden","auto"],i=s.getPropertyValue("overflow"),l=s.getPropertyValue("overflow-y"),a=s.getPropertyValue("overflow-x");if(o.includes(i)||o.includes(l)||o.includes(a))return r;r=r.parentNode}return t}function Yu(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(n){if(n===t)return e==="width"?`${t.innerWidth}px`:e==="height"?`${t.innerHeight}px`:void 0}else return;const r=n.style[e];if(r!==""&&r!==void 0)return r;const s=Mi(n,t);if(s[e]!==""&&s[e]!==void 0)return s[e]}function Mi(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n.currentStyle||e.getComputedStyle(n)}function st(n){return n.offsetWidth}function _t(n){return n.offsetHeight}function yo(n){return n.clientHeight||n.innerHeight}function cd(n){return n.clientWidth||n.innerWidth}function jI(n){return n.selectionStart?n.selectionStart:0}function uz(n){return n.selectionEnd?n.selectionEnd:0}function cz(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=n.document;let t="";return n.getSelection?t=n.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(t=e.selection.createRange().text),t}function LE(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;n.getSelection&&(n.getSelection().empty?n.getSelection().empty():n.getSelection().removeAllRanges&&n.getSelection().removeAllRanges())}function lg(n,e,t){if(t===void 0&&(t=e),n.setSelectionRange){n.focus();try{n.setSelectionRange(e,t)}catch{const s=n.parentNode,o=s.style.display;s.style.display="block",n.setSelectionRange(e,t),s.style.display=o}}}let Zm;function hz(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=n.createElement("div");e.style.height="200px",e.style.width="100%";const t=n.createElement("div");t.style.boxSizing="content-box",t.style.height="150px",t.style.left="0px",t.style.overflow="hidden",t.style.position="absolute",t.style.top="0px",t.style.width="200px",t.style.visibility="hidden",t.appendChild(e),(n.body||n.documentElement).appendChild(t);const r=e.offsetWidth;t.style.overflow="scroll";let s=e.offsetWidth;return r===s&&(s=t.clientWidth),(n.body||n.documentElement).removeChild(t),r-s}function en(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Zm===void 0&&(Zm=hz(n)),Zm}function dz(n){return n.offsetWidth!==n.clientWidth}function fz(n){return n.offsetHeight!==n.clientHeight}function kv(n,e,t){n.style.transform=`translate3d(${e},${t},0)`}function ag(n){n.style.transform&&n.style.transform!==""&&(n.style.transform="")}function nf(n){return n&&(["INPUT","SELECT","TEXTAREA"].indexOf(n.nodeName)>-1||n.contentEditable==="true")}function Nv(n){return nf(n)&&n.hasAttribute("data-hot-input")===!1}function gz(n){const e=n.ownerDocument.activeElement;Nv(e)||n.select()}function GI(n){return!n.parentNode}function mz(n,e){new IntersectionObserver((r,s)=>{r.forEach(o=>{o.isIntersecting&&n.offsetParent!==null&&(e(),s.unobserve(n))})},{root:n.ownerDocument.body}).observe(n)}function ut(n){return typeof n=="function"}function KI(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=null,r;function s(){for(var o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];return t&&clearTimeout(t),t=setTimeout(()=>{r=n.apply(this,i)},e),r}return s}function XI(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return function(){for(var o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];return n.apply(this,t.concat(i))}}function pz(n){const e=n.length;function t(r){return function(){for(var o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];const a=r.concat(i);let u;return a.length>=e?u=n.apply(this,a):u=t(a),u}}return t([])}function OC(n,e,t,r,s,o,i,l){return ue(l)?n.call(e,t,r,s,o,i,l):ue(i)?n.call(e,t,r,s,o,i):ue(o)?n.call(e,t,r,s,o):ue(s)?n.call(e,t,r,s):ue(r)?n.call(e,t,r):ue(t)?n.call(e,t):n.call(e)}var wz=xn,FE=IO,Cz=Cn,VE=ra,yz=kO,$E=wz([].push),vz=function(n){if(Cz(n))return n;if(FE(n)){for(var e=n.length,t=[],r=0;r<e;r++){var s=n[r];typeof s=="string"?$E(t,s):(typeof s=="number"||VE(s)==="Number"||VE(s)==="String")&&$E(t,yz(s))}var o=t.length,i=!0;return function(l,a){if(i)return i=!1,a;if(FE(this))return a;for(var u=0;u<o;u++)if(t[u]===l)return a}}},Sz=Di,qI=ac,QI=Kf,Rz=Bf,mc=xn,ZI=vr,BE=Cn,WE=tv,JI=dv,bz=vz,Ez=ev,Tz=String,Io=qI("JSON","stringify"),ih=mc(/./.exec),UE=mc("".charAt),Mz=mc("".charCodeAt),_z=mc("".replace),Oz=mc(1 .toString),Iz=/[\uD800-\uDFFF]/g,zE=/^[\uD800-\uDBFF]$/,YE=/^[\uDC00-\uDFFF]$/,jE=!Ez||ZI(function(){var n=qI("Symbol")("stringify detection");return Io([n])!=="[null]"||Io({a:n})!=="{}"||Io(Object(n))!=="{}"}),GE=ZI(function(){return Io("\uDF06\uD834")!=='"\\udf06\\ud834"'||Io("\uDEAD")!=='"\\udead"'}),xz=function(n,e){var t=JI(arguments),r=bz(e);if(!(!BE(r)&&(n===void 0||WE(n))))return t[1]=function(s,o){if(BE(r)&&(o=Rz(r,this,Tz(s),o)),!WE(o))return o},QI(Io,null,t)},Az=function(n,e,t){var r=UE(t,e-1),s=UE(t,e+1);return ih(zE,n)&&!ih(YE,s)||ih(YE,n)&&!ih(zE,r)?"\\u"+Oz(Mz(n,0),16):n};Io&&Sz({target:"JSON",stat:!0,arity:3,forced:jE||GE},{stringify:function(e,t,r){var s=JI(arguments),o=QI(jE?xz:Io,null,s);return GE&&typeof o=="string"?_z(o,Iz,Az):o}});function ju(n){let e;return Array.isArray(n)?e=n.length?new Array(n.length).fill(null):[]:(e={},Be(n,(t,r)=>{r!=="__children"&&(t&&typeof t=="object"&&!Array.isArray(t)?e[r]=ju(t):Array.isArray(t)?t.length&&typeof t[0]=="object"&&!Array.isArray(t[0])?e[r]=[ju(t[0])]:e[r]=[]:e[r]=null)})),e}function Vo(n,e){return e.prototype.constructor=e,n.prototype=new e,n.prototype.constructor=n,n}function Ut(n,e,t){const r=Array.isArray(t);return Be(e,(s,o)=>{(r===!1||t.includes(o))&&(n[o]=s)}),n}function ug(n,e){Be(e,(t,r)=>{e[r]&&typeof e[r]=="object"?(n[r]||(Array.isArray(e[r])?n[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?n[r]=e[r]:n[r]={}),ug(n[r],e[r])):n[r]=e[r]})}function _n(n){return typeof n=="object"?JSON.parse(JSON.stringify(n)):n}function Fn(n){const e={};return Be(n,(t,r)=>{e[r]=t}),e}function at(n){n.MIXINS||(n.MIXINS=[]);for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return P(t,s=>{n.MIXINS.push(s.MIXIN_NAME),Be(s,(o,i)=>{if(n.prototype[i]!==void 0)throw new Error(`Mixin conflict. Property '${i}' already exist and cannot be overwritten.`);if(typeof o=="function")n.prototype[i]=o;else{const l=function(c,d){const f=`_${c}`,m=p=>{let w=p;return(Array.isArray(w)||$e(w))&&(w=_n(w)),w};return function(){return this[f]===void 0&&(this[f]=m(d)),this[f]}},a=function(c){const d=`_${c}`;return function(f){this[d]=f}};Object.defineProperty(n.prototype,i,{get:l(i,o),set:a(i),configurable:!0})}})}),n}function Lv(n,e){return JSON.stringify(n)===JSON.stringify(e)}function $e(n){return Object.prototype.toString.call(n)==="[object Object]"}function qs(n,e,t,r){r.value=t,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(n,e,r)}function Be(n,e){for(const t in n)if((!n.hasOwnProperty||n.hasOwnProperty&&Object.prototype.hasOwnProperty.call(n,t))&&e(n[t],t,n)===!1)break;return n}function Pz(n,e){const t=e.split(".");let r=n;return Be(t,s=>{if(r=r[s],r===void 0)return r=void 0,!1}),r}function Jm(n,e,t){const r=e.split(".");let s=n;r.forEach((o,i)=>{i!==r.length-1?(Ht(s,o)||(s[o]={}),s=s[o]):s[o]=t})}function Fv(n){if(!$e(n))return 0;const e=function(t){let r=0;return $e(t)?Be(t,(s,o)=>{o!=="__children"&&(r+=e(s))}):r+=1,r};return e(n)}function Gl(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const t=`_${e}`,r={_touched:!1,[t]:n,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[t]},set(s){this._touched=!0,this[t]=s},enumerable:!0,configurable:!0}),r}function Ht(n,e){return Object.prototype.hasOwnProperty.call(n,e)}const ar=n=>{const e={value:!1};return e.test=(t,r)=>{e.value=n(t,r)},e},Li={chrome:ar((n,e)=>/Chrome/.test(n)&&/Google/.test(e)),chromeWebKit:ar(n=>/CriOS/.test(n)),edge:ar(n=>/Edge/.test(n)),edgeWebKit:ar(n=>/EdgiOS/.test(n)),firefox:ar(n=>/Firefox/.test(n)),firefoxWebKit:ar(n=>/FxiOS/.test(n)),mobile:ar(n=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(n)),safari:ar((n,e)=>/Safari/.test(n)&&/Apple Computer/.test(e))},pc={mac:ar(n=>/^Mac/.test(n)),win:ar(n=>/^Win/.test(n)),linux:ar(n=>/^Linux/.test(n)),ios:ar(n=>/iPhone|iPad|iPod/i.test(n))};function Hz(){let{userAgent:n=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Be(Li,t=>{let{test:r}=t;return void r(n,e)})}function Dz(){let{platform:n=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Be(pc,e=>{let{test:t}=e;return void t(n)})}Hz();Dz();function ex(){return Li.chrome.value}function kz(){return Li.chromeWebKit.value}function ep(){return Li.firefox.value}function Nz(){return Li.firefoxWebKit.value}function Lz(){return Li.edge.value}function is(){return Li.mobile.value}function tx(){return pc.ios.value}function nx(){let{maxTouchPoints:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return n>2&&pc.mac.value}function KE(){return pc.win.value}function XE(){return pc.mac.value}const we={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:ep()?182:174,AUDIO_MUTE:ep()?181:173,AUDIO_UP:ep()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Fz=[we.ALT,we.ARROW_DOWN,we.ARROW_LEFT,we.ARROW_RIGHT,we.ARROW_UP,we.AUDIO_DOWN,we.AUDIO_MUTE,we.AUDIO_UP,we.BACKSPACE,we.CAPS_LOCK,we.DELETE,we.END,we.ENTER,we.ESCAPE,we.F1,we.F2,we.F3,we.F4,we.F5,we.F6,we.F7,we.F8,we.F9,we.F10,we.F11,we.F12,we.F13,we.F14,we.F15,we.F16,we.F17,we.F18,we.F19,we.HOME,we.INSERT,we.MEDIA_NEXT,we.MEDIA_PLAY_PAUSE,we.MEDIA_PREV,we.MEDIA_STOP,we.NULL,we.NUM_LOCK,we.PAGE_DOWN,we.PAGE_UP,we.PAUSE,we.SCROLL_LOCK,we.SHIFT,we.TAB];function Vz(n){return n===32||n>=48&&n<=57||n>=96&&n<=111||n>=186&&n<=192||n>=219&&n<=222||n>=226||n>=65&&n<=90}function rx(n){return Fz.includes(n)}function $z(n){return[we.CONTROL,we.COMMAND_LEFT,we.COMMAND_RIGHT,we.COMMAND_FIREFOX].includes(n)}function Gu(n,e){const t=e.split("|");let r=!1;return P(t,s=>{if(n===we[s])return r=!0,!1}),r}function ds(n){n.isImmediatePropagationEnabled=!1,n.cancelBubble=!0}function dl(n){return n.isImmediatePropagationEnabled===!1}function _i(n){return n.button===2}function Vv(n){return n.button===0}function ct(){ue(console)&&console.warn(...arguments)}function $v(){ue(console)&&console.error(...arguments)}const Yi=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Bz=ot`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,tp=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),np=new Map([]);class he{static getSingleton(){return Uz()}constructor(){this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return P(Yi,t=>e[t]=[]),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(t))P(t,s=>this.add(e,s,r));else{tp.has(e)&&ct(UI(Bz,{hookName:e,removedInVersion:tp.get(e)})),np.has(e)&&ct(np.get(e));const s=this.getBucket(r);if(typeof s[e]>"u"&&(this.register(e),s[e]=[]),t.skip=!1,s[e].indexOf(t)===-1){let o=!1;t.initialHook&&P(s[e],(i,l)=>{if(i.initialHook)return s[e][l]=t,o=!0,!1}),o||s[e].push(t)}}return this}once(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(t)?P(t,s=>this.once(e,s,r)):(t.runOnce=!0,this.add(e,t,r))}remove(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const s=this.getBucket(r);return typeof s[e]<"u"&&s[e].indexOf(t)>=0?(t.skip=!0,!0):!1}has(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const r=this.getBucket(t);return!!(r[e]!==void 0&&r[e].length)}run(e,t,r,s,o,i,l,a){{const u=this.globalBucket[t],c=u?u.length:0;let d=0;if(c)for(;d<c;){if(!u[d]||u[d].skip){d+=1;continue}const f=OC(u[d],e,r,s,o,i,l,a);f!==void 0&&(r=f),u[d]&&u[d].runOnce&&this.remove(t,u[d]),d+=1}}{const u=this.getBucket(e)[t],c=u?u.length:0;let d=0;if(c)for(;d<c;){if(!u[d]||u[d].skip){d+=1;continue}const f=OC(u[d],e,r,s,o,i,l,a);f!==void 0&&(r=f),u[d]&&u[d].runOnce&&this.remove(t,u[d],e),d+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Be(this.getBucket(e),(t,r,s)=>s[r].length=0)}register(e){this.isRegistered(e)||Yi.push(e)}deregister(e){this.isRegistered(e)&&Yi.splice(Yi.indexOf(e),1)}isDeprecated(e){return np.has(e)||tp.has(e)}isRegistered(e){return Yi.indexOf(e)>=0}getRegistered(){return Yi}}const Wz=new he;function Uz(){return Wz}const rp=new Map;function br(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";rp.has(n)||rp.set(n,new Map);const e=rp.get(n);function t(l,a){e.set(l,a)}function r(l){return e.get(l)}function s(l){return e.has(l)}function o(){return[...e.keys()]}function i(){return[...e.values()]}return{register:t,getItem:r,hasItem:s,getNames:o,getValues:i}}const IC=new WeakMap,{register:zz,getItem:sx,hasItem:ox,getNames:fq,getValues:gq}=br("editors");function Yz(n){const e={},t=n;this.getConstructor=function(){return n},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new t(r)),e[r.guid]},he.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function ix(n,e){let t;if(typeof n=="function")IC.get(n)||jn(null,n),t=IC.get(n);else if(typeof n=="string")t=sx(n);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!t)throw Error(`No editor registered under name "${n}"`);return t.getInstance(e)}function qE(n){if(typeof n=="function")return n;if(!ox(n))throw Error(`No registered editor found under "${n}" name`);return sx(n).getConstructor()}function jn(n,e){n&&typeof n!="string"&&(e=n,n=e.EDITOR_TYPE);const t=new Yz(e);typeof n=="string"&&zz(n,t),IC.set(e,t)}class It{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,r){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(i){r.call(this,jz(i))}return this.context.eventListeners.push({element:e,event:t,callback:r,callbackProxy:o,options:s,eventManager:this}),e.addEventListener(t,o,s),()=>{this.removeEventListener(e,t,r)}}removeEventListener(e,t,r){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,i;for(;o;)if(o-=1,i=this.context.eventListeners[o],i.event===t&&i.element===e){if(r&&r!==i.callback||s&&i.eventManager!==this)continue;this.context.eventListeners.splice(o,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;const r=this.context.eventListeners[t];e&&r.eventManager!==this||(this.context.eventListeners.splice(t,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let r=e.document,s=e;r||(r=e.ownerDocument?e.ownerDocument:e,s=r.defaultView);const o={bubbles:!0,cancelable:t!=="mousemove",view:s,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let i;r.createEvent?(i=r.createEvent("MouseEvents"),i.initMouseEvent(t,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):i=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(i):e.fireEvent(`on${t}`,i)}}function jz(n){const e=n.stopImmediatePropagation;return n.stopImmediatePropagation=function(){e.apply(this),ds(this)},n}const cg="editorManager.navigation",fu="editorManager.handlingEditor";class xC{constructor(e,t,r){this.instance=e,this.tableMeta=t,this.selection=r,this.eventManager=new It(e),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.instance.getShortcutManager().addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",o=>this.onAfterDocumentKeyDown(o)),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",o=>{!this.destroyed&&this.instance.isListening()&&this.openEditor("",o)}),this.instance.view._wt.update("onCellDblClick",(o,i,l)=>this.onCellDblClick(o,i,l))}registerShortcuts(){const e=this.instance.getShortcutManager(),t=e.getContext("grid"),r=e.getContext("editor"),s={group:fu};r.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:(o,i)=>{this.closeEditorAndSaveChanges(e.isCtrlPressed()),this.moveSelectionAfterEnter(i.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>{this.closeEditorAndRestoreOriginalValue(e.isCtrlPressed()),this.activeEditor.focus()}}],s),t.addShortcuts([{keys:[["F2"]],callback:o=>{this.openEditor(null,o,!0)}},{keys:[["Backspace"],["Delete"]],callback:()=>{this.instance.emptySelectedCells(),this.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:(o,i)=>{this.instance.getSettings().enterBeginsEditing?this.cellProperties.readOnly?this.moveSelectionAfterEnter():this.openEditor(null,o,!0):this.moveSelectionAfterEnter(i.includes("shift")),ds(o)}}],{...s,runOnlyIf:()=>ue(this.instance.getSelected())})}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,a=>{a&&this.prepareEditor()});return}const{row:e,col:t}=this.instance.getSelectedRangeLast().highlight,r=this.instance.runHooks("modifyGetCellCoords",e,t);let s=e,o=t;Array.isArray(r)&&([s,o]=r),this.cellProperties=this.instance.getCellMeta(s,o);const{activeElement:i}=this.instance.rootDocument;if(i&&Nv(i)&&i.blur(),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.instance.getCell(e,t,!0);if(l){const a=this.instance.getCellEditor(this.cellProperties),u=this.instance.colToProp(o),c=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(s),o);this.activeEditor=ix(a,this.instance),this.activeEditor.prepare(e,t,u,l,c,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){const{row:s,col:o}=this.instance.getSelectedRangeLast().highlight,i=this.instance.rowIndexMapper.getRenderableFromVisualIndex(s),l=this.instance.columnIndexMapper.getRenderableFromVisualIndex(o);this.instance.view.scrollViewport(this.instance._createCellCoords(i,l)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))}closeEditor(e,t,r){this.activeEditor?this.activeEditor.finishEditing(e,t,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.instance.getCellEditor(this.cellProperties),{row:t,col:r}=this.instance.getSelectedRangeLast().highlight,{rowIndexMapper:s,columnIndexMapper:o}=this.instance,i=s.isHidden(this.instance.toPhysicalRow(t))||o.isHidden(this.instance.toPhysicalColumn(r));return!(this.cellProperties.readOnly||!e||i)}moveSelectionAfterEnter(e){const t=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-t.row,-t.col):this.selection.transformStart(t.row,t.col,!0)}onAfterDocumentKeyDown(e){if(!this.instance.isListening())return;const{keyCode:t}=e;if(!this.selection.isSelected())return;const r=(e.ctrlKey||e.metaKey)&&!e.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!rx(t)&&!$z(t)&&!r&&!this.isEditorOpened()){const o=this.instance.getShortcutManager().getContext("editor"),i={runOnlyIf:()=>ue(this.instance.getSelected()),group:cg};o.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.instance.selection.transformStart(0,-1*this.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.instance.selection.transformStart(0,this.instance.getDirectionFactor())}}],i),this.openEditor("",e)}}onCellDblClick(e,t,r){r.nodeName==="TD"&&this.openEditor(null,e,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}const QE=new WeakMap;xC.getInstance=function(n,e,t){let r=QE.get(n);return r||(r=new xC(n,e,t),QE.set(n,r)),r};const lx={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},Gz=new RegExp(Object.keys(lx).map(n=>`(${n})`).join("|"),"gi");function Kz(n){return(n&&n.nodeName||"")==="TABLE"}function ZE(n){const e=n.hasColHeaders(),t=n.hasRowHeaders(),r=[e?-1:0,t?-1:0,n.countRows()-1,n.countCols()-1],s=n.getData(...r),o=s.length,i=o>0?s[0].length:0,l=["<table>","</table>"],a=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=t?1:0,d=e?1:0;for(let f=0;f<o;f+=1){const m=e&&f===0,p=[];for(let M=0;M<i;M+=1){const S=!m&&t&&M===0;let y="";if(m)y=`<th>${n.getColHeader(M-c)}</th>`;else if(S)y=`<th>${n.getRowHeader(f-d)}</th>`;else{const v=s[f][M],{hidden:R,rowspan:I,colspan:F}=n.getCellMeta(f-d,M-c);if(!R){const L=[];if(I&&L.push(`rowspan="${I}"`),F&&L.push(`colspan="${F}"`),Xt(v))y=`<td ${L.join(" ")}></td>`;else{const j=v.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");y=`<td ${L.join(" ")}>${j}</td>`}}}p.push(y)}const w=["<tr>",...p,"</tr>"].join("");m?a.splice(1,0,w):u.splice(-1,0,w)}return l.splice(1,0,a.join(""),u.join("")),l.join("")}function JE(n){const e=n.length,t=["<table>"];for(let r=0;r<e;r+=1){const s=n[r],o=s.length,i=[];r===0&&t.push("<tbody>");for(let l=0;l<o;l+=1){const a=s[l],u=Xt(a)?"":a.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");i.push(`<td>${u}</td>`)}t.push("<tr>",...i,"</tr>"),r+1===e&&t.push("</tbody>")}return t.push("</table>"),t.join("")}function Xz(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const t={},r=e.createDocumentFragment(),s=e.createElement("div");r.appendChild(s);let o=n;if(typeof o=="string"){const v=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,R=>{const I=R.match(/<td\b[^>]*?>/g)[0],F=R.substring(I.length,R.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${I}${F}</td>`});s.insertAdjacentHTML("afterbegin",`${v}`),o=s.querySelector("table")}if(!o||!Kz(o))return;const i=s.querySelector('meta[name$="enerator"]'),l=o.querySelector("tbody th")!==null,a=o.querySelector("tr"),u=a?Array.from(a.cells).reduce((v,R)=>v+R.colSpan,0)-(l?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],d=[];let f=!1,m=0,p=0;if(o.tHead){const v=Array.from(o.tHead.rows).filter(R=>{const I=R.querySelector("td")!==null;return I&&d.push(R),!I});m=v.length,f=m>0,m>1?t.nestedHeaders=Array.from(v).reduce((R,I)=>{const F=Array.from(I.cells).reduce((L,j,X)=>{if(l&&X===0)return L;const{colSpan:G,innerHTML:te}=j,ie=G>1?{label:te,colspan:G}:te;return L.push(ie),L},[]);return R.push(F),R},[]):f&&(t.colHeaders=Array.from(v[0].children).reduce((R,I,F)=>(l&&F===0||R.push(I.innerHTML),R),[]))}d.length&&(t.fixedRowsTop=d.length),c.length&&(t.fixedRowsBottom=c.length);const w=[...d,...Array.from(o.tBodies).reduce((v,R)=>(v.push(...Array.from(R.rows)),v),[]),...c];p=w.length;const M=new Array(p);for(let v=0;v<p;v++)M[v]=new Array(u);const S=[],y=[];for(let v=0;v<p;v++){const R=w[v],I=Array.from(R.cells),F=I.length;for(let L=0;L<F;L++){const j=I[L],{nodeName:X,innerHTML:G,rowSpan:te,colSpan:ie}=j,le=M[v].findIndex(me=>me===void 0);if(X==="TD"){if(te>1||ie>1){for(let Me=v;Me<v+te;Me++)if(Me<p)for(let E=le;E<le+ie;E++)M[Me][E]=null;const Te=j.getAttribute("style");Te&&Te.includes("mso-ignore:colspan")||S.push({col:le,row:v,rowspan:te,colspan:ie})}let me="";i&&/excel/gi.test(i.content)?me=G.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):me=G.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),M[v][le]=me.replace(Gz,Te=>lx[Te])}else y.push(G)}}return S.length&&(t.mergeCells=S),y.length&&(t.rowHeaders=y),M.length&&(t.data=M),t}function Nn(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const t=typeof n;if(t==="number")return!isNaN(n)&&isFinite(n);if(t==="string"){if(n.length===0)return!1;if(n.length===1)return/\d/.test(n);const r=Array.from(new Set([".",...e])).map(s=>`\\${s}`).join("|");return new RegExp(`^[+-]?\\s*(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(n.trim())}else if(t==="object")return!!n&&typeof n.valueOf()=="number"&&!(n instanceof Date);return!1}function qz(n){return Nn(n,[","])}function Ce(n,e,t){let r=-1;for(typeof e=="function"?(t=e,e=n):r=n-1;++r<=e&&t(r)!==!1;);}function AC(n,e,t){let r=n+1;for(typeof e=="function"&&(t=e,e=0);--r>=e&&t(r)!==!1;);}function ax(n,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(n*e/100,10)}const PC="asc",Qz="desc",eT=new Map([[PC,[-1,1]],[Qz,[1,-1]]]),Zz=n=>`The priority '${n}' is already declared in a map.`,Jz=n=>`The priority '${n}' is not a number.`;function eY(){let{errorPriorityExists:n,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=new Map;n=ut(n)?n:Zz,e=ut(e)?e:Jz;function r(o,i){if(!Nn(o))throw new Error(e(o));if(t.has(o))throw new Error(n(o));t.set(o,i)}function s(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:PC;const[i,l]=eT.get(o)||eT.get(PC);return[...t].sort((a,u)=>a[0]<u[0]?i:l).map(a=>a[1])}return{addItem:r,getItems:s}}const tY=n=>`The id '${n}' is already declared in a map.`;function hg(){let{errorIdExists:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;n=ut(n)?n:tY;function t(u,c){if(a(u))throw new Error(n(u));e.set(u,c)}function r(u){return e.delete(u)}function s(){e.clear()}function o(u){const[c]=l().find(d=>{let[f,m]=d;return u===m?f:!1})||[null];return c}function i(u){return e.get(u)}function l(){return[...e]}function a(u){return e.has(u)}return{addItem:t,clear:s,getId:o,getItem:i,getItems:l,hasItem:a,removeItem:r}}const nY=n=>`'${n}' value is already declared in a unique set.`;function rY(){let{errorItemExists:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;n=ut(n)?n:nY;function t(o){if(e.has(o))throw new Error(n(o));e.add(o)}function r(){return[...e]}function s(){e.clear()}return{addItem:t,clear:s,getItems:r}}const Bv=n=>`There is already registered "${n}" plugin.`,sY=n=>`There is already registered plugin on priority "${n}".`,oY=n=>`The priority "${n}" is not a number.`,ux=eY({errorPriorityExists:sY,errorPriorityNaN:oY}),cx=rY({errorItemExists:Bv}),HC=hg({errorIdExists:Bv});function hx(){return[...ux.getItems(),...cx.getItems()]}function Wv(n){const e=Lr(n);return HC.getItem(e)}function iY(n){return!!Wv(n)}function Xe(n,e,t){[n,e,t]=aY(n,e,t),Wv(n)===void 0&&lY(n,e,t)}function lY(n,e,t){const r=Lr(n);if(HC.hasItem(r))throw new Error(Bv(r));t===void 0?cx.addItem(r):ux.addItem(t,r),HC.addItem(r,e)}function aY(n,e,t){return typeof n=="function"&&(e=n,n=e.PLUGIN_KEY,t=e.PLUGIN_PRIORITY),[n,e,t]}const{register:uY,getItem:cY,hasItem:dx,getNames:mq,getValues:pq}=br("renderers");function tT(n){if(typeof n=="function")return n;if(!dx(n))throw Error(`No registered renderer found under "${n}" name`);return cY(n)}function Ms(n,e){typeof n!="string"&&(e=n,n=e.RENDERER_TYPE),uY(n,e)}const{register:hY,getItem:dY,hasItem:fx,getNames:wq,getValues:Cq}=br("validators");function fY(n){if(typeof n=="function")return n;if(!fx(n))throw Error(`No registered validator found under "${n}" name`);return dY(n)}function qa(n,e){typeof n!="string"&&(e=n,n=e.VALIDATOR_TYPE),hY(n,e)}var gx={},gY=MO,mY=cv,pY=Object.keys||function(e){return gY(e,mY)},wY=fs,CY=yO,yY=Hi,vY=jf,SY=Wf,RY=pY;gx.f=wY&&!CY?Object.defineProperties:function(e,t){vY(e);for(var r=SY(t),s=RY(t),o=s.length,i=0,l;o>i;)yY.f(e,l=s[i++],r[l]);return e};var bY=jf,EY=gx,nT=cv,TY=lv,MY=$O,_Y=ov,OY=RO,rT=">",sT="<",DC="prototype",kC="script",mx=OY("IE_PROTO"),sp=function(){},px=function(n){return sT+kC+rT+n+sT+"/"+kC+rT},oT=function(n){n.write(px("")),n.close();var e=n.parentWindow.Object;return n=null,e},IY=function(){var n=_Y("iframe"),e="java"+kC+":",t;return n.style.display="none",MY.appendChild(n),n.src=String(e),t=n.contentWindow.document,t.open(),t.write(px("document.F=Object")),t.close(),t.F},lh,hd=function(){try{lh=new ActiveXObject("htmlfile")}catch{}hd=typeof document<"u"?document.domain&&lh?oT(lh):IY():oT(lh);for(var n=nT.length;n--;)delete hd[DC][nT[n]];return hd()};TY[mx]=!0;var xY=Object.create||function(e,t){var r;return e!==null?(sp[DC]=bY(e),r=new sp,sp[DC]=null,r[mx]=e):r=hd(),t===void 0?r:EY.f(r,t)},AY=Yf,PY=xY,HY=Hi.f,NC=AY("unscopables"),LC=Array.prototype;LC[NC]===void 0&&HY(LC,NC,{configurable:!0,value:PY(null)});var DY=function(n){LC[NC][n]=!0},kY=Di,NY=zf,LY=Gf,FY=uv,VY=DY;kY({target:"Array",proto:!0},{at:function(e){var t=NY(this),r=LY(t),s=FY(e),o=s>=0?s:r+s;return o<0||o>=r?void 0:t[o]}});VY("at");const li=1,mn=2,ji=new WeakMap;class wc{static get DEFAULT_WIDTH(){return 50}constructor(){let{viewportSize:e,scrollOffset:t,totalItems:r,itemSizeFn:s,overrideFn:o,calculationType:i,stretchMode:l,stretchingItemWidthFn:a=c=>c,inlineStartOffset:u}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ji.set(this,{viewportWidth:e,scrollOffset:t,totalColumns:r,columnWidthFn:s,overrideFn:o,calculationType:i,stretchingColumnWidthFn:a,inlineStartOffset:u}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=l,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}calculate(){let e=0,t=!0;const r=[];let s,o=0,i=0;const l=ji.get(this),a=l.calculationType,u=l.overrideFn,c=l.scrollOffset,d=Math.max(l.scrollOffset,0),f=l.totalColumns,m=l.viewportWidth,p=d>0?m+1:m;for(let y=0;y<f;y++)if(s=this._getColumnWidth(y),e<=d&&a!==mn&&(this.startColumn=y,o=s),e>=d&&e+(a===mn?s:0)<=d+p&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=y,o=s),this.endColumn=y),r.push(e),e+=s,i=s,a!==mn&&(this.endColumn=y),e>=d+m){t=!1;break}const w=c+m-p,M=a===mn?0:i,S=a===mn?o:0;if(w<-1*l.inlineStartOffset||c>r.at(-1)+M||-1*l.scrollOffset-l.viewportWidth>-1*S?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===f-1&&t)for(this.startColumn=this.endColumn;this.startColumn>0;){const y=r[this.endColumn]+s-r[this.startColumn-1];if((y<=m||a!==mn)&&(this.startColumn-=1),y>m)break}a===li&&this.startColumn!==null&&u&&u(this),this.startPosition=r[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),f<this.endColumn&&(this.endColumn=f-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}refreshStretching(e){if(this.stretch==="none")return;let t=e;this.totalTargetWidth=t;const r=ji.get(this),s=r.totalColumns;let o=0;for(let l=0;l<s;l++){const a=this._getColumnWidth(l),u=r.stretchingColumnWidthFn(void 0,l);typeof u=="number"?t-=u:o+=a}const i=t-o;if(this.stretch==="all"&&i>0)this.stretchAllRatio=t/o,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&t!==1/0){const l=this._getColumnWidth(s-1),a=i+l;this.stretchLastWidth=a>=0?a:l}}getStretchedColumnWidth(e,t){let r=null;return this.stretch==="all"&&this.stretchAllRatio!==0?r=this._getStretchedAllColumnWidth(e,t):this.stretch==="last"&&this.stretchLastWidth!==0&&(r=this._getStretchedLastColumnWidth(e)),r}_getStretchedAllColumnWidth(e,t){let r=0;const s=ji.get(this),o=s.totalColumns;if(!this.stretchAllColumnsWidth[e]){const i=Math.round(t*this.stretchAllRatio),l=s.stretchingColumnWidthFn(i,e);l===void 0?this.stretchAllColumnsWidth[e]=i:this.stretchAllColumnsWidth[e]=isNaN(l)?this._getColumnWidth(e):l}if(this.stretchAllColumnsWidth.length===o&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let i=0;i<this.stretchAllColumnsWidth.length;i++)r+=this.stretchAllColumnsWidth[i];r!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-r)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){const r=ji.get(this).totalColumns;return e===r-1?this.stretchLastWidth:null}_getColumnWidth(e){let t=ji.get(this).columnWidthFn(e);return isNaN(t)&&(t=wc.DEFAULT_WIDTH),t}}const iT=new WeakMap;class dg{static get DEFAULT_HEIGHT(){return 23}constructor(){let{viewportSize:e,scrollOffset:t,totalItems:r,itemSizeFn:s,overrideFn:o,calculationType:i,scrollbarHeight:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};iT.set(this,{viewportHeight:e,scrollOffset:t,totalRows:r,rowHeightFn:s,overrideFn:o,calculationType:i,horizontalScrollbarHeight:l}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}calculate(){const e=iT.get(this),t=e.calculationType,r=e.overrideFn,s=e.rowHeightFn,o=e.scrollOffset,i=Math.max(e.scrollOffset,0),l=e.totalRows,a=e.viewportHeight,u=e.horizontalScrollbarHeight||0;let c=0,d=!0;const f=[];let m,p=0,w=0;for(let v=0;v<l;v++)if(m=s(v),isNaN(m)&&(m=dg.DEFAULT_HEIGHT),c<=i&&t!==mn&&(this.startRow=v,p=m),c>=i&&c+(t===mn?m:0)<=i+a-u&&(this.startRow===null&&(this.startRow=v,p=m),this.endRow=v),f.push(c),c+=m,w=m,t!==mn&&(this.endRow=v),c>=i+a-u){d=!1;break}const M=o+a-u,S=t===mn?p:0,y=t===mn?0:w;if(M<S||o>f.at(-1)+y?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===l-1&&d)for(this.startRow=this.endRow;this.startRow>0;){const v=f[this.endRow]+m-f[this.startRow-1];if((v<=a-u||t!==mn)&&(this.startRow-=1),v>=a-u)break}t===li&&this.startRow!==null&&r&&r(this),this.startPosition=f[this.startRow],this.startPosition===void 0&&(this.startPosition=null),l<this.endRow&&(this.endRow=l-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function $Y(n,e,t){BY(n,e),e.set(n,t)}function BY(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lT(n,e,t){return e=WY(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function WY(n){var e=UY(n,"string");return typeof e=="symbol"?e:String(e)}function UY(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Oa(n,e){var t=wx(n,e,"get");return zY(n,t)}function zY(n,e){return e.get?e.get.call(n):e.value}function YY(n,e,t){var r=wx(n,e,"set");return jY(n,r,t),t}function wx(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function jY(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var Go=new WeakMap;class Kl{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;lT(this,"row",null),lT(this,"col",null),$Y(this,Go,{writable:!0,value:!1}),YY(this,Go,r),typeof e<"u"&&typeof t<"u"&&(this.row=e,this.col=t)}isValid(e){return!(this.row<0||this.col<0||this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isSouthEastOf(e){return this.row>=e.row&&(Oa(this,Go)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Oa(this,Go)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Oa(this,Go)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Oa(this,Go)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}clone(){return new Kl(this.row,this.col,Oa(this,Go))}toObject(){return{row:this.row,col:this.col}}}function GY(n,e,t){KY(n,e),e.set(n,t)}function KY(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function op(n,e,t){return e=XY(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function XY(n){var e=qY(n,"string");return typeof e=="symbol"?e:String(e)}function qY(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function zr(n,e){var t=Cx(n,e,"get");return QY(n,t)}function QY(n,e){return e.get?e.get.call(n):e.value}function ZY(n,e,t){var r=Cx(n,e,"set");return JY(n,r,t),t}function Cx(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function JY(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var or=new WeakMap;class Cc{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;op(this,"highlight",null),op(this,"from",null),op(this,"to",null),GY(this,or,{writable:!0,value:!1}),this.highlight=e.clone().normalize(),this.from=t.clone(),this.to=r.clone(),ZY(this,or,s)}setHighlight(e){return this.highlight=e.clone().normalize(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:t,col:r}=e,s=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return s.row<=t&&o.row>=t&&s.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}isOverlappingVertically(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}expand(e){const t=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<t.row||e.col<t.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){if(this.includesRange(e)||!this.overlaps(e))return!1;const t=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),s=this.getDirection(),o=e.getOuterTopStartCorner(),i=e.getOuterBottomEndCorner(),l=Math.min(t.row,o.row),a=Math.min(t.col,o.col),u=Math.max(r.row,i.row),c=Math.max(r.col,i.col),d=this._createCellCoords(l,a),f=this._createCellCoords(u,c);return this.from=d,this.to=f,this.setDirection(s),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return zr(this,or)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return zr(this,or)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return zr(this,or)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return zr(this,or)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return zr(this,or)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return zr(this,or)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return zr(this,or)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return zr(this,or)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e,t){return t&&t.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(t.from.row,t.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(t.from.row,t.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(t.to.row,t.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(t.to.row,t.to.col)))?!0:e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e,t){if(!(e instanceof Kl))return!1;if(t){const{from:r,to:s}=t;if(t.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(r.row,r.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(r.row,s.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(s.row,r.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(s.row,s.col)))return this.getOuterTopStartCorner()}}if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},s=[];return t.top===r.top&&s.push("top"),t.right===r.right&&s.push("right"),t.bottom===r.bottom&&s.push("bottom"),t.left===r.left&&s.push("left"),s}getInner(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),r=[];for(let s=e.row;s<=t.row;s++)for(let o=e.col;o<=t.col;o++)!(this.from.row===s&&this.from.col===o)&&!(this.to.row===s&&this.to.col===o)&&r.push(this._createCellCoords(s,o));return r}getAll(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),r=[];for(let s=e.row;s<=t.row;s++)for(let o=e.col;o<=t.col;o++)e.row===s&&e.col===o?r.push(e):t.row===s&&t.col===o?r.push(t):r.push(this._createCellCoords(s,o));return r}forAll(e){const t=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let s=t.row;s<=r.row;s++)for(let o=t.col;o<=r.col;o++)if(e(s,o)===!1)return}clone(){return new Cc(this.highlight,this.from,this.to,zr(this,or))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new Kl(e,t,zr(this,or))}}function Uv(n){return window.requestAnimationFrame(n)}function rf(n){window.cancelAnimationFrame(n)}function yx(){return"ontouchstart"in window}let Gi;function ej(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Gi||(typeof Intl=="object"?Gi=new Intl.Collator(n,e).compare:typeof String.prototype.localeCompare=="function"?Gi=(t,r)=>`${t}`.localeCompare(r):Gi=(t,r)=>t===r?0:t>r?-1:1,Gi)}const Ki=new WeakMap;let vx=class{constructor(e,t,r,s,o,i){let l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;this.wtSettings=r,this.domBindings=t,this.wtTable=o,this.selections=i,this.parent=l,this.eventManager=s,this.facadeGetter=e,Ki.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}registerEvents(){this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",r=>this.onContextMenu(r)),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",r=>this.onMouseOver(r)),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{this.eventManager.addEventListener(this.wtTable.holder,"touchstart",r=>this.onTouchStart(r)),this.eventManager.addEventListener(this.wtTable.holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),this.eventManager.addEventListener(this.wtTable.holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||this.wtSettings.getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,this.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},t=()=>{this.eventManager.addEventListener(this.wtTable.holder,"mouseup",r=>this.onMouseUp(r)),this.eventManager.addEventListener(this.wtTable.holder,"mousedown",r=>this.onMouseDown(r))};is()?e():(yx()&&e(),t())}selectedCellWasTouched(e){const t=Ki.get(this),s=this.parentCell(e).coords;if(t.selectedCellBeforeTouchEnd&&s){const[o,i]=[s.row,t.selectedCellBeforeTouchEnd.from.row],[l,a]=[s.col,t.selectedCellBeforeTouchEnd.from.col];return o===i&&l===a}return!1}parentCell(e){const t={},r=this.wtTable.TABLE,s=oh(e,["TD","TH"],r);return s?(t.coords=this.wtTable.getCoords(s),t.TD=s):Oe(e,"wtBorder")&&Oe(e,"current")?(t.coords=this.selections.getCell().cellRange.highlight,t.TD=this.wtTable.getCell(t.coords)):Oe(e,"wtBorder")&&Oe(e,"area")&&this.selections.createOrGetArea().cellRange&&(t.coords=this.selections.createOrGetArea().cellRange.to,t.TD=this.wtTable.getCell(t.coords)),t}onMouseDown(e){const t=Ki.get(this),r=this.domBindings.rootDocument.activeElement,s=XI(oz,e.target),o=e.target;if(o===r||s(0)===r||s(1)===r)return;const i=this.parentCell(o);Oe(o,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",e,o):i.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,i.coords,i.TD),(e.button===0||this.touchApplied)&&i.TD&&(t.dblClickOrigin[0]=i.TD,clearTimeout(t.dblClickTimeout[0]),t.dblClickTimeout[0]=setTimeout(()=>{t.dblClickOrigin[0]=null},1e3))}onContextMenu(e){if(this.wtSettings.has("onCellContextMenu")){const t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!this.wtSettings.has("onCellMouseOver"))return;const t=this.wtTable.TABLE,r=oh(e.target,["TD","TH"],t),s=this.parent||this;r&&r!==s.lastMouseOver&&yi(r,t)&&(s.lastMouseOver=r,this.callListener("onCellMouseOver",e,this.wtTable.getCoords(r),r))}onMouseOut(e){if(!this.wtSettings.has("onCellMouseOut"))return;const t=this.wtTable.TABLE,r=oh(e.target,["TD","TH"],t),s=oh(e.relatedTarget,["TD","TH"],t),o=this.parent||this;r&&r!==s&&yi(r,t)&&(this.callListener("onCellMouseOut",e,this.wtTable.getCoords(r),r),s===null&&(o.lastMouseOver=null))}onMouseUp(e){const t=Ki.get(this),r=this.parentCell(e.target);r.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===t.dblClickOrigin[0]&&r.TD===t.dblClickOrigin[1]?(Oe(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),t.dblClickOrigin[0]=null,t.dblClickOrigin[1]=null):r.TD===t.dblClickOrigin[0]&&(t.dblClickOrigin[1]=r.TD,clearTimeout(t.dblClickTimeout[1]),t.dblClickTimeout[1]=setTimeout(()=>{t.dblClickOrigin[1]=null},500)))}onTouchStart(e){const t=Ki.get(this);t.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;const r=e.target,s=(t=this.parentCell(r))===null||t===void 0?void 0:t.coords,o=ue(s)&&s.row>=0&&s.col>=0;if(e.cancelable&&o&&this.wtSettings.getSetting("isDataViewInstance")){const l=["A","BUTTON","INPUT"];tx()&&(kz()||Nz())&&this.selectedCellWasTouched(r)&&!l.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,r,s){const o=this.wtSettings.getSettingPure(e);o&&o(t,r,s,this.facadeGetter())}destroy(){const e=Ki.get(this);clearTimeout(e.dblClickTimeout[0]),clearTimeout(e.dblClickTimeout[1]),this.eventManager.destroy()}};class tj{constructor(e,t,r){this.offset=e,this.total=t,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}class nj{constructor(e,t,r){this.offset=e,this.total=t,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const rj=0,sf=1,of=2;class aT{constructor(){this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}class sj{constructor(){this.size=new aT,this.workingSpace=rj,this.sharedSize=null}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof aT}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=sf,e.workingSpace=of,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=of,e.workingSpace=sf,this.sharedSize=e.getViewSize()}}class Sx{constructor(e,t,r){this.rootNode=e,this.nodesPool=t,this.sizeSet=new sj,this.childNodeType=r.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:t}=this;let r=0;if(this.isSharedViewSet()){let s=e.firstElementChild;for(;s;){if(s.tagName===this.childNodeType)r+=1;else if(t.isPlaceOn(sf))break;s=s.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:t}=this,r=this.isSharedViewSet(),{nextSize:s}=t.getViewSize();let o=this.getRenderedChildCount();for(;o<s;){const l=this.nodesPool();!r||r&&t.isPlaceOn(of)?e.appendChild(l):e.insertBefore(l,e.firstChild),o+=1}const i=r&&t.isPlaceOn(sf);for(;o>s;)e.removeChild(i?e.firstChild:e.lastChild),o-=1}render(){const{rootNode:e,sizeSet:t}=this;let r=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(of)&&(r+=t.sharedSize.nextSize);let s=e.childNodes[r];if(s.tagName!==this.childNodeType){const o=this.nodesPool();e.replaceChild(o,s),s=o}this.collectedNodes.push(s),this.visualIndex+=1}end(){}}class Rx extends Sx{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}class oj{constructor(e){this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}class yc{constructor(e,t){this.nodesPool=typeof e=="string"?new oj(e):null,this.nodeType=e,this.rootNode=t,this.table=null,this.renderedNodes=0}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}class ij extends yc{constructor(){super("TH"),this.orderViews=new WeakMap,this.sourceRowIndex=0}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new Rx(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:r,rows:s,cells:o}=this.table;for(let i=0;i<e;i++){const l=this.table.renderedRowToSource(i),a=s.getRenderedNode(i);this.sourceRowIndex=l;const u=this.obtainOrderView(a),c=o.obtainOrderView(a);u.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let d=0;d<r;d++){u.render();const f=u.getCurrentNode();f.className="",f.removeAttribute("style"),t[d](l,f,d)}u.end()}}}class lj extends yc{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:t}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:s}=this.table,o=s+t;for(let l=0,a=e;l<a;l++){for(r=this.rootNode.childNodes[l],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const i=this.rootNode.childNodes.length;if(i>e)for(let l=e;l<i;l++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&hs(r)}render(){const{columnHeadersCount:e}=this.table;for(let t=0;t<e;t+=1){const{columnHeaderFunctions:r,columnsToRender:s,rowHeadersCount:o}=this.table,i=this.rootNode.childNodes[t];for(let l=-1*o;l<s;l+=1){const a=this.table.renderedColumnToSource(l),u=i.childNodes[l+o];u.className="",u.removeAttribute("style"),r[t](a,u,t)}}}}class aj extends yc{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:t}=this.table,r=e+t;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:t}=this.table;for(let s=0;s<t;s++){const o=this.table.renderedColumnToSource(s),i=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[s].style.width=`${i}px`}for(let s=0;s<e;s++){const o=this.table.renderedColumnToSource(s),i=this.table.columnUtils.getStretchedColumnWidth(o);this.rootNode.childNodes[s+t].style.width=`${i}px`}const r=this.rootNode.firstChild;r&&ee(r,"rowHeader")}}let uT=!1;class uj extends yc{constructor(e){super("TR",e),this.orderView=new Sx(e,t=>this.nodesPool.obtain(t),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!uT&&e>1e3&&(uT=!0,ct(ot`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`)),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let t=0;t<e;t++)this.orderView.render();this.orderView.end()}}class cj extends yc{constructor(){super("TD"),this.orderViews=new WeakMap,this.sourceRowIndex=0}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new Rx(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,columnsToRender:t,rows:r,rowHeaders:s}=this.table;for(let o=0;o<e;o++){const i=this.table.renderedRowToSource(o),l=r.getRenderedNode(o);this.sourceRowIndex=i;const a=this.obtainOrderView(l),u=s.obtainOrderView(l);a.prependView(u).setSize(t).setOffset(this.table.renderedColumnToSource(0)).start();for(let c=0;c<t;c++){a.render();const d=a.getCurrentNode(),f=this.table.renderedColumnToSource(c);Oe(d,"hide")||(d.className=""),d.removeAttribute("style"),d.removeAttribute("dir"),this.table.cellRenderer(i,f,d)}a.end()}}}class hj{constructor(e){let{cellRenderer:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=t}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:r,rows:s,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),t.setTable(this),r.setTable(this),s.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=r,this.rows=s,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:t}=this;for(let r=0;r<e;r++){const s=t.getRenderedNode(r);if(s.firstChild){const o=this.renderedRowToSource(r),i=this.rowUtils.getHeight(o);i?s.firstChild.style.height=`${i-1}px`:s.firstChild.style.height=""}}}}class dj{constructor(){let{TABLE:e,THEAD:t,COLGROUP:r,TBODY:s,rowUtils:o,columnUtils:i,cellRenderer:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new hj(e,{cellRenderer:l}),this.renderer.setRenderers({rowHeaders:new ij,columnHeaders:new lj(t),colGroup:new aj(r),rows:new uj(s),cells:new cj}),this.renderer.setAxisUtils(o,i)}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}class fj{constructor(e,t){this.dataAccessObject=e,this.wtSettings=t,this.headerWidths=new Map}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){const t=this.dataAccessObject.wtViewport.columnsRenderCalculator;let r=this.getWidth(e);if(t){const s=t.getStretchedColumnWidth(e,r);s&&(r=s)}return r}getHeaderHeight(e){let t=this.wtSettings.getSetting("defaultRowHeight");const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(t=t?Math.max(t,r):r),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this,{wtTable:t,wtViewport:r,cloneSource:s}=this.dataAccessObject,o=s?s.wtTable.holder:t.holder,i=o.offsetHeight<o.scrollHeight?en():0;let l=e.getSetting("rowHeaderWidth");if(r.columnsRenderCalculator.refreshStretching(r.getViewportWidth()-i),l=e.getSetting("onModifyRowHeaderWidth",l),l!=null){const a=e.getSetting("rowHeaders").length,u=e.getSetting("defaultColumnWidth");for(let c=0;c<a;c++){let d=Array.isArray(l)?l[c]:l;d=d??u,this.headerWidths.set(c,d)}}}}class gj{constructor(e,t){this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(t=t===void 0?r:Math.max(t,r)),t}}function Yr(n,e,t){return e=mj(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function mj(n){var e=pj(n,"string");return typeof e=="symbol"?e:String(e)}function pj(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class la{constructor(e,t,r,s,o){Yr(this,"wtSettings",null),Yr(this,"domBindings",void 0),Yr(this,"TBODY",null),Yr(this,"THEAD",null),Yr(this,"COLGROUP",null),Yr(this,"hasTableHeight",!0),Yr(this,"hasTableWidth",!0),Yr(this,"isTableVisible",!1),Yr(this,"tableOffset",0),Yr(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=s,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,YI(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const i=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(i)),this.rowUtils=new gj(this.dataAccessObject,this.wtSettings),this.columnUtils=new fj(this.dataAccessObject,this.wtSettings),this.tableRenderer=new dj({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const t=e.parentNode;let r;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Oe(t,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",t&&t.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",r}createHider(e){const t=e.parentNode;let r;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Oe(t,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",t&&t.insertBefore(r,e),r.appendChild(e)),r}createHolder(e){const t=e.parentNode;let r;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Oe(t,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",t&&t.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),r.appendChild(e)),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,{wtOverlays:r,wtViewport:s}=this.dataAccessObject,o=t.getSetting("totalRows"),i=t.getSetting("totalColumns"),l=t.getSetting("rowHeaders"),a=l.length,u=t.getSetting("columnHeaders"),c=u.length;let d=!1,f=e;if(this.isMaster&&(this.holderOffset=Wt(this.holder),f=s.createRenderCalculators(f),a&&!t.getSetting("fixedColumnsStart"))){const p=r.inlineStartOverlay.getScrollPosition(),w=this.correctHeaderWidth;this.correctHeaderWidth=p!==0,w!==this.correctHeaderWidth&&(f=!1)}if(this.isMaster&&(d=r.updateStateOfRendering()),f)this.isMaster&&s.createVisibleCalculators(),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=Wt(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const p=o>0?this.getFirstRenderedRow():0,w=i>0?this.getFirstRenderedColumn():0;this.rowFilter=new nj(p,o,c),this.columnFilter=new tj(w,i,a);let M=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const S={};this.wtSettings.getSetting("beforeDraw",!0,S),M=S.skipRender!==!0}if(M){this.tableRenderer.setHeaderContentRenderers(l,u),(this.is(os)||this.is(xo))&&this.tableRenderer.setHeaderContentRenderers(l,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let S;if(this.isMaster&&(S=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(os))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const y=st(this.hider),v=st(this.TABLE);y!==0&&v!==y&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),S!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(os)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let m=!1;return this.isMaster&&(m=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(m=r.bottomOverlay.resetFixedPosition()||m),m=r.inlineStartOverlay.resetFixedPosition()||m,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),m?(r.refreshAll(),r.adjustElementsSize()):this.refreshSelections(f),d&&r.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const t=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const s=this.wtSettings.getSetting("defaultRowHeight");let o,i,l;const a=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),i=this.getColumnHeader(t,r),i&&(l=yo(i),(!o&&s<l||o<l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),Array.isArray(a)?a[r]!==null&&a[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a[r]):isNaN(a)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(a[r]||a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a[r]||a))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,t=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,s=e.getSetting("columnHeaders");for(let o=0,i=s.length;o<i;o++)if(r[o]){if(!t[o]||t[o].childNodes.length===0)return;t[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(os))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let s=0;s<r;s++){const o=this.rowFilter.renderedToSource(s);t.oversizedRows&&t.oversizedRows[o]&&(t.oversizedRows[o]=void 0)}}}removeClassFromCells(e){const t=this.TABLE.querySelectorAll(`.${e}`);for(let r=0,s=t.length;r<s;r++)He(t[r],e)}refreshSelections(e){const{wtSettings:t}=this,{selections:r}=this.dataAccessObject;if(!r)return;const s=Array.from(r),o=s.length;if(e){const i=[];for(let u=0;u<o;u++){const{highlightHeaderClassName:c,highlightRowClassName:d,highlightColumnClassName:f}=s[u].settings,m=s[u].classNames,p=m.length;for(let w=0;w<p;w++)i.includes(m[w])||i.push(m[w]);c&&!i.includes(c)&&i.push(c),d&&!i.includes(d)&&i.push(d),f&&!i.includes(f)&&i.push(f)}const l=t.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(l))for(let u=0;u<l.length;u++)i.push(l[u]);const a=i.length;for(let u=0;u<a;u++)this.removeClassFromCells(i[u])}for(let i=0;i<o;i++)s[i].draw(this.facadeGetter(),e)}getCell(e){let t=e.row,r=e.col;const s=this.wtSettings.getSetting("onModifyGetCellCoords",t,r);if(s&&Array.isArray(s)&&([t,r]=s),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(t);if(!o&&t>=0)throw new Error("TR was expected to be rendered but is not");const i=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!i&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return i}getRow(e){let t=null,r=null;if(e<0){var s;t=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;t=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return t!==void 0&&r!==void 0?r.childNodes.length<t+1?!1:r.childNodes[t]:!1}getColumnHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[t];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(s=>{const o=s.childNodes[r];o&&t.push(o)}),t}getRowHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return;const r=this.wtSettings.getSetting("rowHeaders").length;if(t>=r)return;const s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return s==null?void 0:s.childNodes[t]}getRowHeaders(e){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];const t=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let s=0;s<r;s++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],i=o==null?void 0:o.childNodes[s];i&&t.push(i)}return t}getCoords(e){let t=e;if(t.nodeName!=="TD"&&t.nodeName!=="TH"&&(t=Ci(t,["TD","TH"])),t===null)return null;const r=t.parentNode,s=r.parentNode;let o=lz(r),i=t.cellIndex;return jo(xi,t,this.wtRootElement)||jo(Oi,t,this.wtRootElement)?s.nodeName==="THEAD"&&(o-=s.childNodes.length):jo(xo,t,this.wtRootElement)||jo(os,t,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-s.childNodes.length+o:s===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o),jo(xi,t,this.wtRootElement)||jo(Ii,t,this.wtRootElement)||jo(xo,t,this.wtRootElement)?i=this.columnFilter.offsettedTH(i):i=this.columnFilter.visibleRowHeadedColumnToSourceColumn(i),this.wot.createCellCoords(o,i)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const t=e*this.wtSettings.getSetting("defaultRowHeight"),r=yo(this.TBODY)-1;let s,o,i,l,a;if(!(t===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,i=this.rowFilter.renderedToSource(e),s=this.getRowHeight(i),l=this.getTrForRow(i),a=l.querySelector("th"),a?o=yo(a):o=yo(l)-1,(!s&&this.wtSettings.getSetting("defaultRowHeight")<o||s<o)&&(o+=1,this.dataAccessObject.wtViewport.oversizedRows[i]=o)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return st(this.TABLE)}getHeight(){return _t(this.TABLE)}getTotalWidth(){const e=st(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=_t(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Uu(this.TABLE)}_modifyRowHeaderWidth(e){let t=ut(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return typeof e!="number"&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}const wj="stickyRowsBottom",zv={getFirstRenderedRow(){const n=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),t=n-e;return n===0||e===0?-1:t<0?0:t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const n=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),n)},getVisibleRowsCount(){return this.getRenderedRowsCount()}};qs(zv,"MIXIN_NAME",wj,{writable:!1,enumerable:!1});const Cj="stickyColumnsStart",fg={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const n=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),n)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()}};qs(fg,"MIXIN_NAME",Cj,{writable:!1,enumerable:!1});class Yv extends la{constructor(e,t,r,s){super(e,t,r,s,xo)}}at(Yv,zv);at(Yv,fg);const Oi="top",os="bottom",Ii="inline_start",xi="top_inline_start_corner",xo="bottom_inline_start_corner",yj=[Oi,os,Ii,xi,xo],vj=new Map([[Oi,`ht_clone_${Oi}`],[os,`ht_clone_${os}`],[Ii,`ht_clone_${Ii} ht_clone_left`],[xi,`ht_clone_${xi} ht_clone_top_left_corner`],[xo,`ht_clone_${xo} ht_clone_bottom_left_corner`]]);function ip(n,e,t){return e=Sj(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Sj(n){var e=Rj(n,"string");return typeof e=="symbol"?e:String(e)}function Rj(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class bj{constructor(e){ip(this,"dataAccessObject",void 0),ip(this,"lastScrolledColumnPos",-1),ip(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,t,r,s,o){const i=this.scrollViewportHorizontally(e.col,r,o),l=this.scrollViewportVertically(e.row,t,s);return i||l}scrollViewportHorizontally(e,t,r){const{drawn:s,totalColumns:o}=this.dataAccessObject;if(!s||!Number.isInteger(e)||e<0||e>o)return!1;const i=this.getFirstVisibleColumn(),l=this.getLastVisibleColumn(),a=t===void 0&&r===void 0,{fixedColumnsStart:u,inlineStartOverlay:c}=this.dataAccessObject;if(a&&e<u)return!1;let d=!1;return i===-1?d=c.scrollTo(e,a?e>this.lastScrolledColumnPos:t):(a&&(e<i||e>l)||!a)&&(d=c.scrollTo(e,a?e>l:t)),d&&(this.lastScrolledColumnPos=e),d}scrollViewportVertically(e,t,r){const{drawn:s,totalRows:o}=this.dataAccessObject;if(!s||!Number.isInteger(e)||e<0||e>o)return!1;const i=this.getFirstVisibleRow(),l=this.getLastVisibleRow(),a=t===void 0&&r===void 0,{fixedRowsBottom:u,fixedRowsTop:c,topOverlay:d}=this.dataAccessObject;if(a&&(e<c||e>o-u-1))return!1;let f=!1;return i===-1?f=d.scrollTo(e,a?e>this.lastScrolledRowPos:r):(a&&(e<i||e>l)||!a)&&(f=d.scrollTo(e,a?e>l:r)),f&&(this.lastScrolledRowPos=e),f}getFirstVisibleRow(){const{topOverlay:e,wtTable:t,wtViewport:r,totalRows:s,fixedRowsTop:o,rootWindow:i}=this.dataAccessObject;let l=t.getFirstVisibleRow();if(e.mainTableScrollableElement===i){const a=Wt(t.wtRootElement),u=yo(t.hider),c=yo(i),d=ef(i,i);if(a.top+u-c<=d){let f=r.getColumnHeaderHeight();f+=e.sumCellSizes(0,o);for(let m=s;m>0;m--)if(f+=e.sumCellSizes(m-1,m),a.top+u-f<=d){l=m;break}}}return l}getLastVisibleRow(){const{topOverlay:e,wtTable:t,wtViewport:r,totalRows:s,rootWindow:o}=this.dataAccessObject;let i=t.getLastVisibleRow();if(e.mainTableScrollableElement===o){const l=Wt(t.wtRootElement),a=ef(o,o);if(l.top>a){const u=yo(o);let c=r.getColumnHeaderHeight();for(let d=1;d<=s;d++)if(c+=e.sumCellSizes(d-1,d),l.top+c-a>=u){i=d-2;break}}}return i}getFirstVisibleColumn(){const{inlineStartOverlay:e,wtTable:t,wtViewport:r,totalColumns:s,rootWindow:o}=this.dataAccessObject;let i=t.getFirstVisibleColumn();if(e.mainTableScrollableElement===o){const l=Wt(t.wtRootElement),a=cd(t.hider),u=cd(o),c=Math.abs(_C(o,o));if(l.left+a-u<=c){let d=r.getRowHeaderWidth();for(let f=s;f>0;f--)if(d+=e.sumCellSizes(f-1,f),l.left+a-d<=c){i=f;break}}}return i}getLastVisibleColumn(){const{wtSettings:e,inlineStartOverlay:t,wtTable:r,wtViewport:s,totalColumns:o,rootWindow:i}=this.dataAccessObject;let l=r.getLastVisibleColumn();if(t.mainTableScrollableElement===i){const a=e.getSetting("rtlMode");let u=null;if(a){const d=r.TABLE.getBoundingClientRect(),m=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;u=Math.abs(d.right-m)}else u=Wt(r.wtRootElement).left;const c=Math.abs(_C(i,i));if(u>c){const d=cd(i);let f=s.getRowHeaderWidth();for(let m=1;m<=o;m++)if(f+=t.sumCellSizes(m-1,m),u+f-c>=d){l=m-2;break}}}return l}}function _r(n,e,t){return e=Ej(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ej(n){var e=Tj(n,"string");return typeof e=="symbol"?e:String(e)}function Tj(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class jv{get eventManager(){return new It(this)}constructor(e,t){_r(this,"wtTable",void 0),_r(this,"wtScroll",void 0),_r(this,"wtViewport",void 0),_r(this,"wtOverlays",void 0),_r(this,"selections",void 0),_r(this,"wtEvent",void 0),_r(this,"guid",`wt_${BI()}`),_r(this,"drawInterrupted",!1),_r(this,"drawn",!1),_r(this,"domBindings",void 0),_r(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new bj(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;t<r;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,r){Ti(r,e[t])}])}}createCellCoords(e,t){return new Kl(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,r){return new Cc(e,t,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),s=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<s&&e.col<i)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<s)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<i&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<i)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,r,s,o){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,t,r,s,o)}scrollViewportHorizontally(e,t,r){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,t,r)}scrollViewportVertically(e,t,r){return e<0?!1:this.wtScroll.scrollViewportVertically(e,t,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selections(){return e.selections},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count}}}}function cT(n,e,t){return e=Mj(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Mj(n){var e=_j(n,"string");return typeof e=="symbol"?e:String(e)}function _j(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Oj extends jv{constructor(e,t,r){super(e,t),cT(this,"cloneSource",void 0),cT(this,"cloneOverlay",void 0);const s=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),s,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selections=r.selections,this.wtEvent=new vx(s,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selections,r.event),this.findOriginalHeaders()}}function Ij(n,e,t){return e=xj(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function xj(n){var e=Aj(n,"string");return typeof e=="symbol"?e:String(e)}function Aj(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class vc{constructor(e,t,r,s,o){Ij(this,"wtSettings",null),qs(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=t,this.wtSettings=s;const{TABLE:i,hider:l,spreader:a,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=i,this.hider=l,this.spreader=a,this.holder=u,this.wtRootElement=c,this.trimmingContainer=jl(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const e=this.needFullRender;this.needFullRender=this.shouldBeRendered();const t=e!==this.needFullRender;return t&&!this.needFullRender&&this.reset(),t}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=jl(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=tf(e.TABLE)}getRelativeCellPosition(e,t,r){if(this.clone.wtTable.holder.contains(e)===!1){ct(`The provided element is not a child of the ${this.type} overlay`);return}const s=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),i=t<this.wtSettings.getSetting("fixedRowsTop"),l=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),a=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(a),top:a.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let d=null;return s?d=this.getRelativeCellPositionWithinWindow(i,o,c,u):d=this.getRelativeCellPositionWithinHolder(i,l,o,c,u),d}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,r,s){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let i=0,l=0;if(!t)i=s.start;else{let a=o.left;this.isRtl()&&(a=this.domBindings.rootWindow.innerWidth-(o.left+o.width+en())),i=a<=0?-1*a:0}return e?l=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:l=s.top,{start:r.start+i,top:r.top+l}}getRelativeCellPositionWithinHolder(e,t,r,s,o){const i={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let l=0,a=0;if(r||(l=i.horizontal-o.start),t){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();a=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(a=i.vertical-o.top);return{start:s.start-l,top:s.top-a}}makeClone(){if(yj.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:r}=this.domBindings,s=t.createElement("DIV"),o=t.createElement("TABLE"),i=e.wtRootElement.parentNode;s.className=`${vj.get(this.type)} handsontable`,s.setAttribute("dir",this.isRtl()?"rtl":"ltr"),s.style.position="absolute",s.style.top=0,s.style.overflow="visible",this.isRtl()?s.style.right=0:s.style.left=0,o.className=e.TABLE.className,s.appendChild(o),i.appendChild(s);const l=this.wtSettings.getSetting("preventOverflow");return l===!0||l==="horizontal"&&this.type===Oi||l==="vertical"&&this.type===Ii?this.mainTableScrollableElement=r:r.getComputedStyle(i).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=tf(e.TABLE),new Oj(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this.shouldBeRendered();this.clone&&(this.needFullRender||t)&&this.clone.draw(e),this.needFullRender=t}reset(){if(!this.clone)return;const e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,r=e.style,s=t.style,o=e.parentNode.style;P([r,s,o],i=>{i.width="",i.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class Pj extends vc{constructor(e,t,r,s,o,i){super(e,t,xo,r,s),this.bottomOverlay=o,this.inlineStartOverlay=i}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new Yv(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),i=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${o}px`,t.style.bottom=`${i}px`}else ag(t),this.repositionOverlay();let r=_t(this.clone.wtTable.TABLE);const s=st(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),t.style.height=`${r}px`,t.style.width=`${s}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r}=this.domBindings,s=this.clone.wtTable.holder.parentNode;let o=0;t.hasVerticalScroll()||(o+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(o+=en(r)),s.style.bottom=`${o}px`}}const Hj="calculatedColumns",gg={getFirstRenderedColumn(){const n=this.dataAccessObject.startColumnRendered;return n===null?-1:n},getFirstVisibleColumn(){const n=this.dataAccessObject.startColumnVisible;return n===null?-1:n},getLastRenderedColumn(){const n=this.dataAccessObject.endColumnRendered;return n===null?-1:n},getLastVisibleColumn(){const n=this.dataAccessObject.endColumnVisible;return n===null?-1:n},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible}};qs(gg,"MIXIN_NAME",Hj,{writable:!1,enumerable:!1});class Gv extends la{constructor(e,t,r,s){super(e,t,r,s,os)}}at(Gv,zv);at(Gv,gg);function Dj(n,e,t){return e=kj(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function kj(n){var e=Nj(n,"string");return typeof e=="symbol"?e:String(e)}function Nj(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Lj extends vc{constructor(e,t,r,s){super(e,t,os,r,s),Dj(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new Gv(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let r=0;const s=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!s||s!=="vertical")?(r=this.getOverlayOffset(),t.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r}=this.domBindings,s=this.clone.wtTable.holder.parentNode;let o=0;t.hasVerticalScroll()||(o+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(o+=en(r)),s.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let r=!1;return this.mainTableScrollableElement===t?(t.scrollTo(Yl(t),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const{wtTable:r,wtSettings:s}=this.wot,o=s.getSetting("defaultRowHeight");let i=e,l=0;for(;i<t;){const a=r.getRowHeight(i);l+=a===void 0?o:a,i+=1}return l}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r,rootWindow:s}=this.domBindings,o=en(r),l=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||a==="horizontal"){let c=t.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=o),c=Math.min(c,e.wtRootElement.scrollWidth),l.width=`${c}px`}else l.width="";this.clone.wtTable.holder.style.width=l.width;let u=_t(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),l.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let i=0;t&&o.offsetHeight!==o.clientHeight&&(i=en(this.domBindings.rootDocument)),t?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=i,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return ef(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const s=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),i=s-o,l=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-l+s,0),r>i&&(r=0)}return r}adjustHeaderBordersPosition(e){const t=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==t,s=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||t===0)&&s.length>0){const i=this.wot.wtTable.holder.parentNode,l=Oe(i,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(ee(i,"innerBorderBottom"),o=!l):(He(i,"innerBorderBottom"),o=l)}return o}}const Fj="calculatedRows",Kv={getFirstRenderedRow(){const n=this.dataAccessObject.startRowRendered;return n===null?-1:n},getFirstVisibleRow(){const n=this.dataAccessObject.startRowVisible;return n===null?-1:n},getLastRenderedRow(){const n=this.dataAccessObject.endRowRendered;return n===null?-1:n},getLastVisibleRow(){const n=this.dataAccessObject.endRowVisible;return n===null?-1:n},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible}};qs(Kv,"MIXIN_NAME",Fj,{writable:!1,enumerable:!1});class Xv extends la{constructor(e,t,r,s){super(e,t,r,s,Ii)}}at(Xv,Kv);at(Xv,fg);class Vj extends vc{constructor(e,t,r,s){super(e,t,Ii,r,s)}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new Xv(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,r=this.clone.wtTable.holder.parentNode,s=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===t&&(!s||s!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),kv(r,`${o}px`,"0px")):(o=this.getScrollPosition(),ag(r));const i=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),i}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,zu(t)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){const r=this.wtSettings.getSetting("defaultColumnWidth");let s=e,o=0;for(;s<t;)o+=this.wot.wtTable.getStretchedColumnWidth(s)||r,s+=1;return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:r}=this.domBindings,s=en(t),i=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||l==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=s),u=Math.min(u,e.wtRootElement.scrollHeight),i.height=`${u}px`}else i.height="";this.clone.wtTable.holder.style.height=i.height;const a=st(this.clone.wtTable.TABLE);i.width=`${a}px`}adjustRootChildrenSize(){var e;const{holder:t}=this.clone.wtTable,{selections:r}=this.wot,s=this.facadeGetter(),o=Math.abs((e=r==null?void 0:r.getCell().getBorder(s).cornerCenterPointOffset)!==null&&e!==void 0?e:0);this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width=`${parseInt(t.parentNode.style.width,10)+o}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[t]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let i=0;if(t){const l=this.wot.wtTable.getColumnWidth(e),a=this.wot.wtViewport.getViewportWidth();l>a&&(t=!1)}return t&&o.offsetWidth!==o.clientWidth&&(i=en(this.domBindings.rootDocument)),t?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportWidth()):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),r+=i,this.setScrollPosition(r)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let t=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(t=this.wot.wtTable.holderOffset.left),t}getScrollPosition(){return Math.abs(_C(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||t!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const s=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),i=s-o;r>i&&(r=0)}return r}adjustHeaderBordersPosition(e){const t=this.wot.wtTable.holder.parentNode,r=this.wtSettings.getSetting("rowHeaders"),s=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?He(t,"emptyRows"):ee(t,"emptyRows");let i=!1;if(s&&!r.length)ee(t,"innerBorderLeft innerBorderInlineStart");else if(!s&&r.length){const l=Oe(t,"innerBorderInlineStart");e?(ee(t,"innerBorderLeft innerBorderInlineStart"),i=!l):(He(t,"innerBorderLeft innerBorderInlineStart"),i=l)}return i}}const $j="stickyRowsTop",qv={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const n=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),n)},getVisibleRowsCount(){return this.getRenderedRowsCount()}};qs(qv,"MIXIN_NAME",$j,{writable:!1,enumerable:!1});class Qv extends la{constructor(e,t,r,s){super(e,t,r,s,xi)}}at(Qv,qv);at(Qv,fg);function hT(n,e,t){return e=Bj(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Bj(n){var e=Wj(n,"string");return typeof e=="symbol"?e:String(e)}function Wj(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Uj extends vc{constructor(e,t,r,s,o,i){super(e,t,xi,r,s),hT(this,"topOverlay",void 0),hT(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=i}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new Qv(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();kv(e,`${s}px`,`${o}px`)}else ag(e);let t=_t(this.clone.wtTable.TABLE);const r=st(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${r}px`,!1}}class Zv extends la{constructor(e,t,r,s){super(e,t,r,s,Oi)}}at(Zv,qv);at(Zv,gg);function zj(n,e,t){return e=Yj(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Yj(n){var e=jj(n,"string");return typeof e=="symbol"?e:String(e)}function jj(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Gj extends vc{constructor(e,t,r,s){super(e,t,Oi,r,s),zj(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new Zv(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let s=0,o=!1;if(this.trimmingContainer===t&&(!r||r!=="vertical")){const{wtTable:l}=this.wot,a=l.hider.getBoundingClientRect(),u=Math.ceil(a.bottom),c=e.offsetHeight;o=u===c,s=this.getOverlayOffset(),kv(e,"0px",`${s}px`)}else s=this.getScrollPosition(),ag(e);const i=this.adjustHeaderBordersPosition(s,o);return this.adjustElementsSize(),i}setScrollPosition(e){const t=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(Yl(t),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const r=this.wtSettings.getSetting("defaultRowHeight");let s=e,o=0;for(;s<t;){const i=this.wot.wtTable.getRowHeight(s);o+=i===void 0?r:i,s+=1}return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:r}=this.domBindings,s=en(t),i=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||l==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=s),u=Math.min(u,e.wtRootElement.scrollWidth),i.width=`${u}px`}else i.width="";this.clone.wtTable.holder.style.width=i.width;let a=_t(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(a=0),i.height=`${a}px`}adjustRootChildrenSize(){var e;const{holder:t}=this.clone.wtTable,{selections:r}=this.wot,s=this.facadeGetter(),o=Math.abs((e=r==null?void 0:r.getCell().getBorder(s).cornerCenterPointOffset)!==null&&e!==void 0?e:0);this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=`${parseInt(t.parentNode.style.height,10)+o}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){const{wot:r,wtSettings:s}=this,i=(r.cloneSource?r.cloneSource:r).wtTable.holder;let l=this.getTableParentOffset(),a=0;if(t){const u=this.wot.wtTable.getRowHeight(e),c=this.wot.wtViewport.getViewportHeight();u>c&&(t=!1)}if(t&&i.offsetHeight!==i.clientHeight&&(a=en(this.domBindings.rootDocument)),t){const u=s.getSetting("fixedRowsBottom"),c=s.getSetting("totalRows");l+=this.sumCellSizes(0,e+1),l-=r.wtViewport.getViewportHeight()-this.sumCellSizes(c-u,c),l+=1}else l+=this.sumCellSizes(s.getSetting("fixedRowsTop"),e);return l+=a,this.setScrollPosition(l)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return ef(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const s=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),i=s-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>i&&(r=0)}return r}adjustHeaderBordersPosition(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?He(r,"emptyColumns"):ee(r,"emptyColumns");let o=!1;if(!t){const i=this.wtSettings.getSetting("fixedRowsTop"),l=this.cachedFixedRowsTop!==i,a=this.wtSettings.getSetting("columnHeaders");if((l||i===0)&&a.length>0){const u=Oe(r,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||this.wtSettings.getSetting("totalRows")===0?(ee(r,"innerBorderTop"),o=!u):(He(r,"innerBorderTop"),o=u)}}return o}}function ys(n,e,t){return e=Kj(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Kj(n){var e=Xj(n,"string");return typeof e=="symbol"?e:String(e)}function Xj(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class qj{constructor(e,t,r,s,o,i){ys(this,"wot",null),ys(this,"topOverlay",null),ys(this,"bottomOverlay",null),ys(this,"inlineStartOverlay",null),ys(this,"topInlineStartCornerOverlay",null),ys(this,"bottomInlineStartCornerOverlay",null),ys(this,"browserLineHeight",void 0),ys(this,"wtSettings",null),ys(this,"resizeObserver",new ResizeObserver(c=>{Uv(()=>{!Array.isArray(c)||!c.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=s,this.domBindings=r,this.facadeGetter=t,this.wtTable=i;const{rootDocument:l,rootWindow:a}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=en(l);const u=a.getComputedStyle(i.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?i.holder:tf(i.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=a.scrollX,this.lastScrollY=a.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){const{rootWindow:e,rootDocument:t}=this.domBindings,r=e.getComputedStyle(t.body),s=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=s||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new Gj(...e),this.bottomOverlay=new Lj(...e),this.inlineStartOverlay=new Vj(...e),this.topInlineStartCornerOverlay=new Uj(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new Pj(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:s}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",d=>this.onKeyDown(d)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",d=>this.onTableScroll(d),{passive:!0}),r!==s&&this.eventManager.addEventListener(s,"scroll",d=>this.onTableScroll(d),{passive:!0});const o=t.devicePixelRatio&&t.devicePixelRatio>1,i=this.scrollableElement===t,l=this.wtSettings.getSetting("preventWheel"),a={passive:i};(l||o||!ex())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",d=>this.onCloneWheel(d,l),a),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(d=>{if(d&&d.needFullRender){const{holder:f}=d.clone.wtTable;this.eventManager.addEventListener(f,"wheel",m=>this.onCloneWheel(m,l),a)}});let c;this.eventManager.addEventListener(t,"resize",()=>{clearTimeout(c),c=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),i||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const t=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(s!==t&&o!==t&&!e.target.contains(s)||r!==t&&o!==t&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,t){const{rootWindow:r}=this.domBindings,s=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,i=e.target,l=o!==r&&i!==r&&!i.contains(o),a=s!==r&&i!==r&&!i.contains(s);if(this.keyPressed&&(l||a))return;const u=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Gu(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,t+=t*this.browserLineHeight);const s=this.scrollVertically(t),o=this.scrollHorizontally(r);return s||o}scrollVertically(e){const t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){const t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,t=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[s,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=t.scrollLeft!==s||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=s;const i=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;i&&(i.scrollLeft=s)}this.verticalScrolling&&(r.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=tf(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,t=e.clientWidth,r=e.clientHeight,s=t!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return s&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=r),s}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtViewport:t}=this.wot,{wtTable:r}=this,s=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),i=t.getRowHeaderWidth(),l=t.getColumnHeaderHeight(),a=r.hider.style;if(a.width=`${i+this.inlineStartOverlay.sumCellSizes(0,s)}px`,a.height=`${l+this.topOverlay.sumCellSizes(0,o)+1}px`,this.scrollbarSize>0){const{scrollHeight:u,scrollWidth:c}=r.wtRootElement,{scrollHeight:d,scrollWidth:f}=r.holder;this.hasScrollbarRight=u<d,this.hasScrollbarBottom=c<f,this.hasScrollbarRight&&r.hider.scrollWidth+this.scrollbarSize>c?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&r.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return P(t,s=>{s&&s.clone&&s.clone.wtTable.TABLE.contains(e)&&(r=s.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];P(t,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function dT(n,e,t){return e=Qj(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Qj(n){var e=Zj(n,"string");return typeof e=="symbol"?e:String(e)}function Zj(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Jj{constructor(e){dT(this,"settings",{}),dT(this,"defaults",Object.freeze(this.getDefaults())),Be(this.defaults,(t,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(t===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=t}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,r)=>{const s=this.getSetting("data",e,t);Ti(r,s??"")},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}update(e,t){return t===void 0?Be(e,(r,s)=>{this.settings[s]=r}):this.settings[e]=t,this}getSetting(e,t,r,s,o){return typeof this.settings[e]=="function"?this.settings[e](t,r,s,o):t!==void 0&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class Jv extends la{constructor(e,t,r,s){super(e,t,r,s,"master")}alignOverlaysWithTrimmingContainer(){const e=jl(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,s=Yu(e,"height",t),o=Yu(e,"overflow",t),i=this.holder.style,{scrollWidth:l,scrollHeight:a}=e;let{width:u,height:c}=e.getBoundingClientRect();if(r&&["auto","hidden","scroll"].includes(o)){const f=e.cloneNode(!1);f.style.overflow="auto",f.style.position="absolute",e.nextElementSibling?r.insertBefore(f,e.nextElementSibling):r.appendChild(f);const m=parseInt(Mi(f,t).height,10);r.removeChild(f),m===0&&(c=0)}c=Math.min(c,a),i.height=s==="auto"?"auto":`${c}px`,u=Math.min(u,l),i.width=`${u}px`,i.overflow="",this.hasTableHeight=i.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=Uu(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!t.hasOversizedColumnHeadersMarked[r]){const l=e.getSetting("rowHeaders").length,a=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*l;c<a;c++)this.markIfOversizedColumnHeader(c);t.hasOversizedColumnHeadersMarked[r]=!0}}}at(Jv,Kv);at(Jv,gg);class e3{constructor(e,t,r,s,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=s,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return t===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=_t(t)>0&&t.clientHeight>0?t.clientHeight:1/0,r}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:t,rootWindow:r}=this.domBindings,s=this.dataAccessObject.inlineStartOverlayTrimmingContainer,o=t.documentElement.offsetWidth,i=e.getSetting("totalColumns"),l=e.getSetting("preventOverflow"),a=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),c=a?u.right-o:u.left,d=o-c;let f,m;if(l)return st(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?f=Math.min(d,o):f=Math.min(this.getContainerFillWidth(),d,o),s===r&&i>0&&this.sumColumnWidths(0,i-1)>f)return t.documentElement.clientWidth;if(s!==r&&(m=Yu(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",r),m==="scroll"||m==="hidden"||m==="auto"))return Math.max(f,s.clientWidth);const p=e.getSetting("stretchH");return p==="none"||!p?Math.max(f,st(this.wtTable.TABLE)):f}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,t){let r=0,s=e;for(;s<t;)r+=this.wtTable.getColumnWidth(s),s+=1;return r}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,t=this.domBindings.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);const r=t.offsetWidth;return this.containerWidth=r,e.removeChild(t),r}getWorkspaceOffset(){return Wt(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=_t(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,s=t.length;r<s;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let s=0,o=t.length;s<o;s++)r?(this.rowHeaderWidth+=st(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const t=this.getRowHeaderWidth();return t>0?e-t:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:li;const{wtSettings:t,wtTable:r}=this;let s,o,i;this.rowHeaderWidth=NaN,t.getSetting("renderAllRows")&&e===li?s=1/0:s=this.getViewportHeight();let l=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const a=t.getSetting("fixedRowsTop"),u=t.getSetting("fixedRowsBottom"),c=t.getSetting("totalRows");return a&&l>=0&&(i=this.dataAccessObject.topOverlay.sumCellSizes(0,a),l+=i,s-=i),u&&this.dataAccessObject.bottomOverlay.clone&&(i=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),s-=i),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=en(this.domBindings.rootDocument),new dg({viewportSize:s,scrollOffset:l,totalItems:t.getSetting("totalRows"),itemSizeFn:d=>r.getRowHeight(d),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,scrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:li;const{wtSettings:t,wtTable:r}=this;let s=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const i=t.getSetting("fixedColumnsStart");if(i&&o>=0){const l=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,i);o+=l,s-=l}return r.holder.clientWidth!==r.holder.offsetWidth&&(s-=en(this.domBindings.rootDocument)),new wc({viewportSize:s,scrollOffset:o,totalItems:t.getSetting("totalColumns"),itemSizeFn:l=>r.getColumnWidth(l),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:t.getSetting("stretchH"),stretchingItemWidthFn:(l,a)=>t.getSetting("onBeforeStretchingColumnWidth",l,a),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(t){const r=this.createRowsCalculator(mn),s=this.createColumnsCalculator(mn);this.areAllProposedVisibleRowsAlreadyRendered(r)&&this.areAllProposedVisibleColumnsAlreadyRendered(s)||(t=!1)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(li),this.columnsRenderCalculator=this.createColumnsCalculator(li)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(mn),this.columnsVisibleCalculator=this.createColumnsCalculator(mn)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;const{startRow:t,endRow:r,isVisibleInTrimmingContainer:s}=e;if(t===null&&r===null)return!s;const{startRow:o,endRow:i}=this.rowsRenderCalculator;return t<o||t===o&&t>0?!1:!(r>i||r===i&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;const{startColumn:t,endColumn:r,isVisibleInTrimmingContainer:s}=e;if(t===null&&r===null)return!s;const{startColumn:o,endColumn:i}=this.columnsRenderCalculator;return t<o||t===o&&t>0?!1:!(r>i||r===i&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Be(this.hasOversizedColumnHeadersMarked,(e,t,r)=>{r[t]=void 0})}}class t3 extends jv{constructor(e,t){super(e,new Jj(t));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new Jv(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new e3(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selections=this.wtSettings.getSetting("selections"),this.wtEvent=new vx(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selections),this.wtOverlays=new qj(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},t=[],r=[];Be(e,(s,o)=>{this.wtSettings.getSetting(o).length&&r.push(s),t.push(s)}),He(this.wtTable.wtRootElement.parentNode,t),ee(this.wtTable.wtRootElement.parentNode,r)}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class eS{constructor(e){e instanceof jv?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=t=>{const r=new eS(t);return()=>r},this._wot=new t3(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selections(){return this._wot.selections}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,r){return this._wot.createCellRange(e,t,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,t)}scrollViewport(e,t,r,s,o){return this._wot.scrollViewport(e,t,r,s,o)}scrollViewportHorizontally(e,t,r){return this._wot.scrollViewportHorizontally(e,t,r)}scrollViewportVertically(e,t,r){return this._wot.scrollViewportVertically(e,t,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,r,s,o){return this._wot.wtSettings.getSetting(e,t,r,s,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}class n3{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let t=0,r=this.main.childNodes.length;t<r;t++){const s=this.main.childNodes[t];this.eventManager.addEventListener(s,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),ds(e);const r=this,s=this.wot.rootDocument.body,o=t.getBoundingClientRect();t.style.display="none";function i(a){if(a.clientY<Math.floor(o.top)||a.clientY>Math.ceil(o.top+o.height)||a.clientX<Math.floor(o.left)||a.clientX>Math.ceil(o.left+o.width))return!0}function l(a){i(a)&&(r.eventManager.removeEventListener(s,"mousemove",l),t.style.display="block")}this.eventManager.addEventListener(s,"mousemove",l)}createBorders(e){const{rootDocument:t}=this.wot;this.main=t.createElement("div");const r=["top","start","bottom","end","corner"];let s=this.main.style;s.position="absolute",s.top=0,s.left=0;for(let l=0;l<5;l++){const a=r[l],u=t.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[a]&&this.settings[a].hide&&(u.className+=" hidden"),s=u.style,s.backgroundColor=this.settings[a]&&this.settings[a].color?this.settings[a].color:e.border.color,s.height=this.settings[a]&&this.settings[a].width?`${this.settings[a].width}px`:`${e.border.width}px`,s.width=this.settings[a]&&this.settings[a].width?`${this.settings[a].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),is()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let i=o.bordersHolder;i||(i=t.createElement("div"),i.className="htBorders",o.bordersHolder=i,o.spreader.appendChild(i)),i.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const t=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const s={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`};Be(s,(i,l)=>{this.selectionHandles.styles.bottomHitArea[l]=i,this.selectionHandles.styles.topHitArea[l]=i});const o={position:"absolute",height:`${t}px`,width:`${t}px`,"border-radius":`${parseInt(t/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Be(o,(i,l)=>{this.selectionHandles.styles.bottom[l]=i,this.selectionHandles.styles.top[l]=i}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){const r=this.wot.selections.createOrGetArea();return!!(r.cellRange&&(e!==r.cellRange.to.row||t!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,t,r,s,o,i){const a=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:d,bottomHitArea:f}=this.selectionHandles.styles,m=parseInt(u.borderWidth,10),p=parseInt(u.width,10),w=parseInt(c.width,10),M=this.wot.wtTable.getWidth(),S=this.wot.wtTable.getHeight();u.top=`${parseInt(r-p-1,10)}px`,u[a]=`${parseInt(s-p-1,10)}px`,c.top=`${parseInt(r-w/4*3,10)}px`,c[a]=`${parseInt(s-w/4*3,10)}px`;const y=Math.min(parseInt(s+o,10),M-p-m*2),v=Math.min(parseInt(s+o-w/4,10),M-w-m*2);d[a]=`${y}px`,f[a]=`${v}px`;const R=Math.min(parseInt(r+i,10),S-p-m*2),I=Math.min(parseInt(r+i-w/4,10),S-w-m*2);d.top=`${R}px`,f.top=`${I}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,t)?(d.display="none",f.display="none"):(d.display="block",f.display="block")):(u.display="none",d.display="none",c.display="none",f.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:t,rootDocument:r,rootWindow:s}=this.wot;let o,i,l,a,u,c;const d=t.getRenderedRowsCount();for(let E=0;E<d;E+=1){const h=t.rowFilter.renderedToSource(E);if(h>=e[0]&&h<=e[2]){o=h,u=e[0];break}}for(let E=d-1;E>=0;E-=1){const h=t.rowFilter.renderedToSource(E);if(h>=e[0]&&h<=e[2]){i=h;break}}const f=t.getRenderedColumnsCount();for(let E=0;E<f;E+=1){const h=t.columnFilter.renderedToSource(E);if(h>=e[1]&&h<=e[3]){l=h,c=e[1];break}}for(let E=f-1;E>=0;E-=1){const h=t.columnFilter.renderedToSource(E);if(h>=e[1]&&h<=e[3]){a=h;break}}if(o===void 0||l===void 0){this.disappear();return}let m=t.getCell(this.wot.createCellCoords(o,l));const p=o!==i||l!==a,w=p?t.getCell(this.wot.createCellCoords(i,a)):m,M=Wt(m),S=p?Wt(w):M,y=Wt(t.TABLE),v=st(t.TABLE),R=M.top,I=M.left,F=this.wot.wtSettings.getSetting("rtlMode");let L=0,j=0;if(F){const E=st(m),h=s.innerWidth-y.left-v;j=I+E-S.left,L=s.innerWidth-I-E-h-1}else j=S.left+st(w)-I,L=I-y.left-1;if(this.isEntireColumnSelected(o,i)){const E=this.getDimensionsFromHeader("columns",l,a,u,y);let h=null;E&&([h,L,j]=E),h&&(m=h)}let X=R-y.top-1,G=S.top+_t(w)-R;if(this.isEntireRowSelected(l,a)){const E=this.getDimensionsFromHeader("rows",o,i,c,y);let h=null;E&&([h,X,G]=E),h&&(m=h)}const te=Mi(m,s);parseInt(te.borderTopWidth,10)>0&&(X+=1,G=G>0?G-1:0),parseInt(te[F?"borderRightWidth":"borderLeftWidth"],10)>0&&(L+=1,j=j>0?j-1:0);const ie=F?"right":"left";this.topStyle.top=`${X}px`,this.topStyle[ie]=`${L}px`,this.topStyle.width=`${j}px`,this.topStyle.display="block",this.startStyle.top=`${X}px`,this.startStyle[ie]=`${L}px`,this.startStyle.height=`${G}px`,this.startStyle.display="block";const le=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${X+G-le}px`,this.bottomStyle[ie]=`${L}px`,this.bottomStyle.width=`${j}px`,this.bottomStyle.display="block",this.endStyle.top=`${X}px`,this.endStyle[ie]=`${L+j-le}px`,this.endStyle.height=`${G+1}px`,this.endStyle.display="block";let me=this.settings.border.cornerVisible;me=typeof me=="function"?me(this.settings.layerLevel):me;const Te=this.wot.getSetting("onModifyGetCellCoords",i,a);let[Ue,Me]=[i,a];if(Te&&Array.isArray(Te)&&([,,Ue,Me]=Te),is()||!me||this.isPartRange(Ue,Me))this.cornerStyle.display="none";else{this.cornerStyle.top=`${X+G+this.cornerCenterPointOffset-1}px`,this.cornerStyle[ie]=`${L+j+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let E=jl(t.TABLE);const h=E===s;h&&(E=r.documentElement);const g=parseInt(this.cornerDefaultStyle.width,10)/2,C=parseInt(this.cornerDefaultStyle.height,10)/2;if(a===this.wot.getSetting("totalColumns")-1){const _=h?w.getBoundingClientRect().left:w.offsetLeft;let O=!1,A=0;F?(A=_-parseInt(this.cornerDefaultStyle.width,10)/2,O=A<0):(A=_+st(w)+parseInt(this.cornerDefaultStyle.width,10)/2,O=A>=cd(E)),O&&(this.cornerStyle[ie]=`${Math.floor(L+j+this.cornerCenterPointOffset-g)}px`,this.cornerStyle[F?"borderLeftWidth":"borderRightWidth"]=0)}i===this.wot.getSetting("totalRows")-1&&(h?w.getBoundingClientRect().top:w.offsetTop)+_t(w)+parseInt(this.cornerDefaultStyle.height,10)/2>=yo(E)&&(this.cornerStyle.top=`${Math.floor(X+G+this.cornerCenterPointOffset-C)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}is()&&this.updateMultipleSelectionHandlesPosition(i,a,X,L,j,G)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,r,s,o){const{wtTable:i}=this.wot,l=i.wtRootElement.parentNode;let a=null,u=null,c=null,d=null,f=null,m=null,p=null,w=null;switch(e){case"rows":a=function(){return i.getRowHeader(...arguments)},u=function(){return _t(...arguments)},c="ht__selection--rows",m="top";break;case"columns":a=function(){return i.getColumnHeader(...arguments)},u=function(){return st(...arguments)},c="ht__selection--columns",m="left";break}if(l.classList.contains(c)){const M=this.wot.getSetting("columnHeaders").length;if(p=a(t,M-s),w=a(r,M-s),!p||!w)return!1;const S=Wt(p),y=Wt(w);return p&&w&&(d=S[m]-o[m]-1,f=y[m]+u(w)-S[m]),[p,d,f]}return!1}changeBorderStyle(e,t){const r=this[e].style,s=t[e];!s||s.hide?ee(this[e],"hidden"):(Oe(this[e],"hidden")&&He(this[e],"hidden"),r.backgroundColor=s.color,(e==="top"||e==="bottom")&&(r.height=`${s.width}px`),(e==="start"||e==="end")&&(r.width=`${s.width}px`))}changeBorderToDefaultStyle(e){const t={width:1,color:"#000"},r=this[e].style;r.backgroundColor=t.color,r.width=`${t.width}px`,r.height=`${t.width}px`}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?ee(this[e],"hidden"):He(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",is()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}let r3=class{constructor(e,t){this.settings=e,this.cellRange=t||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}getBorder(e){return this.instanceBorders[e.guid]||(this.instanceBorders[e.guid]=new n3(e,this.settings)),this.instanceBorders[e.guid]}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}addClassAtCoords(e,t,r,s){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;const i=e.wtTable.getCell(this.settings.createCellCoords(t,r));if(typeof i=="object"){let l=s;o&&(l=this.classNameGenerator(i),this.classNames.includes(l)||this.classNames.push(l)),ee(i,l)}return this}linearClassNameGenerator(e,t){return function r(s){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(t===0||o===0)return e;let i=o>=0?o:t,l=e;i-=1;const a=i===0?e:`${e}-${i}`;if(Oe(s,a)){const u=i+1;l=`${e}-${u}`}else l=r(s,i);return l}}draw(e){if(this.isEmpty()){this.settings.border&&this.getBorder(e).disappear();return}const t=e.wtTable.getRenderedRowsCount(),r=e.wtTable.getRenderedColumnsCount(),s=this.getCorners(),[o,i,l,a]=s,{highlightHeaderClassName:u,highlightColumnClassName:c,highlightRowClassName:d,highlightOnlyClosestHeader:f,selectionType:m}=this.settings,p=m===void 0||["active-header","header"].includes(m);if(p&&i!==null&&a!==null){let w=0;for(let M=0;M<r;M+=1){const S=e.wtTable.columnFilter.renderedToSource(M);if(S>=i&&S<=a){let y=e.wtTable.getColumnHeaders(S);const v=y.length-1;f&&y.length>1&&(y=[y[v]]);for(let R=0;R<y.length;R+=1){const I=[];let F=y[R];u&&I.push(u),c&&I.push(c),R=f?v:R;const L=e.getSetting("onBeforeHighlightingColumnHeader",S,R,{selectionType:m,columnCursor:w,selectionWidth:a-i+1,classNames:I});L!==S&&(F=e.wtTable.getColumnHeader(L,R)),ee(F,I)}w+=1}}}if(o!==null&&l!==null){let w=0;for(let M=0;M<t;M+=1){const S=e.wtTable.rowFilter.renderedToSource(M);if(p&&S>=o&&S<=l){let y=e.wtTable.getRowHeaders(S);const v=y.length-1;f&&y.length>1&&(y=[y[v]]);for(let R=0;R<y.length;R+=1){const I=[];let F=y[R];u&&I.push(u),d&&I.push(d),R=f?v:R;const L=e.getSetting("onBeforeHighlightingRowHeader",S,R,{selectionType:m,rowCursor:w,selectionHeight:l-o+1,classNames:I});L!==S&&(F=e.wtTable.getRowHeader(L,R)),ee(F,I)}w+=1}if(i!==null&&a!==null)for(let y=0;y<r;y+=1){const v=e.wtTable.columnFilter.renderedToSource(y);S>=o&&S<=l&&v>=i&&v<=a?this.settings.className&&this.addClassAtCoords(e,S,v,this.settings.className,this.settings.markIntersections):S>=o&&S<=l?d&&this.addClassAtCoords(e,S,v,d):v>=i&&v<=a&&c&&this.addClassAtCoords(e,S,v,c);const R=e.getSetting("onAfterDrawSelection",S,v,this.settings.layerLevel);typeof R=="string"&&this.addClassAtCoords(e,S,v,R)}}}e.getSetting("onBeforeDrawBorders",s,this.settings.className),this.settings.border&&this.getBorder(e).appear(s)}destroy(){Object.values(this.instanceBorders).forEach(e=>e.destroy())}};function fT(n){let{isShiftKey:e,isLeftClick:t,isRightClick:r,coords:s,selection:o,controller:i,cellCoordsFactory:l}=n;const a=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(e&&a)s.row>=0&&s.col>=0&&!i.cell?o.setRangeEnd(s):(u||c)&&s.row>=0&&s.col>=0&&!i.cell?o.setRangeEnd(l(s.row,s.col)):u&&s.row<0&&!i.column?o.setRangeEnd(l(a.to.row,s.col)):c&&s.col<0&&!i.row?o.setRangeEnd(l(s.row,a.to.col)):(!u&&!c&&s.col<0||u&&s.col<0)&&!i.row?o.selectRows(Math.max(a.from.row,0),s.row,s.col):(!u&&!c&&s.row<0||c&&s.row<0)&&!i.column&&o.selectColumns(Math.max(a.from.col,0),s.col,s.row);else{const d=!o.inInSelection(s),f=t||r&&d;s.row<0&&s.col>=0&&!i.column?f&&o.selectColumns(s.col,s.col,s.row):s.col<0&&s.row>=0&&!i.row?f&&o.selectRows(s.row,s.row,s.col):s.col>=0&&s.row>=0&&!i.cell?f&&o.setRangeStart(s):s.col<0&&s.row<0&&o.selectAll(!0,!0)}}function s3(n){let{isLeftClick:e,coords:t,selection:r,controller:s,cellCoordsFactory:o}=n;if(!e)return;const i=r.isSelectedByRowHeader(),l=r.isSelectedByColumnHeader(),a=r.tableProps.countCols(),u=r.tableProps.countRows();l&&!s.column?r.setRangeEnd(o(u-1,t.col)):i&&!s.row?r.setRangeEnd(o(t.row,a-1)):s.cell||r.setRangeEnd(t)}const o3=new Map([["mousedown",fT],["mouseover",s3],["touchstart",fT]]);function gT(n,e){let{coords:t,selection:r,controller:s,cellCoordsFactory:o}=e;o3.get(n.type)({coords:t,selection:r,controller:s,cellCoordsFactory:o,isShiftKey:n.shiftKey,isLeftClick:Vv(n)||n.type==="touchstart",isRightClick:_i(n)})}const bx=new WeakMap,tS=Symbol("rootInstance");function i3(n){bx.set(n,!0)}function l3(n){return n===tS}function FC(n){return bx.has(n)}function mT(n,e,t){a3(n,e),e.set(n,t)}function a3(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zs(n,e,t){return e=u3(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function u3(n){var e=c3(n,"string");return typeof e=="symbol"?e:String(e)}function c3(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function pT(n,e){var t=Ex(n,e,"get");return h3(n,t)}function h3(n,e){return e.get?e.get.call(n):e.value}function wT(n,e,t){var r=Ex(n,e,"set");return d3(n,r,t),t}function Ex(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function d3(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}const Ko=new WeakMap;var lp=new WeakMap,ap=new WeakMap;class f3{constructor(e){Zs(this,"instance",void 0),Zs(this,"eventManager",void 0),Zs(this,"settings",void 0),Zs(this,"THEAD",void 0),Zs(this,"TBODY",void 0),Zs(this,"_wt",void 0),Zs(this,"activeWt",void 0),mT(this,lp,{writable:!0,value:0}),mT(this,ap,{writable:!0,value:0}),Zs(this,"postponedAdjustElementsSize",!1),this.instance=e,this.eventManager=new It(this.instance),this.settings=this.instance.getSettings(),Ko.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,t){const r=this._wt.getCell(e,t);return r<0?null:r}scrollViewport(e,t,r,s,o){return this._wt.scrollViewport(e,t,r,s,o)}scrollViewportHorizontally(e,t,r){return this._wt.scrollViewportHorizontally(e,t,r)}scrollViewportVertically(e,t,r){return this._wt.scrollViewportVertically(e,t,r)}createElements(){const e=Ko.get(this),{rootElement:t,rootDocument:r}=this.instance,s=t.getAttribute("style");s&&t.setAttribute("data-originalstyle",s),ee(t,"handsontable"),e.table=r.createElement("TABLE"),ee(e.table,"htCore"),this.instance.getSettings().tableClassName&&ee(e.table,this.instance.getSettings().tableClassName),this.THEAD=r.createElement("THEAD"),e.table.appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),e.table.appendChild(this.TBODY),this.instance.table=e.table,this.instance.container.insertBefore(e.table,this.instance.container.firstChild)}registerEvents(){const e=Ko.get(this),{rootElement:t,rootDocument:r,selection:s}=this.instance,o=r.documentElement;this.eventManager.addEventListener(t,"mousedown",i=>{if(e.selectionMouseDown=!0,!this.isTextSelectionAllowed(i.target)){const{rootWindow:l}=this.instance;LE(l),i.preventDefault(),l.focus()}}),this.eventManager.addEventListener(t,"mouseup",()=>{e.selectionMouseDown=!1}),this.eventManager.addEventListener(t,"mousemove",i=>{e.selectionMouseDown&&!this.isTextSelectionAllowed(i.target)&&(this.settings.fragmentSelection&&LE(this.instance.rootWindow),i.preventDefault())}),this.eventManager.addEventListener(o,"keyup",i=>{s.isInProgress()&&!i.shiftKey&&s.finish()}),this.eventManager.addEventListener(o,"mouseup",i=>{s.isInProgress()&&Vv(i)&&s.finish(),e.mouseDown=!1,(Nv(r.activeElement)||!s.isSelected()&&!s.isSelectedByAnyHeader()&&!t.contains(i.target)&&!_i(i))&&this.instance.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",i=>{s.isInProgress()&&_i(i)&&(s.finish(),e.mouseDown=!1)}),this.eventManager.addEventListener(o,"touchend",()=>{s.isInProgress()&&s.finish(),e.mouseDown=!1}),this.eventManager.addEventListener(o,"mousedown",i=>{const l=i.target,a=i.x||i.clientX,u=i.y||i.clientY;let c=i.target;if(e.mouseDown||!t||!this.instance.view)return;const{holder:d}=this.instance.view._wt.wtTable;if(c===d){const m=en(r);if(r.elementFromPoint(a+m,u)!==d||r.elementFromPoint(a,u+m)!==d)return}else for(;c!==o;){if(c===null){if(i.isTargetWebComponent)break;return}if(c===t)return;c=c.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.instance.deselectCell():this.instance.destroyEditor(!1,!1)}),this.eventManager.addEventListener(e.table,"selectstart",i=>{this.settings.fragmentSelection||nf(i.target)||i.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:t,col:r}=e;return this.instance._createCellCoords(...this.translateFromRenderableToVisualIndex(t,r))}translateFromRenderableToVisualIndex(e,t){let r=e>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e,s=t>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;return r===null&&(r=e),s===null&&(s=t),[r,s]}countRenderableIndexes(e,t){const r=Math.min(e.getNotTrimmedIndexesLength(),t),s=e.getNearestNotHiddenIndex(r-1,-1);return s===null?0:e.getRenderableFromVisualIndex(s)+1}countRenderableColumns(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.instance.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.instance.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,r,s){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,t),i=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(i))return 0;let l=0;return t<0?l=i+1:t>0&&(l=s-i),l}countNotHiddenFixedColumnsStart(){const e=this.instance.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){const e=this.instance.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){const e=this.instance.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>e&&this.instance.countRenderedCols()>t}initializeWalkontable(){const e=Ko.get(this),t={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:e.table,isDataViewInstance:()=>FC(this.instance),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(i,l)=>this.instance.getDataAtCell(...this.translateFromRenderableToVisualIndex(i,l)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||t.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||t.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,rowHeaders:()=>{const i=[];return this.instance.hasRowHeaders()&&i.push((l,a)=>{const u=l>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(l):l;this.appendRowHeader(u,a)}),this.instance.runHooks("afterGetRowHeaderRenderers",i),wT(this,ap,i.length),i},columnHeaders:()=>{const i=[];return this.instance.hasColHeaders()&&i.push((l,a)=>{const u=l>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(l):l;this.appendColHeader(u,a)}),this.instance.runHooks("afterGetColumnHeaderRenderers",i),wT(this,lp,i.length),i},columnWidth:i=>{const l=this.instance.columnIndexMapper.getVisualFromRenderableIndex(i);return this.instance.getColWidth(l===null?i:l)},rowHeight:i=>{const l=this.instance.rowIndexMapper.getVisualFromRenderableIndex(i);return this.instance.getRowHeight(l===null?i:l)},cellRenderer:(i,l,a)=>{const[u,c]=this.translateFromRenderableToVisualIndex(i,l),d=this.instance.runHooks("modifyGetCellCoords",u,c);let f=u,m=c;Array.isArray(d)&&([f,m]=d);const p=this.instance.getCellMeta(f,m),w=this.instance.colToProp(m);let M=this.instance.getDataAtRowProp(f,w);this.instance.hasHook("beforeValueRender")&&(M=this.instance.runHooks("beforeValueRender",M,p)),this.instance.runHooks("beforeRenderer",a,u,c,w,M,p),this.instance.getCellRenderer(p)(this.instance,a,u,c,w,M,p),this.instance.runHooks("afterRenderer",a,u,c,w,M,p)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.instance&&!this.instance.isDestroyed&&this.instance.refreshDimensions()},onContainerElementResize:()=>{this.instance&&!this.instance.isDestroyed&&this.instance.refreshDimensions()},onCellMouseDown:(i,l,a,u)=>{const c=this.translateFromRenderableToVisualCoords(l),d={row:!1,column:!1,cell:!1};this.instance.listen(),this.activeWt=u,e.mouseDown=!0,this.instance.runHooks("beforeOnCellMouseDown",i,c,a,d),!dl(i)&&(gT(i,{coords:c,selection:this.instance.selection,controller:d,cellCoordsFactory:(f,m)=>this.instance._createCellCoords(f,m)}),this.instance.runHooks("afterOnCellMouseDown",i,c,a),this.activeWt=this._wt)},onCellContextMenu:(i,l,a,u)=>{const c=this.translateFromRenderableToVisualCoords(l);this.activeWt=u,e.mouseDown=!1,this.instance.selection.isInProgress()&&this.instance.selection.finish(),this.instance.runHooks("beforeOnCellContextMenu",i,c,a),!dl(i)&&(this.instance.runHooks("afterOnCellContextMenu",i,c,a),this.activeWt=this._wt)},onCellMouseOut:(i,l,a,u)=>{const c=this.translateFromRenderableToVisualCoords(l);this.activeWt=u,this.instance.runHooks("beforeOnCellMouseOut",i,c,a),!dl(i)&&(this.instance.runHooks("afterOnCellMouseOut",i,c,a),this.activeWt=this._wt)},onCellMouseOver:(i,l,a,u)=>{const c=this.translateFromRenderableToVisualCoords(l),d={row:!1,column:!1,cell:!1};this.activeWt=u,this.instance.runHooks("beforeOnCellMouseOver",i,c,a,d),!dl(i)&&(e.mouseDown&&gT(i,{coords:c,selection:this.instance.selection,controller:d,cellCoordsFactory:(f,m)=>this.instance._createCellCoords(f,m)}),this.instance.runHooks("afterOnCellMouseOver",i,c,a),this.activeWt=this._wt)},onCellMouseUp:(i,l,a,u)=>{const c=this.translateFromRenderableToVisualCoords(l);this.activeWt=u,this.instance.runHooks("beforeOnCellMouseUp",i,c,a),!(dl(i)||this.instance.isDestroyed)&&(this.instance.runHooks("afterOnCellMouseUp",i,c,a),this.activeWt=this._wt)},onCellCornerMouseDown:i=>{i.preventDefault(),this.instance.runHooks("afterOnCellCornerMouseDown",i)},onCellCornerDblClick:i=>{i.preventDefault(),this.instance.runHooks("afterOnCellCornerDblClick",i)},beforeDraw:(i,l)=>this.beforeRender(i,l),onDraw:i=>this.afterRender(i),onScrollVertically:()=>this.instance.runHooks("afterScrollVertically"),onScrollHorizontally:()=>this.instance.runHooks("afterScrollHorizontally"),onBeforeRemoveCellClassNames:()=>this.instance.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(i,l,a)=>{const u=this.instance.rowIndexMapper,c=u.getVisualFromRenderableIndex(i),d=this.instance.runHooks("beforeHighlightingRowHeader",c,l,a);return u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(d,1))},onBeforeHighlightingColumnHeader:(i,l,a)=>{const u=this.instance.columnIndexMapper,c=u.getVisualFromRenderableIndex(i),d=this.instance.runHooks("beforeHighlightingColumnHeader",c,l,a);return u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(d,1))},onAfterDrawSelection:(i,l,a)=>{let u;const[c,d]=this.translateFromRenderableToVisualIndex(i,l),f=this.instance.selection.getSelectedRange(),m=f.size();if(m>0){const p=(a??0)+1-m,w=f.peekByIndex(p);u=[w.from.row,w.from.col,w.to.row,w.to.col]}return this.instance.runHooks("afterDrawSelection",c,d,u,a)},onBeforeDrawBorders:(i,l)=>{const[a,u,c,d]=i,f=[this.instance.rowIndexMapper.getVisualFromRenderableIndex(a),this.instance.columnIndexMapper.getVisualFromRenderableIndex(u),this.instance.rowIndexMapper.getVisualFromRenderableIndex(c),this.instance.columnIndexMapper.getVisualFromRenderableIndex(d)];return this.instance.runHooks("beforeDrawBorders",f,l)},onBeforeTouchScroll:()=>this.instance.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.instance.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(i,l)=>{const a=this.instance.columnIndexMapper.getVisualFromRenderableIndex(l);return this.instance.runHooks("beforeStretchingColumnWidth",i,a)},onModifyRowHeaderWidth:i=>this.instance.runHooks("modifyRowHeaderWidth",i),onModifyGetCellCoords:(i,l,a)=>{const u=this.instance.rowIndexMapper,c=this.instance.columnIndexMapper,d=l>=0?c.getVisualFromRenderableIndex(l):l,f=i>=0?u.getVisualFromRenderableIndex(i):i,m=this.instance.runHooks("modifyGetCellCoords",f,d,a);if(Array.isArray(m)){const[p,w,M,S]=m;return[p>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(p,1)):p,w>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(w,1)):w,M>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(M,-1)):M,S>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(S,-1)):S]}},viewportRowCalculatorOverride:i=>{let l=this.settings.viewportRowRenderingOffset;if(l==="auto"&&this.settings.fixedRowsTop&&(l=10),l>0||l==="auto"){const a=this.countRenderableRows(),u=i.startRow,c=i.endRow;if(typeof l=="number")i.startRow=Math.max(u-l,0),i.endRow=Math.min(c+l,a-1);else if(l==="auto"){const d=Math.ceil(c/a*12);i.startRow=Math.max(u-d,0),i.endRow=Math.min(c+d,a-1)}}this.instance.runHooks("afterViewportRowCalculatorOverride",i)},viewportColumnCalculatorOverride:i=>{let l=this.settings.viewportColumnRenderingOffset;if(l==="auto"&&this.settings.fixedColumnsStart&&(l=10),l>0||l==="auto"){const a=this.countRenderableColumns(),u=i.startColumn,c=i.endColumn;if(typeof l=="number"&&(i.startColumn=Math.max(u-l,0),i.endColumn=Math.min(c+l,a-1)),l==="auto"){const d=Math.ceil(c/a*6);i.startColumn=Math.max(u-d,0),i.endColumn=Math.min(c+d,a-1)}}this.instance.runHooks("afterViewportColumnCalculatorOverride",i)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const i=this.instance.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||i}};this.instance.runHooks("beforeInitWalkontable",t),this._wt=new eS(t),this.activeWt=this._wt;const r=this._wt.wtTable.spreader,{width:s,height:o}=this.instance.rootElement.getBoundingClientRect();this.setLastSize(s,o),this.eventManager.addEventListener(r,"mousedown",i=>{i.target===r&&i.which===3&&i.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",i=>{i.target===r&&i.which===3&&i.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.instance.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(nf(e))return!0;const t=yi(e,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&t||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&t||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Ko.get(this).mouseDown}isSelectedOnlyCell(){var e,t;return(e=(t=this.instance.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.instance.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,t)}afterRender(e){e&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){const r=t.firstChild;if(!Oe(r,"relative")){hs(t),this.appendRowHeader(e,t);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{const{rootDocument:r,getRowHeader:s}=this.instance,o=r.createElement("div"),i=r.createElement("span");o.className="relative",i.className="rowHeader",this.updateCellHeader(i,e,s),o.appendChild(i),t.appendChild(o)}this.instance.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(t.firstChild){const o=t.firstChild;Oe(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),e,r,s):(hs(t),this.appendColHeader(e,t,r,s))}else{const{rootDocument:o}=this.instance,i=o.createElement("div"),l=o.createElement("span");i.className="relative",l.className="colHeader",this.updateCellHeader(l,e,r,s),i.appendChild(l),t.appendChild(i)}this.instance.runHooks("afterGetColHeader",e,t,s)}updateCellHeader(e,t,r){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=t;const i=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Oe(e,"colHeader")?o=i.wtTable.columnFilter.sourceToRendered(t):Oe(e,"rowHeader")&&(o=i.wtTable.rowFilter.sourceToRendered(t))),o>-1?ia(e,r(t,s)):(Ti(e," "),ee(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,t){const r=Ko.get(this);[r.lastWidth,r.lastHeight]=[e,t]}getLastSize(){const e=Ko.get(this);return{width:e.lastWidth,height:e.lastHeight}}getFirstFullyVisibleRow(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return pT(this,lp)}getRowHeadersCount(){return pT(this,ap)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}const g3="ABCDEFGHIJKLMNOPQRSTUVWXYZ",CT=g3.length;function m3(n){let e=n+1,t="",r;for(;e>0;)r=(e-1)%CT,t=String.fromCharCode(65+r)+t,e=parseInt((e-r)/CT,10);return t}function yT(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=n;const r=[];return(!Array.isArray(n)||!Array.isArray(n[0]))&&(t=[n]),t.forEach((s,o)=>{Array.isArray(s)?s.forEach((i,l)=>{r.push([o+e,l,i])}):Object.keys(s).forEach(i=>{r.push([o+e,i,s[i]])})}),r}function Tx(n){let e=0;return Array.isArray(n)&&(n[0]&&Array.isArray(n[0])?e=n[0].length:n[0]&&$e(n[0])&&(e=Fv(n[0]))),e}function p3(n){return!!(Array.isArray(n)&&n.length&&n.every(e=>Array.isArray(e)))}function w3(n){return!!(Array.isArray(n)&&n.length&&n.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}class C3{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.hot=e,this.data=t,this.dataType="array",this.colToProp=()=>{},this.propToCol=()=>{}}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),t!==void 0&&!Number.isInteger(t)?t:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const t=[];return P(this.data,(r,s)=>{const o=this.getAtCell(s,e);t.push(o)}),t}getAtRow(e,t,r){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=t===void 0&&r===void 0;let i=null,l=null;if(i=this.modifyRowData(e),Array.isArray(i))l=[],o?i.forEach((a,u)=>{l[u]=this.getAtPhysicalCell(e,u,i)}):Ce(t,r,a=>{l[a-t]=this.getAtPhysicalCell(e,a,i)});else if($e(i)||ut(i))if(s?l=[]:l={},!o||s){const u=this.countFirstRowKeys()-1;Ce(0,u,c=>{const d=this.colToProp(c);if(c>=(t||0)&&c<=(r||u)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,i);s?l.push(f):Jm(l,d,f)}})}else Be(i,(a,u)=>{Jm(l,u,this.getAtPhysicalCell(e,u,i))});return l}setAtCell(e,t,r){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const s=Gl(r);this.hot.runHooks("modifySourceData",e,t,s,"set"),s.isTouched()&&(r=s.value)}Number.isInteger(t)?this.data[e][t]=r:Jm(this.data[e],t,r)}}getAtPhysicalCell(e,t,r){let s=null;if(r&&(typeof t=="string"?s=Pz(r,t):typeof t=="function"?s=t(r):s=r[t]),this.hot.hasHook("modifySourceData")){const o=Gl(s);this.hot.runHooks("modifySourceData",e,t,o,"get"),o.isTouched()&&(s=o.value)}return s}getAtCell(e,t){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=!1,o=null,i=null,l=null,a=null;e===null||t===null?(s=!0,o=0,l=this.countRows()-1):(o=Math.min(e.row,t.row),i=Math.min(e.col,t.col),l=Math.max(e.row,t.row),a=Math.max(e.col,t.col));const u=[];return Ce(o,l,c=>{u.push(s?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,i,a,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return Tx(this.data)}destroy(){this.data=null,this.hot=null}}const y3="localHooks",An={_localHooks:Object.create(null),addLocalHook(n,e){return this._localHooks[n]||(this._localHooks[n]=[]),this._localHooks[n].push(e),this},runLocalHooks(n,e,t,r,s,o,i){if(this._localHooks[n]){const l=this._localHooks[n].length;for(let a=0;a<l;a++)OC(this._localHooks[n][a],this,e,t,r,s,o,i)}},clearLocalHooks(){return this._localHooks={},this}};qs(An,"MIXIN_NAME",y3,{writable:!1,enumerable:!1});class Fi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.indexedValues=[],this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length?(this.indexedValues[e]=t,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,ut(this.initValueOrFn)?Ce(e-1,t=>this.indexedValues.push(this.initValueOrFn(t))):Ce(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}at(Fi,An);function nS(n,e,t,r){const s=t.length?t[0]:void 0;return[...n.slice(0,s),...t.map((o,i)=>ut(r)?r(o,i):r),...s===void 0?[]:n.slice(s)]}function rS(n,e){return yr(n,(t,r)=>e.includes(r)===!1)}class $o extends Fi{insert(e,t){this.indexedValues=nS(this.indexedValues,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=rS(this.indexedValues,e),super.remove(e)}}class mg extends $o{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Sn(this.getValues(),(e,t,r)=>(t&&e.push(r),e),[])}}function sS(n,e,t){return[...n.slice(0,e),...t,...n.slice(e)]}function Ku(n,e){return yr(n,t=>e.includes(t)===!1)}function oS(n,e){return Ve(n,t=>t-e.filter(r=>r<t).length)}function iS(n,e){const t=e[0],r=e.length;return Ve(n,s=>s>=t?s+r:s)}function v3(n,e,t){return e=S3(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function S3(n){var e=R3(n,"string");return typeof e=="symbol"?e:String(e)}function R3(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class pg extends Fi{constructor(){super(...arguments),v3(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=t,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Ku(this.orderOfIndexes,[e]),ut(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=nS(this.indexedValues,e,t,this.initValueOrFn),this.orderOfIndexes=iS(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=rS(this.indexedValues,e),this.orderOfIndexes=Ku(this.orderOfIndexes,e),this.orderOfIndexes=oS(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Sc extends $o{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Sn(this.getValues(),(e,t,r)=>(t&&e.push(r),e),[])}}const vT=new Map([["indexesSequence",{getListWithInsertedItems:sS,getListWithRemovedItems:Ku}],["physicallyIndexed",{getListWithInsertedItems:nS,getListWithRemovedItems:rS}]]),Mx=n=>{if(vT.has(n)===!1)throw new Error(`Alter strategy with ID '${n}' does not exist.`);return vT.get(n)};class _x extends Fi{constructor(){super(e=>e)}insert(e,t){const r=iS(this.indexedValues,t);this.indexedValues=sS(r,e,t),super.insert(e,t)}remove(e){const t=Ku(this.indexedValues,e);this.indexedValues=oS(t,e),super.remove(e)}}const ST=new Map([["hiding",mg],["index",Fi],["linkedPhysicalIndexToValue",pg],["physicalIndexToValue",$o],["trimming",Sc]]);function b3(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!ST.has(n))throw new Error(`The provided map type ("${n}") does not exist.`);return new(ST.get(n))(e)}class lS{constructor(){this.collection=new Map}register(e,t){this.collection.has(e)===!1&&(this.collection.set(e,t),t.addLocalHook("change",()=>this.runLocalHooks("change",t)))}unregister(e){const t=this.collection.get(e);ue(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t))}unregisterAll(){this.collection.forEach((e,t)=>this.unregister(t)),this.collection.clear()}get(e){return dt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(t=>{t.remove(e)})}insertToEvery(e,t){this.collection.forEach(r=>{r.insert(e,t)})}initEvery(e){this.collection.forEach(t=>{t.init(e)})}}at(lS,An);class RT extends lS{constructor(e,t){super(),this.mergedValuesCache=[],this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const t=Ve(this.get(),o=>o.getValues()),r=[],s=ue(t[0])&&t[0].length||0;for(let o=0;o<s;o+=1){const i=[];for(let l=0;l<this.getLength();l+=1)i.push(t[l][o]);r.push(i)}return Ve(r,this.aggregationFunction)}getMergedValueAtIndex(e,t){const r=this.getMergedValues(t)[e];return ue(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function E3(n,e,t){T3(n,e),e.set(n,t)}function T3(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function M3(n,e,t){var r=Ox(n,e,"set");return _3(n,r,t),t}function _3(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function O3(n,e){var t=Ox(n,e,"get");return I3(n,t)}function Ox(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function I3(n,e){return e.get?e.get.call(n):e.value}var up=new WeakMap;class Ix{constructor(){E3(this,up,{writable:!0,value:[]})}subscribe(e){return this.addLocalHook("change",e),this._write(O3(this,up)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){M3(this,up,e)}}at(Ix,An);function bT(n,e){const t=[];let r=0,s=0;for(;r<n.length&&s<e.length;r++,s++)n[r]!==e[s]&&t.push({op:"replace",index:s,oldValue:n[r],newValue:e[s]});for(;r<e.length;r++)t.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;s<n.length;s++)t.push({op:"remove",index:s,oldValue:n[s],newValue:void 0});return t}function Ia(n,e,t){x3(n,e),e.set(n,t)}function x3(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ir(n,e){var t=xx(n,e,"get");return A3(n,t)}function A3(n,e){return e.get?e.get.call(n):e.value}function ah(n,e,t){var r=xx(n,e,"set");return P3(n,r,t),t}function xx(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function P3(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var uh=new WeakMap,xa=new WeakMap,ch=new WeakMap,hh=new WeakMap,dh=new WeakMap;class H3{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ia(this,uh,{writable:!0,value:new Set}),Ia(this,xa,{writable:!0,value:[]}),Ia(this,ch,{writable:!0,value:[]}),Ia(this,hh,{writable:!0,value:!1}),Ia(this,dh,{writable:!0,value:!1}),ah(this,dh,e??!1)}createObserver(){const e=new Ix;return ir(this,uh).add(e),e.addLocalHook("unsubscribe",()=>{ir(this,uh).delete(e)}),e._writeInitialChanges(bT(ir(this,xa),ir(this,ch))),e}emit(e){let t=ir(this,ch);(!ir(this,hh)||ir(this,xa).length!==e.length)&&(e.length===0?e=new Array(t.length).fill(ir(this,dh)):ah(this,xa,new Array(e.length).fill(ir(this,dh))),ir(this,hh)||(ah(this,hh,!0),t=ir(this,xa)));const r=bT(t,e);ir(this,uh).forEach(s=>s._write(r)),ah(this,ch,e)}}class VC{constructor(){this.indexesSequence=new _x,this.trimmingMapsCollection=new RT(e=>e.some(t=>t===!0),!1),this.hidingMapsCollection=new RT(e=>e.some(t=>t===!0),!1),this.variousMapsCollection=new lS,this.hidingChangesObservable=new H3({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,r){return this.registerMap(e,b3(t,r))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof Sc?this.trimmingMapsCollection.register(e,t):t instanceof mg?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);const r=this.getNumberOfIndexes();return r>0&&t.init(r),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const t=this.notTrimmedIndexesCache[e];return ue(t)?t:null}getPhysicalFromRenderableIndex(e){const t=this.renderablePhysicalIndexesCache[e];return ue(t)?t:null}getVisualFromPhysicalIndex(e){const t=this.fromPhysicalToVisualIndexesCache.get(e);return ue(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const t=this.fromVisualToRenderableIndexesCache.get(e);return ue(t)?t:null}getNearestNotHiddenIndex(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let i=-1;return t>0?i=o.findIndex(l=>l>e):i=o.reverse().findIndex(l=>l<e),i===-1?r?this.getNearestNotHiddenIndex(e,-t,!1):null:o[i]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const t=this.getNumberOfIndexes();if(e<t){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(s=>s+e);this.removeIndexes(r)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){typeof e=="number"&&(e=[e]);const r=Ve(e,u=>this.getPhysicalFromVisualIndex(u)),s=this.getNotTrimmedIndexesLength(),o=e.length,i=Ku(this.getIndexesSequence(),r),l=i.filter(u=>this.isTrimmed(u)===!1);let a=i.indexOf(l[l.length-1])+1;if(t+o<s){const u=l[t];a=i.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(sS(i,a,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){const r=this.getNotTrimmedIndexes()[e],s=ue(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),i=Ve(new Array(t).fill(s),(l,a)=>l+a);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,i),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,i),this.hidingMapsCollection.insertToEvery(o,i),this.variousMapsCollection.insertToEvery(o,i),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&t===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){const r=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(r,t)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){const r=this.getPhysicalFromRenderableIndex(t),s=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(s,t)}}}at(VC,An);function D3(n,e){return Be(e,(t,r)=>{dt(n[r])&&(n[r]=t)}),n}function Ax(n){const t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(n);return t?`${t[1].toLowerCase()}-${t[2].toUpperCase()}`:n}function Px(n){ue(n)&&$v(ot`Language with code "${n}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function k3(n,e){return Array.isArray(n)&&Number.isInteger(e)?n[e]:n}const{register:N3,getValues:L3}=br("phraseFormatters");function F3(n,e){N3(n,e)}function V3(){return L3()}F3("pluralize",k3);const Hx="ContextMenu:items",De=Hx,aS=`${De}.noItems`,uS=`${De}.insertRowAbove`,cS=`${De}.insertRowBelow`,hS=`${De}.insertColumnOnTheLeft`,dS=`${De}.insertColumnOnTheRight`,fS=`${De}.removeRow`,gS=`${De}.removeColumn`,mS=`${De}.undo`,pS=`${De}.redo`,wS=`${De}.readOnly`,CS=`${De}.clearColumn`,yS=`${De}.copy`,vS=`${De}.copyWithHeaders`,SS=`${De}.copyWithGroupHeaders`,RS=`${De}.copyHeadersOnly`,bS=`${De}.cut`,ES=`${De}.freezeColumn`,TS=`${De}.unfreezeColumn`,MS=`${De}.mergeCells`,_S=`${De}.unmergeCells`,OS=`${De}.addComment`,IS=`${De}.editComment`,xS=`${De}.removeComment`,AS=`${De}.readOnlyComment`,PS=`${De}.align`,HS=`${De}.align.left`,DS=`${De}.align.center`,kS=`${De}.align.right`,NS=`${De}.align.justify`,LS=`${De}.align.top`,FS=`${De}.align.middle`,VS=`${De}.align.bottom`,$S=`${De}.borders`,BS=`${De}.borders.top`,WS=`${De}.borders.right`,US=`${De}.borders.bottom`,zS=`${De}.borders.left`,YS=`${De}.borders.remove`,jS=`${De}.nestedHeaders.insertChildRow`,GS=`${De}.nestedHeaders.detachFromParent`,KS=`${De}.hideColumn`,XS=`${De}.showColumn`,qS=`${De}.hideRow`,QS=`${De}.showRow`,Pn="Filters:",xt=`${Pn}conditions`,wg=`${xt}.none`,ZS=`${xt}.isEmpty`,JS=`${xt}.isNotEmpty`,e0=`${xt}.isEqualTo`,t0=`${xt}.isNotEqualTo`,n0=`${xt}.beginsWith`,r0=`${xt}.endsWith`,s0=`${xt}.contains`,o0=`${xt}.doesNotContain`,$3=`${xt}.byValue`,i0=`${xt}.greaterThan`,l0=`${xt}.greaterThanOrEqualTo`,a0=`${xt}.lessThan`,u0=`${xt}.lessThanOrEqualTo`,c0=`${xt}.isBetween`,h0=`${xt}.isNotBetween`,d0=`${xt}.after`,f0=`${xt}.before`,g0=`${xt}.today`,m0=`${xt}.tomorrow`,p0=`${xt}.yesterday`,w0=`${Pn}labels.filterByCondition`,C0=`${Pn}labels.filterByValue`,y0=`${Pn}labels.conjunction`,Cg=`${Pn}labels.disjunction`,lf=`${Pn}values.blankCells`,v0=`${Pn}buttons.selectAll`,S0=`${Pn}buttons.clear`,R0=`${Pn}buttons.ok`,b0=`${Pn}buttons.cancel`,E0=`${Pn}buttons.placeholder.search`,T0=`${Pn}buttons.placeholder.value`,M0=`${Pn}buttons.placeholder.secondValue`,B3=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:OS,CONTEXTMENU_ITEMS_ALIGNMENT:PS,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:VS,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:DS,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:NS,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:HS,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:FS,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:kS,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:LS,CONTEXTMENU_ITEMS_BORDERS:$S,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:US,CONTEXTMENU_ITEMS_BORDERS_LEFT:zS,CONTEXTMENU_ITEMS_BORDERS_RIGHT:WS,CONTEXTMENU_ITEMS_BORDERS_TOP:BS,CONTEXTMENU_ITEMS_CLEAR_COLUMN:CS,CONTEXTMENU_ITEMS_COPY:yS,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:RS,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:SS,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:vS,CONTEXTMENU_ITEMS_CUT:bS,CONTEXTMENU_ITEMS_EDIT_COMMENT:IS,CONTEXTMENU_ITEMS_FREEZE_COLUMN:ES,CONTEXTMENU_ITEMS_HIDE_COLUMN:KS,CONTEXTMENU_ITEMS_HIDE_ROW:qS,CONTEXTMENU_ITEMS_INSERT_LEFT:hS,CONTEXTMENU_ITEMS_INSERT_RIGHT:dS,CONTEXTMENU_ITEMS_MERGE_CELLS:MS,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:GS,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:jS,CONTEXTMENU_ITEMS_NO_ITEMS:aS,CONTEXTMENU_ITEMS_READ_ONLY:wS,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:AS,CONTEXTMENU_ITEMS_REDO:pS,CONTEXTMENU_ITEMS_REMOVE_BORDERS:YS,CONTEXTMENU_ITEMS_REMOVE_COLUMN:gS,CONTEXTMENU_ITEMS_REMOVE_COMMENT:xS,CONTEXTMENU_ITEMS_REMOVE_ROW:fS,CONTEXTMENU_ITEMS_ROW_ABOVE:uS,CONTEXTMENU_ITEMS_ROW_BELOW:cS,CONTEXTMENU_ITEMS_SHOW_COLUMN:XS,CONTEXTMENU_ITEMS_SHOW_ROW:QS,CONTEXTMENU_ITEMS_UNDO:mS,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:TS,CONTEXTMENU_ITEMS_UNMERGE_CELLS:_S,CONTEXT_MENU_ITEMS_NAMESPACE:Hx,FILTERS_BUTTONS_CANCEL:b0,FILTERS_BUTTONS_CLEAR:S0,FILTERS_BUTTONS_OK:R0,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:E0,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:M0,FILTERS_BUTTONS_PLACEHOLDER_VALUE:T0,FILTERS_BUTTONS_SELECT_ALL:v0,FILTERS_CONDITIONS_AFTER:d0,FILTERS_CONDITIONS_BEFORE:f0,FILTERS_CONDITIONS_BEGINS_WITH:n0,FILTERS_CONDITIONS_BETWEEN:c0,FILTERS_CONDITIONS_BY_VALUE:$3,FILTERS_CONDITIONS_CONTAINS:s0,FILTERS_CONDITIONS_EMPTY:ZS,FILTERS_CONDITIONS_ENDS_WITH:r0,FILTERS_CONDITIONS_EQUAL:e0,FILTERS_CONDITIONS_GREATER_THAN:i0,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:l0,FILTERS_CONDITIONS_LESS_THAN:a0,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:u0,FILTERS_CONDITIONS_NAMESPACE:xt,FILTERS_CONDITIONS_NONE:wg,FILTERS_CONDITIONS_NOT_BETWEEN:h0,FILTERS_CONDITIONS_NOT_CONTAIN:o0,FILTERS_CONDITIONS_NOT_EMPTY:JS,FILTERS_CONDITIONS_NOT_EQUAL:t0,FILTERS_CONDITIONS_TODAY:g0,FILTERS_CONDITIONS_TOMORROW:m0,FILTERS_CONDITIONS_YESTERDAY:p0,FILTERS_DIVS_FILTER_BY_CONDITION:w0,FILTERS_DIVS_FILTER_BY_VALUE:C0,FILTERS_LABELS_CONJUNCTION:y0,FILTERS_LABELS_DISJUNCTION:Cg,FILTERS_NAMESPACE:Pn,FILTERS_VALUES_BLANK_CELLS:lf},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const Dx={languageCode:"en-US",[aS]:"No available options",[uS]:"Insert row above",[cS]:"Insert row below",[hS]:"Insert column left",[dS]:"Insert column right",[fS]:["Remove row","Remove rows"],[gS]:["Remove column","Remove columns"],[mS]:"Undo",[pS]:"Redo",[wS]:"Read only",[CS]:"Clear column",[PS]:"Alignment",[HS]:"Left",[DS]:"Center",[kS]:"Right",[NS]:"Justify",[LS]:"Top",[FS]:"Middle",[VS]:"Bottom",[ES]:"Freeze column",[TS]:"Unfreeze column",[$S]:"Borders",[BS]:"Top",[WS]:"Right",[US]:"Bottom",[zS]:"Left",[YS]:"Remove border(s)",[OS]:"Add comment",[IS]:"Edit comment",[xS]:"Delete comment",[AS]:"Read-only comment",[MS]:"Merge cells",[_S]:"Unmerge cells",[yS]:"Copy",[vS]:["Copy with header","Copy with headers"],[SS]:["Copy with group header","Copy with group headers"],[RS]:["Copy header only","Copy headers only"],[bS]:"Cut",[jS]:"Insert child row",[GS]:"Detach from parent",[KS]:["Hide column","Hide columns"],[XS]:["Show column","Show columns"],[qS]:["Hide row","Hide rows"],[QS]:["Show row","Show rows"],[wg]:"None",[ZS]:"Is empty",[JS]:"Is not empty",[e0]:"Is equal to",[t0]:"Is not equal to",[n0]:"Begins with",[r0]:"Ends with",[s0]:"Contains",[o0]:"Does not contain",[i0]:"Greater than",[l0]:"Greater than or equal to",[a0]:"Less than",[u0]:"Less than or equal to",[c0]:"Is between",[h0]:"Is not between",[d0]:"After",[f0]:"Before",[g0]:"Today",[m0]:"Tomorrow",[p0]:"Yesterday",[lf]:"Blank cells",[w0]:"Filter by condition",[C0]:"Filter by value",[y0]:"And",[Cg]:"Or",[v0]:"Select all",[S0]:"Clear",[R0]:"OK",[b0]:"Cancel",[E0]:"Search",[T0]:"Value",[M0]:"Second value"},W3=B3,$C=Dx.languageCode,{register:U3,getItem:kx,hasItem:z3,getValues:Y3}=br("languagesDictionaries");Nx(Dx);function Nx(n,e){let t=n,r=e;return $e(n)&&(r=n,t=r.languageCode),j3(t,r),U3(t,_n(r)),_n(r)}function j3(n,e){n!==$C&&D3(e,kx($C))}function Lx(n){return _0(n)?_n(kx(n)):null}function _0(n){return z3(n)}function G3(){return Y3()}function Fx(n,e,t){const r=Lx(n);if(r===null)return null;const s=r[e];if(dt(s))return null;const o=K3(s,t);return Array.isArray(o)?o[0]:o}function K3(n,e){let t=n;return P(V3(),r=>{t=r(n,e)}),t}function X3(n){let e=Ax(n);return _0(e)||(e=$C,Px(n)),e}const yg="active-header",vg="area",Xu="cell",O0="fill",Rc="header",I0="custom-selection";function q3(n,e,t){return e=Q3(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Q3(n){var e=Z3(n,"string");return typeof e=="symbol"?e:String(e)}function Z3(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class aa extends r3{constructor(e,t){super(e,null),q3(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:r}=e,s=this.getNearestNotHiddenCoords(t,1),o=this.getNearestNotHiddenCoords(r,-1);if(s===null||o===null)return null;if(s.row>o.row||s.col>o.col){if(!(this.settings.type==="header"||this.settings.type==="active-header"))return null;s=t,o=r}return this.settings.createCellRange(s,s,o)}getNearestNotHiddenCoords(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const s=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),e.row,t);if(s===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),e.col,r);return o===null?null:this.settings.createCellCoords(s,o)}getNearestNotHiddenIndex(e,t,r){if(t<0)return t;const s=e.getNearestNotHiddenIndex(t,r);return(this.settings.type==="header"||this.settings.type==="active-header")&&s===null?-1:s}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const t=e.getVerticalDirection()==="N-S"?1:-1,r=e.getHorizontalDirection()==="W-E"?1:-1,s=this.getNearestNotHiddenCoords(e.from.clone().normalize(),t,r);if(s!==null&&e.overlaps(s)){if(this.cellRange===null){const o=this.settings.visualToRenderableCoords(s);this.cellRange=this.settings.createCellRange(o)}return e.setHighlight(s),this}return e.setHighlight(e.from),this}getCorners(){const{from:e,to:t}=this.cellRange,r=e.row===null||t.row===null,s=e.col===null||t.col===null,o=this.settings.createCellCoords(r?null:Math.min(e.row,t.row),s?null:Math.min(e.col,t.col)),i=this.settings.createCellCoords(r?null:Math.max(e.row,t.row),s?null:Math.max(e.col,t.col));return[o.row,o.col,i.row,i.col]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){const r=this.settings.visualToRenderableCoords(e),s=this.settings.visualToRenderableCoords(t);return this.settings.createCellRange(r,r,s)}}function J3(n){let{activeHeaderClassName:e,...t}=n;return new aa({highlightHeaderClassName:e,...t,selectionType:yg})}function eG(n){let{layerLevel:e,areaCornerVisible:t,...r}=n;return new aa({className:"area",markIntersections:!0,layerLevel:Math.min(e,7),border:{width:1,color:"#4b89ff",cornerVisible:t},...r,selectionType:vg})}function tG(n){let{cellCornerVisible:e,...t}=n;return new aa({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e},...t,selectionType:Xu})}function nG(n){let{border:e,visualCellRange:t,...r}=n;return new aa({...e,...r,selectionType:I0},t)}function rG(n){let{...e}=n;return new aa({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:O0})}function sG(n){let{headerClassName:e,rowClassName:t,columnClassName:r,...s}=n;return new aa({className:"highlight",highlightHeaderClassName:e,highlightRowClassName:t,highlightColumnClassName:r,...s,highlightOnlyClosestHeader:!0,selectionType:Rc})}const{register:ua,getItem:oG}=br("highlight/types");ua(yg,J3);ua(vg,eG);ua(Xu,tG);ua(I0,nG);ua(O0,rG);ua(Rc,sG);function Xi(n,e){return oG(n)({type:n,...e})}class iG{constructor(e){this.options=e,this.layerLevel=0,this.cell=Xi(Xu,e),this.fill=Xi(O0,e),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}isEnabledFor(e,t){let r=e;e===Xu&&(r="current");let s=this.options.disabledCellSelection(t.row,t.col);return typeof s=="string"&&(s=[s]),s===!1||Array.isArray(s)&&!s.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getCell(){return this.cell}getFill(){return this.fill}createOrGetArea(){const e=this.layerLevel;let t;return this.areas.has(e)?t=this.areas.get(e):(t=Xi(vg,{layerLevel:e,...this.options}),this.areas.set(e,t)),t}getAreas(){return[...this.areas.values()]}createOrGetHeader(){const e=this.layerLevel;let t;return this.headers.has(e)?t=this.headers.get(e):(t=Xi(Rc,{...this.options}),this.headers.set(e,t)),t}getHeaders(){return[...this.headers.values()]}createOrGetActiveHeader(){const e=this.layerLevel;let t;return this.activeHeaders.has(e)?t=this.activeHeaders.get(e):(t=Xi(yg,{...this.options}),this.activeHeaders.set(e,t)),t}getActiveHeaders(){return[...this.activeHeaders.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(Xi(I0,{...this.options,...e}))}clear(){this.cell.clear(),this.fill.clear(),P(this.areas.values(),e=>void e.clear()),P(this.headers.values(),e=>void e.clear()),P(this.activeHeaders.values(),e=>void e.clear())}[Symbol.iterator](){return[this.cell,this.fill,...this.areas.values(),...this.headers.values(),...this.activeHeaders.values(),...this.customSelections][Symbol.iterator]()}}class lG{constructor(e){this.ranges=[],this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(0)}previous(){return this.peekByIndex(-1)}includes(e){return this.ranges.some(t=>t.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const t=this.size()+e-1;let r;return t>=0&&(r=this.ranges[t]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}class Vx{constructor(e,t){this.range=e,this.options=t}transformStart(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=this.options.createCellCoords(e,t),o=this.range.current().highlight,{row:i,col:l}=this.options.visualToRenderableCoords(o);let a=o,u=0,c=0;if(this.runLocalHooks("beforeTransformStart",s),i!==null&&l!==null){let d=this.options.countRows(),f=this.options.countCols();const m=this.options.fixedRowsBottom(),p=this.options.minSpareRows(),w=this.options.minSpareCols(),M=this.options.autoWrapRow(),S=this.options.autoWrapCol();i+e>d-1?r&&p>0&&!(m&&i>=d-m-1)?(this.runLocalHooks("insertRowRequire",d),d=this.options.countRows()):S&&(s.row=1-d,s.col=l+s.col===f-1?1-f:1):S&&i+s.row<0&&l+s.col>=0&&(s.row=d-1,s.col=l+s.col===0?f-1:-1),l+s.col>f-1?r&&w>0?(this.runLocalHooks("insertColRequire",f),f=this.options.countCols()):M&&(s.row=i+s.row===d-1?1-d:1,s.col=1-f):M&&l+s.col<0&&i+s.row>=0&&(s.row=i+s.row===0?d-1:-1,s.col=f-1);const y=this.options.createCellCoords(i+s.row,l+s.col);u=0,c=0,y.row<0?(u=-1,y.row=0):y.row>0&&y.row>=d&&(u=1,y.row=d-1),y.col<0?(c=-1,y.col=0):y.col>0&&y.col>=f&&(c=1,y.col=f-1),a=this.options.renderableToVisualCoords(y)}return this.runLocalHooks("afterTransformStart",a,u,c),a}transformEnd(e,t){const r=this.options.createCellCoords(e,t),s=this.range.current();let o=s.to,i=0,l=0;this.runLocalHooks("beforeTransformEnd",r);const{row:a,col:u}=this.options.visualToRenderableCoords(s.highlight);if(a!==null&&u!==null){const c=this.options.countRows(),d=this.options.countCols(),{row:f,col:m}=this.options.visualToRenderableCoords(s.to),p=this.options.createCellCoords(f+r.row,m+r.col);i=0,l=0,p.row<0?(i=-1,p.row=0):p.row>0&&p.row>=c&&(i=1,p.row=c-1),p.col<0?(l=-1,p.col=0):p.col>0&&p.col>=d&&(l=1,p.col=d-1),o=this.options.renderableToVisualCoords(p)}return this.runLocalHooks("afterTransformEnd",o,i,l),o}}at(Vx,An);const Sg=0,Rg=1,$x=2,x0=3,aG=[x0,$x],uG=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],cp=Symbol("root"),ET=Symbol("child");function Xl(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:cp;if(e!==cp&&e!==ET)throw new Error("The second argument is used internally only and cannot be overwritten.");const t=Array.isArray(n),r=e===cp;let s=Sg;if(t){const o=n[0];n.length===0?s=Rg:r&&o instanceof Cc?s=x0:r&&Array.isArray(o)?s=Xl(o,ET):n.length>=2&&n.length<=4&&!n.some((l,a)=>!uG[a].includes(typeof l))&&(s=$x)}return s}function qu(n){let{keepDirection:e=!1,propToCol:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!aG.includes(n))throw new Error("Unsupported selection ranges schema type was provided.");return function(r){const s=n===x0;let o=s?r.from.row:r[0],i=s?r.from.col:r[1],l=s?r.to.row:r[2],a=s?r.to.col:r[3];if(typeof t=="function"&&(typeof i=="string"&&(i=t(i)),typeof a=="string"&&(a=t(a))),dt(l)&&(l=o),dt(a)&&(a=i),!e){const u=o,c=i,d=l,f=a;o=Math.min(u,d),i=Math.min(c,f),l=Math.max(u,d),a=Math.max(c,f)}return[o,i,l,a]}}function cG(n){const e=Xl(n);if(e===Sg||e===Rg)return[];const t=qu(e),r=new Set;P(n,i=>{const[,l,,a]=t(i),u=Math.max(l,0),c=a-u+1;P(Array.from(new Array(c),(d,f)=>u+f),d=>{r.has(d)||r.add(d)})});const s=Array.from(r).sort((i,l)=>i-l);return Sn(s,(i,l,a,u)=>(a!==0&&l===u[a-1]+1?i[i.length-1][1]+=1:i.push([l,1]),i),[])}function hG(n){const e=Xl(n);if(e===Sg||e===Rg)return[];const t=qu(e),r=new Set;P(n,i=>{const[l,,a]=t(i),u=Math.max(l,0),c=a-u+1;P(Array.from(new Array(c),(d,f)=>u+f),d=>{r.has(d)||r.add(d)})});const s=Array.from(r).sort((i,l)=>i-l);return Sn(s,(i,l,a,u)=>(a!==0&&l===u[a-1]+1?i[i.length-1][1]+=1:i.push([l,1]),i),[])}function Js(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof n=="number"&&n>=0&&n<e}class Bx{constructor(e,t){var r=this;this.settings=e,this.tableProps=t,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new lG((s,o,i)=>this.tableProps.createCellRange(s,o,i)),this.highlight=new iG({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,disabledCellSelection:(s,o)=>this.tableProps.isDisabledCellSelection(s,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:s=>this.tableProps.visualToRenderableCoords(s),renderableToVisualCoords:s=>this.tableProps.renderableToVisualCoords(s),createCellCoords:(s,o)=>this.tableProps.createCellCoords(s,o),createCellRange:(s,o,i)=>this.tableProps.createCellRange(s,o,i),rowIndexMapper:()=>this.tableProps.rowIndexMapper(),columnIndexMapper:()=>this.tableProps.columnIndexMapper()}),this.transformation=new Vx(this.selectedRange,{countRows:()=>this.tableProps.countRowsTranslated(),countCols:()=>this.tableProps.countColsTranslated(),visualToRenderableCoords:s=>this.tableProps.visualToRenderableCoords(s),renderableToVisualCoords:s=>this.tableProps.renderableToVisualCoords(s),createCellCoords:(s,o)=>this.tableProps.createCellCoords(s,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r.runLocalHooks("beforeModifyTransformStart",...o)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r.runLocalHooks("afterModifyTransformStart",...o)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r.runLocalHooks("afterModifyTransformEnd",...o)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r.runLocalHooks("insertRowRequire",...o)}),this.transformation.addLocalHook("insertColRequire",function(){for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r.runLocalHooks("insertColRequire",...o)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=this.settings.selectionMode==="multiple",o=dt(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,i=e.row<0,l=e.col<0,a=i&&l,u=e.clone();this.selectedByCorner=a,this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,u),(!s||s&&!o&&dt(t))&&this.selectedRange.clear(),this.selectedRange.add(u),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!a&&l&&this.selectedByRowHeader.add(this.getLayerLevel()),!a&&i&&this.selectedByColumnHeader.add(this.getLayerLevel()),r||this.setRangeEnd(e)}setRangeStartOnly(e,t){this.setRangeStart(e,t,!0)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const t=e.clone();this.runLocalHooks("beforeSetRangeEnd",t),this.begin();const r=this.selectedRange.current();this.settings.selectionMode!=="single"&&r.setTo(this.tableProps.createCellCoords(t.row,t.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(Xu,r.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(r);const s=this.getLayerLevel();s<this.highlight.layerLevel&&(P(this.highlight.getAreas(),a=>void a.clear()),P(this.highlight.getHeaders(),a=>void a.clear()),P(this.highlight.getActiveHeaders(),a=>void a.clear())),this.highlight.useLayerLevel(s);const o=this.highlight.createOrGetArea(),i=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();if(o.clear(),i.clear(),l.clear(),this.highlight.isEnabledFor(vg,r.highlight)&&(this.isMultiple()||s>=1)&&(o.add(r.from).add(r.to).commit(),s===1)){const a=this.selectedRange.previous();this.highlight.useLayerLevel(s-1).createOrGetArea().add(a.from).commit().syncWith(a),this.highlight.useLayerLevel(s)}if(this.highlight.isEnabledFor(Rc,r.highlight)){const a=this.tableProps.countRowsTranslated()===0,u=this.tableProps.countColsTranslated()===0;let c=r;(a||u)&&(c=r.clone()),a&&(c.from.row=-1),u&&(c.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&c.from.normalize(),i.add(c.from).commit()):i.add(c.from).add(c.to).commit(),this.isEntireRowSelected()&&this.tableProps.countCols()===r.getWidth()&&l.add(this.tableProps.createCellCoords(r.from.row,-1)).add(this.tableProps.createCellCoords(r.to.row,-1)).commit(),this.isEntireColumnSelected()&&this.tableProps.countRows()===r.getHeight()&&l.add(this.tableProps.createCellCoords(-1,r.from.col)).add(this.tableProps.createCellCoords(-1,r.to.col)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}isMultiple(){const e=Gl(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(e,t,r))}transformEnd(e,t){this.setRangeEnd(this.transformation.transformEnd(e,t))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&this.isEntireRowSelected(e)}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e)}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(e)}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByCorner}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.tableProps.countRows(),s=this.tableProps.countCols();if(!e&&!t&&(r===0||s===0))return;const o=this.tableProps.createCellCoords(t?-1:0,e?-1:0),i=this.tableProps.createCellCoords(r-1,s-1);this.clear(),this.setRangeStartOnly(o),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(i),this.finish()}selectCells(e){const t=Xl(e);if(t===Rg)return!1;if(t===Sg)throw new Error(ot`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const r=qu(t,{propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),s=this.tableProps.countRows(),o=this.tableProps.countCols(),i=!e.some(l=>{const[a,u,c,d]=r(l);return!(Js(a,s)&&Js(u,o)&&Js(c,s)&&Js(d,o))});return i&&(this.clear(),P(e,l=>{const[a,u,c,d]=r(l);this.setRangeStartOnly(this.tableProps.createCellCoords(a,u),!1),this.setRangeEnd(this.tableProps.createCellCoords(c,d)),this.finish()})),i}selectColumns(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;const s=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof t=="string"?this.tableProps.propToCol(t):t,i=this.tableProps.countCols(),l=this.tableProps.countRows(),a=Js(s,i)&&Js(o,i);return a&&(this.setRangeStartOnly(this.tableProps.createCellCoords(r,s)),this.setRangeEnd(this.tableProps.createCellCoords(l-1,o)),this.finish()),a}selectRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;const s=this.tableProps.countRows(),o=this.tableProps.countCols(),i=Js(e,s)&&Js(t,s);return i&&(this.setRangeStartOnly(this.tableProps.createCellCoords(e,r)),this.setRangeEnd(this.tableProps.createCellCoords(t,o-1)),this.finish()),i}refresh(){if(this.highlight.getCustomSelections().forEach(s=>{s.commit()}),!this.isSelected())return;const t=this.highlight.getCell(),r=this.getLayerLevel();t.commit().syncWith(this.selectedRange.current());for(let s=0;s<this.selectedRange.size();s+=1){this.highlight.useLayerLevel(s);const o=this.highlight.createOrGetArea(),i=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();o.commit(),i.commit(),l.commit()}this.highlight.useLayerLevel(r)}}at(Bx,An);const TT=/^(\r\n|\n\r|\r|\n)/,dG=/^[^\t\r\n]+/,MT=/^\t/;function fG(n){const e=[[""]];if(n.length===0)return e;let t=0,r=0,s;for(;n.length>0&&s!==n.length;)if(s=n.length,n.match(MT))n=n.replace(MT,""),t+=1,e[r][t]="";else if(n.match(TT))n=n.replace(TT,""),t=0,r+=1,e[r]=[""];else{let o="";if(n.startsWith('"')){let i=0,l=!0;for(;l;){const a=n.slice(0,1);a==='"'&&(i+=1),o+=a,n=n.slice(1),(n.length===0||n.match(/^[\t\r\n]/)&&i%2===0)&&(l=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,a=>new Array(Math.floor(a.length/2)).fill('"').join(""))}else{const i=n.match(dG);o=i?i[0]:"",n=n.slice(o.length)}e[r][t]=o}return e}function gu(n){let e,t,r,s,o="",i;for(e=0,t=n.length;e<t;e+=1){for(s=n[e].length,r=0;r<s;r+=1)r>0&&(o+="	"),i=n[e][r],typeof i=="string"?i.indexOf(`
`)>-1?o+=`"${i.replace(/"/g,'""')}"`:o+=i:i==null?o+="":o+=i;e!==t-1&&(o+=`
`)}return o}class _l{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,r){this.instance=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=t,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const t=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,t){let s=0,o=0,i=!1;if(typeof t=="function"){const l=Fv(e);s=l>0?l:this.countFirstRowKeys(),i=!0}else{const l=this.tableMeta.maxCols;s=Math.min(l,t.length)}for(r=0;r<s;r++){const l=i?t(r):t[r];if($e(l)){if(typeof l.data<"u"){const a=i?o:r;this.colToPropCache[a]=l.data,this.propToColCache.set(l.data,a)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return Tx(this.dataSource)}recursiveDuckColumns(e,t,r){let s=t,o=r,i;return typeof s>"u"&&(s=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Be(e,(l,a)=>{l===null?(i=o+a,this.colToPropCache.push(i),this.propToColCache.set(i,s),s+=1):s=this.recursiveDuckColumns(l,s,`${a}.`)}),s}colToProp(e){if(Number.isInteger(e)===!1)return e;const t=this.instance.toPhysicalColumn(e);return t===null?e:this.colToPropCache&&ue(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){const t=this.propToColCache.get(e);if(ue(t))return this.instance.toVisualColumn(t);const r=this.instance.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?ju(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:s="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.instance.countSourceRows();let i=o,l=0,a=e;if((typeof a!="number"||a>=o)&&(a=o),a<this.instance.countRows()&&(i=this.instance.toPhysicalRow(a)),this.instance.runHooks("beforeCreateRow",a,t,r)===!1||i===null)return{delta:0};const c=this.tableMeta.maxRows,d=this.getSchema().length,f=[];for(;l<t&&o+l<c;){let p=null;this.instance.dataType==="array"?this.tableMeta.dataSchema?p=_n(this.getSchema()):(p=[],Ce(d-1,()=>p.push(null))):this.instance.dataType==="function"?p=this.tableMeta.dataSchema(a+l):(p={},ug(p,this.getSchema())),f.push(p),l+=1}this.instance.rowIndexMapper.insertIndexes(a,l),s==="below"&&(i=Math.min(i+1,o)),this.spliceData(i,0,f);const m=this.instance.toVisualRow(i);return this.instance.countSourceRows()===f.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),l>0&&(e==null?this.metaManager.createRow(null,l):r!=="auto"&&this.metaManager.createRow(i,t)),this.instance.runHooks("afterCreateRow",m,l,r),this.instance.forceFullRender=!0,{delta:l,startPhysicalIndex:i}}createCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:s="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,i=this.tableMeta.maxCols,l=this.instance.countSourceCols();let a=e;if((typeof a!="number"||a>=l)&&(a=l),this.instance.runHooks("beforeCreateCol",a,t,r)===!1)return{delta:0};let c=l;a<this.instance.countCols()&&(c=this.instance.toPhysicalColumn(a));const d=this.instance.countSourceRows();let f=this.instance.countCols(),m=0,p=c;s==="end"&&(p=Math.min(p+1,l));const w=p;for(;m<t&&f<i;){if(typeof a!="number"||a>=f)if(d>0)for(let S=0;S<d;S+=1)typeof o[S]>"u"&&(o[S]=[]),o[S].push(null);else o.push([null]);else for(let S=0;S<d;S++)o[S].splice(p,0,null);m+=1,p+=1,f+=1}this.instance.columnIndexMapper.insertIndexes(a,m),m>0&&(e==null?this.metaManager.createColumn(null,m):r!=="auto"&&this.metaManager.createColumn(w,t));const M=this.instance.toVisualColumn(w);return this.instance.runHooks("afterCreateCol",M,m,r),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:m,startPhysicalIndex:w}}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,s=Number.isInteger(e)?e:-t;const o=this.visualRowsToPhysical(s,t),i=this.instance.countSourceRows();if(s=(i+s)%i,this.instance.runHooks("beforeRemoveRow",s,o.length,o,r)===!1)return!1;const a=o.length;if(this.filterData(s,a,o),s<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(o);const c=ue(this.tableMeta.columns)||ue(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,d)=>d-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.instance.runHooks("afterRemoveRow",s,a,o,r),this.instance.forceFullRender=!0,!0}removeCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let s=typeof e!="number"?-t:e;s=(this.instance.countCols()+s)%this.instance.countCols();const o=this.visualColumnsToPhysical(s,t),i=o.slice(0).sort((d,f)=>f-d);if(this.instance.runHooks("beforeRemoveCol",s,t,o,r)===!1)return!1;let a=!0;const u=i.length,c=this.dataSource;for(let d=0;d<u;d++)a&&o[0]!==o[d]-d&&(a=!1);if(a)for(let d=0,f=this.instance.countSourceRows();d<f;d++)c[d].splice(o[0],t),d===0&&this.metaManager.removeColumn(o[0],t);else for(let d=0,f=this.instance.countSourceRows();d<f;d++)for(let m=0;m<u;m++)c[d].splice(i[m],1),d===0&&this.metaManager.removeColumn(i[m],1);return s<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(o),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",s,t,o,r),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,t,r){const s=this.instance.getDataAtCol(e),o=s.slice(t,t+r),i=s.slice(t+r);for(var l=arguments.length,a=new Array(l>3?l-3:0),u=3;u<l;u++)a[u-3]=arguments[u];IE(a,i);let c=0;for(;c<r;)a.push(null),c+=1;return JU(a),this.instance.populateFromArray(t,e,a,null,null,"spliceCol"),o}spliceRow(e,t,r){const s=this.instance.getSourceDataAtRow(e),o=s.slice(t,t+r),i=s.slice(t+r);for(var l=arguments.length,a=new Array(l>3?l-3:0),u=3;u<l;u++)a[u-3]=arguments[u];IE(a,i);let c=0;for(;c<r;)a.push(null),c+=1;return this.instance.populateFromArray(e,t,[a],null,null,"spliceRow"),o}spliceData(e,t,r){if(this.instance.runHooks("beforeDataSplice",e,t,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(i=>this.dataSource.push(i))}}filterData(e,t,r){let s=this.instance.runHooks("filterData",e,t,r);Array.isArray(s)===!1&&(s=this.dataSource.filter((o,i)=>r.indexOf(i)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,s)}get(e,t){const r=this.instance.toPhysicalRow(e);let s=this.dataSource[r];const o=this.instance.runHooks("modifyRowData",r);s=isNaN(o)?o:s;let i=null;if(s&&s.hasOwnProperty&&Ht(s,t))i=s[t];else if(typeof t=="string"&&t.indexOf(".")>-1){const l=t.split(".");let a=s;if(!a)return null;for(let u=0,c=l.length;u<c;u++)if(a=a[l[u]],typeof a>"u")return null;i=a}else typeof t=="function"&&(i=t(this.dataSource.slice(r,r+1)[0]));if(this.instance.hasHook("modifyData")){const l=Gl(i);this.instance.runHooks("modifyData",r,this.propToCol(t),l,"get"),l.isTouched()&&(i=l.value)}return i}getCopyable(e,t){return this.instance.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,r){const s=this.instance.toPhysicalRow(e);let o=r,i=this.dataSource[s];const l=this.instance.runHooks("modifyRowData",s);if(i=isNaN(l)?l:i,this.instance.hasHook("modifyData")){const a=Gl(o);this.instance.runHooks("modifyData",s,this.propToCol(t),a,"set"),a.isTouched()&&(o=a.value)}if(i&&i.hasOwnProperty&&Ht(i,t))i[t]=o;else if(typeof t=="string"&&t.indexOf(".")>-1){const a=t.split(".");let u=i,c=0,d;for(c=0,d=a.length-1;c<d;c++)typeof u[a[c]]>"u"&&(u[a[c]]={}),u=u[a[c]];u[a[c]]=o}else typeof t=="function"?t(this.dataSource.slice(s,s+1)[0],o):i[t]=o}visualRowsToPhysical(e,t){const r=this.instance.countSourceRows(),s=[];let o=(r+e)%r,i=t,l;for(;o<r&&i;)l=this.instance.toPhysicalRow(o),s.push(l),i-=1,o+=1;return s}visualColumnsToPhysical(e,t){const r=this.instance.countCols(),s=[];let o=(r+e)%r,i=t;for(;o<r&&i;){const l=this.instance.toPhysicalColumn(o);s.push(l),i-=1,o+=1}return s}clear(){for(let e=0;e<this.instance.countSourceRows();e++)for(let t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){const e=this.tableMeta.maxRows;let t;e<0||e===0?t=0:t=e||1/0;const r=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,t)}getAll(){const e={row:0,col:0},t={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return e.row-t.row===0&&!this.instance.countSourceRows()?[]:this.getRange(e,t,_l.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,r){const s=[];let o,i,l;const a=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(a===0||u===0)return[];const c=r===_l.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,d=Math.min(Math.max(a-1,0),Math.max(e.row,t.row)),f=Math.min(Math.max(u-1,0),Math.max(e.col,t.col));for(o=Math.min(e.row,t.row);o<=d;o++){l=[];const m=o>=0?this.instance.toPhysicalRow(o):o;for(i=Math.min(e.col,t.col);i<=f&&m!==null;i++)l.push(c.call(this,o,this.colToProp(i)));m!==null&&s.push(l)}return s}getText(e,t){return gu(this.getRange(e,t,_l.DESTINATION_RENDERER))}getCopyableText(e,t){return gu(this.getRange(e,t,_l.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:gG,getItem:mG,hasItem:Wx,getNames:Sq,getValues:Rq}=br("cellTypes");function pG(n){if(!Wx(n))throw Error(`You declared cell type "${n}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return mG(n)}function Zr(n,e){typeof n!="string"&&(e=n,n=e.CELL_TYPE);const{editor:t,renderer:r,validator:s}=e;t&&jn(n,t),r&&Ms(n,r),s&&qa(n,s),gG(n,e)}function wG(n,e){var t;return n==="CELL_TYPE"?!1:((t=e._automaticallyAssignedMetaProps)===null||t===void 0?void 0:t.has(n))||!Ht(e,n)}function bg(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const r=typeof e.type=="string"?pG(e.type):e.type;if(n._automaticallyAssignedMetaProps&&Be(e,(o,i)=>void n._automaticallyAssignedMetaProps.delete(i)),!$e(r))return;t===n&&!n._automaticallyAssignedMetaProps&&(n._automaticallyAssignedMetaProps=new Set);const s={};Be(r,(o,i)=>{if(wG(i,t)){var l;s[i]=o,(l=n._automaticallyAssignedMetaProps)===null||l===void 0||l.add(i)}}),Ut(n,s)}function CG(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function t(){}Vo(t,n);for(let r=0;r<e.length;r++)t.prototype[e[r]]=void 0;return t}function dd(n){return Number.isInteger(n)&&n>=0}function fd(n,e){if(!n())throw new Error(`Assertion failed: ${e}`)}function fh(n){return n==null}const Ux=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol(n){let e,t,r;for(e=0,t=this.countRows();e<t;e++)if(r=this.getDataAtCell(e,n),Xt(r)===!1)return!1;return!0},isEmptyRow(n){let e,t,r,s;for(e=0,t=this.countCols();e<t;e++)if(r=this.getDataAtCell(n,e),Xt(r)===!1)return typeof r=="object"?(s=this.getCellMeta(n,e),Lv(this.getSchema()[s.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function yG(){return class{}}class vG{constructor(e){this.metaCtor=yG(),this.meta=this.metaCtor.prototype,Ut(this.meta,Ux()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;Ut(this.meta,e),bg(this.meta,{...e,type:(t=e.type)!==null&&t!==void 0?t:this.meta.type},e)}}class SG{constructor(e){const t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){Ut(this.meta,e),bg(this.meta,e,e)}}class BC{constructor(e){this.valueFactory=e,this.data=[],this.index=[],this.holes=new Set}obtain(e){fd(()=>dd(e),"Expecting an unsigned number.");const t=this._getStorageIndexByKey(e);let r;if(t>=0)r=this.data[t],r===void 0&&(r=this.valueFactory(e),this.data[t]=r);else if(r=this.valueFactory(e),this.holes.size>0){const s=this.holes.values().next().value;this.holes.delete(s),this.data[s]=r,this.index[e]=s}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;fd(()=>dd(e)||fh(e),"Expecting an unsigned number or null/undefined argument.");const r=[],s=this.data.length;for(let i=0;i<t;i++)r.push(s+i),this.data.push(void 0);const o=fh(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;fd(()=>dd(e)||fh(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(fh(e)?this.index.length-t:e,t);for(let s=0;s<r.length;s++){const o=r[s];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return yr(this.data,(e,t)=>!this.holes.has(t))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const s=this._getKeyByStorageIndex(r);s!==-1&&e.push([s,this.data[r]])}let t=0;return{next:()=>{if(t<e.length){const r=e[t];return t+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}const RG=["data","width"];class bG{constructor(e){this.globalMeta=e,this.metas=new BC(()=>this._createMeta())}updateMeta(e,t){const r=this.getMeta(e);Ut(r,t),bg(r,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return CG(this.globalMeta.getMetaConstructor(),RG).prototype}}class EG{constructor(e){this.columnMeta=e,this.metas=new BC(()=>this._createRow())}updateMeta(e,t,r){const s=this.getMeta(e,t);Ut(s,r),bg(s,r)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,t)}getMeta(e,t,r){const s=this.metas.obtain(e).obtain(t);return r===void 0?s:s[r]}setMeta(e,t,r,s){var o;const i=this.metas.obtain(e).obtain(t);(o=i._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),i[r]=s}removeMeta(e,t,r){const s=this.metas.obtain(e).obtain(t);delete s[r]}getMetas(){const e=[],t=Array.from(this.metas.values());for(let r=0;r<t.length;r++)e.push(...t[r].values());return e}getMetasAtRow(e){fd(()=>dd(e),"Expecting an unsigned number.");const t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new BC(e=>this._createMeta(e))}_createMeta(e){const t=this.columnMeta.getMetaConstructor(e);return new t}}class zx{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new vG(e),this.tableMeta=new SG(this.globalMeta),this.columnMeta=new bG(this.globalMeta),this.cellMeta=new EG(this.columnMeta),r.forEach(s=>new s(this)),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,r){let{visualRow:s,visualColumn:o}=r;const i=this.cellMeta.getMeta(e,t);return i.visualRow=s,i.visualCol=o,i.row=e,i.col=t,this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,t,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,r)}setCellMeta(e,t,r,s){this.cellMeta.setMeta(e,t,r,s)}updateCellMeta(e,t,r){this.cellMeta.updateMeta(e,t,r)}removeCellMeta(e,t,r){this.cellMeta.removeMeta(e,t,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}at(zx,An);function _T(n,e,t,r){const{hotInstance:s,dataMap:o,dataSource:i,internalSource:l,source:a,metaManager:u,firstRun:c}=r,d=Lr(l),f=s.getSettings();Array.isArray(f.dataSchema)?s.dataType="array":ut(f.dataSchema)?s.dataType="function":s.dataType="object",o&&o.destroy(),n=s.runHooks(`before${d}`,n,c,a);const m=new _l(s,n,u);if(e(m),typeof n=="object"&&n!==null)n.push&&n.splice||(n=[n]);else if(n===null){const p=m.getSchema();n=[];let w,M=0,S=0;for(M=0,S=f.startRows;M<S;M++)if((s.dataType==="object"||s.dataType==="function")&&f.dataSchema)w=_n(p),n.push(w);else if(s.dataType==="array")w=_n(p[0]),n.push(w);else{w=[];for(let y=0,v=f.startCols;y<v;y++)w.push(null);n.push(w)}}else throw new Error(`${l} only accepts array of objects or array of arrays (${typeof n} given)`);Array.isArray(n[0])&&(s.dataType="array"),f.data=n,m.dataSource=n,i.data=n,i.dataType=s.dataType,i.colToProp=m.colToProp.bind(m),i.propToCol=m.propToCol.bind(m),i.countCachedColumns=m.countCachedColumns.bind(m),t(m),s.runHooks(`after${d}`,n,c,a),c||(s.runHooks("afterChange",null,l),s.render())}class TG{constructor(e){this.metaManager=e,this.metaSyncMemo=new Map,e.addLocalHook("afterGetCellMeta",t=>this.extendCellMeta(t)),he.getSingleton().add("beforeRender",t=>{t&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var t;const{row:r,col:s}=e;if((t=this.metaSyncMemo.get(r))!==null&&t!==void 0&&t.has(s))return;const{visualRow:o,visualCol:i}=e,l=this.metaManager.hot,a=l.colToProp(i);e.prop=a,l.runHooks("beforeGetCellMeta",o,i,e);const u=Ht(e,"type")?e.type:null;let c=ut(e.cells)?e.cells(r,s,a):null;if(u)if(c){var d;c.type=(d=c.type)!==null&&d!==void 0?d:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,s,c),l.runHooks("afterGetCellMeta",o,i,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(s)}}class MG{constructor(e){this.metaManager=e,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){if(this.metaManager.hot.isRtl()&&t==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(t,r,s){if(!s)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}}]]),this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,t)=>{const{target:r,onChange:s=()=>{}}=e,o=typeof r=="string",i=o?r:t,l=`_${i}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[i],this.installPropWatcher(t,l,s),o&&this.installPropWatcher(r,l,s)})}installPropWatcher(e,t,r){const s=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(o){const i=!s.usageTracker.has(e);s.usageTracker.add(e),r.call(s,e,o,i),this[t]=o},enumerable:!0,configurable:!0})}}const OT=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),gh=n=>n.map(e=>{const t=e.toLowerCase();return OT.has(t)?OT.get(t):t}).sort().join("+"),_G=n=>n.split("+"),IT=n=>n.toLowerCase(),OG=n=>{const e=hg({errorIdExists:a=>`The "${a}" shortcut is already registered in the "${n}" context.`}),t=function(){let{keys:a,callback:u,group:c,runOnlyIf:d=()=>!0,captureCtrl:f=!1,preventDefault:m=!0,stopPropagation:p=!1,relativeToGroup:w,position:M}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(dt(c))throw new Error("You need to define the shortcut's group.");if(ut(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(a)===!1)throw new Error(ot`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const S={callback:u,group:c,runOnlyIf:d,captureCtrl:f,preventDefault:m,stopPropagation:p};ue(w)&&([S.relativeToGroup,S.position]=[w,M]),a.forEach(y=>{const v=gh(y);if(e.hasItem(v)){const I=e.getItem(v);let F=I.findIndex(L=>L.group===w);F!==-1?M==="before"?F-=1:F+=1:F=I.length,I.splice(F,0,S)}else e.addItem(v,[S])})},r=function(a){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};a.forEach(c=>{Be(u,(d,f)=>{Object.prototype.hasOwnProperty.call(c,f)===!1&&(c[f]=u[f])}),t(c)})},s=a=>{const u=gh(a);e.removeItem(u)};return{addShortcut:t,addShortcuts:r,getShortcuts:a=>{const u=gh(a),c=e.getItem(u);return ue(c)?c.slice():[]},hasShortcut:a=>{const u=gh(a);return e.hasItem(u)},removeShortcutsByKeys:s,removeShortcutsByGroup:a=>{e.getItems().forEach(c=>{let[d,f]=c;const m=f.filter(p=>p.group!==a);m.length===0?s(_G(d)):(f.length=0,f.push(...m))})}}};function IG(){const n=new Set;return{press(e){n.add(e)},release(e){n.delete(e)},releaseAll(){n.clear()},isPressed(e){return n.has(e)}}}const xG=["meta","alt","shift","control"],Aa=IG();function AG(n,e,t,r,s){const o=f=>xG.includes(f),i=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=[];return f.altKey&&p.push("alt"),m&&(f.ctrlKey||f.metaKey)?p.push("control/meta"):(f.ctrlKey&&p.push("control"),f.metaKey&&p.push("meta")),f.shiftKey&&p.push("shift"),p},l=f=>{if(e(f)===!1)return;const m=t(f);if(f.keyCode===229||m===!1||dl(f))return;const p=IT(f.key);let w=[];o(p)?Aa.press(p):w=i(f);const M=[p].concat(w);!s(f,M)&&(XE()&&w.includes("meta")||!XE()&&w.includes("control"))&&s(f,[p].concat(i(f,!0))),r(f)},a=f=>{if(e(f)===!1)return;const m=IT(f.key);o(m)!==!1&&Aa.release(m)},u=()=>{Aa.releaseAll()};return{mount:()=>{let f=n;for(;f;)f.document.documentElement.addEventListener("keydown",l),f.document.documentElement.addEventListener("keyup",a),f.document.documentElement.addEventListener("blur",u),f=Jd(f)},unmount:()=>{let f=n;for(;f;)f.document.documentElement.removeEventListener("keydown",l),f.document.documentElement.removeEventListener("keyup",a),f.document.documentElement.removeEventListener("blur",u),f=Jd(f)},isPressed:f=>Aa.isPressed(f),releasePressedKeys:()=>Aa.releaseAll()}}const PG=n=>{let{ownerWindow:e,handleEvent:t,beforeKeyDown:r,afterKeyDown:s}=n;const o=hg({errorIdExists:m=>`The "${m}" context name is already registered.`});let i="grid";const l=m=>{const p=OG(m);return o.addItem(m,p),p},a=()=>i,u=m=>o.getItem(m),c=m=>{i=m};let d=!1;const f=AG(e,t,r,s,(m,p)=>{const w=u(a());let M=!1;if(!w.hasShortcut(p))return M;const S=w.getShortcuts(p);for(let y=0;y<S.length;y++){const{callback:v,runOnlyIf:R,preventDefault:I,stopPropagation:F,captureCtrl:L}=S[y];if(R(m)!==!1&&(d=L,M=v(m,p)===!1,d=!1,I&&m.preventDefault(),F&&m.stopPropagation(),M))break}return M});return f.mount(),{addContext:l,getActiveContextName:a,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!d&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}},HG="gridDefault";let hp=null;function A0(n,e){var t;let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=!1,o=this;const i=new It(o);let l,a,u,c,d=!0;l3(r)&&i3(this),this.rootElement=n,this.rootDocument=n.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const f=(t=e==null?void 0:e.layoutDirection)!==null&&t!==void 0?t:"inherit",m=["rtl","ltr"].includes(f)?f:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",m),this.isRtl=function(){return m==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},e.language=X3(e.language);const p=new zx(o,e,[TG,MG]),w=p.getTableMeta(),M=p.getGlobalMeta(),S=hg();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,n.insertBefore(this.container,n.firstChild),FC(this)&&rz(e.licenseKey,n),this.guid=`ht_${BI()}`,this.columnIndexMapper=new VC,this.rowIndexMapper=new VC,this.columnIndexMapper.addLocalHook("indexesSequenceChange",h=>{o.runHooks("afterColumnSequenceChange",h)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",h=>{o.runHooks("afterRowSequenceChange",h)}),a=new C3(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const y=h=>{const{row:g,col:C}=h;return o._createCellCoords(g>=0?o.rowIndexMapper.getRenderableFromVisualIndex(g):g,C>=0?o.columnIndexMapper.getRenderableFromVisualIndex(C):C)},v=h=>{const{row:g,col:C}=h;return o._createCellCoords(g>=0?o.rowIndexMapper.getVisualFromRenderableIndex(g):g,C>=0?o.columnIndexMapper.getVisualFromRenderableIndex(C):C)};let R=new Bx(w,{rowIndexMapper:()=>o.rowIndexMapper,columnIndexMapper:()=>o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:h=>l.propToCol(h),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countColsTranslated:()=>this.view.countRenderableColumns(),countRowsTranslated:()=>this.view.countRenderableRows(),getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(h,g)=>o._createCellCoords(h,g),createCellRange:(h,g,C)=>o._createCellRange(h,g,C),visualToRenderableCoords:y,renderableToVisualCoords:v,isDisabledCellSelection:(h,g)=>o.getCellMeta(h,g).disableVisualSelection});this.selection=R;const I=h=>{let{hiddenIndexesChanged:g}=h;g&&this.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",I),this.rowIndexMapper.addLocalHook("cacheUpdated",I),this.selection.addLocalHook("beforeSetRangeStart",h=>{this.runHooks("beforeSetRangeStart",h)}),this.selection.addLocalHook("beforeSetRangeStartOnly",h=>{this.runHooks("beforeSetRangeStartOnly",h)}),this.selection.addLocalHook("beforeSetRangeEnd",h=>{this.runHooks("beforeSetRangeEnd",h),h.row<0&&(h.row=this.view._wt.wtTable.getFirstVisibleRow()),h.col<0&&(h.col=this.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",h=>{const g=Gl(!1),C=this.selection.getSelectedRange(),{from:_,to:O}=C.current(),A=C.size()-1;this.runHooks("afterSelection",_.row,_.col,O.row,O.col,g,A),this.runHooks("afterSelectionByProp",_.row,o.colToProp(_.col),O.row,o.colToProp(O.col),g,A);const W=this.selection.isSelectedByAnyHeader(),z=this.selection.selectedRange.current();let K=!0;s&&(K=!1),g.isTouched()&&(K=!g.value);const Z=this.selection.isSelectedByRowHeader(),Q=this.selection.isSelectedByColumnHeader();K!==!1&&(W?Z?this.view.scrollViewportVertically(o.rowIndexMapper.getRenderableFromVisualIndex(h.row)):Q&&this.view.scrollViewportHorizontally(o.columnIndexMapper.getRenderableFromVisualIndex(h.col)):z&&!this.selection.isMultiple()?this.view.scrollViewport(y(z.from)):this.view.scrollViewport(y(h))),Z&&Q?ee(this.rootElement,["ht__selection--rows","ht__selection--columns"]):Z?(He(this.rootElement,"ht__selection--columns"),ee(this.rootElement,"ht__selection--rows")):Q?(He(this.rootElement,"ht__selection--rows"),ee(this.rootElement,"ht__selection--columns")):He(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",h=>{const g=h.length-1,{from:C,to:_}=h[g];this.runHooks("afterSelectionEnd",C.row,C.col,_.row,_.col,g),this.runHooks("afterSelectionEndByProp",C.row,o.colToProp(C.col),_.row,o.colToProp(_.col),g)}),this.selection.addLocalHook("afterIsMultipleSelection",h=>{const g=this.runHooks("afterIsMultipleSelection",h.value);h.value&&(h.value=g)}),this.selection.addLocalHook("beforeModifyTransformStart",h=>{this.runHooks("modifyTransformStart",h)}),this.selection.addLocalHook("afterModifyTransformStart",(h,g,C)=>{this.runHooks("afterModifyTransformStart",h,g,C)}),this.selection.addLocalHook("beforeModifyTransformEnd",h=>{this.runHooks("modifyTransformEnd",h)}),this.selection.addLocalHook("afterModifyTransformEnd",(h,g,C)=>{this.runHooks("afterModifyTransformEnd",h,g,C)}),this.selection.addLocalHook("afterDeselect",()=>{c.destroyEditor(),this._refreshBorders(),He(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",h=>{this.alter("insert_row_above",h,1,"auto")}),this.selection.addLocalHook("insertColRequire",h=>{this.alter("insert_col_start",h,1,"auto")}),u={alter(h,g){var C,_;let O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,A=arguments.length>3?arguments[3]:void 0,W=arguments.length>4?arguments[4]:void 0;const z=K=>{if(K.length===0)return[];const Z=[...K];return Z.sort((pe,Ae)=>{let[Ee]=pe,[_e]=Ae;return Ee===_e?0:Ee>_e?1:-1}),Sn(Z,(pe,Ae)=>{let[Ee,_e]=Ae;const q=pe[pe.length-1],[je,Ie]=q,be=je+Ie;if(Ee<=be){const Pe=Math.max(_e-(be-Ee),0);q[1]+=Pe}else pe.push([Ee,_e]);return pe},[Z[0]])};switch(h){case"insert_row_below":case"insert_row_above":const K=o.countSourceRows();if(w.maxRows===K)return;const Z=h==="insert_row_below"?"below":"above";g=(C=g)!==null&&C!==void 0?C:Z==="below"?K:0;const{delta:Q,startPhysicalIndex:pe}=l.createRow(g,O,{source:A,mode:Z});if(Q){const Ie=R.selectedRange.current(),be=Ie==null?void 0:Ie.from,Pe=be==null?void 0:be.row,ye=o.toVisualRow(pe);if(R.isSelectedByCorner())o.selectAll();else if(ue(Pe)&&Pe>=ye){const{row:b,col:T}=Ie.to;let x=be.col;R.isSelectedByRowHeader()&&(x=-1),R.getSelectedRange().pop(),R.setRangeStartOnly(o._createCellCoords(Pe+Q,x),!0),R.setRangeEnd(o._createCellCoords(b+Q,T))}else o._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const Ae=h==="insert_col_end"?"end":"start";g=(_=g)!==null&&_!==void 0?_:Ae==="end"?o.countSourceCols():0;const{delta:Ee,startPhysicalIndex:_e}=l.createCol(g,O,{source:A,mode:Ae});if(Ee){if(Array.isArray(w.colHeaders)){const b=[o.toVisualColumn(_e),0];b.length+=Ee,Array.prototype.splice.apply(w.colHeaders,b)}const Ie=R.selectedRange.current(),be=Ie==null?void 0:Ie.from,Pe=be==null?void 0:be.col,ye=o.toVisualColumn(_e);if(R.isSelectedByCorner())o.selectAll();else if(ue(Pe)&&Pe>=ye){const{row:b,col:T}=Ie.to;let x=be.row;R.isSelectedByColumnHeader()&&(x=-1),R.getSelectedRange().pop(),R.setRangeStartOnly(o._createCellCoords(x,Pe+Ee),!0),R.setRangeEnd(o._createCellCoords(b,T+Ee))}else o._refreshBorders()}break;case"remove_row":const q=Ie=>{let be=0;P(Ie,Pe=>{let[ye,b]=Pe;const T=Xt(ye)?o.countRows()-1:Math.max(ye-be,0);if(Number.isInteger(ye)&&(ye=Math.max(ye-be,0)),!l.removeRow(ye,b,A))return;const $=o.countRows(),H=w.fixedRowsTop;H>=T+1&&(w.fixedRowsTop-=Math.min(b,H-T));const B=w.fixedRowsBottom;B&&T>=$-B&&(w.fixedRowsBottom-=Math.min(b,B)),be+=b})};Array.isArray(g)?q(z(g)):q([[g,O]]),u.adjustRowsAndCols(),o._refreshBorders();break;case"remove_col":const je=Ie=>{let be=0;P(Ie,Pe=>{let[ye,b]=Pe;const T=Xt(ye)?o.countCols()-1:Math.max(ye-be,0);let x=o.toPhysicalColumn(T);if(Number.isInteger(ye)&&(ye=Math.max(ye-be,0)),!l.removeCol(ye,b,A))return;const H=w.fixedColumnsStart;H>=T+1&&(w.fixedColumnsStart-=Math.min(b,H-T)),Array.isArray(w.colHeaders)&&(typeof x>"u"&&(x=-1),w.colHeaders.splice(x,b)),be+=b})};Array.isArray(g)?je(z(g)):je([[g,O]]),u.adjustRowsAndCols(),o._refreshBorders();break;default:throw new Error(`There is no such action "${h}"`)}W||u.adjustRowsAndCols()},adjustRowsAndCols(){const h=w.minRows,g=w.minSpareRows,C=w.minCols,_=w.minSpareCols;if(o.countRows()===0&&o.countCols()===0&&R.deselect(),h){const O=o.countRows();O<h&&l.createRow(O,h-O,{source:"auto"})}if(g){const O=o.countEmptyRows(!0);if(O<g){const A=g-O,W=Math.min(A,w.maxRows-o.countSourceRows());l.createRow(o.countRows(),W,{source:"auto"})}}{let O;(C||_)&&(O=o.countEmptyCols(!0));let A=o.countCols();if(C&&!w.columns&&A<C){const W=C-A;O+=W,l.createCol(A,W,{source:"auto"})}if(_&&!w.columns&&o.dataType==="array"&&O<_){A=o.countCols();const W=_-O,z=Math.min(W,w.maxCols-A);l.createCol(A,z,{source:"auto"})}}if(R.isSelected()){const O=o.countRows(),A=o.countCols();P(R.selectedRange,W=>{let z=!1,K=W.from.row,Z=W.from.col,Q=W.to.row,pe=W.to.col;K>O-1?(K=O-1,z=!0,Q>K&&(Q=K)):Q>O-1&&(Q=O-1,z=!0,K>Q&&(K=Q)),Z>A-1?(Z=A-1,z=!0,pe>Z&&(pe=Z)):pe>A-1&&(pe=A-1,z=!0,Z>pe&&(Z=pe)),z&&o.selectCell(K,Z,Q,pe)})}o.view&&o.view.adjustElementsSize()},populateFromArray(h,g,C,_,O){let A,W,z,K;const Z=[],Q={},pe=[],Ae=h.row,Ee=h.col;if(W=g.length,W===0)return!1;let _e=0,q=0;switch($e(C)&&(_e=C.col-Ee+1,q=C.row-Ae+1),O){case"shift_down":const je=ud(g),Ie=je.length,be=Math.max(Ie,_e),Pe=o.getData().slice(Ae),ye=ud(Pe).slice(Ee,Ee+be);for(z=0;z<be;z+=1)if(z<Ie){for(A=0,W=je[z].length;A<q-W;A+=1)je[z].push(je[z][A%W]);z<ye.length?pe.push(je[z].concat(ye[z])):pe.push(je[z].concat(new Array(Pe.length).fill(null)))}else pe.push(je[z%Ie].concat(ye[z]));o.populateFromArray(Ae,Ee,ud(pe));break;case"shift_right":const b=g.length,T=Math.max(b,q),x=o.getData().slice(Ae).map(Y=>Y.slice(Ee));for(A=0;A<T;A+=1)if(A<b){for(z=0,K=g[A].length;z<_e-K;z+=1)g[A].push(g[A][z%K]);if(A<x.length)for(let Y=0;Y<x[A].length;Y+=1)g[A].push(x[A][Y]);else g[A].push(...new Array(x[0].length).fill(null))}else g.push(g[A%W].slice(0,T).concat(x[A]));o.populateFromArray(Ae,Ee,g);break;case"overwrite":default:Q.row=h.row,Q.col=h.col;let $=0,H=0,B=!0,N;const k=function(oe){let de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const ve=g[oe%g.length];return de!==null?ve[de%ve.length]:ve},U=g.length,V=C?C.row-h.row+1:0;for(C?W=V:W=Math.max(U,V),A=0;A<W&&!(C&&Q.row>C.row&&V>U||!w.allowInsertRow&&Q.row>o.countRows()-1||Q.row>=w.maxRows);A++){const Y=A-$,oe=k(Y).length,de=C?C.col-h.col+1:0;if(C?K=de:K=Math.max(oe,de),Q.col=h.col,N=o.getCellMeta(Q.row,Q.col),(_==="CopyPaste.paste"||_==="Autofill.fill")&&N.skipRowOnPaste){$+=1,Q.row+=1,W+=1;continue}for(H=0,z=0;z<K&&!(C&&Q.col>C.col&&de>oe||!w.allowInsertColumn&&Q.col>o.countCols()-1||Q.col>=w.maxCols);z++){if(N=o.getCellMeta(Q.row,Q.col),(_==="CopyPaste.paste"||_==="Autofill.fill")&&N.skipColumnOnPaste){H+=1,Q.col+=1,K+=1;continue}if(N.readOnly&&_!=="UndoRedo.undo"){Q.col+=1;continue}const ve=z-H;let xe=k(Y,ve),Ne=o.getDataAtCell(Q.row,Q.col);if(xe!==null&&typeof xe=="object")if(Array.isArray(xe)&&Ne===null&&(Ne=[]),Ne===null||typeof Ne!="object")B=!1;else{const Qe=ju(Array.isArray(Ne)?Ne:Ne[0]||Ne),ke=ju(Array.isArray(xe)?xe:xe[0]||xe);Lv(Qe,ke)||Array.isArray(Qe)&&Array.isArray(ke)?xe=_n(xe):B=!1}else Ne!==null&&typeof Ne=="object"&&(B=!1);B&&Z.push([Q.row,Q.col,xe]),B=!0,Q.col+=1}Q.row+=1}o.setDataAtCell(Z,null,null,_||"populateFromArray");break}}};function F(h){const g=Ax(h);_0(g)?(o.runHooks("beforeLanguageChange",g),M.language=g,o.runHooks("afterLanguageChange",g)):Px(h)}function L(h,g){const C=h==="className"?o.rootElement:o.table;if(d)ee(C,g);else{let _=[],O=[];M[h]&&(_=Array.isArray(M[h])?M[h]:AE(M[h])),g&&(O=Array.isArray(g)?g:AE(g));const A=xE(_,O),W=xE(O,_);A.length&&He(C,A),W.length&&ee(C,W)}M[h]=g}this.init=function(){a.setData(w.data),o.runHooks("beforeInit"),(is()||nx())&&ee(o.rootElement,"mobile"),this.updateSettings(w,!0),this.view=new f3(this),c=xC.getInstance(o,w,R),o.runHooks("init"),this.forceFullRender=!0,this.view.render(),d&&o.rootElement.offsetParent===null&&mz(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof d=="object"&&(o.runHooks("afterChange",d[0],d[1]),d=!1),o.runHooks("afterInit")};function j(){let h=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,h=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&h===!1&&(h=!0,this.onQueueEmpty(this.valid))}}}function X(h){const g=h.replace(",",".");return isNaN(parseFloat(g))===!1?parseFloat(g):h}function G(h,g,C){if(!h.length)return;const _=o.getActiveEditor(),O=new j;let A=!0;O.onQueueEmpty=W=>{_&&A&&_.cancelChanges(),C(W)};for(let W=h.length-1;W>=0;W--){const[z,K,,Z]=h[W],Q=l.propToCol(K),pe=o.getCellMeta(z,Q);pe.type==="numeric"&&typeof Z=="string"&&qz(Z)&&(h[W][3]=X(Z)),o.getCellValidator(pe)&&(O.addValidatorToQueue(),o.validateCell(h[W][3],pe,function(Ae,Ee){return function(_e){if(typeof _e!="boolean")throw new Error("Validation error: result is not boolean");if(_e===!1&&Ee.allowInvalid===!1){A=!1,h.splice(Ae,1),Ee.valid=!0;const q=o.getCell(Ee.visualRow,Ee.visualCol);q!==null&&He(q,w.invalidCellClassName)}O.removeValidatorFormQueue()}}(W,pe),g))}O.checkIfQueueIsEmpty()}function te(h,g){let C=h.length-1;if(C<0)return;for(;C>=0;C--){let O=!1;if(h[C]===null){h.splice(C,1);continue}if(!((h[C][2]===null||h[C][2]===void 0)&&(h[C][3]===null||h[C][3]===void 0))){if(w.allowInsertRow)for(;h[C][0]>o.countRows()-1;){const{delta:A}=l.createRow(void 0,void 0,{source:g});if(A===0){O=!0;break}}if(o.dataType==="array"&&(!w.columns||w.columns.length===0)&&w.allowInsertColumn)for(;l.propToCol(h[C][1])>o.countCols()-1;){const{delta:A}=l.createCol(void 0,void 0,{source:g});if(A===0){O=!0;break}}O||l.set(h[C][0],h[C][1],h[C][3])}}o.forceFullRender=!0,u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",h,g),c.lockEditor(),o._refreshBorders(null),c.unlockEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",h,g||"edit");const _=o.getActiveEditor();_&&ue(_.refreshValue)&&_.refreshValue()}this._createCellCoords=function(h,g){return o.view._wt.createCellCoords(h,g)},this._createCellRange=function(h,g,C){return o.view._wt.createCellRange(h,g,C)},this.validateCell=function(h,g,C,_){let O=o.getCellValidator(g);function A(W){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||g.hidden===!0){C(W);return}const K=g.visualCol,Z=g.visualRow,Q=o.getCell(Z,K,!0);if(Q&&Q.nodeName!=="TH"){const pe=o.rowIndexMapper.getRenderableFromVisualIndex(Z),Ae=o.columnIndexMapper.getRenderableFromVisualIndex(K);o.view._wt.getSetting("cellRenderer",pe,Ae,Q)}C(W)}ez(O)&&(O=function(W){return function(z,K){K(W.test(z))}}(O)),ut(O)?(h=o.runHooks("beforeValidate",h,g.visualRow,g.prop,_),o._registerImmediate(()=>{O.call(g,h,W=>{o&&(W=o.runHooks("afterValidate",W,h,g.visualRow,g.prop,_),g.valid=W,A(W),o.runHooks("postAfterValidate",W,h,g.visualRow,g.prop,_))})})):o._registerImmediate(()=>{g.valid=!0,A(g.valid,!1)})};function ie(h,g,C){return Array.isArray(h)?h:[[h,g,C]]}function le(h,g){const C=o.getActiveEditor(),_=o.runHooks("beforeChange",h,g||"edit"),O=h.filter(A=>A!==null);return _===!1||O.length===0?(C&&C.cancelChanges(),[]):O}this.setDataAtCell=function(h,g,C,_){const O=ie(h,g,C),A=[];let W=_,z,K,Z;for(z=0,K=O.length;z<K;z++){if(typeof O[z]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof O[z][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");O[z][1]>=this.countCols()?Z=O[z][1]:Z=l.colToProp(O[z][1]),A.push([O[z][0],Z,a.getAtCell(this.toPhysicalRow(O[z][0]),O[z][1]),O[z][2]])}!W&&typeof h=="object"&&(W=g);const Q=le(A,_);o.runHooks("afterSetDataAtCell",Q,W),G(Q,W,()=>{te(Q,W)})},this.setDataAtRowProp=function(h,g,C,_){const O=ie(h,g,C),A=[];let W=_,z,K;for(z=0,K=O.length;z<K;z++)A.push([O[z][0],O[z][1],a.getAtCell(this.toPhysicalRow(O[z][0]),O[z][1]),O[z][2]]);!W&&typeof h=="object"&&(W=g);const Z=le(A,_);o.runHooks("afterSetDataAtRowProp",Z,W),G(Z,W,()=>{te(Z,W)})},this.listen=function(){o&&!o.isListening()&&(hp=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(hp=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return hp===o.guid},this.destroyEditor=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;o._refreshBorders(h,g)},this.populateFromArray=function(h,g,C,_,O,A,W){if(!(typeof C=="object"&&typeof C[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const z=typeof _=="number"?o._createCellCoords(_,O):null;return u.populateFromArray(o._createCellCoords(h,g),C,z,A,W)},this.spliceCol=function(h,g,C){for(var _=arguments.length,O=new Array(_>3?_-3:0),A=3;A<_;A++)O[A-3]=arguments[A];return l.spliceCol(h,g,C,...O)},this.spliceRow=function(h,g,C){for(var _=arguments.length,O=new Array(_>3?_-3:0),A=3;A<_;A++)O[A-3]=arguments[A];return l.spliceRow(h,g,C,...O)},this.getSelected=function(){if(R.isSelected())return Ve(R.getSelectedRange(),h=>{let{from:g,to:C}=h;return[g.row,g.col,C.row,C.col]})},this.getSelectedLast=function(){const h=this.getSelected();let g;return h&&h.length>0&&(g=h[h.length-1]),g},this.getSelectedRange=function(){if(R.isSelected())return Array.from(R.getSelectedRange())},this.getSelectedRangeLast=function(){const h=this.getSelectedRange();let g;return h&&h.length>0&&(g=h[h.length-1]),g},this.emptySelectedCells=function(h){if(!R.isSelected()||this.countRows()===0||this.countCols()===0)return;const g=[];P(R.getSelectedRange(),C=>{const _=C.getTopStartCorner(),O=C.getBottomEndCorner();Ce(_.row,O.row,A=>{Ce(_.col,O.col,W=>{this.getCellMeta(A,W).readOnly||g.push([A,W,null])})})}),g.length>0&&this.setDataAtCell(g,h)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const h=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(h,0),!this.isRenderSuspended()&&h===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(c.lockEditor(),this._refreshBorders(null),c.unlockEditor()))},this.batchRender=function(h){this.suspendRender();const g=h();return this.resumeRender(),g},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const g=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(g,0),(!this.isExecutionSuspended()&&g===this.executionSuspendedCounter||h)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const C=h();return this.resumeExecution(g),C},this.batch=function(h){this.suspendRender(),this.suspendExecution();const g=h();return this.resumeExecution(),this.resumeRender(),g},this.refreshDimensions=function(){if(!o.view)return;const{width:h,height:g}=o.view.getLastSize(),{width:C,height:_}=o.rootElement.getBoundingClientRect(),O=C!==h||_!==g;o.runHooks("beforeRefreshDimensions",{width:h,height:g},{width:C,height:_},O)!==!1&&((O||o.view._wt.wtOverlays.scrollableElement===o.rootWindow)&&(o.view.setLastSize(C,_),o.render()),o.runHooks("afterRefreshDimensions",{width:h,height:g},{width:C,height:_},O))},this.updateData=function(h,g){_T(h,C=>{l=C},C=>{l=C,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols()},{hotInstance:o,dataMap:l,dataSource:a,internalSource:"updateData",source:g,metaManager:p,firstRun:d})},this.loadData=function(h,g){_T(h,C=>{l=C},()=>{p.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),d&&(d=[null,"loadData"])},{hotInstance:o,dataMap:l,dataSource:a,internalSource:"loadData",source:g,metaManager:p,firstRun:d})},this.getInitialColumnCount=function(){const h=w.columns;let g=0;if(Array.isArray(h))g=h.length;else if(ut(h))if(o.dataType==="array"){const C=this.countSourceCols();for(let _=0;_<C;_+=1)h(_)&&(g+=1)}else(o.dataType==="object"||o.dataType==="function")&&(g=l.colToPropCache.length);else if(ue(w.dataSchema)){const C=l.getSchema();g=Array.isArray(C)?C.length:Fv(C)}else g=this.countSourceCols();return g},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(h,g,C,_){return dt(h)?l.getAll():l.getRange(o._createCellCoords(h,g),o._createCellCoords(C,_),l.DESTINATION_RENDERER)},this.getCopyableText=function(h,g,C,_){return l.getCopyableText(o._createCellCoords(h,g),o._createCellCoords(C,_))},this.getCopyableData=function(h,g){return l.getCopyable(h,l.colToProp(g))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const C=(d?o.loadData:o.updateData).bind(this);let _=!1,O,A;if(ue(h.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ue(h.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ue(h.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(O in h)O==="data"||(O==="language"?F(h.language):O==="className"?L("className",h.className):O==="tableClassName"&&o.table?(L("tableClassName",h.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames()):he.getSingleton().isRegistered(O)||he.getSingleton().isDeprecated(O)?(ut(h[O])||Array.isArray(h[O]))&&(h[O].initialHook=!0,o.addHook(O,h[O])):!g&&Ht(h,O)&&(M[O]=h[O]));h.data===void 0&&w.data===void 0?C(null,"updateSettings"):h.data!==void 0?C(h.data,"updateSettings"):h.columns!==void 0&&(l.createMap(),o.initIndexMappers());const W=o.countCols(),z=w.columns;if(z&&ut(z)&&(_=!0),(h.cell!==void 0||h.cells!==void 0||h.columns!==void 0)&&p.clearCache(),W>0)for(O=0,A=0;O<W;O++){if(z){const Q=_?z(O):z[A];Q&&p.updateColumnMeta(A,Q)}A+=1}ue(h.cell)&&Be(h.cell,Q=>{o.setCellMetaObject(Q.row,Q.col,Q)}),o.runHooks("afterCellMetaReset");let K=o.rootElement.style.height;K!==""&&(K=parseInt(o.rootElement.style.height,10));let Z=h.height;if(ut(Z)&&(Z=Z()),g&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),Z===null){const Q=o.rootElement.getAttribute("data-initialstyle");Q&&(Q.indexOf("height")>-1||Q.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",Q):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else Z!==void 0&&(o.rootElement.style.height=isNaN(Z)?`${Z}`:`${Z}px`,o.rootElement.style.overflow="hidden");if(typeof h.width<"u"){let Q=h.width;ut(Q)&&(Q=Q()),o.rootElement.style.width=isNaN(Q)?`${Q}`:`${Q}px`}g||(o.view&&(o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames()),o.runHooks("afterUpdateSettings",h)),u.adjustRowsAndCols(),o.view&&!d&&(o.forceFullRender=!0,c.lockEditor(),o._refreshBorders(null),o.view._wt.wtOverlays.adjustElementsSize(),c.unlockEditor()),!g&&o.view&&(K===""||Z===""||Z===void 0)&&K!==Z&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const h=o.getSelectedLast();if(w.getValue){if(ut(w.getValue))return w.getValue.call(o);if(h)return o.getData()[h[0][0]][w.getValue]}else if(h)return o.getDataAtCell(h[0],h[1])},this.getSettings=function(){return w},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(h,g,C,_,O){u.alter(h,g,C,_,O)},this.getCell=function(h,g){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,_=g,O=h;if(g>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(g)))return null;_=this.columnIndexMapper.getRenderableFromVisualIndex(g)}if(h>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(h)))return null;O=this.rowIndexMapper.getRenderableFromVisualIndex(h)}return O===null||_===null?null:o.view.getCellAtCoords(o._createCellCoords(O,_),C)},this.getCoords=function(h){const g=this.view._wt.wtTable.getCoords(h);if(g===null)return null;const{row:C,col:_}=g;let O=C,A=_;return C>=0&&(O=this.rowIndexMapper.getVisualFromRenderableIndex(C)),_>=0&&(A=this.columnIndexMapper.getVisualFromRenderableIndex(_)),o._createCellCoords(O,A)},this.colToProp=function(h){return l.colToProp(h)},this.propToCol=function(h){return l.propToCol(h)},this.toVisualRow=h=>this.rowIndexMapper.getVisualFromPhysicalIndex(h),this.toVisualColumn=h=>this.columnIndexMapper.getVisualFromPhysicalIndex(h),this.toPhysicalRow=h=>this.rowIndexMapper.getPhysicalFromVisualIndex(h),this.toPhysicalColumn=h=>this.columnIndexMapper.getPhysicalFromVisualIndex(h),this.getDataAtCell=function(h,g){return l.get(h,l.colToProp(g))},this.getDataAtRowProp=function(h,g){return l.get(h,g)},this.getDataAtCol=function(h){const g=[],C=l.getRange(o._createCellCoords(0,h),o._createCellCoords(w.data.length-1,h),l.DESTINATION_RENDERER);for(let _=0;_<C.length;_+=1)for(let O=0;O<C[_].length;O+=1)g.push(C[_][O]);return g},this.getDataAtProp=function(h){const g=[],C=l.getRange(o._createCellCoords(0,l.propToCol(h)),o._createCellCoords(w.data.length-1,l.propToCol(h)),l.DESTINATION_RENDERER);for(let _=0;_<C.length;_+=1)for(let O=0;O<C[_].length;O+=1)g.push(C[_][O]);return g},this.getSourceData=function(h,g,C,_){let O;return h===void 0?O=a.getData():O=a.getByRange(o._createCellCoords(h,g),o._createCellCoords(C,_)),O},this.getSourceDataArray=function(h,g,C,_){let O;return h===void 0?O=a.getData(!0):O=a.getByRange(o._createCellCoords(h,g),o._createCellCoords(C,_),!0),O},this.getSourceDataAtCol=function(h){return a.getAtColumn(h)},this.setSourceDataAtCell=function(h,g,C,_){const O=ie(h,g,C),A=this.hasHook("afterSetSourceDataAtCell"),W=[];A&&P(O,K=>{let[Z,Q,pe]=K;W.push([Z,Q,a.getAtCell(Z,Q),pe])}),P(O,K=>{let[Z,Q,pe]=K;a.setAtCell(Z,Q,pe)}),A&&this.runHooks("afterSetSourceDataAtCell",W,_),this.render();const z=o.getActiveEditor();z&&ue(z.refreshValue)&&z.refreshValue()},this.getSourceDataAtRow=function(h){return a.getAtRow(h)},this.getSourceDataAtCell=function(h,g){return a.getAtCell(h,g)},this.getDataAtRow=function(h){return l.getRange(o._createCellCoords(h,0),o._createCellCoords(h,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(h,g,C,_){const O=h===void 0?[0,0,this.countRows(),this.countCols()]:[h,g,C,_],[A,W]=O;let[,,z,K]=O,Z=null,Q=null;z===void 0&&(z=A),K===void 0&&(K=W);let pe="mixed";return Ce(Math.max(Math.min(A,z),0),Math.max(A,z),Ae=>{let Ee=!0;return Ce(Math.max(Math.min(W,K),0),Math.max(W,K),_e=>(Q=this.getCellMeta(Ae,_e).type,Z?Ee=Z===Q:Z=Q,Ee)),pe=Ee?Q:"mixed",Ee}),pe},this.removeCellMeta=function(h,g,C){const[_,O]=[this.toPhysicalRow(h),this.toPhysicalColumn(g)];let A=p.getCellMetaKeyValue(_,O,C);o.runHooks("beforeRemoveCellMeta",h,g,C,A)!==!1&&(p.removeCellMeta(_,O,C),o.runHooks("afterRemoveCellMeta",h,g,C,A)),A=null},this.spliceCellsMeta=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var C=arguments.length,_=new Array(C>2?C-2:0),O=2;O<C;O++)_[O-2]=arguments[O];if(_.length>0&&!Array.isArray(_[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");g>0&&p.removeRow(this.toPhysicalRow(h),g),_.length>0&&P(_.reverse(),A=>{p.createRow(this.toPhysicalRow(h)),P(A,(W,z)=>this.setCellMetaObject(h,z,W))}),o.render()},this.setCellMetaObject=function(h,g,C){typeof C=="object"&&Be(C,(_,O)=>{this.setCellMeta(h,g,O,_)})},this.setCellMeta=function(h,g,C,_){if(o.runHooks("beforeSetCellMeta",h,g,C,_)===!1)return;let A=h,W=g;h<this.countRows()&&(A=this.toPhysicalRow(h)),g<this.countCols()&&(W=this.toPhysicalColumn(g)),p.setCellMeta(A,W,C,_),o.runHooks("afterSetCellMeta",h,g,C,_)},this.getCellsMeta=function(){return p.getCellsMeta()},this.getCellMeta=function(h,g){let C=this.toPhysicalRow(h),_=this.toPhysicalColumn(g);return C===null&&(C=h),_===null&&(_=g),p.getCellMeta(C,_,{visualRow:h,visualColumn:g})},this.getCellMetaAtRow=function(h){return p.getCellsMetaAtRow(h)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||w.columns)},this.getCellRenderer=function(h,g){const C=typeof h=="number"?o.getCellMeta(h,g).renderer:h.renderer;return typeof C=="string"?tT(C):dt(C)?tT("text"):C},this.getCellEditor=function(h,g){const C=typeof h=="number"?o.getCellMeta(h,g).editor:h.editor;return typeof C=="string"?qE(C):dt(C)?qE("text"):C},this.getCellValidator=function(h,g){const C=typeof h=="number"?o.getCellMeta(h,g).validator:h.validator;return typeof C=="string"?fY(C):C},this.validateCells=function(h){this._validateCells(h)},this.validateRows=function(h,g){if(!Array.isArray(h))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(g,h)},this.validateColumns=function(h,g){if(!Array.isArray(h))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(g,void 0,h)},this._validateCells=function(h,g,C){const _=new j;h&&(_.onQueueEmpty=h);let O=o.countRows()-1;for(;O>=0;){if(g!==void 0&&g.indexOf(O)===-1){O-=1;continue}let A=o.countCols()-1;for(;A>=0;){if(C!==void 0&&C.indexOf(A)===-1){A-=1;continue}_.addValidatorToQueue(),o.validateCell(o.getDataAtCell(O,A),o.getCellMeta(O,A),W=>{if(typeof W!="boolean")throw new Error("Validation error: result is not boolean");W===!1&&(_.valid=!1),_.removeValidatorFormQueue()},"validateCells"),A-=1}O-=1}_.checkIfQueueIsEmpty()},this.getRowHeader=function(h){let g=w.rowHeaders,C=h;return C!==void 0&&(C=o.runHooks("modifyRowHeader",C)),C===void 0?(g=[],Ce(o.countRows()-1,_=>{g.push(o.getRowHeader(_))})):Array.isArray(g)&&g[C]!==void 0?g=g[C]:ut(g)?g=g(C):g&&typeof g!="string"&&typeof g!="number"&&(g=C+1),g},this.hasRowHeaders=function(){return!!w.rowHeaders},this.hasColHeaders=function(){if(w.colHeaders!==void 0&&w.colHeaders!==null)return!!w.colHeaders;for(let h=0,g=o.countCols();h<g;h++)if(o.getColHeader(h))return!0;return!1},this.getColHeader=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const C=o.runHooks("modifyColHeader",h);if(C===void 0){const z=[],K=o.countCols();for(let Z=0;Z<K;Z++)z.push(o.getColHeader(Z));return z}let _=w.colHeaders;const O=function(z){const K=[],Z=o.countCols();let Q=0;for(;Q<Z;Q++)ut(w.columns)&&w.columns(Q)&&K.push(Q);return K[z]},A=o.toPhysicalColumn(C),W=O(A);return w.colHeaders===!1?_=null:w.columns&&ut(w.columns)&&w.columns(W)&&w.columns(W).title?_=w.columns(W).title:w.columns&&w.columns[A]&&w.columns[A].title?_=w.columns[A].title:Array.isArray(w.colHeaders)&&w.colHeaders[A]!==void 0?_=w.colHeaders[A]:ut(w.colHeaders)?_=w.colHeaders(A):w.colHeaders&&typeof w.colHeaders!="string"&&typeof w.colHeaders!="number"&&(_=m3(C)),_=o.runHooks("modifyColumnHeaderValue",_,h,g),_},this._getColWidthFromSettings=function(h){let g;if(h>=0&&(g=o.getCellMeta(0,h).width),(g===void 0||g===w.width)&&(g=w.colWidths),g!=null){switch(typeof g){case"object":g=g[h];break;case"function":g=g(h);break}typeof g=="string"&&(g=parseInt(g,10))}return g},this.getColWidth=function(h){let g=o._getColWidthFromSettings(h);return g=o.runHooks("modifyColWidth",g,h),g===void 0&&(g=wc.DEFAULT_WIDTH),g},this._getRowHeightFromSettings=function(h){let g=w.rowHeights;if(g!=null){switch(typeof g){case"object":g=g[h];break;case"function":g=g(h);break}typeof g=="string"&&(g=parseInt(g,10))}return g},this.getRowHeight=function(h){let g=o._getRowHeightFromSettings(h);return g=o.runHooks("modifyRowHeight",g,h),g},this.countSourceRows=function(){return a.countRows()},this.countSourceCols=function(){return a.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const h=w.maxCols,g=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(h,g)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=0;return AC(o.countRows()-1,C=>{if(o.isEmptyRow(C))g+=1;else if(h===!0)return!1}),g},this.countEmptyCols=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=0;return AC(o.countCols()-1,C=>{if(o.isEmptyCol(C))g+=1;else if(h===!0)return!1}),g},this.isEmptyRow=function(h){return w.isEmptyRow.call(o,h)},this.isEmptyCol=function(h){return w.isEmptyCol.call(o,h)},this.selectCell=function(h,g,C,_){let O=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,A=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return dt(h)||dt(g)?!1:this.selectCells([[h,g,C,_]],O,A)},this.selectCells=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;g===!1&&(s=!0);const _=R.selectCells(h);return _&&C&&o.listen(),s=!1,_},this.selectColumns=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h;return R.selectColumns(h,g)},this.selectRows=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h;return R.selectRows(h,g)},this.deselectCell=function(){R.deselect()},this.selectAll=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const g=h&&this.hasRowHeaders(),C=h&&this.hasColHeaders();s=!0,R.selectAll(g,C),s=!1};const me=(h,g)=>h.getNearestNotHiddenIndex(g,1,!0);this.scrollViewportTo=function(h,g){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,_=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,O=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;const A=!C,W=!_;let z=h,K=g;if(O){const pe=Number.isInteger(h),Ae=Number.isInteger(g),Ee=pe?me(this.rowIndexMapper,h):void 0,_e=Ae?me(this.columnIndexMapper,g):void 0;if(Ee===null||_e===null)return!1;z=pe?o.rowIndexMapper.getRenderableFromVisualIndex(Ee):void 0,K=Ae?o.columnIndexMapper.getRenderableFromVisualIndex(_e):void 0}const Z=Number.isInteger(z),Q=Number.isInteger(K);return Z&&Q?o.view.scrollViewport(o._createCellCoords(z,K),A,_,C,W):Z&&Q===!1?o.view.scrollViewportVertically(z,A,C):Q&&Z===!1?o.view.scrollViewportHorizontally(K,_,W):!1},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),a&&a.destroy(),a=null,this.getShortcutManager().destroy(),p.clearCache(),FC(o)){const h=this.rootDocument.querySelector(".hot-display-license-info");h&&h.parentNode.removeChild(h)}hs(o.rootElement),i.destroy(),c&&c.destroy(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),S.getItems().forEach(h=>{let[,g]=h;g.destroy()}),S.clear(),o.runHooks("afterDestroy")},!0),he.getSingleton().destroy(o),Be(o,(h,g,C)=>{ut(h)?C[g]=Te(g):g!=="guid"&&(C[g]=null)}),o.isDestroyed=!0,l&&l.destroy(),l=null,u=null,R=null,c=null,o=null};function Te(h){return()=>{throw new Error(`The "${h}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getPlugin=function(h){const g=Lr(h);return g==="UndoRedo"?this.undoRedo:S.getItem(g)},this.getPluginName=function(h){return h===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:S.getId(h)},this.getInstance=function(){return o},this.addHook=function(h,g){he.getSingleton().add(h,g,o)},this.hasHook=function(h){return he.getSingleton().has(h,o)||he.getSingleton().has(h)},this.addHookOnce=function(h,g){he.getSingleton().once(h,g,o)},this.removeHook=function(h,g){he.getSingleton().remove(h,g,o)},this.runHooks=function(h,g,C,_,O,A,W){return he.getSingleton().run(o,h,g,C,_,O,A,W)},this.getTranslatedPhrase=function(h,g){return Fx(w.language,h,g)},this.toHTML=()=>ZE(this),this.toTableElement=()=>{const h=this.rootDocument.createElement("div");return h.insertAdjacentHTML("afterbegin",ZE(this)),h.firstElementChild},this.timeouts=[],this._registerTimeout=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,C=h;typeof C=="function"&&(C=setTimeout(C,g)),this.timeouts.push(C)},this._clearTimeouts=function(){P(this.timeouts,h=>{clearTimeout(h)})},this.immediates=[],this._registerImmediate=function(h){this.immediates.push(setImmediate(h))},this._clearImmediates=function(){P(this.immediates,h=>{clearImmediate(h)})},this._refreshBorders=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.destroyEditor(h),o.view.render(),g&&R.isSelected()&&c.prepareEditor()},this.isRtl=function(){return o.rootWindow.getComputedStyle(o.rootElement).direction==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1};const Ue=PG({handleEvent(h){const g=o.isListening(),C=(h==null?void 0:h.key)!==void 0;return g&&C},beforeKeyDown:h=>this.runHooks("beforeKeyDown",h),afterKeyDown:h=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",h)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",h=>{h.ctrlKey===!1&&h.metaKey===!1&&Ue.releasePressedKeys()}),this.getShortcutManager=function(){return Ue};const Me=Ue.addContext("grid"),E={runOnlyIf:()=>ue(o.getSelected())&&o.countRenderedRows()>0&&o.countRenderedCols()>0,group:HG};Ue.setActiveContextName("grid"),Me.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>{o.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:()=>{const h=o.getSelectedRange(),{row:g,col:C}=h[h.length-1].highlight,_=o.getDataAtCell(g,C),O=new Map;for(let A=0;A<h.length;A++)h[A].forAll((W,z)=>{if(W>=0&&z>=0&&(W!==g||z!==C)){const{readOnly:K}=o.getCellMeta(W,z);K||O.set(`${W}x${z}`,[W,z,_])}});o.setDataAtCell(Array.from(O.values()))},runOnlyIf:()=>o.getSelectedRangeLast().getCellsCount()>1},{keys:[["ArrowUp"]],callback:()=>{R.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>{R.setRangeStart(o._createCellCoords(o.rowIndexMapper.getNearestNotHiddenIndex(0,1),o.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:()=>{R.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:h,to:g}=o.getSelectedRangeLast(),C=o.rowIndexMapper.getNearestNotHiddenIndex(0,1);R.setRangeStart(h.clone()),R.setRangeEnd(o._createCellCoords(C,g.col))},runOnlyIf:()=>!(o.selection.isSelectedByCorner()||o.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>{R.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>{R.setRangeStart(o._createCellCoords(o.rowIndexMapper.getNearestNotHiddenIndex(o.countRows()-1,-1),o.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:()=>{R.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:h,to:g}=o.getSelectedRangeLast(),C=o.rowIndexMapper.getNearestNotHiddenIndex(o.countRows()-1,-1);R.setRangeStart(h.clone()),R.setRangeEnd(o._createCellCoords(C,g.col))},runOnlyIf:()=>!(o.selection.isSelectedByCorner()||o.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>{R.transformStart(0,-1*o.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>{const h=o.getSelectedRangeLast().highlight.row,g=o.columnIndexMapper.getNearestNotHiddenIndex(...o.isRtl()?[o.countCols()-1,-1]:[0,1]);R.setRangeStart(o._createCellCoords(h,g))}},{keys:[["ArrowLeft","Shift"]],callback:()=>{R.transformEnd(0,-1*o.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:h,to:g}=o.getSelectedRangeLast(),C=o.columnIndexMapper.getNearestNotHiddenIndex(...o.isRtl()?[o.countCols()-1,-1]:[0,1]);R.setRangeStart(h.clone()),R.setRangeEnd(o._createCellCoords(g.row,C))},runOnlyIf:()=>!(o.selection.isSelectedByCorner()||o.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>{R.transformStart(0,o.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>{const h=o.getSelectedRangeLast().highlight.row,g=o.columnIndexMapper.getNearestNotHiddenIndex(...o.isRtl()?[0,1]:[o.countCols()-1,-1]);R.setRangeStart(o._createCellCoords(h,g))}},{keys:[["ArrowRight","Shift"]],callback:()=>{R.transformEnd(0,o.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:h,to:g}=o.getSelectedRangeLast(),C=o.columnIndexMapper.getNearestNotHiddenIndex(...o.isRtl()?[0,1]:[o.countCols()-1,-1]);R.setRangeStart(h.clone()),R.setRangeEnd(o._createCellCoords(g.row,C))},runOnlyIf:()=>!(o.selection.isSelectedByCorner()||o.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>{const h=parseInt(o.getSettings().fixedColumnsStart,10),g=o.getSelectedRangeLast().highlight.row,C=o.columnIndexMapper.getNearestNotHiddenIndex(h,1);R.setRangeStart(o._createCellCoords(g,C))},runOnlyIf:()=>o.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>{R.setRangeEnd(o._createCellCoords(R.selectedRange.current().from.row,o.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>{const h=parseInt(o.getSettings().fixedRowsTop,10),g=parseInt(o.getSettings().fixedColumnsStart,10),C=o.rowIndexMapper.getNearestNotHiddenIndex(h,1),_=o.columnIndexMapper.getNearestNotHiddenIndex(g,1);R.setRangeStart(o._createCellCoords(C,_))},runOnlyIf:()=>o.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>{R.setRangeStart(o._createCellCoords(o.getSelectedRangeLast().highlight.row,o.columnIndexMapper.getNearestNotHiddenIndex(o.countCols()-1,-1)))},runOnlyIf:()=>o.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>{R.setRangeEnd(o._createCellCoords(R.selectedRange.current().from.row,o.columnIndexMapper.getNearestNotHiddenIndex(o.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>{const h=parseInt(o.getSettings().fixedRowsBottom,10),g=o.rowIndexMapper.getNearestNotHiddenIndex(o.countRows()-h-1,-1),C=o.columnIndexMapper.getNearestNotHiddenIndex(o.countCols()-1,-1);R.setRangeStart(o._createCellCoords(g,C))},runOnlyIf:()=>o.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>{R.transformStart(-o.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:()=>{const{to:h}=o.getSelectedRangeLast(),g=Math.max(h.row-o.countVisibleRows(),0),C=o.rowIndexMapper.getNearestNotHiddenIndex(g,1);if(C!==null){const _=o._createCellCoords(C,h.col),O=h.row-o.view.getFirstFullyVisibleRow(),A=Math.max(_.row-O,0);R.setRangeEnd(_),o.scrollViewportTo(A)}}},{keys:[["PageDown"]],callback:()=>{R.transformStart(o.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:()=>{const{to:h}=o.getSelectedRangeLast(),g=Math.min(h.row+o.countVisibleRows(),o.countRows()-1),C=o.rowIndexMapper.getNearestNotHiddenIndex(g,-1);if(C!==null){const _=o._createCellCoords(C,h.col),O=h.row-o.view.getFirstFullyVisibleRow(),A=Math.min(_.row-O,o.countRows()-1);R.setRangeEnd(_),o.scrollViewportTo(A)}}},{keys:[["Tab"]],callback:h=>{const g=typeof w.tabMoves=="function"?w.tabMoves(h):w.tabMoves;R.transformStart(g.row,g.col,!0)}},{keys:[["Shift","Tab"]],callback:h=>{const g=typeof w.tabMoves=="function"?w.tabMoves(h):w.tabMoves;R.transformStart(-g.row,-g.col)}}],E),hx().forEach(h=>{const g=Wv(h);S.addItem(h,new g(this))}),he.getSingleton().run(o,"construct")}const DG="hooksRefRegisterer",Yx={_hooksStorage:Object.create(null),addHook(n,e){return this._hooksStorage[n]||(this._hooksStorage[n]=[]),this.hot.addHook(n,e),this._hooksStorage[n].push(e),this},removeHooksByKey(n){P(this._hooksStorage[n]||[],e=>{this.hot.removeHook(n,e)})},clearHooks(){Be(this._hooksStorage,(n,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};qs(Yx,"MIXIN_NAME",DG,{writable:!1,enumerable:!1});const kG="base",qt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),WC="baseEditor";class ca{static get EDITOR_TYPE(){return kG}constructor(e){this.hot=e,this.instance=e,this.state=qt.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,r,s,o,i){this.TD=s,this.row=e,this.col=t,this.prop=r,this.originalValue=o,this.cellProperties=i,this.state=qt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let r,s,o,i;if(t){const d=this.hot.getSelectedLast();r=Math.max(Math.min(d[0],d[2]),0),s=Math.max(Math.min(d[1],d[3]),0),o=Math.max(d[0],d[2]),i=Math.max(d[1],d[3])}else[r,s,o,i]=[this.row,this.col,null,null];const l=this.hot.runHooks("modifyGetCellCoords",r,s);Array.isArray(l)&&([r,s]=l);const u=this.hot.getShortcutManager().getContext("editor"),c={runOnlyIf:()=>ue(this.hot.getSelected()),group:WC};this.isInFullEditMode()&&u.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],c),this.hot.populateFromArray(r,s,e,o,i,"edit")}beginEditing(e,t){if(this.state!==qt.VIRGIN)return;const r=this.hot,s=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(s,o)),this.state=qt.EDITING,this.isInFullEditMode()){const i=typeof e=="string"?e:Lt(this.originalValue);this.setValue(i)}this.open(t),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,t,r){let s;if(r){const l=this._closeCallback;this._closeCallback=a=>{l&&l(a),r(a),this.hot.view.render()}}if(this.isWaiting())return;const i=this.hot.getShortcutManager().getContext("editor");if(i.removeShortcutsByGroup(WC),i.removeShortcutsByGroup(cg),this.state===qt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===qt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const l=this.getValue();this.cellProperties.trimWhitespace?s=[[typeof l=="string"?String.prototype.trim.call(l||""):l]]:s=[[l]],this.state=qt.WAITING,this.saveValue(s,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",a=>{this.state=qt.FINISHED,this.discardEditor(a)}):(this.state=qt.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=qt.FINISHED,this.discardEditor()}discardEditor(e){this.state===qt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=qt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=qt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===qt.WAITING}getEditedCellRect(){var e;const t=this.getEditedCell();if(!t)return;const{wtOverlays:r,wtViewport:s}=this.hot.view._wt,o=this.hot.rootWindow,i=Wt(t),l=st(t),a=Wt(this.hot.rootElement),u=st(this.hot.rootElement),c=r.topOverlay.holder,d=r.inlineStartOverlay.holder,f=c!==o?c.scrollTop:0,m=d!==o?d.scrollLeft:0,p=o.innerWidth-a.left-u,{wtTable:w}=(e=r.getParentOverlay(t))!==null&&e!==void 0?e:this.hot.view._wt,M=w.name,S=["master","inline_start"].includes(M)?f:0,y=["master","top","bottom"].includes(M)?m:0,v=i.top===a.top?0:1;let R=i.top-a.top-v-S,I=0;this.hot.isRtl()?I=o.innerWidth-i.left-l-p-1+y:I=i.left-a.left-1-y,["top","top_inline_start_corner"].includes(M)&&(R+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(M)&&(I+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const F=this.hot.hasColHeaders(),L=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),j=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),G=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(F&&L<=0||L===G)&&(R+=1),j<=0&&(I+=1);const te=s.rowsRenderCalculator.startPosition,ie=s.columnsRenderCalculator.startPosition,le=Math.abs(r.inlineStartOverlay.getScrollPosition()),me=r.topOverlay.getScrollPosition(),Te=en(this.hot.rootDocument),Ue=t.offsetTop+te-me;let Me=0;if(this.hot.isRtl()){const Z=t.offsetLeft;Z>=0?Me=w.getWidth()-t.offsetLeft:Me=Math.abs(Z),Me+=ie-le-l}else Me=t.offsetLeft+ie-le;const E=Mi(this.TD,this.hot.rootWindow),h=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",g=parseInt(E[h],10)>0?0:1,C=parseInt(E.borderTopWidth,10)>0?0:1,_=st(t)+g,O=_t(t)+C,A=dz(c)?Te:0,W=fz(d)?Te:0,z=this.hot.view.maximumVisibleElementWidth(Me)-A+g,K=Math.max(this.hot.view.maximumVisibleElementHeight(Ue)-W+C,23);return{top:R,start:I,height:O,maxHeight:K,width:_,maxWidth:z}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?t="top-inline-start-corner":t="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?t="bottom-inline-start-corner":t="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}at(ca,Yx);function NG(){var n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},e,t=document.body,r=document.createTextNode(""),s=document.createElement("SPAN"),o=function(f,m,p){f.addEventListener(m,p,!1)},i=function(f,m,p){f.removeEventListener(m,p,!1)},l=function(f){var m,p;f?/^[a-zA-Z \.,\\\/\|0-9]$/.test(f)||(f="."):f="",r.textContent!==void 0?r.textContent=e.value+f:r.data=e.value+f,s.style.position="absolute",s.style.fontSize=d(e).fontSize,s.style.fontFamily=d(e).fontFamily,s.style.whiteSpace="pre",t.appendChild(s),m=s.clientWidth+2,t.removeChild(s),e.style.height=n.minHeight+"px",n.minWidth>m?e.style.width=n.minWidth+"px":m>n.maxWidth?e.style.width=n.maxWidth+"px":e.style.width=m+"px",p=e.scrollHeight?e.scrollHeight-1:0,n.minHeight>p?e.style.height=n.minHeight+"px":n.maxHeight<p?(e.style.height=n.maxHeight+"px",e.style.overflowY="visible"):e.style.height=p+"px"},a=function(){window.setTimeout(l,0)},u=function(f){if(f&&f.minHeight)if(f.minHeight=="inherit")n.minHeight=e.clientHeight;else{var m=parseInt(f.minHeight);isNaN(m)||(n.minHeight=m)}if(f&&f.maxHeight)if(f.maxHeight=="inherit")n.maxHeight=e.clientHeight;else{var p=parseInt(f.maxHeight);isNaN(p)||(n.maxHeight=p)}if(f&&f.minWidth)if(f.minWidth=="inherit")n.minWidth=e.clientWidth;else{var w=parseInt(f.minWidth);isNaN(w)||(n.minWidth=w)}if(f&&f.maxWidth)if(f.maxWidth=="inherit")n.maxWidth=e.clientWidth;else{var M=parseInt(f.maxWidth);isNaN(M)||(n.maxWidth=M)}s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(r))},c=function(f,m,p){e=f,u(m),e.nodeName=="TEXTAREA"&&(e.style.resize="none",e.style.overflowY="",e.style.height=n.minHeight+"px",e.style.minWidth=n.minWidth+"px",e.style.maxWidth=n.maxWidth+"px",e.style.overflowY="hidden"),p&&(o(e,"change",l),o(e,"cut",a),o(e,"paste",a),o(e,"drop",a),o(e,"keydown",a),o(e,"focus",l),o(e,"compositionstart",a),o(e,"compositionupdate",a),o(e,"compositionend",a)),l()};function d(f){return f.currentStyle||document.defaultView.getComputedStyle(f)}return{init:function(f,m,p){c(f,m,p)},unObserve:function(){i(e,"change",l),i(e,"cut",a),i(e,"paste",a),i(e,"drop",a),i(e,"keydown",a),i(e,"focus",l),i(e,"compositionstart",a),i(e,"compositionupdate",a),i(e,"compositionend",a)},resize:l}}function xT(n,e){const t=jI(e),r=e.value.split(`
`);let s=t,o=0;for(let i=0;i<r.length;i++){const l=r[i];i!==0&&(o+=r[i-1].length+1);const a=o+l.length;if(n==="home"?s=o:n==="end"&&(s=a),t<=a)break}lg(e,s)}const LG="ht_editor_visible",mh="ht_editor_hidden",AT="textEditor",FG="text";class Vi extends ca{static get EDITOR_TYPE(){return FG}constructor(e){super(e),this.eventManager=new It(this),this.autoResize=NG(),this.TEXTAREA=void 0,this.textareaStyle=void 0,this.TEXTAREA_PARENT=void 0,this.textareaParentStyle=void 0,this.layerClass=void 0,this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",t=>this.onAfterDocumentKeyDown(t)),this.registerShortcuts()}close(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}prepare(e,t,r,s,o,i){const l=this.state;if(super.prepare(e,t,r,s,o,i),!i.readOnly){this.refreshDimensions(!0);const{allowInvalid:a,fragmentSelection:u}=i;a&&(this.TEXTAREA.value=""),l!==qt.FINISHED&&this.hideEditableElement(),!u&&!is()&&this.focus()}}beginEditing(e,t){this.state===qt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),lg(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,ee(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),ee(this.TEXTAREA_PARENT,"handsontableInputHolder"),Oe(this.TEXTAREA_PARENT,this.layerClass)&&He(this.TEXTAREA_PARENT,this.layerClass),ee(this.TEXTAREA_PARENT,mh),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){Lz()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",He(this.TEXTAREA_PARENT,this.layerClass),ee(this.TEXTAREA_PARENT,mh)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";const e=this.TEXTAREA_PARENT.childNodes;let t=!1;Ce(e.length-1,r=>{const s=e[r];if(Oe(s,"handsontableEditor"))return t=!0,!1}),Oe(this.TEXTAREA_PARENT,mh)&&He(this.TEXTAREA_PARENT,mh),t?(this.layerClass=LG,ee(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),ee(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==qt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:t,start:r,width:s,maxWidth:o,height:i,maxHeight:l}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const a=Mi(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=a.fontSize,this.TEXTAREA.style.fontFamily=a.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=Mi(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),d=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),f=s-c,m=i-d,p=o-c,w=l-d;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(f,p),minHeight:Math.min(m,w),maxWidth:p,maxHeight:w},!0)}bindEvents(){this.eventManager.addEventListener(this.TEXTAREA,"cut",e=>e.stopPropagation()),this.eventManager.addEventListener(this.TEXTAREA,"paste",e=>e.stopPropagation()),tx()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>ue(this.hot.getSelected()),group:AT},s=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};t.addShortcuts([{keys:[["Tab"]],callback:o=>{const i=this.hot.getSettings(),l=typeof i.tabMoves=="function"?i.tabMoves(o):i.tabMoves;this.hot.selection.transformStart(l.row,l.col,!0)}},{keys:[["Shift","Tab"]],callback:o=>{const i=this.hot.getSettings(),l=typeof i.tabMoves=="function"?i.tabMoves(o):i.tabMoves;this.hot.selection.transformStart(-l.row,-l.col)}},{keys:[["Control","Enter"]],callback:()=>(s(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey,relativeToGroup:fu,position:"before"},{keys:[["Meta","Enter"]],callback:()=>(s(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple(),relativeToGroup:fu,position:"before"},{keys:[["Alt","Enter"]],callback:()=>(s(),!1),relativeToGroup:fu,position:"before"},{keys:[["PageUp"]],callback:()=>{this.hot.selection.transformStart(-this.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:()=>{this.hot.selection.transformStart(this.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:(o,i)=>{let[l]=i;xT(l,this.TEXTAREA)}},{keys:[["End"]],callback:(o,i)=>{let[l]=i;xT(l,this.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout(()=>{this.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout(()=>{this.autoResize.resize()},10)}}],r)}unregisterShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");t.removeShortcutsByGroup(cg),t.removeShortcutsByGroup(AT),t.removeShortcutsByGroup(WC)}onAfterDocumentKeyDown(e){[we.ARROW_UP,we.ARROW_RIGHT,we.ARROW_DOWN,we.ARROW_LEFT].indexOf(e.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(e.keyCode))}}const VG="base";function bc(n,e,t,r,s,o,i){const l=[],a=[];i.className&&ee(e,i.className),i.readOnly&&l.push(i.readOnlyCellClassName),i.valid===!1&&i.invalidCellClassName?l.push(i.invalidCellClassName):a.push(i.invalidCellClassName),i.wordWrap===!1&&i.noWordWrapClassName&&l.push(i.noWordWrapClassName),!o&&i.placeholder&&l.push(i.placeholderCellClassName),He(e,a),ee(e,l)}bc.RENDERER_TYPE=VG;const $G="text";function Bo(n,e,t,r,s,o,i){bc.apply(this,[n,e,t,r,s,o,i]);let l=o;if(!l&&i.placeholder&&(l=i.placeholder),l=Lt(l),i.trimWhitespace&&(l=l.trim()),i.rendererTemplate){hs(e);const a=n.rootDocument.createElement("TEMPLATE");a.setAttribute("bind","{{}}"),a.innerHTML=i.rendererTemplate,HTMLTemplateElement.decorate(a),a.model=n.getSourceDataAtRow(t),e.appendChild(a)}else Ti(e,l)}Bo.RENDERER_TYPE=$G;const BG="text",jx={CELL_TYPE:BG,editor:Vi,renderer:Bo};Zr(jx);ze.editors={BaseEditor:ca};function ze(n,e){const t=new A0(n,e||{},tS);return t.init(),t}ze.Core=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new A0(n,e,tS)};ze.DefaultSettings=Ux();ze.hooks=he.getSingleton();ze.CellCoords=Kl;ze.CellRange=Cc;ze.packageName="handsontable";ze.buildDate="31/08/2023 08:23:33";ze.version="13.1.0";ze.languages={dictionaryKeys:W3,getLanguageDictionary:Lx,getLanguagesDictionaries:G3,registerLanguageDictionary:Nx,getTranslatedPhrase:Fx};function PT(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function WG(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?PT(Object(t),!0).forEach(function(r){UG(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):PT(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Qu(n){"@babel/helpers - typeof";return Qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qu(n)}function ql(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function HT(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,Kx(r.key),r)}}function Ql(n,e,t){return e&&HT(n.prototype,e),t&&HT(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function UG(n,e,t){return e=Kx(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Zu(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&UC(n,e)}function af(n){return af=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},af(n)}function UC(n,e){return UC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},UC(n,e)}function zG(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gx(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function YG(n,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gx(n)}function Ju(n){var e=zG();return function(){var r=af(n),s;if(e){var o=af(this).constructor;s=Reflect.construct(r,arguments,o)}else s=r.apply(this,arguments);return YG(this,s)}}function jG(n){return GG(n)||KG(n)||XG(n)||qG()}function GG(n){if(Array.isArray(n))return zC(n)}function KG(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function XG(n,e){if(n){if(typeof n=="string")return zC(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return zC(n,e)}}function zC(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function qG(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QG(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}function Kx(n){var e=QG(n,"string");return typeof e=="symbol"?e:String(e)}var dp=null,ZG="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",JG="The Handsontable instance bound to this component was destroyed and cannot be used properly.",uf="global",e4="hot-wrapper-editor-container";function t4(){if(typeof console<"u"){var n;(n=console).warn.apply(n,arguments)}}function YC(n,e){var t=$t.Children.toArray(n),r=$t.Children.count(n),s=null;return r!==0&&(r===1&&t[0].props[e]?s=t[0]:s=t.find(function(o){return o.props[e]!==void 0})),s||null}function Xx(n){return n?n.type.WrappedComponent?n.type.WrappedComponent:n.type:null}function qx(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,e=arguments.length>1?arguments[1]:void 0;if(e===null)return null;var t=Zx(e.props,!1);return t.className="".concat(e4," ").concat(t.className),nO.createPortal($t.createElement("div",Object.assign({},t),e),n.body)}function Qx(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:uf,r=YC(n,"hot-editor"),s=Xx(r);return r?$t.cloneElement(r,{emitEditorInstance:function(i,l){e.get(s)||e.set(s,new Map);var a=e.get(s);a.set(l??uf,i)},editorColumnScope:t,isEditor:!0}):null}function n4(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;t||(t=document),dp||(dp=t.createDocumentFragment());var r=t.createElement("DIV");dp.appendChild(r);var s=$t.cloneElement(n,WG({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:nO.createPortal(s,r,"".concat(e.row,"-").concat(e.col,"-").concat(Math.random())),portalContainer:r}}function Zx(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:n.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:n.className||"",style:n.style||{}}}var Jx=function(){function n(){ql(this,n)}return Ql(n,null,[{key:"getSettings",value:function(t){var r={};if(t.settings){var s=t.settings;for(var o in s)s.hasOwnProperty(o)&&(r[o]=s[o])}for(var i in t)i!=="settings"&&i!=="children"&&t.hasOwnProperty(i)&&(r[i]=t[i]);return r}}]),n}(),r4=function(n){Zu(t,n);var e=Ju(t);function t(){return ql(this,t),e.apply(this,arguments)}return Ql(t,[{key:"getSettingsProps",value:function(){var s=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(o){return!s.internalProps.includes(o)}).reduce(function(o,i){return o[i]=s.props[i],o},{})}},{key:"getLocalEditorElement",value:function(){return Qx(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var s=this.props._getChildElementByType(this.props.children,"hot-renderer"),o=this.getLocalEditorElement();this.columnSettings=Jx.getSettings(this.getSettingsProps()),s!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(s),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),o!==null&&(this.columnSettings.editor=this.props._getEditorClass(o,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var s=this.props._getOwnerDocument(),o=qx(s,this.getLocalEditorElement());return $t.createElement($t.Fragment,null,o)}}]),t}($t.Component),s4=function(n){Zu(t,n);var e=Ju(t);function t(){var r;return ql(this,t),r=e.apply(this,arguments),r.state={portals:[]},r}return Ql(t,[{key:"render",value:function(){return $t.createElement($t.Fragment,null,this.state.portals)}}]),t}($t.Component),o4="13.1.0";function P0(n,e){return e={exports:{}},n(e,e.exports),e.exports}/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tn=typeof Symbol=="function"&&Symbol.for,H0=tn?Symbol.for("react.element"):60103,D0=tn?Symbol.for("react.portal"):60106,Eg=tn?Symbol.for("react.fragment"):60107,Tg=tn?Symbol.for("react.strict_mode"):60108,Mg=tn?Symbol.for("react.profiler"):60114,_g=tn?Symbol.for("react.provider"):60109,Og=tn?Symbol.for("react.context"):60110,k0=tn?Symbol.for("react.async_mode"):60111,Ig=tn?Symbol.for("react.concurrent_mode"):60111,xg=tn?Symbol.for("react.forward_ref"):60112,Ag=tn?Symbol.for("react.suspense"):60113,i4=tn?Symbol.for("react.suspense_list"):60120,Pg=tn?Symbol.for("react.memo"):60115,Hg=tn?Symbol.for("react.lazy"):60116,l4=tn?Symbol.for("react.block"):60121,a4=tn?Symbol.for("react.fundamental"):60117,u4=tn?Symbol.for("react.responder"):60118,c4=tn?Symbol.for("react.scope"):60119;function nr(n){if(Qu(n)==="object"&&n!==null){var e=n.$$typeof;switch(e){case H0:switch(n=n.type,n){case k0:case Ig:case Eg:case Mg:case Tg:case Ag:return n;default:switch(n=n&&n.$$typeof,n){case Og:case xg:case Hg:case Pg:case _g:return n;default:return e}}case D0:return e}}}function eA(n){return nr(n)===Ig}var h4=k0,d4=Ig,f4=Og,g4=_g,m4=H0,p4=xg,w4=Eg,C4=Hg,y4=Pg,v4=D0,S4=Mg,R4=Tg,b4=Ag,E4=function(e){return eA(e)||nr(e)===k0},T4=eA,M4=function(e){return nr(e)===Og},_4=function(e){return nr(e)===_g},O4=function(e){return Qu(e)==="object"&&e!==null&&e.$$typeof===H0},I4=function(e){return nr(e)===xg},x4=function(e){return nr(e)===Eg},A4=function(e){return nr(e)===Hg},P4=function(e){return nr(e)===Pg},H4=function(e){return nr(e)===D0},D4=function(e){return nr(e)===Mg},k4=function(e){return nr(e)===Tg},N4=function(e){return nr(e)===Ag},L4=function(e){return typeof e=="string"||typeof e=="function"||e===Eg||e===Ig||e===Mg||e===Tg||e===Ag||e===i4||Qu(e)==="object"&&e!==null&&(e.$$typeof===Hg||e.$$typeof===Pg||e.$$typeof===_g||e.$$typeof===Og||e.$$typeof===xg||e.$$typeof===a4||e.$$typeof===u4||e.$$typeof===c4||e.$$typeof===l4)},F4=nr,V4={AsyncMode:h4,ConcurrentMode:d4,ContextConsumer:f4,ContextProvider:g4,Element:m4,ForwardRef:p4,Fragment:w4,Lazy:C4,Memo:y4,Portal:v4,Profiler:S4,StrictMode:R4,Suspense:b4,isAsyncMode:E4,isConcurrentMode:T4,isContextConsumer:M4,isContextProvider:_4,isElement:O4,isForwardRef:I4,isFragment:x4,isLazy:A4,isMemo:P4,isPortal:H4,isProfiler:D4,isStrictMode:k4,isSuspense:N4,isValidElementType:L4,typeOf:F4},lt=P0(function(n,e){});lt.AsyncMode;lt.ConcurrentMode;lt.ContextConsumer;lt.ContextProvider;lt.Element;lt.ForwardRef;lt.Fragment;lt.Lazy;lt.Memo;lt.Portal;lt.Profiler;lt.StrictMode;lt.Suspense;lt.isAsyncMode;lt.isConcurrentMode;lt.isContextConsumer;lt.isContextProvider;lt.isElement;lt.isForwardRef;lt.isFragment;lt.isLazy;lt.isMemo;lt.isPortal;lt.isProfiler;lt.isStrictMode;lt.isSuspense;lt.isValidElementType;lt.typeOf;P0(function(n){n.exports=V4});/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var DT=Object.getOwnPropertySymbols,$4=Object.prototype.hasOwnProperty,B4=Object.prototype.propertyIsEnumerable;function W4(n){if(n==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(n)}function U4(){try{if(!Object.assign)return!1;var n=new String("abc");if(n[5]="de",Object.getOwnPropertyNames(n)[0]==="5")return!1;for(var e={},t=0;t<10;t++)e["_"+String.fromCharCode(t)]=t;var r=Object.getOwnPropertyNames(e).map(function(o){return e[o]});if(r.join("")!=="0123456789")return!1;var s={};return"abcdefghijklmnopqrst".split("").forEach(function(o){s[o]=o}),Object.keys(Object.assign({},s)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}U4();var z4="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Y4=z4;Function.call.bind(Object.prototype.hasOwnProperty);function tA(){}function nA(){}nA.resetWarningCache=tA;var j4=function(){function e(s,o,i,l,a,u){if(u!==Y4){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:nA,resetWarningCache:tA};return r.PropTypes=r,r},G4=P0(function(n){n.exports=j4()}),fp=G4,rA=function(n){Zu(t,n);var e=Ju(t);function t(){var r;return ql(this,t),r=e.apply(this,arguments),r.id=null,r.__hotInstance=null,r.hotElementRef=null,r.columnSettings=[],r.renderersPortalManager=null,r.portalCacheArray=[],r.renderedCellCache=new Map,r.editorCache=new Map,r.componentRendererColumns=new Map,r}return Ql(t,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(JG),null)},set:function(s){this.__hotInstance=s}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return this.hotElementRef?this.hotElementRef.ownerDocument:document}},{key:"setHotElementRef",value:function(s){this.hotElementRef=s}},{key:"getRendererWrapper",value:function(s){var o=this;return function(i,l,a,u,c,d,f){var m=o.getRenderedCellCache();if(m.has("".concat(a,"-").concat(u))&&(l.innerHTML=m.get("".concat(a,"-").concat(u)).innerHTML),l&&!l.getAttribute("ghost-table")){for(var p=n4(s,{TD:l,row:a,col:u,prop:c,value:d,cellProperties:f,isRenderer:!0},l.ownerDocument),w=p.portal,M=p.portalContainer;l.firstChild;)l.removeChild(l.firstChild);l.appendChild(M),o.portalCacheArray.push(w)}return m.set("".concat(a,"-").concat(u),l),l}}},{key:"getEditorClass",value:function(s){var o,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:uf,l=Xx(s),a=(o=this.getEditorCache().get(l))===null||o===void 0?void 0:o.get(i);return this.makeEditorClass(a)}},{key:"makeEditorClass",value:function(s){var o=function(i){Zu(a,i);var l=Ju(a);function a(u){var c;return ql(this,a),c=l.call(this,u),s.hotCustomEditorInstance=Gx(c),c.editorComponent=s,c}return Ql(a,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),a}(ze.editors.BaseEditor);return Object.getOwnPropertyNames(ze.editors.BaseEditor.prototype).forEach(function(i){i!=="constructor"&&(o.prototype[i]=function(){for(var l,a=arguments.length,u=new Array(a),c=0;c<a;c++)u[c]=arguments[c];return(l=s[i]).call.apply(l,[s].concat(u))})}),o}},{key:"getGlobalRendererElement",value:function(){return YC(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return Qx(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var s=Jx.getSettings(this.props),o=this.getGlobalRendererElement(),i=this.getGlobalEditorElement();return s.columns=this.columnSettings.length?this.columnSettings:s.columns,i?s.editor=this.getEditorClass(i,uf):s.editor=this.props.editor||(this.props.settings?this.props.settings.editor:void 0),o?(s.renderer=this.getRendererWrapper(o),this.componentRendererColumns.set("global",!0)):s.renderer=this.props.renderer||(this.props.settings?this.props.settings.renderer:void 0),s}},{key:"displayAutoSizeWarning",value:function(s){var o,i;this.hotInstance&&((o=this.hotInstance.getPlugin("autoRowSize"))!==null&&o!==void 0&&o.enabled||(i=this.hotInstance.getPlugin("autoColumnSize"))!==null&&i!==void 0&&i.enabled)&&this.componentRendererColumns.size>0&&t4(ZG)}},{key:"setHotColumnSettings",value:function(s,o){this.columnSettings[o]=s}},{key:"handsontableBeforeViewRender",value:function(){this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){var s=this;this.renderersPortalManager.setState({portals:jG(this.portalCacheArray)},function(){s.portalCacheArray=[]})}},{key:"updateHot",value:function(s){this.hotInstance&&this.hotInstance.updateSettings(s,!1)}},{key:"setRenderersPortalManagerRef",value:function(s){this.renderersPortalManager=s}},{key:"componentDidMount",value:function(){var s=this,o=this.createNewGlobalSettings();this.hotInstance=new ze.Core(this.hotElementRef,o),this.hotInstance.addHook("beforeViewRender",function(){return s.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return s.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(o)}},{key:"componentDidUpdate",value:function(){this.clearCache();var s=this.createNewGlobalSettings();this.updateHot(s),this.displayAutoSizeWarning(s)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var s=this,o=Zx(this.props),i=function(d){return d.type===r4},l=$t.Children.toArray(this.props.children),a=l.filter(function(c){return i(c)}).map(function(c,d){return $t.cloneElement(c,{_componentRendererColumns:s.componentRendererColumns,_emitColumnSettings:s.setHotColumnSettings.bind(s),_columnIndex:d,_getChildElementByType:YC.bind(s),_getRendererWrapper:s.getRendererWrapper.bind(s),_getEditorClass:s.getEditorClass.bind(s),_getOwnerDocument:s.getOwnerDocument.bind(s),_getEditorCache:s.getEditorCache.bind(s),children:c.props.children})}),u=qx(this.getOwnerDocument(),this.getGlobalEditorElement());return $t.createElement($t.Fragment,null,$t.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},o),a),$t.createElement(s4,{ref:this.setRenderersPortalManagerRef.bind(this)}),u)}}],[{key:"version",get:function(){return o4}}]),t}($t.Component);rA.propTypes={style:fp.object,id:fp.string,className:fp.string};$t.Component;const kT="handsontableEditor",K4="handsontable";class N0 extends Vi{static get EDITOR_TYPE(){return K4}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),lg(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,r,s,o,i){super.prepare(e,t,r,s,o,i);const l=this,a={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown(u,c){const d=this.getSourceData(c.row,c.col);d!==void 0&&l.setValue(d),l.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Ut(a,i.handsontable),this.htOptions=a}beginEditing(e,t){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,t)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const s=this.htEditor.getInstance().getValue();s!==void 0&&this.setValue(s)}super.finishEditing(e,t,r)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:kT,relativeToGroup:cg,position:"before"},s=(o,i)=>{const l=this.htEditor.getInstance();if(o!==void 0&&(o<0||l.flipped&&o>l.countRows()-1?l.deselectCell():l.selectCell(o,0),l.getData().length))return i.preventDefault(),ds(i),this.hot.listen(),this.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const i=this.htEditor.getInstance();let l,a;return!i.getSelectedLast()&&i.flipped?l=i.countRows()-1:i.getSelectedLast()&&(i.flipped?(a=i.getSelectedLast()[0],l=Math.max(0,a-1)):(a=i.getSelectedLast()[0],l=a-1)),s(l,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const i=this.htEditor.getInstance();let l,a;if(!i.getSelectedLast()&&!i.flipped)l=0;else if(i.getSelectedLast()){if(i.flipped)l=i.getSelectedLast()[0]+1;else if(!i.flipped){const u=i.countRows()-1;a=i.getSelectedLast()[0],l=Math.min(u,a+1)}}return s(l,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(kT)}}function X4(n,e,t){return e=q4(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function q4(n){var e=Q4(n,"string");return typeof e=="symbol"?e:String(e)}function Q4(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const gp=new WeakMap,Z4="autocomplete";class L0 extends N0{static get EDITOR_TYPE(){return Z4}constructor(e){super(e),X4(this,"sortByRelevance",function(t,r,s){const o=[],i=[],l=t.length;let a=r.length,u,c,d,f;if(l===0){for(d=0;d<a;d++)i.push(d);return i}for(d=0;d<a;d++){if(c=NE(Lt(r[d])),s)f=c.indexOf(t);else{const m=this.cellProperties.locale;f=c.toLocaleLowerCase(m).indexOf(t.toLocaleLowerCase(m))}f!==-1&&(u=c.length-f-l,o.push({baseIndex:d,index:f,charsLeft:u,value:c}))}for(o.sort((m,p)=>{if(p.index===-1)return-1;if(m.index===-1)return 1;if(m.index<p.index)return-1;if(p.index<m.index)return 1;if(m.index===p.index){if(m.charsLeft<p.charsLeft)return-1;if(m.charsLeft>p.charsLeft)return 1}return 0}),d=0,a=o.length;d<a;d++)i.push(o[d].baseIndex);return i}),this.query=null,this.strippedChoices=[],this.rawChoices=[],gp.set(this,{skipOne:!1,isMacOS:this.hot.rootWindow.navigator.platform.indexOf("Mac")>-1})}getValue(){const e=this.rawChoices.find(t=>this.stripValueIfNeeded(t)===this.TEXTAREA.value);return ue(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),ee(this.htContainer,"autocompleteEditor"),ee(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}open(){const e=gp.get(this);super.open();const t=this.htEditor.getInstance(),r=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();let s=en();s===0&&e.isMacOS&&(s+=15),this.addHook("beforeKeyDown",o=>this.onBeforeKeyDown(o)),t.updateSettings({colWidths:r?[st(this.TEXTAREA)-2]:void 0,width:r?st(this.TEXTAREA)+s:void 0,renderer:(o,i,l,a,u,c,d)=>{Bo(o,i,l,a,u,c,d);const{filteringCaseSensitive:f,allowHtml:m,locale:p}=this.cellProperties,w=this.query;let M=Lt(c),S,y;M&&!m&&(S=f===!0?M.indexOf(w):M.toLocaleLowerCase(p).indexOf(w.toLocaleLowerCase(p)),S!==-1&&(y=M.substr(S,w.length),M=M.replace(y,`<strong>${y}</strong>`))),i.innerHTML=M},autoColumnSize:!0}),e.skipOne&&(e.skipOne=!1),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close()}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const t=this.cellProperties.source;this.query=e,typeof t=="function"?t.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){const t=jI(this.TEXTAREA),r=uz(this.TEXTAREA),s=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let i=null,l=null,a=e;s&&(i=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),a,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(i)?i.length:0;if(o===!1)u&&(l=i[0]);else{const c=[];for(let d=0,f=a.length;d<f&&!(s&&u<=d);d++)u?c.push(a[i[d]]):c.push(a[d]);l=0,a=c}this.strippedChoices=a,this.htEditor.loadData(ud([a])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(l),this.hot.listen(),lg(this.TEXTAREA,t,t===r?void 0:r)}flipDropdownIfNeeded(){const e=jl(this.hot.view._wt.wtTable.TABLE),t=e===this.hot.rootWindow,r=this.cellProperties.preventOverflow;if(t||!t&&(r||r==="horizontal"))return!1;const s=Wt(this.TEXTAREA),o=_t(this.TEXTAREA),i=this.getDropdownHeight(),l=e.scrollTop,a=_t(this.hot.view._wt.wtTable.THEAD),u=Wt(e),c=s.top-u.top-a+l,d=e.scrollHeight-c-a-o,f=i>d&&c>d;return f?this.flipDropdown(i):this.unflipDropdown(),this.limitDropdownIfNeeded(f?c:d,i),f}limitDropdownIfNeeded(e,t){if(t>e){let r=0,s=0,o=0,i=null;do o=this.htEditor.getRowHeight(s)||this.htEditor.view._wt.getSetting("defaultRowHeight"),r+=o,s+=1;while(r<e);i=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+t-i}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const t=this.htEditor.rootElement.style;t.position="absolute",t.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const e=this.htEditor.getColWidth(0)+en(this.hot.rootDocument)+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getInstance().getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:t}=this.cellProperties,r=Ve(e,o=>Lt(o));return Ve(r,o=>t?o:NE(o))}allowKeyEventPropagation(e){const t=this.htEditor.getSelectedRangeLast(),r={row:t?t.from.row:-1};let s=!1;return e===we.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(s=!0),e===we.ARROW_UP&&r.row>-1&&(s=!0),s}onBeforeKeyDown(e){const t=gp.get(this);if(t.skipOne=!1,Vz(e.keyCode)||e.keyCode===we.BACKSPACE||e.keyCode===we.DELETE||e.keyCode===we.INSERT){let r=10;if(e.keyCode===we.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(r+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value),t.skipOne=!0},r)}}}const J4="checkbox";class sA extends ca{static get EDITOR_TYPE(){return J4}beginEditing(e,t){if(t&&t.type==="mouseup"){const r=this.TD.querySelector('input[type="checkbox"]');Oe(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var oA={exports:{}};const e6=MP(ZU);/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(n,e){(function(t,r){var s;{try{s=e6}catch{}n.exports=r(s)}})(za,function(t){var r=typeof t=="function",s=!!window.addEventListener,o=window.document,i=window.setTimeout,l=function(E,h,g,C){s?E.addEventListener(h,g,!!C):E.attachEvent("on"+h,g)},a=function(E,h,g,C){s?E.removeEventListener(h,g,!!C):E.detachEvent("on"+h,g)},u=function(E){return E.trim?E.trim():E.replace(/^\s+|\s+$/g,"")},c=function(E,h){return(" "+E.className+" ").indexOf(" "+h+" ")!==-1},d=function(E,h){c(E,h)||(E.className=E.className===""?h:E.className+" "+h)},f=function(E,h){E.className=u((" "+E.className+" ").replace(" "+h+" "," "))},m=function(E){return/Array/.test(Object.prototype.toString.call(E))},p=function(E){return/Date/.test(Object.prototype.toString.call(E))&&!isNaN(E.getTime())},w=function(E){var h=E.getDay();return h===0||h===6},M=function(E){return E%4===0&&E%100!==0||E%400===0},S=function(E,h){return[31,M(E)?29:28,31,30,31,30,31,31,30,31,30,31][h]},y=function(E){p(E)&&E.setHours(0,0,0,0)},v=function(E,h){return E.getTime()===h.getTime()},R=function(E,h,g){var C,_;for(C in h)_=E[C]!==void 0,_&&typeof h[C]=="object"&&h[C]!==null&&h[C].nodeName===void 0?p(h[C])?g&&(E[C]=new Date(h[C].getTime())):m(h[C])?g&&(E[C]=h[C].slice(0)):E[C]=R({},h[C],g):(g||!_)&&(E[C]=h[C]);return E},I=function(E,h,g){var C;o.createEvent?(C=o.createEvent("HTMLEvents"),C.initEvent(h,!0,!1),C=R(C,g),E.dispatchEvent(C)):o.createEventObject&&(C=o.createEventObject(),C=R(C,g),E.fireEvent("on"+h,C))},F=function(E){return E.month<0&&(E.year-=Math.ceil(Math.abs(E.month)/12),E.month+=12),E.month>11&&(E.year+=Math.floor(Math.abs(E.month)/12),E.month-=12),E},L={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},j=function(E,h,g){for(h+=E.firstDay;h>=7;)h-=7;return g?E.i18n.weekdaysShort[h]:E.i18n.weekdays[h]},X=function(E){var h=[],g="false";if(E.isEmpty)if(E.showDaysInNextAndPreviousMonths)h.push("is-outside-current-month"),E.enableSelectionDaysInNextAndPreviousMonths||h.push("is-selection-disabled");else return'<td class="is-empty"></td>';return E.isDisabled&&h.push("is-disabled"),E.isToday&&h.push("is-today"),E.isSelected&&(h.push("is-selected"),g="true"),E.hasEvent&&h.push("has-event"),E.isInRange&&h.push("is-inrange"),E.isStartRange&&h.push("is-startrange"),E.isEndRange&&h.push("is-endrange"),'<td data-day="'+E.day+'" class="'+h.join(" ")+'" aria-selected="'+g+'"><button class="pika-button pika-day" type="button" data-pika-year="'+E.year+'" data-pika-month="'+E.month+'" data-pika-day="'+E.day+'">'+E.day+"</button></td>"},G=function(E,h){E.setHours(0,0,0,0);var g=E.getDate(),C=E.getDay(),_=h,O=_-1,A=7,W=function(pe){return(pe+A-1)%A};E.setDate(g+O-W(C));var z=new Date(E.getFullYear(),0,_),K=24*60*60*1e3,Z=(E.getTime()-z.getTime())/K,Q=1+Math.round((Z-O+W(z.getDay()))/A);return Q},te=function(E,h,g,C){var _=new Date(g,h,E),O=r?t(_).isoWeek():G(_,C);return'<td class="pika-week">'+O+"</td>"},ie=function(E,h,g,C){return'<tr class="pika-row'+(g?" pick-whole-week":"")+(C?" is-selected":"")+'">'+(h?E.reverse():E).join("")+"</tr>"},le=function(E){return"<tbody>"+E.join("")+"</tbody>"},me=function(E){var h,g=[];for(E.showWeekNumber&&g.push("<th></th>"),h=0;h<7;h++)g.push('<th scope="col"><abbr title="'+j(E,h)+'">'+j(E,h,!0)+"</abbr></th>");return"<thead><tr>"+(E.isRTL?g.reverse():g).join("")+"</tr></thead>"},Te=function(E,h,g,C,_,O){var A,W,z,K=E._o,Z=g===K.minYear,Q=g===K.maxYear,pe='<div id="'+O+'" class="pika-title" role="heading" aria-live="assertive">',Ae,Ee,_e=!0,q=!0;for(z=[],A=0;A<12;A++)z.push('<option value="'+(g===_?A-h:12+A-h)+'"'+(A===C?' selected="selected"':"")+(Z&&A<K.minMonth||Q&&A>K.maxMonth?' disabled="disabled"':"")+">"+K.i18n.months[A]+"</option>");for(Ae='<div class="pika-label">'+K.i18n.months[C]+'<select class="pika-select pika-select-month" tabindex="-1">'+z.join("")+"</select></div>",m(K.yearRange)?(A=K.yearRange[0],W=K.yearRange[1]+1):(A=g-K.yearRange,W=1+g+K.yearRange),z=[];A<W&&A<=K.maxYear;A++)A>=K.minYear&&z.push('<option value="'+A+'"'+(A===g?' selected="selected"':"")+">"+A+"</option>");return Ee='<div class="pika-label">'+g+K.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+z.join("")+"</select></div>",K.showMonthAfterYear?pe+=Ee+Ae:pe+=Ae+Ee,Z&&(C===0||K.minMonth>=C)&&(_e=!1),Q&&(C===11||K.maxMonth<=C)&&(q=!1),h===0&&(pe+='<button class="pika-prev'+(_e?"":" is-disabled")+'" type="button">'+K.i18n.previousMonth+"</button>"),h===E._o.numberOfMonths-1&&(pe+='<button class="pika-next'+(q?"":" is-disabled")+'" type="button">'+K.i18n.nextMonth+"</button>"),pe+="</div>"},Ue=function(E,h,g){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+g+'">'+me(E)+le(h)+"</table>"},Me=function(E){var h=this,g=h.config(E);h._onMouseDown=function(_){if(h._v){_=_||window.event;var O=_.target||_.srcElement;if(O)if(c(O,"is-disabled")||(c(O,"pika-button")&&!c(O,"is-empty")&&!c(O.parentNode,"is-disabled")?(h.setDate(new Date(O.getAttribute("data-pika-year"),O.getAttribute("data-pika-month"),O.getAttribute("data-pika-day"))),g.bound&&i(function(){h.hide(),g.blurFieldOnSelect&&g.field&&g.field.blur()},100)):c(O,"pika-prev")?h.prevMonth():c(O,"pika-next")&&h.nextMonth()),c(O,"pika-select"))h._c=!0;else if(_.preventDefault)_.preventDefault();else return _.returnValue=!1,!1}},h._onChange=function(_){_=_||window.event;var O=_.target||_.srcElement;O&&(c(O,"pika-select-month")?h.gotoMonth(O.value):c(O,"pika-select-year")&&h.gotoYear(O.value))},h._onKeyChange=function(_){if(_=_||window.event,h.isVisible())switch(_.keyCode){case 13:case 27:g.field&&g.field.blur();break;case 37:h.adjustDate("subtract",1);break;case 38:h.adjustDate("subtract",7);break;case 39:h.adjustDate("add",1);break;case 40:h.adjustDate("add",7);break;case 8:case 46:h.setDate(null);break}},h._parseFieldValue=function(){if(g.parse)return g.parse(g.field.value,g.format);if(r){var _=t(g.field.value,g.format,g.formatStrict);return _&&_.isValid()?_.toDate():null}else return new Date(Date.parse(g.field.value))},h._onInputChange=function(_){var O;_.firedBy!==h&&(O=h._parseFieldValue(),p(O)&&h.setDate(O),h._v||h.show())},h._onInputFocus=function(){h.show()},h._onInputClick=function(){h.show()},h._onInputBlur=function(){var _=o.activeElement;do if(c(_,"pika-single"))return;while(_=_.parentNode);h._c||(h._b=i(function(){h.hide()},50)),h._c=!1},h._onClick=function(_){_=_||window.event;var O=_.target||_.srcElement,A=O;if(O){!s&&c(O,"pika-select")&&(O.onchange||(O.setAttribute("onchange","return;"),l(O,"change",h._onChange)));do if(c(A,"pika-single")||A===g.trigger)return;while(A=A.parentNode);h._v&&O!==g.trigger&&A!==g.trigger&&h.hide()}},h.el=o.createElement("div"),h.el.className="pika-single"+(g.isRTL?" is-rtl":"")+(g.theme?" "+g.theme:""),l(h.el,"mousedown",h._onMouseDown,!0),l(h.el,"touchend",h._onMouseDown,!0),l(h.el,"change",h._onChange),g.keyboardInput&&l(o,"keydown",h._onKeyChange),g.field&&(g.container?g.container.appendChild(h.el):g.bound?o.body.appendChild(h.el):g.field.parentNode.insertBefore(h.el,g.field.nextSibling),l(g.field,"change",h._onInputChange),g.defaultDate||(g.defaultDate=h._parseFieldValue(),g.setDefaultDate=!0));var C=g.defaultDate;p(C)?g.setDefaultDate?h.setDate(C,!0):h.gotoDate(C):h.gotoDate(new Date),g.bound?(this.hide(),h.el.className+=" is-bound",l(g.trigger,"click",h._onInputClick),l(g.trigger,"focus",h._onInputFocus),l(g.trigger,"blur",h._onInputBlur)):this.show()};return Me.prototype={config:function(E){this._o||(this._o=R({},L,!0));var h=R(this._o,E,!0);h.isRTL=!!h.isRTL,h.field=h.field&&h.field.nodeName?h.field:null,h.theme=typeof h.theme=="string"&&h.theme?h.theme:null,h.bound=!!(h.bound!==void 0?h.field&&h.bound:h.field),h.trigger=h.trigger&&h.trigger.nodeName?h.trigger:h.field,h.disableWeekends=!!h.disableWeekends,h.disableDayFn=typeof h.disableDayFn=="function"?h.disableDayFn:null;var g=parseInt(h.numberOfMonths,10)||1;if(h.numberOfMonths=g>4?4:g,p(h.minDate)||(h.minDate=!1),p(h.maxDate)||(h.maxDate=!1),h.minDate&&h.maxDate&&h.maxDate<h.minDate&&(h.maxDate=h.minDate=!1),h.minDate&&this.setMinDate(h.minDate),h.maxDate&&this.setMaxDate(h.maxDate),m(h.yearRange)){var C=new Date().getFullYear()-10;h.yearRange[0]=parseInt(h.yearRange[0],10)||C,h.yearRange[1]=parseInt(h.yearRange[1],10)||C}else h.yearRange=Math.abs(parseInt(h.yearRange,10))||L.yearRange,h.yearRange>100&&(h.yearRange=100);return h},toString:function(E){return E=E||this._o.format,p(this._d)?this._o.toString?this._o.toString(this._d,E):r?t(this._d).format(E):this._d.toDateString():""},getMoment:function(){return r?t(this._d):null},setMoment:function(E,h){r&&t.isMoment(E)&&this.setDate(E.toDate(),h)},getDate:function(){return p(this._d)?new Date(this._d.getTime()):null},setDate:function(E,h){if(!E)return this._d=null,this._o.field&&(this._o.field.value="",I(this._o.field,"change",{firedBy:this})),this.draw();if(typeof E=="string"&&(E=new Date(Date.parse(E))),!!p(E)){var g=this._o.minDate,C=this._o.maxDate;p(g)&&E<g?E=g:p(C)&&E>C&&(E=C),this._d=new Date(E.getTime()),y(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),I(this._o.field,"change",{firedBy:this})),!h&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(E){var h=!0;if(p(E)){if(this.calendars){var g=new Date(this.calendars[0].year,this.calendars[0].month,1),C=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),_=E.getTime();C.setMonth(C.getMonth()+1),C.setDate(C.getDate()-1),h=_<g.getTime()||C.getTime()<_}h&&(this.calendars=[{month:E.getMonth(),year:E.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(E,h){var g=this.getDate()||new Date,C=parseInt(h)*24*60*60*1e3,_;E==="add"?_=new Date(g.valueOf()+C):E==="subtract"&&(_=new Date(g.valueOf()-C)),this.setDate(_)},adjustCalendars:function(){this.calendars[0]=F(this.calendars[0]);for(var E=1;E<this._o.numberOfMonths;E++)this.calendars[E]=F({month:this.calendars[0].month+E,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(E){isNaN(E)||(this.calendars[0].month=parseInt(E,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(E){isNaN(E)||(this.calendars[0].year=parseInt(E,10),this.adjustCalendars())},setMinDate:function(E){E instanceof Date?(y(E),this._o.minDate=E,this._o.minYear=E.getFullYear(),this._o.minMonth=E.getMonth()):(this._o.minDate=L.minDate,this._o.minYear=L.minYear,this._o.minMonth=L.minMonth,this._o.startRange=L.startRange),this.draw()},setMaxDate:function(E){E instanceof Date?(y(E),this._o.maxDate=E,this._o.maxYear=E.getFullYear(),this._o.maxMonth=E.getMonth()):(this._o.maxDate=L.maxDate,this._o.maxYear=L.maxYear,this._o.maxMonth=L.maxMonth,this._o.endRange=L.endRange),this.draw()},setStartRange:function(E){this._o.startRange=E},setEndRange:function(E){this._o.endRange=E},draw:function(E){if(!(!this._v&&!E)){var h=this._o,g=h.minYear,C=h.maxYear,_=h.minMonth,O=h.maxMonth,A="",W;this._y<=g&&(this._y=g,!isNaN(_)&&this._m<_&&(this._m=_)),this._y>=C&&(this._y=C,!isNaN(O)&&this._m>O&&(this._m=O));for(var z=0;z<h.numberOfMonths;z++)W="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),A+='<div class="pika-lendar">'+Te(this,z,this.calendars[z].year,this.calendars[z].month,this.calendars[0].year,W)+this.render(this.calendars[z].year,this.calendars[z].month,W)+"</div>";this.el.innerHTML=A,h.bound&&h.field.type!=="hidden"&&i(function(){h.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),h.bound&&h.field.setAttribute("aria-label",h.ariaLabel)}},adjustPosition:function(){var E,h,g,C,_,O,A,W,z,K,Z,Q;if(!this._o.container){if(this.el.style.position="absolute",E=this._o.trigger,h=E,g=this.el.offsetWidth,C=this.el.offsetHeight,_=window.innerWidth||o.documentElement.clientWidth,O=window.innerHeight||o.documentElement.clientHeight,A=window.pageYOffset||o.body.scrollTop||o.documentElement.scrollTop,Z=!0,Q=!0,typeof E.getBoundingClientRect=="function")K=E.getBoundingClientRect(),W=K.left+window.pageXOffset,z=K.bottom+window.pageYOffset;else for(W=h.offsetLeft,z=h.offsetTop+h.offsetHeight;h=h.offsetParent;)W+=h.offsetLeft,z+=h.offsetTop;(this._o.reposition&&W+g>_||this._o.position.indexOf("right")>-1&&W-g+E.offsetWidth>0)&&(W=W-g+E.offsetWidth,Z=!1),(this._o.reposition&&z+C>O+A||this._o.position.indexOf("top")>-1&&z-C-E.offsetHeight>0)&&(z=z-C-E.offsetHeight,Q=!1),this.el.style.left=W+"px",this.el.style.top=z+"px",d(this.el,Z?"left-aligned":"right-aligned"),d(this.el,Q?"bottom-aligned":"top-aligned"),f(this.el,Z?"right-aligned":"left-aligned"),f(this.el,Q?"top-aligned":"bottom-aligned")}},render:function(E,h,g){var C=this._o,_=new Date,O=S(E,h),A=new Date(E,h,1).getDay(),W=[],z=[];y(_),C.firstDay>0&&(A-=C.firstDay,A<0&&(A+=7));for(var K=h===0?11:h-1,Z=h===11?0:h+1,Q=h===0?E-1:E,pe=h===11?E+1:E,Ae=S(Q,K),Ee=O+A,_e=Ee;_e>7;)_e-=7;Ee+=7-_e;for(var q=!1,je=0,Ie=0;je<Ee;je++){var be=new Date(E,h,1+(je-A)),Pe=p(this._d)?v(be,this._d):!1,ye=v(be,_),b=C.events.indexOf(be.toDateString())!==-1,T=je<A||je>=O+A,x=1+(je-A),$=h,H=E,B=C.startRange&&v(C.startRange,be),N=C.endRange&&v(C.endRange,be),k=C.startRange&&C.endRange&&C.startRange<be&&be<C.endRange,U=C.minDate&&be<C.minDate||C.maxDate&&be>C.maxDate||C.disableWeekends&&w(be)||C.disableDayFn&&C.disableDayFn(be);T&&(je<A?(x=Ae+x,$=K,H=Q):(x=x-O,$=Z,H=pe));var V={day:x,month:$,year:H,hasEvent:b,isSelected:Pe,isToday:ye,isDisabled:U,isEmpty:T,isStartRange:B,isEndRange:N,isInRange:k,showDaysInNextAndPreviousMonths:C.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:C.enableSelectionDaysInNextAndPreviousMonths};C.pickWholeWeek&&Pe&&(q=!0),z.push(X(V)),++Ie===7&&(C.showWeekNumber&&z.unshift(te(je-A,h,E,C.firstWeekOfYearMinDays)),W.push(ie(z,C.isRTL,C.pickWholeWeek,q)),z=[],Ie=0,q=!1)}return Ue(C,W,g)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),f(this.el,"is-hidden"),this._o.bound&&(l(o,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var E=this._v;E!==!1&&(this._o.bound&&a(o,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),d(this.el,"is-hidden"),this._v=!1,E!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var E=this._o;this.hide(),a(this.el,"mousedown",this._onMouseDown,!0),a(this.el,"touchend",this._onMouseDown,!0),a(this.el,"change",this._onChange),E.keyboardInput&&a(o,"keydown",this._onKeyChange),E.field&&(a(E.field,"change",this._onInputChange),E.bound&&(a(E.trigger,"click",this._onInputClick),a(E.trigger,"focus",this._onInputFocus),a(E.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},Me})})(oA);var t6=oA.exports;const NT=bf(t6),iA="date",LT="dateEditor";class lA extends Vi{static get EDITOR_TYPE(){return iA}constructor(e){super(e),this.defaultDateFormat="DD/MM/YYYY",this.isCellEdited=!1,this.parentDestroyed=!1,this.$datePicker=null}init(){if(typeof J!="function")throw new Error("You need to include moment.js to your project.");if(typeof NT!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.instance.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),ee(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),new It(this).addEventListener(this.datePicker,"mousedown",t=>t.stopPropagation())}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,r,s,o,i){super.prepare(e,t,r,s,o,i)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(e),r.addShortcut({keys:[["Enter"]],callback:s=>{s.stopPropagation()},group:LT})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(()=>{this.instance._refreshBorders()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(LT),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e){const r=this.originalValue;r!==void 0&&this.setValue(r)}super.finishEditing(e,t)}showDatepicker(e){const t=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,s=this.instance.view.isMouseDown(),o=e?rx(e.keyCode):!1;let i;this.datePicker.style.display="block",this.$datePicker=new NT(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+t.top+_t(this.TD)}px`;let l=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?l=t.right-st(this.datePicker):l=t.left,this.datePickerStyle.left=`${l}px`,this.originalValue?(i=this.originalValue,J(i,r,!0).isValid()&&this.$datePicker.setMoment(J(i,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!o&&!s&&this.setValue("")):this.cellProperties.defaultDate?(i=this.cellProperties.defaultDate,J(i,r,!0).isValid()&&this.$datePicker.setMoment(J(i,r),!0),!o&&!s&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,t={};this.cellProperties&&this.cellProperties.datePickerConfig&&ug(t,this.cellProperties.datePickerConfig);const r=t.onSelect,s=t.onClose;return t.field=e,t.trigger=e,t.container=this.datePicker,t.bound=!1,t.format=t.format||this.defaultDateFormat,t.reposition=t.reposition||!1,t.isRTL=!1,t.onSelect=o=>{let i=o;isNaN(i.getTime())||(i=J(i).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(i),this.hideDatepicker(),r&&r()},t.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),s&&s()},t}}const n6="dropdown";class F0 extends L0{static get EDITOR_TYPE(){return n6}prepare(e,t,r,s,o,i){super.prepare(e,t,r,s,o,i),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}he.getSingleton().add("beforeValidate",function(n,e,t){const r=this.getCellMeta(e,this.propToCol(t));r.editor===F0&&r.strict===void 0&&(r.filter=!1,r.strict=!0)});const r6="numeric";class aA extends Vi{static get EDITOR_TYPE(){return r6}}const s6="password";class uA extends Vi{static get EDITOR_TYPE(){return s6}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,hs(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const mp="ht_editor_visible",FT="selectEditor",o6="select";class i6 extends ca{static get EDITOR_TYPE(){return o6}init(){this.select=this.hot.rootDocument.createElement("SELECT"),ee(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",Oe(this.select,mp)&&He(this.select,mp),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,t,r,s,o,i){super.prepare(e,t,r,s,o,i);const l=this.cellProperties.selectOptions;let a;typeof l=="function"?a=this.prepareOptions(l(this.row,this.col,this.prop)):a=this.prepareOptions(l),hs(this.select),Be(a,(u,c)=>{const d=this.hot.rootDocument.createElement("OPTION");d.value=c,ia(d,u),this.select.appendChild(d)})}prepareOptions(e){let t={};if(Array.isArray(e))for(let r=0,s=e.length;r<s;r++)t[e[r]]=e[r];else typeof e=="object"&&(t=e);return t}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==qt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:t,width:r,height:s}=this.getEditedCellRect(),o=this.select.style;o.height=`${s}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${t}px`,o.margin="0px",ee(this.select,mp)}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),r={group:FT};this.isInFullEditMode()!==!1&&t.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const s=this.select.selectedIndex-1;s>=0&&(this.select[s].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const s=this.select.selectedIndex+1;s<=this.select.length-1&&(this.select[s].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(FT)}}const l6="time";class cA extends Vi{static get EDITOR_TYPE(){return l6}prepare(e,t,r,s,o,i){super.prepare(e,t,r,s,o,i),this.TEXTAREA.dir="ltr"}}function a6(){jn(ca),jn(L0),jn(sA),jn(lA),jn(F0),jn(N0),jn(aA),jn(uA),jn(i6),jn(Vi),jn(cA)}const u6="html";function V0(n,e,t,r,s,o,i){bc.apply(this,[n,e,t,r,s,o,i]),ia(e,o??"",!1)}V0.RENDERER_TYPE=u6;const c6="autocomplete";function ha(n,e,t,r,s,o,i){const{rootDocument:l}=n,a=i.allowHtml?V0:Bo,u=l.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(l.createTextNode("▼")),a.apply(this,[n,e,t,r,s,o,i]),e.firstChild||e.appendChild(l.createTextNode(" ")),e.insertBefore(u,e.firstChild),ee(e,"htAutocomplete"),!n.acArrowListener){const c=new It(n);n.acArrowListener=function(d){Oe(d.target,"htAutocompleteArrow")&&n.view._wt.getSetting("onCellDblClick",null,n._createCellCoords(t,r),e)},c.addEventListener(n.rootElement,"mousedown",n.acArrowListener),n.addHookOnce("afterDestroy",()=>{c.destroy()})}}ha.RENDERER_TYPE=c6;const VT=new WeakMap,$T=new WeakMap,h6="htBadValue",Zl="data-row",Jl="data-col",d6="checkboxRenderer",hA="checkbox";he.getSingleton().add("modifyAutoColumnSizeSeed",function(n,e,t){const{label:r,type:s,row:o,column:i,prop:l}=e;if(s===hA){if(r){const{value:a,property:u}=r;let c=t;if(a)c=typeof a=="function"?a(o,i,l,t):a;else if(u){const d=this.getDataAtRowProp(o,u);c=d!==null?d:t}n=c}return n}});function $0(n,e,t,r,s,o,i){const{rootDocument:l}=n;bc.apply(this,[n,e,t,r,s,o,i]),f6(n);let a=g6(l);const u=i.label;let c=!1;if(typeof i.checkedTemplate>"u"&&(i.checkedTemplate=!0),typeof i.uncheckedTemplate>"u"&&(i.uncheckedTemplate=!1),hs(e),o===i.checkedTemplate||Lt(o).toLocaleLowerCase(i.locale)===Lt(i.checkedTemplate).toLocaleLowerCase(i.locale)?a.checked=!0:o===i.uncheckedTemplate||Lt(o).toLocaleLowerCase(i.locale)===Lt(i.uncheckedTemplate).toLocaleLowerCase(i.locale)?a.checked=!1:Xt(o)?ee(a,"noValue"):(a.style.display="none",ee(a,h6),c=!0),a.setAttribute(Zl,t),a.setAttribute(Jl,r),!c&&u){let p="";if(u.value)p=typeof u.value=="function"?u.value.call(this,t,r,s,o):u.value;else if(u.property){const M=n.getDataAtRowProp(t,u.property);p=M!==null?M:""}const w=m6(l,p,u.separated!==!0);u.position==="before"?u.separated?(e.appendChild(w),e.appendChild(a)):(w.appendChild(a),a=w):(!u.position||u.position==="after")&&(u.separated?(e.appendChild(a),e.appendChild(w)):(w.insertBefore(a,w.firstChild),a=w))}(!u||u&&!u.separated)&&e.appendChild(a),c&&e.appendChild(l.createTextNode("#bad-value#")),VT.has(n)||(VT.set(n,!0),d());function d(){const w=n.getShortcutManager().getContext("grid"),M={group:d6};w.addShortcuts([{keys:[["space"]],callback:()=>(f(),!m())},{keys:[["enter"]],callback:()=>(f(),!m()),runOnlyIf:()=>n.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!m()),relativeToGroup:fu,position:"before"}],M)}function f(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const w=n.getSelectedRange();if(w)for(let M=0;M<w.length;M++){const{row:S,col:y}=w[M].getTopStartCorner(),{row:v,col:R}=w[M].getBottomEndCorner(),I=[];for(let F=S;F<=v;F+=1)for(let L=y;L<=R;L+=1){const j=n.getCellMeta(F,L);if(j.type!=="checkbox")return;if(j.readOnly===!0)continue;typeof j.checkedTemplate>"u"&&(j.checkedTemplate=!0),typeof j.uncheckedTemplate>"u"&&(j.uncheckedTemplate=!1);const X=n.getDataAtCell(F,L);p===!1?[j.checkedTemplate,j.checkedTemplate.toString()].includes(X)?I.push([F,L,j.uncheckedTemplate]):[j.uncheckedTemplate,j.uncheckedTemplate.toString(),null,void 0].includes(X)&&I.push([F,L,j.checkedTemplate]):I.push([F,L,j.uncheckedTemplate])}I.length>0&&n.setDataAtCell(I)}}function m(){const p=n.getSelectedRange();if(p){for(let w=0;w<p.length;w++){const M=p[w].getTopStartCorner(),S=p[w].getBottomEndCorner();for(let y=M.row;y<=S.row;y++)for(let v=M.col;v<=S.col;v++){const R=n.getCellMeta(y,v);if(R.type!=="checkbox")return!1;const I=n.getCell(y,v);if(I==null)return!0;if(I.querySelectorAll("input[type=checkbox]").length>0&&!R.readOnly)return!0}}return!1}}}$0.RENDERER_TYPE=hA;function f6(n){let e=$T.get(n);if(!e){const{rootElement:t}=n;e=new It(n),e.addEventListener(t,"click",r=>w6(r,n)),e.addEventListener(t,"mouseup",r=>p6(r,n)),e.addEventListener(t,"change",r=>C6(r,n)),$T.set(n,e)}return e}function g6(n){const e=n.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function m6(n,e,t){const r=n.createElement("label");return r.className=`htCheckboxRendererLabel ${t?"fullWidth":""}`,r.appendChild(n.createTextNode(e)),r.cloneNode(!0)}function p6(n,e){const{target:t}=n;B0(t)&&(!t.hasAttribute(Zl)||!t.hasAttribute(Jl)||setTimeout(e.listen,10))}function w6(n,e){const{target:t}=n;if(!B0(t)||!t.hasAttribute(Zl)||!t.hasAttribute(Jl))return;const r=parseInt(t.getAttribute(Zl),10),s=parseInt(t.getAttribute(Jl),10);e.getCellMeta(r,s).readOnly&&n.preventDefault()}function C6(n,e){const{target:t}=n;if(!B0(t)||!t.hasAttribute(Zl)||!t.hasAttribute(Jl))return;const r=parseInt(t.getAttribute(Zl),10),s=parseInt(t.getAttribute(Jl),10),o=e.getCellMeta(r,s);if(!o.readOnly){let i=null;n.target.checked?i=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:i=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,s,i)}}function B0(n){return n.tagName==="INPUT"&&n.getAttribute("type")==="checkbox"}function ph(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var dA={exports:{}};(function(n,e){(function(t){n.exports=t()})(function(){return function t(r,s,o){function i(u,c){if(!s[u]){if(!r[u]){var d=typeof ph=="function"&&ph;if(!c&&d)return d(u,!0);if(l)return l(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var m=s[u]={exports:{}};r[u][0].call(m.exports,function(p){return i(r[u][1][p]||p)},m,m.exports,t,r,s,o)}return s[u].exports}for(var l=typeof ph=="function"&&ph,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(t,r,s){(function(o){var i,l=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,a=Math.ceil,u=Math.floor,c="[BigNumber Error] ",d=c+"Number primitive has more than 15 significant digits: ",f=1e14,m=14,p=9007199254740991,w=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],M=1e7,S=1e9;function y(X){var G=0|X;return 0<X||X===G?G:G-1}function v(X){for(var G,te,ie=1,le=X.length,me=X[0]+"";ie<le;){for(G=X[ie++]+"",te=m-G.length;te--;G="0"+G);me+=G}for(le=me.length;me.charCodeAt(--le)===48;);return me.slice(0,le+1||1)}function R(X,G){var te,ie,le=X.c,me=G.c,Te=X.s,Ue=G.s,Me=X.e,E=G.e;if(!Te||!Ue)return null;if(te=le&&!le[0],ie=me&&!me[0],te||ie)return te?ie?0:-Ue:Te;if(Te!=Ue)return Te;if(te=Te<0,ie=Me==E,!le||!me)return ie?0:!le^te?1:-1;if(!ie)return E<Me^te?1:-1;for(Ue=(Me=le.length)<(E=me.length)?Me:E,Te=0;Te<Ue;Te++)if(le[Te]!=me[Te])return le[Te]>me[Te]^te?1:-1;return Me==E?0:E<Me^te?1:-1}function I(X,G,te,ie){if(X<G||te<X||X!==(X<0?a(X):u(X)))throw Error(c+(ie||"Argument")+(typeof X=="number"?X<G||te<X?" out of range: ":" not an integer: ":" not a primitive number: ")+String(X))}function F(X){var G=X.c.length-1;return y(X.e/m)==G&&X.c[G]%2!=0}function L(X,G){return(1<X.length?X.charAt(0)+"."+X.slice(1):X)+(G<0?"e":"e+")+G}function j(X,G,te){var ie,le;if(G<0){for(le=te+".";++G;le+=te);X=le+X}else if(++G>(ie=X.length)){for(le=te,G-=ie;--G;le+=te);X+=le}else G<ie&&(X=X.slice(0,G)+"."+X.slice(G));return X}(i=function X(G){var te,ie,le,me,Te,Ue,Me,E,h,g,C=q.prototype={constructor:q,toString:null,valueOf:null},_=new q(1),O=20,A=4,W=-7,z=21,K=-1e7,Z=1e7,Q=!1,pe=1,Ae=0,Ee={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},_e="0123456789abcdefghijklmnopqrstuvwxyz";function q(b,T){var x,$,H,B,N,k,U,V,Y=this;if(!(Y instanceof q))return new q(b,T);if(T==null){if(b instanceof q)return Y.s=b.s,Y.e=b.e,void(Y.c=(b=b.c)?b.slice():b);if((k=typeof b=="number")&&0*b==0){if(Y.s=1/b<0?(b=-b,-1):1,b===~~b){for(B=0,N=b;10<=N;N/=10,B++);return Y.e=B,void(Y.c=[b])}V=String(b)}else{if(V=String(b),!l.test(V))return le(Y,V,k);Y.s=V.charCodeAt(0)==45?(V=V.slice(1),-1):1}-1<(B=V.indexOf("."))&&(V=V.replace(".","")),0<(N=V.search(/e/i))?(B<0&&(B=N),B+=+V.slice(N+1),V=V.substring(0,N)):B<0&&(B=V.length)}else{if(I(T,2,_e.length,"Base"),V=String(b),T==10)return Pe(Y=new q(b instanceof q?b:V),O+Y.e+1,A);if(k=typeof b=="number"){if(0*b!=0)return le(Y,V,k,T);if(Y.s=1/b<0?(V=V.slice(1),-1):1,q.DEBUG&&15<V.replace(/^0\.0*|\./,"").length)throw Error(d+b);k=!1}else Y.s=V.charCodeAt(0)===45?(V=V.slice(1),-1):1;for(x=_e.slice(0,T),B=N=0,U=V.length;N<U;N++)if(x.indexOf($=V.charAt(N))<0){if($=="."){if(B<N){B=U;continue}}else if(!H&&(V==V.toUpperCase()&&(V=V.toLowerCase())||V==V.toLowerCase()&&(V=V.toUpperCase()))){H=!0,N=-1,B=0;continue}return le(Y,String(b),k,T)}-1<(B=(V=ie(V,T,10,Y.s)).indexOf("."))?V=V.replace(".",""):B=V.length}for(N=0;V.charCodeAt(N)===48;N++);for(U=V.length;V.charCodeAt(--U)===48;);if(V=V.slice(N,++U)){if(U-=N,k&&q.DEBUG&&15<U&&(p<b||b!==u(b)))throw Error(d+Y.s*b);if(Z<(B=B-N-1))Y.c=Y.e=null;else if(B<K)Y.c=[Y.e=0];else{if(Y.e=B,Y.c=[],N=(B+1)%m,B<0&&(N+=m),N<U){for(N&&Y.c.push(+V.slice(0,N)),U-=m;N<U;)Y.c.push(+V.slice(N,N+=m));V=V.slice(N),N=m-V.length}else N-=U;for(;N--;V+="0");Y.c.push(+V)}}else Y.c=[Y.e=0]}function je(b,T,x,$){var H,B,N,k,U;if(x==null?x=A:I(x,0,8),!b.c)return b.toString();if(H=b.c[0],N=b.e,T==null)U=v(b.c),U=$==1||$==2&&(N<=W||z<=N)?L(U,N):j(U,N,"0");else if(B=(b=Pe(new q(b),T,x)).e,k=(U=v(b.c)).length,$==1||$==2&&(T<=B||B<=W)){for(;k<T;U+="0",k++);U=L(U,B)}else if(T-=N,U=j(U,B,"0"),k<B+1){if(0<--T)for(U+=".";T--;U+="0");}else if(0<(T+=B-k))for(B+1==k&&(U+=".");T--;U+="0");return b.s<0&&H?"-"+U:U}function Ie(b,T){for(var x,$=1,H=new q(b[0]);$<b.length;$++){if(!(x=new q(b[$])).s){H=x;break}T.call(H,x)&&(H=x)}return H}function be(b,T,x){for(var $=1,H=T.length;!T[--H];T.pop());for(H=T[0];10<=H;H/=10,$++);return(x=$+x*m-1)>Z?b.c=b.e=null:b.c=x<K?[b.e=0]:(b.e=x,T),b}function Pe(b,T,x,$){var H,B,N,k,U,V,Y,oe=b.c,de=w;if(oe){e:{for(H=1,k=oe[0];10<=k;k/=10,H++);if((B=T-H)<0)B+=m,N=T,Y=(U=oe[V=0])/de[H-N-1]%10|0;else if((V=a((B+1)/m))>=oe.length){if(!$)break e;for(;oe.length<=V;oe.push(0));U=Y=0,N=(B%=m)-m+(H=1)}else{for(U=k=oe[V],H=1;10<=k;k/=10,H++);Y=(N=(B%=m)-m+H)<0?0:U/de[H-N-1]%10|0}if($=$||T<0||oe[V+1]!=null||(N<0?U:U%de[H-N-1]),$=x<4?(Y||$)&&(x==0||x==(b.s<0?3:2)):5<Y||Y==5&&(x==4||$||x==6&&(0<B?0<N?U/de[H-N]:0:oe[V-1])%10&1||x==(b.s<0?8:7)),T<1||!oe[0])return oe.length=0,$?(T-=b.e+1,oe[0]=de[(m-T%m)%m],b.e=-T||0):oe[0]=b.e=0,b;if(B==0?(oe.length=V,k=1,V--):(oe.length=V+1,k=de[m-B],oe[V]=0<N?u(U/de[H-N]%de[N])*k:0),$)for(;;){if(V==0){for(B=1,N=oe[0];10<=N;N/=10,B++);for(N=oe[0]+=k,k=1;10<=N;N/=10,k++);B!=k&&(b.e++,oe[0]==f&&(oe[0]=1));break}if(oe[V]+=k,oe[V]!=f)break;oe[V--]=0,k=1}for(B=oe.length;oe[--B]===0;oe.pop());}b.e>Z?b.c=b.e=null:b.e<K&&(b.c=[b.e=0])}return b}function ye(b){var T,x=b.e;return x===null?b.toString():(T=v(b.c),T=x<=W||z<=x?L(T,x):j(T,x,"0"),b.s<0?"-"+T:T)}return q.clone=X,q.ROUND_UP=0,q.ROUND_DOWN=1,q.ROUND_CEIL=2,q.ROUND_FLOOR=3,q.ROUND_HALF_UP=4,q.ROUND_HALF_DOWN=5,q.ROUND_HALF_EVEN=6,q.ROUND_HALF_CEIL=7,q.ROUND_HALF_FLOOR=8,q.EUCLID=9,q.config=q.set=function(b){var T,x;if(b!=null){if(typeof b!="object")throw Error(c+"Object expected: "+b);if(b.hasOwnProperty(T="DECIMAL_PLACES")&&(I(x=b[T],0,S,T),O=x),b.hasOwnProperty(T="ROUNDING_MODE")&&(I(x=b[T],0,8,T),A=x),b.hasOwnProperty(T="EXPONENTIAL_AT")&&((x=b[T])&&x.pop?(I(x[0],-S,0,T),I(x[1],0,S,T),W=x[0],z=x[1]):(I(x,-S,S,T),W=-(z=x<0?-x:x))),b.hasOwnProperty(T="RANGE"))if((x=b[T])&&x.pop)I(x[0],-S,-1,T),I(x[1],1,S,T),K=x[0],Z=x[1];else{if(I(x,-S,S,T),!x)throw Error(c+T+" cannot be zero: "+x);K=-(Z=x<0?-x:x)}if(b.hasOwnProperty(T="CRYPTO")){if((x=b[T])!==!!x)throw Error(c+T+" not true or false: "+x);if(x){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Q=!x,Error(c+"crypto unavailable");Q=x}else Q=x}if(b.hasOwnProperty(T="MODULO_MODE")&&(I(x=b[T],0,9,T),pe=x),b.hasOwnProperty(T="POW_PRECISION")&&(I(x=b[T],0,S,T),Ae=x),b.hasOwnProperty(T="FORMAT")){if(typeof(x=b[T])!="object")throw Error(c+T+" not an object: "+x);Ee=x}if(b.hasOwnProperty(T="ALPHABET")){if(typeof(x=b[T])!="string"||/^.$|[+-.\s]|(.).*\1/.test(x))throw Error(c+T+" invalid: "+x);_e=x}}return{DECIMAL_PLACES:O,ROUNDING_MODE:A,EXPONENTIAL_AT:[W,z],RANGE:[K,Z],CRYPTO:Q,MODULO_MODE:pe,POW_PRECISION:Ae,FORMAT:Ee,ALPHABET:_e}},q.isBigNumber=function(b){return b instanceof q||b&&b._isBigNumber===!0||!1},q.maximum=q.max=function(){return Ie(arguments,C.lt)},q.minimum=q.min=function(){return Ie(arguments,C.gt)},q.random=(me=9007199254740992,Te=Math.random()*me&2097151?function(){return u(Math.random()*me)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(b){var T,x,$,H,B,N=0,k=[],U=new q(_);if(b==null?b=O:I(b,0,S),H=a(b/m),Q)if(crypto.getRandomValues){for(T=crypto.getRandomValues(new Uint32Array(H*=2));N<H;)9e15<=(B=131072*T[N]+(T[N+1]>>>11))?(x=crypto.getRandomValues(new Uint32Array(2)),T[N]=x[0],T[N+1]=x[1]):(k.push(B%1e14),N+=2);N=H/2}else{if(!crypto.randomBytes)throw Q=!1,Error(c+"crypto unavailable");for(T=crypto.randomBytes(H*=7);N<H;)9e15<=(B=281474976710656*(31&T[N])+1099511627776*T[N+1]+4294967296*T[N+2]+16777216*T[N+3]+(T[N+4]<<16)+(T[N+5]<<8)+T[N+6])?crypto.randomBytes(7).copy(T,N):(k.push(B%1e14),N+=7);N=H/7}if(!Q)for(;N<H;)(B=Te())<9e15&&(k[N++]=B%1e14);for(H=k[--N],b%=m,H&&b&&(B=w[m-b],k[N]=u(H/B)*B);k[N]===0;k.pop(),N--);if(N<0)k=[$=0];else{for($=-1;k[0]===0;k.splice(0,1),$-=m);for(N=1,B=k[0];10<=B;B/=10,N++);N<m&&($-=m-N)}return U.e=$,U.c=k,U}),q.sum=function(){for(var b=1,T=arguments,x=new q(T[0]);b<T.length;)x=x.plus(T[b++]);return x},ie=function(){var b="0123456789";function T(x,$,H,B){for(var N,k,U=[0],V=0,Y=x.length;V<Y;){for(k=U.length;k--;U[k]*=$);for(U[0]+=B.indexOf(x.charAt(V++)),N=0;N<U.length;N++)U[N]>H-1&&(U[N+1]==null&&(U[N+1]=0),U[N+1]+=U[N]/H|0,U[N]%=H)}return U.reverse()}return function(x,$,H,B,N){var k,U,V,Y,oe,de,ve,xe,Ne=x.indexOf("."),Qe=O,ke=A;for(0<=Ne&&(Y=Ae,Ae=0,x=x.replace(".",""),de=(xe=new q($)).pow(x.length-Ne),Ae=Y,xe.c=T(j(v(de.c),de.e,"0"),10,H,b),xe.e=xe.c.length),V=Y=(ve=T(x,$,H,N?(k=_e,b):(k=b,_e))).length;ve[--Y]==0;ve.pop());if(!ve[0])return k.charAt(0);if(Ne<0?--V:(de.c=ve,de.e=V,de.s=B,ve=(de=te(de,xe,Qe,ke,H)).c,oe=de.r,V=de.e),Ne=ve[U=V+Qe+1],Y=H/2,oe=oe||U<0||ve[U+1]!=null,oe=ke<4?(Ne!=null||oe)&&(ke==0||ke==(de.s<0?3:2)):Y<Ne||Ne==Y&&(ke==4||oe||ke==6&&1&ve[U-1]||ke==(de.s<0?8:7)),U<1||!ve[0])x=oe?j(k.charAt(1),-Qe,k.charAt(0)):k.charAt(0);else{if(ve.length=U,oe)for(--H;++ve[--U]>H;)ve[U]=0,U||(++V,ve=[1].concat(ve));for(Y=ve.length;!ve[--Y];);for(Ne=0,x="";Ne<=Y;x+=k.charAt(ve[Ne++]));x=j(x,V,k.charAt(0))}return x}}(),te=function(){function b($,H,B){var N,k,U,V,Y=0,oe=$.length,de=H%M,ve=H/M|0;for($=$.slice();oe--;)Y=((k=de*(U=$[oe]%M)+(N=ve*U+(V=$[oe]/M|0)*de)%M*M+Y)/B|0)+(N/M|0)+ve*V,$[oe]=k%B;return Y&&($=[Y].concat($)),$}function T($,H,B,N){var k,U;if(B!=N)U=N<B?1:-1;else for(k=U=0;k<B;k++)if($[k]!=H[k]){U=$[k]>H[k]?1:-1;break}return U}function x($,H,B,N){for(var k=0;B--;)$[B]-=k,k=$[B]<H[B]?1:0,$[B]=k*N+$[B]-H[B];for(;!$[0]&&1<$.length;$.splice(0,1));}return function($,H,B,N,k){var U,V,Y,oe,de,ve,xe,Ne,Qe,ke,Ze,Vt,Bi,Er,fa,rr,yt,zt=$.s==H.s?1:-1,nn=$.c,ft=H.c;if(!(nn&&nn[0]&&ft&&ft[0]))return new q($.s&&H.s&&(nn?!ft||nn[0]!=ft[0]:ft)?nn&&nn[0]==0||!ft?0*zt:zt/0:NaN);for(Qe=(Ne=new q(zt)).c=[],zt=B+(V=$.e-H.e)+1,k||(k=f,V=y($.e/m)-y(H.e/m),zt=zt/m|0),Y=0;ft[Y]==(nn[Y]||0);Y++);if(ft[Y]>(nn[Y]||0)&&V--,zt<0)Qe.push(1),oe=!0;else{for(Er=nn.length,rr=ft.length,zt+=2,1<(de=u(k/(ft[Y=0]+1)))&&(ft=b(ft,de,k),nn=b(nn,de,k),rr=ft.length,Er=nn.length),Bi=rr,Ze=(ke=nn.slice(0,rr)).length;Ze<rr;ke[Ze++]=0);yt=ft.slice(),yt=[0].concat(yt),fa=ft[0],ft[1]>=k/2&&fa++;do{if(de=0,(U=T(ft,ke,rr,Ze))<0){if(Vt=ke[0],rr!=Ze&&(Vt=Vt*k+(ke[1]||0)),1<(de=u(Vt/fa)))for(k<=de&&(de=k-1),xe=(ve=b(ft,de,k)).length,Ze=ke.length;T(ve,ke,xe,Ze)==1;)de--,x(ve,rr<xe?yt:ft,xe,k),xe=ve.length,U=1;else de==0&&(U=de=1),xe=(ve=ft.slice()).length;if(xe<Ze&&(ve=[0].concat(ve)),x(ke,ve,Ze,k),Ze=ke.length,U==-1)for(;T(ft,ke,rr,Ze)<1;)de++,x(ke,rr<Ze?yt:ft,Ze,k),Ze=ke.length}else U===0&&(de++,ke=[0]);Qe[Y++]=de,ke[0]?ke[Ze++]=nn[Bi]||0:(ke=[nn[Bi]],Ze=1)}while((Bi++<Er||ke[0]!=null)&&zt--);oe=ke[0]!=null,Qe[0]||Qe.splice(0,1)}if(k==f){for(Y=1,zt=Qe[0];10<=zt;zt/=10,Y++);Pe(Ne,B+(Ne.e=Y+V*m-1)+1,N,oe)}else Ne.e=V,Ne.r=+oe;return Ne}}(),Ue=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Me=/^([^.]+)\.$/,E=/^\.([^.]+)$/,h=/^-?(Infinity|NaN)$/,g=/^\s*\+(?=[\w.])|^\s+|\s+$/g,le=function(b,T,x,$){var H,B=x?T:T.replace(g,"");if(h.test(B))b.s=isNaN(B)?null:B<0?-1:1,b.c=b.e=null;else{if(!x&&(B=B.replace(Ue,function(N,k,U){return H=(U=U.toLowerCase())=="x"?16:U=="b"?2:8,$&&$!=H?N:k}),$&&(H=$,B=B.replace(Me,"$1").replace(E,"0.$1")),T!=B))return new q(B,H);if(q.DEBUG)throw Error(c+"Not a"+($?" base "+$:"")+" number: "+T);b.c=b.e=b.s=null}},C.absoluteValue=C.abs=function(){var b=new q(this);return b.s<0&&(b.s=1),b},C.comparedTo=function(b,T){return R(this,new q(b,T))},C.decimalPlaces=C.dp=function(b,T){var x,$,H;if(b!=null)return I(b,0,S),T==null?T=A:I(T,0,8),Pe(new q(this),b+this.e+1,T);if(!(x=this.c))return null;if($=((H=x.length-1)-y(this.e/m))*m,H=x[H])for(;H%10==0;H/=10,$--);return $<0&&($=0),$},C.dividedBy=C.div=function(b,T){return te(this,new q(b,T),O,A)},C.dividedToIntegerBy=C.idiv=function(b,T){return te(this,new q(b,T),0,1)},C.exponentiatedBy=C.pow=function(b,T){var x,$,H,B,N,k,U,V,Y=this;if((b=new q(b)).c&&!b.isInteger())throw Error(c+"Exponent not an integer: "+ye(b));if(T!=null&&(T=new q(T)),N=14<b.e,!Y.c||!Y.c[0]||Y.c[0]==1&&!Y.e&&Y.c.length==1||!b.c||!b.c[0])return V=new q(Math.pow(+ye(Y),N?2-F(b):+ye(b))),T?V.mod(T):V;if(k=b.s<0,T){if(T.c?!T.c[0]:!T.s)return new q(NaN);($=!k&&Y.isInteger()&&T.isInteger())&&(Y=Y.mod(T))}else{if(9<b.e&&(0<Y.e||Y.e<-1||(Y.e==0?1<Y.c[0]||N&&24e7<=Y.c[1]:Y.c[0]<8e13||N&&Y.c[0]<=9999975e7)))return B=Y.s<0&&F(b)?-0:0,-1<Y.e&&(B=1/B),new q(k?1/B:B);Ae&&(B=a(Ae/m+2))}for(U=N?(x=new q(.5),k&&(b.s=1),F(b)):(H=Math.abs(+ye(b)))%2,V=new q(_);;){if(U){if(!(V=V.times(Y)).c)break;B?V.c.length>B&&(V.c.length=B):$&&(V=V.mod(T))}if(H){if((H=u(H/2))===0)break;U=H%2}else if(Pe(b=b.times(x),b.e+1,1),14<b.e)U=F(b);else{if((H=+ye(b))==0)break;U=H%2}Y=Y.times(Y),B?Y.c&&Y.c.length>B&&(Y.c.length=B):$&&(Y=Y.mod(T))}return $?V:(k&&(V=_.div(V)),T?V.mod(T):B?Pe(V,Ae,A,void 0):V)},C.integerValue=function(b){var T=new q(this);return b==null?b=A:I(b,0,8),Pe(T,T.e+1,b)},C.isEqualTo=C.eq=function(b,T){return R(this,new q(b,T))===0},C.isFinite=function(){return!!this.c},C.isGreaterThan=C.gt=function(b,T){return 0<R(this,new q(b,T))},C.isGreaterThanOrEqualTo=C.gte=function(b,T){return(T=R(this,new q(b,T)))===1||T===0},C.isInteger=function(){return!!this.c&&y(this.e/m)>this.c.length-2},C.isLessThan=C.lt=function(b,T){return R(this,new q(b,T))<0},C.isLessThanOrEqualTo=C.lte=function(b,T){return(T=R(this,new q(b,T)))===-1||T===0},C.isNaN=function(){return!this.s},C.isNegative=function(){return this.s<0},C.isPositive=function(){return 0<this.s},C.isZero=function(){return!!this.c&&this.c[0]==0},C.minus=function(b,T){var x,$,H,B,N=this,k=N.s;if(T=(b=new q(b,T)).s,!k||!T)return new q(NaN);if(k!=T)return b.s=-T,N.plus(b);var U=N.e/m,V=b.e/m,Y=N.c,oe=b.c;if(!U||!V){if(!Y||!oe)return Y?(b.s=-T,b):new q(oe?N:NaN);if(!Y[0]||!oe[0])return oe[0]?(b.s=-T,b):new q(Y[0]?N:A==3?-0:0)}if(U=y(U),V=y(V),Y=Y.slice(),k=U-V){for((H=(B=k<0)?(k=-k,Y):(V=U,oe)).reverse(),T=k;T--;H.push(0));H.reverse()}else for($=(B=(k=Y.length)<(T=oe.length))?k:T,k=T=0;T<$;T++)if(Y[T]!=oe[T]){B=Y[T]<oe[T];break}if(B&&(H=Y,Y=oe,oe=H,b.s=-b.s),0<(T=($=oe.length)-(x=Y.length)))for(;T--;Y[x++]=0);for(T=f-1;k<$;){if(Y[--$]<oe[$]){for(x=$;x&&!Y[--x];Y[x]=T);--Y[x],Y[$]+=f}Y[$]-=oe[$]}for(;Y[0]==0;Y.splice(0,1),--V);return Y[0]?be(b,Y,V):(b.s=A==3?-1:1,b.c=[b.e=0],b)},C.modulo=C.mod=function(b,T){var x,$,H=this;return b=new q(b,T),!H.c||!b.s||b.c&&!b.c[0]?new q(NaN):!b.c||H.c&&!H.c[0]?new q(H):(pe==9?($=b.s,b.s=1,x=te(H,b,0,3),b.s=$,x.s*=$):x=te(H,b,0,pe),(b=H.minus(x.times(b))).c[0]||pe!=1||(b.s=H.s),b)},C.multipliedBy=C.times=function(b,T){var x,$,H,B,N,k,U,V,Y,oe,de,ve,xe,Ne,Qe,ke=this,Ze=ke.c,Vt=(b=new q(b,T)).c;if(!(Ze&&Vt&&Ze[0]&&Vt[0]))return!ke.s||!b.s||Ze&&!Ze[0]&&!Vt||Vt&&!Vt[0]&&!Ze?b.c=b.e=b.s=null:(b.s*=ke.s,Ze&&Vt?(b.c=[0],b.e=0):b.c=b.e=null),b;for($=y(ke.e/m)+y(b.e/m),b.s*=ke.s,(U=Ze.length)<(oe=Vt.length)&&(xe=Ze,Ze=Vt,Vt=xe,H=U,U=oe,oe=H),H=U+oe,xe=[];H--;xe.push(0));for(Ne=f,Qe=M,H=oe;0<=--H;){for(x=0,de=Vt[H]%Qe,ve=Vt[H]/Qe|0,B=H+(N=U);H<B;)x=((V=de*(V=Ze[--N]%Qe)+(k=ve*V+(Y=Ze[N]/Qe|0)*de)%Qe*Qe+xe[B]+x)/Ne|0)+(k/Qe|0)+ve*Y,xe[B--]=V%Ne;xe[B]=x}return x?++$:xe.splice(0,1),be(b,xe,$)},C.negated=function(){var b=new q(this);return b.s=-b.s||null,b},C.plus=function(b,T){var x,$=this,H=$.s;if(T=(b=new q(b,T)).s,!H||!T)return new q(NaN);if(H!=T)return b.s=-T,$.minus(b);var B=$.e/m,N=b.e/m,k=$.c,U=b.c;if(!B||!N){if(!k||!U)return new q(H/0);if(!k[0]||!U[0])return U[0]?b:new q(k[0]?$:0*H)}if(B=y(B),N=y(N),k=k.slice(),H=B-N){for((x=0<H?(N=B,U):(H=-H,k)).reverse();H--;x.push(0));x.reverse()}for((H=k.length)-(T=U.length)<0&&(x=U,U=k,k=x,T=H),H=0;T;)H=(k[--T]=k[T]+U[T]+H)/f|0,k[T]=f===k[T]?0:k[T]%f;return H&&(k=[H].concat(k),++N),be(b,k,N)},C.precision=C.sd=function(b,T){var x,$,H;if(b!=null&&b!==!!b)return I(b,1,S),T==null?T=A:I(T,0,8),Pe(new q(this),b,T);if(!(x=this.c))return null;if($=(H=x.length-1)*m+1,H=x[H]){for(;H%10==0;H/=10,$--);for(H=x[0];10<=H;H/=10,$++);}return b&&this.e+1>$&&($=this.e+1),$},C.shiftedBy=function(b){return I(b,-p,p),this.times("1e"+b)},C.squareRoot=C.sqrt=function(){var b,T,x,$,H,B=this,N=B.c,k=B.s,U=B.e,V=O+4,Y=new q("0.5");if(k!==1||!N||!N[0])return new q(!k||k<0&&(!N||N[0])?NaN:N?B:1/0);if((x=(k=Math.sqrt(+ye(B)))==0||k==1/0?(((T=v(N)).length+U)%2==0&&(T+="0"),k=Math.sqrt(+T),U=y((U+1)/2)-(U<0||U%2),new q(T=k==1/0?"1e"+U:(T=k.toExponential()).slice(0,T.indexOf("e")+1)+U)):new q(k+"")).c[0]){for((k=(U=x.e)+V)<3&&(k=0);;)if(H=x,x=Y.times(H.plus(te(B,H,V,1))),v(H.c).slice(0,k)===(T=v(x.c)).slice(0,k)){if(x.e<U&&--k,(T=T.slice(k-3,k+1))!="9999"&&($||T!="4999")){+T&&(+T.slice(1)||T.charAt(0)!="5")||(Pe(x,x.e+O+2,1),b=!x.times(x).eq(B));break}if(!$&&(Pe(H,H.e+O+2,0),H.times(H).eq(B))){x=H;break}V+=4,k+=4,$=1}}return Pe(x,x.e+O+1,A,b)},C.toExponential=function(b,T){return b!=null&&(I(b,0,S),b++),je(this,b,T,1)},C.toFixed=function(b,T){return b!=null&&(I(b,0,S),b=b+this.e+1),je(this,b,T)},C.toFormat=function(b,T,x){var $;if(x==null)b!=null&&T&&typeof T=="object"?(x=T,T=null):b&&typeof b=="object"?(x=b,b=T=null):x=Ee;else if(typeof x!="object")throw Error(c+"Argument not an object: "+x);if($=this.toFixed(b,T),this.c){var H,B=$.split("."),N=+x.groupSize,k=+x.secondaryGroupSize,U=x.groupSeparator||"",V=B[0],Y=B[1],oe=this.s<0,de=oe?V.slice(1):V,ve=de.length;if(k&&(H=N,N=k,ve-=k=H),0<N&&0<ve){for(H=ve%N||N,V=de.substr(0,H);H<ve;H+=N)V+=U+de.substr(H,N);0<k&&(V+=U+de.slice(H)),oe&&(V="-"+V)}$=Y?V+(x.decimalSeparator||"")+((k=+x.fractionGroupSize)?Y.replace(new RegExp("\\d{"+k+"}\\B","g"),"$&"+(x.fractionGroupSeparator||"")):Y):V}return(x.prefix||"")+$+(x.suffix||"")},C.toFraction=function(b){var T,x,$,H,B,N,k,U,V,Y,oe,de,ve=this,xe=ve.c;if(b!=null&&(!(k=new q(b)).isInteger()&&(k.c||k.s!==1)||k.lt(_)))throw Error(c+"Argument "+(k.isInteger()?"out of range: ":"not an integer: ")+ye(k));if(!xe)return new q(ve);for(T=new q(_),V=x=new q(_),$=U=new q(_),de=v(xe),B=T.e=de.length-ve.e-1,T.c[0]=w[(N=B%m)<0?m+N:N],b=!b||0<k.comparedTo(T)?0<B?T:V:k,N=Z,Z=1/0,k=new q(de),U.c[0]=0;Y=te(k,T,0,1),(H=x.plus(Y.times($))).comparedTo(b)!=1;)x=$,$=H,V=U.plus(Y.times(H=V)),U=H,T=k.minus(Y.times(H=T)),k=H;return H=te(b.minus(x),$,0,1),U=U.plus(H.times(V)),x=x.plus(H.times($)),U.s=V.s=ve.s,oe=te(V,$,B*=2,A).minus(ve).abs().comparedTo(te(U,x,B,A).minus(ve).abs())<1?[V,$]:[U,x],Z=N,oe},C.toNumber=function(){return+ye(this)},C.toPrecision=function(b,T){return b!=null&&I(b,1,S),je(this,b,T,2)},C.toString=function(b){var T,x=this,$=x.s,H=x.e;return H===null?$?(T="Infinity",$<0&&(T="-"+T)):T="NaN":(T=b==null?H<=W||z<=H?L(v(x.c),H):j(v(x.c),H,"0"):b===10?j(v((x=Pe(new q(x),O+H+1,A)).c),x.e,"0"):(I(b,2,_e.length,"Base"),ie(j(v(x.c),H,"0"),10,b,$,!0)),$<0&&x.c[0]&&(T="-"+T)),T},C.valueOf=C.toJSON=function(){return ye(this)},C._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(C[Symbol.toStringTag]="BigNumber",C[Symbol.for("nodejs.util.inspect.custom")]=C.valueOf),G!=null&&q.set(G),q}()).default=i.BigNumber=i,r!==void 0&&r.exports?r.exports=i:(o||(o=typeof self<"u"&&self?self:window),o.BigNumber=i)})(this)},{}],2:[function(t,r,s){r.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(o){var i=o%10;return~~(o%100/10)==1?"th":i===1?"st":i===2?"nd":i===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(t,r,s){function o(y,v){return function(R){if(Array.isArray(R))return R}(y)||function(R,I){var F=[],L=!0,j=!1,X=void 0;try{for(var G,te=R[Symbol.iterator]();!(L=(G=te.next()).done)&&(F.push(G.value),!I||F.length!==I);L=!0);}catch(ie){j=!0,X=ie}finally{try{L||te.return==null||te.return()}finally{if(j)throw X}}return F}(y,v)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var i=t("./globalState"),l=t("./validating"),a=t("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},d={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function f(y){var v=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},R=2<arguments.length?arguments[2]:void 0;if(typeof v=="string"&&(v=a.parseFormat(v)),!l.validateFormat(v))return"ERROR: invalid format";var I=v.prefix||"",F=v.postfix||"",L=function(j,X,G){switch(X.output){case"currency":return X=S(X,i.currentCurrencyDefaultFormat()),function(_e,q,je){var Ie=je.currentCurrency(),be=Object.assign({},d,q),Pe=void 0,ye="",b=!!be.totalLength||!!be.forceAverage||be.average,T=q.currencyPosition||Ie.position,x=q.currencySymbol||Ie.symbol;be.spaceSeparated&&(ye=" "),T==="infix"&&(Pe=ye+x+ye);var $=M({instance:_e,providedFormat:q,state:je,decimalSeparator:Pe});return T==="prefix"&&($=_e._value<0&&be.negative==="sign"?"-".concat(ye).concat(x).concat($.slice(1)):x+ye+$),T&&T!=="postfix"||($=$+(ye=b?"":ye)+x),$}(j,X,i);case"percent":return X=S(X,i.currentPercentageDefaultFormat()),function(_e,q,je,Ie){var be=q.prefixSymbol,Pe=M({instance:Ie(100*_e._value),providedFormat:q,state:je}),ye=Object.assign({},d,q);return be?"%".concat(ye.spaceSeparated?" ":"").concat(Pe):"".concat(Pe).concat(ye.spaceSeparated?" ":"","%")}(j,X,i,G);case"byte":return X=S(X,i.currentByteDefaultFormat()),_=j,A=i,W=G,z=(O=X).base||"binary",K=c[z],Z=m(_._value,K.suffixes,K.scale),Q=Z.value,pe=Z.suffix,Ae=M({instance:W(Q),providedFormat:O,state:A,defaults:A.currentByteDefaultFormat()}),Ee=A.currentAbbreviations(),"".concat(Ae).concat(Ee.spaced?" ":"").concat(pe);case"time":return X=S(X,i.currentTimeDefaultFormat()),E=j,h=Math.floor(E._value/60/60),g=Math.floor((E._value-60*h*60)/60),C=Math.round(E._value-60*h*60-60*g),"".concat(h,":").concat(g<10?"0":"").concat(g,":").concat(C<10?"0":"").concat(C);case"ordinal":return X=S(X,i.currentOrdinalDefaultFormat()),te=j,ie=X,me=(le=i).currentOrdinal(),Te=Object.assign({},d,ie),Ue=M({instance:te,providedFormat:ie,state:le}),Me=me(te._value),"".concat(Ue).concat(Te.spaceSeparated?" ":"").concat(Me);case"number":default:return M({instance:j,providedFormat:X,numbro:G})}var te,ie,le,me,Te,Ue,Me,E,h,g,C,_,O,A,W,z,K,Z,Q,pe,Ae,Ee}(y,v,R);return L=(L=I+L)+F}function m(y,v,R){var I=v[0],F=Math.abs(y);if(R<=F){for(var L=1;L<v.length;++L){var j=Math.pow(R,L),X=Math.pow(R,L+1);if(j<=F&&F<X){I=v[L],y/=j;break}}I===v[0]&&(y/=Math.pow(R,v.length-1),I=v[v.length-1])}return{value:y,suffix:I}}function p(y){for(var v="",R=0;R<y;R++)v+="0";return v}function w(y,v){return y.toString().indexOf("e")!==-1?function(R,I){var F=R.toString(),L=o(F.split("e"),2),j=L[0],X=L[1],G=o(j.split("."),2),te=G[0],ie=G[1],le=ie===void 0?"":ie;if(0<+X)F=te+le+p(X-le.length);else{var me=".";me=+te<0?"-0".concat(me):"0".concat(me);var Te=(p(-X-1)+Math.abs(te)+le).substr(0,I);Te.length<I&&(Te+=p(I-Te.length)),F=me+Te}return 0<+X&&0<I&&(F+=".".concat(p(I))),F}(y,v):(Math.round(+"".concat(y,"e+").concat(v))/Math.pow(10,v)).toFixed(v)}function M(y){var v=y.instance,R=y.providedFormat,I=y.state,F=I===void 0?i:I,L=y.decimalSeparator,j=y.defaults,X=j===void 0?F.currentDefaults():j,G=v._value;if(G===0&&F.hasZeroFormat())return F.getZeroFormat();if(!isFinite(G))return G.toString();var te,ie,le,me,Te,Ue,Me,E,h=Object.assign({},d,X,R),g=h.totalLength,C=g?0:h.characteristic,_=h.optionalCharacteristic,O=h.forceAverage,A=!!g||!!O||h.average,W=g?-1:A&&R.mantissa===void 0?0:h.mantissa,z=!g&&(R.optionalMantissa===void 0?W===-1:h.optionalMantissa),K=h.trimMantissa,Z=h.thousandSeparated,Q=h.spaceSeparated,pe=h.negative,Ae=h.forceSign,Ee=h.exponential,_e="";if(A){var q=function(b){var T=b.value,x=b.forceAverage,$=b.abbreviations,H=b.spaceSeparated,B=H!==void 0&&H,N=b.totalLength,k=N===void 0?0:N,U="",V=Math.abs(T),Y=-1;if(V>=Math.pow(10,12)&&!x||x==="trillion"?(U=$.trillion,T/=Math.pow(10,12)):V<Math.pow(10,12)&&V>=Math.pow(10,9)&&!x||x==="billion"?(U=$.billion,T/=Math.pow(10,9)):V<Math.pow(10,9)&&V>=Math.pow(10,6)&&!x||x==="million"?(U=$.million,T/=Math.pow(10,6)):(V<Math.pow(10,6)&&V>=Math.pow(10,3)&&!x||x==="thousand")&&(U=$.thousand,T/=Math.pow(10,3)),U&&(U=(B?" ":"")+U),k){var oe=T.toString().split(".")[0];Y=Math.max(k-oe.length,0)}return{value:T,abbreviation:U,mantissaPrecision:Y}}({value:G,forceAverage:O,abbreviations:F.currentAbbreviations(),spaceSeparated:Q,totalLength:g});G=q.value,_e+=q.abbreviation,g&&(W=q.mantissaPrecision)}if(Ee){var je=(ie=(te={value:G,characteristicPrecision:C}).value,le=te.characteristicPrecision,me=le===void 0?0:le,Te=o(ie.toExponential().split("e"),2),Ue=Te[0],Me=Te[1],E=+Ue,me&&1<me&&(E*=Math.pow(10,me-1),Me=0<=(Me=+Me-(me-1))?"+".concat(Me):Me),{value:E,abbreviation:"e".concat(Me)});G=je.value,_e=je.abbreviation+_e}var Ie,be,Pe,ye=function(b,T,x,$,H){if($===-1)return b;var B=w(T,$),N=o(B.toString().split("."),2),k=N[0],U=N[1],V=U===void 0?"":U;if(V.match(/^0+$/)&&(x||H))return k;var Y=V.match(/0+$/);return H&&Y?"".concat(k,".").concat(V.toString().slice(0,Y.index)):B.toString()}(G.toString(),G,z,W,K);return ye=function(b,T,x,$,H){var B=$.currentDelimiters(),N=B.thousands;H=H||B.decimal;var k=B.thousandsSize||3,U=b.toString(),V=U.split(".")[0],Y=U.split(".")[1];return x&&(T<0&&(V=V.slice(1)),function(oe,de){for(var ve=[],xe=0,Ne=oe;0<Ne;Ne--)xe===de&&(ve.unshift(Ne),xe=0),xe++;return ve}(V.length,k).forEach(function(oe,de){V=V.slice(0,oe+de)+N+V.slice(oe+de)}),T<0&&(V="-".concat(V))),U=Y?V+H+Y:V}(ye=function(b,T,x,$){var H=b,B=o(H.toString().split("."),2),N=B[0],k=B[1];if(N.match(/^-?0$/)&&x)return k?"".concat(N.replace("0",""),".").concat(k):N.replace("0","");if(N.length<$)for(var U=$-N.length,V=0;V<U;V++)H="0".concat(H);return H.toString()}(ye,0,_,C),G,Z,F,L),(A||Ee)&&(ye=ye+_e),(Ae||G<0)&&(Ie=ye,Pe=pe,ye=(be=G)===0?Ie:+Ie==0?Ie.replace("-",""):0<be?"+".concat(Ie):Pe==="sign"?Ie:"(".concat(Ie.replace("-",""),")")),ye}function S(y,v){if(!y)return v;var R=Object.keys(y);return R.length===1&&R[0]==="output"?v:y}r.exports=function(y){return{format:function(){for(var v=arguments.length,R=new Array(v),I=0;I<v;I++)R[I]=arguments[I];return f.apply(void 0,R.concat([y]))},getByteUnit:function(){for(var v=arguments.length,R=new Array(v),I=0;I<v;I++)R[I]=arguments[I];return(function(F){var L=c.general;return m(F._value,L.suffixes,L.scale).suffix}).apply(void 0,R.concat([y]))},getBinaryByteUnit:function(){for(var v=arguments.length,R=new Array(v),I=0;I<v;I++)R[I]=arguments[I];return(function(F){var L=c.binary;return m(F._value,L.suffixes,L.scale).suffix}).apply(void 0,R.concat([y]))},getDecimalByteUnit:function(){for(var v=arguments.length,R=new Array(v),I=0;I<v;I++)R[I]=arguments[I];return(function(F){var L=c.decimal;return m(F._value,L.suffixes,L.scale).suffix}).apply(void 0,R.concat([y]))},formatOrDefault:S}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(t,r,s){var o=t("./en-US"),i=t("./validating"),l=t("./parsing"),a={},u=void 0,c={},d=null,f={};function m(w){u=w}function p(){return c[u]}a.languages=function(){return Object.assign({},c)},a.currentLanguage=function(){return u},a.currentCurrency=function(){return p().currency},a.currentAbbreviations=function(){return p().abbreviations},a.currentDelimiters=function(){return p().delimiters},a.currentOrdinal=function(){return p().ordinal},a.currentDefaults=function(){return Object.assign({},p().defaults,f)},a.currentOrdinalDefaultFormat=function(){return Object.assign({},a.currentDefaults(),p().ordinalFormat)},a.currentByteDefaultFormat=function(){return Object.assign({},a.currentDefaults(),p().byteFormat)},a.currentPercentageDefaultFormat=function(){return Object.assign({},a.currentDefaults(),p().percentageFormat)},a.currentCurrencyDefaultFormat=function(){return Object.assign({},a.currentDefaults(),p().currencyFormat)},a.currentTimeDefaultFormat=function(){return Object.assign({},a.currentDefaults(),p().timeFormat)},a.setDefaults=function(w){w=l.parseFormat(w),i.validateFormat(w)&&(f=w)},a.getZeroFormat=function(){return d},a.setZeroFormat=function(w){return d=typeof w=="string"?w:null},a.hasZeroFormat=function(){return d!==null},a.languageData=function(w){if(w){if(c[w])return c[w];throw new Error('Unknown tag "'.concat(w,'"'))}return p()},a.registerLanguage=function(w){var M=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!i.validateLanguage(w))throw new Error("Invalid language data");c[w.languageTag]=w,M&&m(w.languageTag)},a.setLanguage=function(w){var M=1<arguments.length&&arguments[1]!==void 0?arguments[1]:o.languageTag;if(!c[w]){var S=w.split("-")[0],y=Object.keys(c).find(function(v){return v.split("-")[0]===S});return c[y]?void m(y):void m(M)}m(w)},a.registerLanguage(o),u=o.languageTag,r.exports=a},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(t,r,s){r.exports=function(o){return{loadLanguagesInNode:function(i){return l=o,void i.forEach(function(a){var u=void 0;try{u=t("../languages/".concat(a))}catch{console.error('Unable to load "'.concat(a,'". No matching language file found.'))}u&&l.registerLanguage(u)});var l}}}},{}],6:[function(t,r,s){var o=t("bignumber.js");function i(l,a,u){var c=new o(l._value),d=a;return u.isNumbro(a)&&(d=a._value),d=new o(d),l._value=c.minus(d).toNumber(),l}r.exports=function(l){return{add:function(a,u){return d=u,f=l,m=new o((c=a)._value),p=d,f.isNumbro(d)&&(p=d._value),p=new o(p),c._value=m.plus(p).toNumber(),c;var c,d,f,m,p},subtract:function(a,u){return i(a,u,l)},multiply:function(a,u){return d=u,f=l,m=new o((c=a)._value),p=d,f.isNumbro(d)&&(p=d._value),p=new o(p),c._value=m.times(p).toNumber(),c;var c,d,f,m,p},divide:function(a,u){return d=u,f=l,m=new o((c=a)._value),p=d,f.isNumbro(d)&&(p=d._value),p=new o(p),c._value=m.dividedBy(p).toNumber(),c;var c,d,f,m,p},set:function(a,u){return c=a,f=d=u,l.isNumbro(d)&&(f=d._value),c._value=f,c;var c,d,f},difference:function(a,u){return c=u,i(f=(d=l)(a._value),c,d),Math.abs(f._value);var c,d,f}}}},{"bignumber.js":1}],7:[function(t,r,s){function o(M,S){for(var y=0;y<S.length;y++){var v=S[y];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(M,v.key,v)}}var i=t("./globalState"),l=t("./validating"),a=t("./loading")(w),u=t("./unformatting"),c=t("./formatting")(w),d=t("./manipulating")(w),f=t("./parsing"),m=function(){function M(v){(function(R,I){if(!(R instanceof I))throw new TypeError("Cannot call a class as a function")})(this,M),this._value=v}var S,y;return S=M,(y=[{key:"clone",value:function(){return w(this._value)}},{key:"format",value:function(){var v=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,v)}},{key:"formatCurrency",value:function(v){return typeof v=="string"&&(v=f.parseFormat(v)),(v=c.formatOrDefault(v,i.currentCurrencyDefaultFormat())).output="currency",c.format(this,v)}},{key:"formatTime",value:function(){var v=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return v.output="time",c.format(this,v)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(v){return d.difference(this,v)}},{key:"add",value:function(v){return d.add(this,v)}},{key:"subtract",value:function(v){return d.subtract(this,v)}},{key:"multiply",value:function(v){return d.multiply(this,v)}},{key:"divide",value:function(v){return d.divide(this,v)}},{key:"set",value:function(v){return d.set(this,p(v))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&o(S.prototype,y),M}();function p(M){var S=M;return w.isNumbro(M)?S=M._value:typeof M=="string"?S=w.unformat(M):isNaN(M)&&(S=NaN),S}function w(M){return new m(p(M))}w.version="2.1.2",w.isNumbro=function(M){return M instanceof m},w.language=i.currentLanguage,w.registerLanguage=i.registerLanguage,w.setLanguage=i.setLanguage,w.languages=i.languages,w.languageData=i.languageData,w.zeroFormat=i.setZeroFormat,w.defaultFormat=i.currentDefaults,w.setDefaults=i.setDefaults,w.defaultCurrencyFormat=i.currentCurrencyDefaultFormat,w.validate=l.validate,w.loadLanguagesInNode=a.loadLanguagesInNode,w.unformat=u.unformat,r.exports=w},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(t,r,s){r.exports={parseFormat:function(o){var i,l,a,u,c,d,f,m,p,w,M,S,y,v,R,I,F,L,j,X,G=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof o!="string"?o:(l=G,o=(a=(i=o).match(/^{([^}]*)}/))?(l.prefix=a[1],i.slice(a[0].length)):i,c=G,function(te,ie){if(te.indexOf("$")===-1){if(te.indexOf("%")===-1)return te.indexOf("bd")!==-1?(ie.output="byte",ie.base="general"):te.indexOf("b")!==-1?(ie.output="byte",ie.base="binary"):te.indexOf("d")!==-1?(ie.output="byte",ie.base="decimal"):te.indexOf(":")===-1?te.indexOf("o")!==-1&&(ie.output="ordinal"):ie.output="time";ie.output="percent"}else ie.output="currency"}(o=(d=(u=o).match(/{([^}]*)}$/))?(c.postfix=d[1],u.slice(0,-d[0].length)):u,G),f=G,(m=o.match(/[1-9]+[0-9]*/))&&(f.totalLength=+m[0]),p=G,(w=o.split(".")[0].match(/0+/))&&(p.characteristic=w[0].length),function(te,ie){if(te.indexOf(".")!==-1){var le=te.split(".")[0];ie.optionalCharacteristic=le.indexOf("0")===-1}}(o,G),M=G,o.indexOf("a")!==-1&&(M.average=!0),y=G,(S=o).indexOf("K")!==-1?y.forceAverage="thousand":S.indexOf("M")!==-1?y.forceAverage="million":S.indexOf("B")!==-1?y.forceAverage="billion":S.indexOf("T")!==-1&&(y.forceAverage="trillion"),function(te,ie){var le=te.split(".")[1];if(le){var me=le.match(/0+/);me&&(ie.mantissa=me[0].length)}}(o,G),R=G,(v=o).match(/\[\.]/)?R.optionalMantissa=!0:v.match(/\./)&&(R.optionalMantissa=!1),I=G,o.indexOf(",")!==-1&&(I.thousandSeparated=!0),F=G,o.indexOf(" ")!==-1&&(F.spaceSeparated=!0),j=G,(L=o).match(/^\+?\([^)]*\)$/)&&(j.negative="parenthesis"),L.match(/^\+?-/)&&(j.negative="sign"),X=G,o.match(/^\+/)&&(X.forceSign=!0),G)}}},{}],9:[function(t,r,s){var o=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function i(a){return a.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function l(a,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",d=3<arguments.length?arguments[3]:void 0,f=4<arguments.length?arguments[4]:void 0,m=5<arguments.length?arguments[5]:void 0,p=6<arguments.length?arguments[6]:void 0;if(a!=="")return a===f?0:function w(M,S){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",v=3<arguments.length?arguments[3]:void 0,R=4<arguments.length?arguments[4]:void 0,I=5<arguments.length?arguments[5]:void 0,F=6<arguments.length?arguments[6]:void 0;if(!isNaN(+M))return+M;var L="",j=M.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(j!==M)return-1*w(j,S,y,v,R,I,F);for(var X=0;X<o.length;X++){var G=o[X];if((L=M.replace(G.key,""))!==M)return w(L,S,y,v,R,I,F)*G.factor}if((L=M.replace("%",""))!==M)return w(L,S,y,v,R,I,F)/100;var te=parseFloat(M);if(!isNaN(te)){var ie=v(te);if(ie&&ie!=="."&&(L=M.replace(new RegExp("".concat(i(ie),"$")),""))!==M)return w(L,S,y,v,R,I,F);var le={};Object.keys(I).forEach(function(g){le[I[g]]=g});for(var me=Object.keys(le).sort().reverse(),Te=me.length,Ue=0;Ue<Te;Ue++){var Me=me[Ue],E=le[Me];if((L=M.replace(Me,""))!==M){var h=void 0;switch(E){case"thousand":h=Math.pow(10,3);break;case"million":h=Math.pow(10,6);break;case"billion":h=Math.pow(10,9);break;case"trillion":h=Math.pow(10,12)}return w(L,S,y,v,R,I,F)*h}}}}(function(w,M){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",y=w.replace(S,"");return y=(y=y.replace(new RegExp("([0-9])".concat(i(M.thousands),"([0-9])"),"g"),"$1$2")).replace(M.decimal,".")}(a,u,c),u,c,d,f,m,p)}r.exports={unformat:function(a,u){var c,d,f,m=t("./globalState"),p=m.currentDelimiters(),w=m.currentCurrency().symbol,M=m.currentOrdinal(),S=m.getZeroFormat(),y=m.currentAbbreviations(),v=void 0;if(typeof a=="string")v=function(R,I){if(!R.indexOf(":")||I.thousands===":")return!1;var F=R.split(":");if(F.length!==3)return!1;var L=+F[0],j=+F[1],X=+F[2];return!isNaN(L)&&!isNaN(j)&&!isNaN(X)}(a,p)?(c=a.split(":"),d=+c[0],f=+c[1],+c[2]+60*f+3600*d):l(a,p,w,M,S,y,u);else{if(typeof a!="number")return;v=a}if(v!==void 0)return v}}},{"./globalState":4}],10:[function(t,r,s){function o(p){return function(w){if(Array.isArray(w)){for(var M=0,S=new Array(w.length);M<w.length;M++)S[M]=w[M];return S}}(p)||function(w){if(Symbol.iterator in Object(w)||Object.prototype.toString.call(w)==="[object Arguments]")return Array.from(w)}(p)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(p){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w})(p)}var l=t("./unformatting"),a=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(p,w){return w.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(p){return p.output==="byte"}},characteristic:{type:"number",restriction:function(p){return 0<=p},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(p){return 0<=p},message:"value must be positive"},{restriction:function(p,w){return!w.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(p){return 0<=p},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(p,w){return w.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(p){return p.match(a)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function d(p){return!!l.unformat(p)}function f(p,w,M){var S=3<arguments.length&&arguments[3]!==void 0&&arguments[3],y=Object.keys(p).map(function(v){if(!w[v])return console.error("".concat(M," Invalid key: ").concat(v)),!1;var R=p[v],I=w[v];if(typeof I=="string"&&(I={type:I}),I.type==="format"){if(!f(R,u,"[Validate ".concat(v,"]"),!0))return!1}else if(i(R)!==I.type)return console.error("".concat(M," ").concat(v,' type mismatched: "').concat(I.type,'" expected, "').concat(i(R),'" provided')),!1;if(I.restrictions&&I.restrictions.length)for(var F=I.restrictions.length,L=0;L<F;L++){var j=I.restrictions[L],X=j.restriction,G=j.message;if(!X(R,p))return console.error("".concat(M," ").concat(v," invalid value: ").concat(G)),!1}return I.restriction&&!I.restriction(R,p)?(console.error("".concat(M," ").concat(v," invalid value: ").concat(I.message)),!1):I.validValues&&I.validValues.indexOf(R)===-1?(console.error("".concat(M," ").concat(v," invalid value: must be among ").concat(JSON.stringify(I.validValues),', "').concat(R,'" provided')),!1):!(I.children&&!f(R,I.children,"[Validate ".concat(v,"]")))});return S||y.push.apply(y,o(Object.keys(w).map(function(v){var R=w[v];if(typeof R=="string"&&(R={type:R}),R.mandatory){var I=R.mandatory;if(typeof I=="function"&&(I=I(p)),I&&p[v]===void 0)return console.error("".concat(M,' Missing mandatory key "').concat(v,'"')),!1}return!0}))),y.reduce(function(v,R){return v&&R},!0)}function m(p){return f(p,u,"[Validate format]")}r.exports={validate:function(p,w){var M=d(p),S=m(w);return M&&S},validateFormat:m,validateInput:d,validateLanguage:function(p){return f(p,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(dA);var y6=dA.exports;const Xo=bf(y6),v6="numeric";function W0(n,e,t,r,s,o,i){let l=o;if(Nn(l)){const a=i.numericFormat,u=a&&a.culture||"-",c=a&&a.pattern,d=i.className||"",f=d.length?d.split(" "):[];if(typeof u<"u"&&!Xo.languages()[u]){const m=u.replace("-",""),p=Xo.allLanguages?Xo.allLanguages[u]:Xo[m];p&&Xo.registerLanguage(p)}Xo.setLanguage(u),l=Xo(l).format(c||"0"),f.indexOf("htLeft")<0&&f.indexOf("htCenter")<0&&f.indexOf("htRight")<0&&f.indexOf("htJustify")<0&&f.push("htRight"),f.indexOf("htNumeric")<0&&f.push("htNumeric"),i.className=f.join(" "),e.dir="ltr"}Bo(n,e,t,r,s,l,i)}W0.RENDERER_TYPE=v6;const S6="password";function U0(n,e,t,r,s,o,i){Bo.apply(this,[n,e,t,r,s,o,i]);const l=i.hashLength||e.innerHTML.length,a=i.hashSymbol||"*";let u="";Ce(l-1,()=>{u+=a}),ia(e,u)}U0.RENDERER_TYPE=S6;const R6="time";function z0(n,e,t,r,s,o,i){Bo.apply(this,[n,e,t,r,s,o,i]),e.dir="ltr"}z0.RENDERER_TYPE=R6;function b6(){Ms(ha),Ms(bc),Ms($0),Ms(V0),Ms(W0),Ms(U0),Ms(Bo),Ms(z0)}const E6="autocomplete";function Dg(n,e){let t=n;if(t==null&&(t=""),this.allowEmpty&&t===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(t,BT(t,e)):BT(t,e)(this.source):e(!0)}Dg.VALIDATOR_TYPE=E6;function BT(n,e){const t=n;return function(r){let s=!1;for(let o=0,i=r.length;o<i;o++)if(t===r[o]){s=!0;break}e(s)}}function T6(n){const e=new Date(n);return isNaN(new Date(`${n}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const M6="date";function Y0(n,e){const t=ix(iA,this.instance);let r=n,s=!0;r==null&&(r="");let o=J(r,this.dateFormat||t.defaultDateFormat,!0).isValid(),i=J(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(i=!0,o=!0),i||(s=!1),!i&&o&&(s=!0),i&&!o)if(this.correctFormat===!0){const l=_6(r,this.dateFormat),a=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(a,u,l,"dateValidator"),s=!0}else s=!1;e(s)}Y0.VALIDATOR_TYPE=M6;function _6(n,e){const t=J(T6(n)),r=J(n,e),s=n.search(/[A-z]/g)>-1;let o;return t.isValid()&&t.format("x")===r.format("x")||!r.isValid()||s?o=t:o=r,o.format(e)}const O6="numeric";function j0(n,e){let t=n;t==null&&(t=""),this.allowEmpty&&t===""?e(!0):e(t===""?!1:Nn(n))}j0.VALIDATOR_TYPE=O6;const I6=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],x6="time";function G0(n,e){const t=this.timeFormat||"h:mm:ss a";let r=!0,s=n;s===null&&(s=""),s=/^\d{3,}$/.test(s)?parseInt(s,10):s;const o=/^\d{1,2}$/.test(s);o&&(s+=":00");const i=J(s,I6,!0).isValid()?J(s):J(s,t);let l=i.isValid(),a=J(s,t,!0).isValid()&&!o;if(this.allowEmpty&&s===""&&(l=!0,a=!0),l||(r=!1),!l&&a&&(r=!0),l&&!a)if(this.correctFormat===!0){const u=i.format(t),c=this.instance.toVisualRow(this.row),d=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,d,u,"timeValidator"),r=!0}else r=!1;e(r)}G0.VALIDATOR_TYPE=x6;function A6(){qa(Dg),qa(Y0),qa(j0),qa(G0)}const P6="autocomplete",H6={CELL_TYPE:P6,editor:L0,renderer:ha,validator:Dg},D6="checkbox",k6={CELL_TYPE:D6,editor:sA,renderer:$0},N6="date",L6={CELL_TYPE:N6,editor:lA,renderer:ha,validator:Y0},F6="dropdown",V6={CELL_TYPE:F6,editor:F0,renderer:ha,validator:Dg},$6="handsontable",B6={CELL_TYPE:$6,editor:N0,renderer:ha},W6="numeric",U6={CELL_TYPE:W6,editor:aA,renderer:W0,validator:j0,dataType:"number"},z6="password",Y6={CELL_TYPE:z6,editor:uA,renderer:U0,copyable:!1},j6="time",G6={CELL_TYPE:j6,editor:cA,renderer:z0,validator:G0};function K6(){Zr(H6),Zr(k6),Zr(L6),Zr(V6),Zr(B6),Zr(U6),Zr(Y6),Zr(jx),Zr(G6)}function X6(n,e){q6(n,e),e.add(n)}function q6(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Q6(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}const WT=new Map([["plugin",iY],["cell-type",Wx],["editor",ox],["renderer",dx],["validator",fx]]),Z6="base",qo=new WeakMap,pp=[];let jr=null;var UT=new WeakSet;class nt{static get PLUGIN_KEY(){return Z6}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){X6(this,UT),qs(this,"hot",e,{writable:!1}),qo.set(this,{hooks:{}}),jr=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",t=>this.onUpdateSettings(t)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,t=Array.isArray(e)?e:[];if(t.length>0){const s=[];if(t.forEach(o=>{const[i,l]=o.split(":");if(!WT.has(i))throw new Error(`Unknown plugin dependency type "${i}" was found.`);WT.get(i)(l)||s.push(` - ${l} (${i})`)}),s.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${s.join(`
`)}
`].join("");pp.push(o)}}if(jr||(jr=hx()),jr.indexOf("UndoRedo")>=0&&jr.splice(jr.indexOf("UndoRedo"),1),jr.indexOf(this.pluginName)>=0&&jr.splice(jr.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),jr.length===0){if(pp.length>0){const s=[`${pp.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(s)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}addHook(e,t){qo.get(this).hooks[e]=qo.get(this).hooks[e]||[];const r=qo.get(this).hooks[e];this.hot.addHook(e,t),r.push(t),qo.get(this).hooks[e]=r}removeHooks(e){P(qo.get(this).hooks[e]||[],t=>{this.hot.removeHook(e,t)})}clearHooks(){const e=qo.get(this).hooks;Be(e,(t,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){P(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const t=Q6(this,UT,J6).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}updatePlugin(){}destroy(){this.eventManager&&this.eventManager.destroy(),this.clearHooks(),Be(this,(e,t)=>{t!=="hot"&&(this[t]=null)}),delete this.t,delete this.hot}}function J6(n){if(!n)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let t=0;t<e.length;t++)if(n[e[t]]!==void 0)return!0;return!1}let fA=class{constructor(e){this.hot=e,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}addRow(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const t=this.hot.getColHeader(0);if(t!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),P(this.rows,t=>{e(t.row,_t(t.table)-1)})}getWidths(e){this.injected||this.injectTable(),P(this.columns,t=>{const{width:r}=t.table.getBoundingClientRect();e(t.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(){const e=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&e.appendChild(this.createColElement(-1)),this.samples.forEach(t=>{P(t.strings,r=>{e.appendChild(this.createColElement(r.col))})}),e}createRow(e){const{rootDocument:t}=this.hot,r=t.createDocumentFragment(),s=t.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,s),r.appendChild(s)),this.samples.forEach(o=>{P(o.strings,i=>{const l=i.col,a=this.hot.getCellMeta(e,l);a.col=l,a.row=e;const u=this.hot.getCellRenderer(a),c=t.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,l,this.hot.colToProp(l),i.value,a),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,t=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const s=e.createElement("th");r.push([-1,s]),t.appendChild(s)}this.samples.forEach(s=>{P(s.strings,o=>{const i=o.col,l=e.createElement("th");r.push([i,l]),t.appendChild(l)})}),this.table.tHead.appendChild(t),P(r,s=>{const[o,i]=s;this.hot.view.appendColHeader(o,i)})}createCol(e){const{rootDocument:t}=this.hot,r=t.createDocumentFragment();return this.samples.forEach(s=>{P(s.strings,o=>{const i=o.row,l=this.hot.getCellMeta(i,e);l.col=e,l.row=i;const a=this.hot.getCellRenderer(l),u=t.createElement("td"),c=t.createElement("tr");u.setAttribute("ghost-table",1),a(this.hot,u,i,e,this.hot.colToProp(e),o.value,l),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e){const t=this.hot.rootDocument.createElement("col");return t.style.width=`${this.hot.view._wt.wtTable.getStretchedColumnWidth(e)}px`,t}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,r=t.createDocumentFragment(),s=t.createElement("table"),o=t.createElement("thead"),i=t.createElement("tbody"),l=t.createElement("colgroup"),a=t.createElement("tr"),u=t.createElement("th");return this.isVertical()&&s.appendChild(l),this.isHorizontal()&&(a.appendChild(u),o.appendChild(a),s.style.tableLayout="auto",s.style.width="auto"),s.appendChild(o),this.isVertical()&&i.appendChild(a),s.appendChild(i),ee(s,e),r.appendChild(s),{fragment:r,table:s,tHead:o,tBody:i,colGroup:l,tr:a,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,r=t.createDocumentFragment(),s=t.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return ee(s,o),r.appendChild(s),{fragment:r,container:s}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};class kg{static get SAMPLE_COUNT(){return 3}constructor(e){this.samples=null,this.dataFactory=e,this.customSampleCount=null,this.allowDuplicates=!1}getSampleCount(){return this.customSampleCount?this.customSampleCount:kg.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,t){return this.generateSamples("row",t,e)}generateColumnSamples(e,t){return this.generateSamples("col",t,e)}generateSamples(e,t,r){const s=new Map,{from:o,to:i}=typeof r=="number"?{from:r,to:r}:r;return Ce(o,i,l=>{const a=this.generateSample(e,t,l);s.set(l,a)}),s}generateSample(e,t,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const s=new Map,o=e==="row"?"col":"row",i=[];return Ce(t.from,t.to,l=>{const{value:a,bundleSeed:u}=e==="row"?this.dataFactory(r,l):this.dataFactory(l,r),c=typeof u=="string"&&u.length>0;let d;c?d=u:$e(a)?d=`${Object.keys(a).length}`:Array.isArray(a)?d=`${a.length}`:d=`${Lt(a).length}`,s.has(d)||s.set(d,{needed:this.getSampleCount(),strings:[]});const f=s.get(d);f.needed&&(!(i.indexOf(a)>-1)||this.allowDuplicates||c)&&(f.strings.push({value:a,[o]:l}),i.push(a),f.needed-=1)}),s}}he.getSingleton().register("modifyAutoColumnSizeSeed");const Pa="autoColumnSize",eK=10,wp=new WeakMap,tK="autoColumnSize";class mu extends nt{static get PLUGIN_KEY(){return Pa}static get PLUGIN_PRIORITY(){return eK}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),wp.set(this,{cachedColumnHeaders:[]}),this.ghostTable=new fA(this.hot),this.samplesGenerator=new kg((t,r)=>{const s=this.hot.getCellMeta(t,r);let o="";s.spanned||(o=this.hot.getDataAtCell(t,r));let i="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(i=this.hot.runHooks("modifyAutoColumnSizeSeed",i,s,o)),{value:o,bundleSeed:i}}),this.firstCalculation=!0,this.inProgress=!1,this.measuredColumns=0,this.columnWidthsMap=new $o,this.hot.columnIndexMapper.registerMap(tK,this.columnWidthsMap),this.addHook("beforeColumnResize",(t,r,s)=>this.onBeforeColumnResize(t,r,s))}isEnabled(){return this.hot.getSettings()[Pa]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[Pa];t&&t.useHeaders!==null&&t.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",t.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("beforeChangeRender",r=>this.onBeforeChange(r)),this.addHook("afterFormulasValuesUpdate",r=>this.onAfterFormulasValuesUpdate(r)),this.addHook("beforeViewRender",r=>this.onBeforeViewRender(r)),this.addHook("modifyColWidth",(r,s)=>this.getColumnWidth(s,r)),this.addHook("afterInit",()=>this.onAfterInit()),super.enablePlugin()}updatePlugin(){const e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,t,r)=>this.onBeforeColumnResize(e,t,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const t=this.hot.renderCall,r=this.getFirstVisibleColumn(),s=this.getLastVisibleColumn();r===-1||s===-1||this.calculateColumnsWidth({from:r,to:s},void 0,t)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=typeof e=="number"?{from:e,to:e}:e,o=typeof t=="number"?{from:t,to:t}:t;Ce(s.from,s.to,i=>{let l=this.hot.toPhysicalColumn(i);if(l===null&&(l=i),r||this.columnWidthsMap.getValueAtIndex(l)===null&&!this.hot._getColWidthFromSettings(l)){const a=this.samplesGenerator.generateColumnSamples(i,o);P(a,u=>{let[c,d]=u;return this.ghostTable.addColumn(c,d)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((i,l)=>{const a=this.hot.toPhysicalColumn(i);this.columnWidthsMap.setValueAtIndex(a,l)})},!0),this.measuredColumns=s.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=0;const r=this.hot.countCols()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){rf(s),this.inProgress=!1;return}this.calculateColumnsWidth({from:t,to:Math.min(t+mu.CALCULATION_STEP,r)},e),t=t+mu.CALCULATION_STEP+1,t<r?s=Uv(o):(rf(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},i=this.getSyncCalculationLimit();this.firstCalculation&&i>=0&&(this.calculateColumnsWidth({from:0,to:i},e),this.firstCalculation=!1,t=i+1),t<r?o():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[Pa],t=e&&Ht(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Ht(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const e=this.hot.getSettings()[Pa];let t=mu.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return $e(e)&&(t=e.syncLimit,WI(t)?t=ax(r,t):t>>=0),Math.min(t,r)}getColumnWidth(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=t;return s===void 0&&(s=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof s=="number"&&(s=Math.max(s,wc.DEFAULT_WIDTH))),s}getFirstVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const t=e.wtTable.getFirstVisibleColumn();if(t!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){const t=e.wtTable.getFirstRenderedColumn();if(t!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}return-1}getLastVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const t=e.wtTable.getLastVisibleColumn();if(t!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){const t=e.wtTable.getLastRenderedColumn();if(t!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}return-1}findColumnsWhereHeaderWasChanged(){const e=this.hot.getColHeader(),{cachedColumnHeaders:t}=wp.get(this);return Sn(e,(s,o,i)=>{const l=t.length;return(l-1<i||t[i]!==o)&&s.push(i),l-1<i?t.push(o):t[i]=o,s},[])}clearCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];e.length?this.hot.batchExecution(()=>{P(e,t=>{this.columnWidthsMap.setValueAtIndex(t,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!yr(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),e=>e===null).length}onBeforeViewRender(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}onAfterLoadData(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}onBeforeChange(e){const t=Ve(e,r=>{let[,s]=r;return this.hot.toPhysicalColumn(this.hot.propToCol(s))});this.clearCache(Array.from(new Set(t)))}onBeforeColumnResize(e,t,r){let s=e;return r&&(this.calculateColumnsWidth(t,void 0,!0),s=this.getColumnWidth(t,void 0,!1)),s}onAfterInit(){wp.get(this).cachedColumnHeaders=this.hot.getColHeader()}onAfterFormulasValuesUpdate(e){const t=yr(e,s=>{var o;return ue((o=s.address)===null||o===void 0?void 0:o.col)}),r=Ve(t,s=>s.address.col);this.clearCache(Array.from(new Set(r)))}destroy(){this.ghostTable.clean(),super.destroy()}}const di={horizontal:"horizontal",vertical:"vertical"};function nK(n,e,t){let r,s,o;return e[0]===n[0]&&e[1]<n[1]?(o="left",r=t(e[0],e[1]),s=t(e[2],n[1]-1)):e[2]===n[2]&&e[0]===n[0]&&e[3]>n[3]?(o="right",r=t(e[0],n[3]+1),s=t(e[2],e[3])):e[0]<n[0]&&e[1]===n[1]?(o="up",r=t(e[0],e[1]),s=t(n[0]-1,e[3])):e[2]>n[2]&&e[1]===n[1]&&(o="down",r=t(n[2]+1,e[1]),s=t(e[2],e[3])),r&&r.normalize(),s&&s.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:s}}function rK(n){const e={};return n===!0?(e.directions=Object.keys(di),e.autoInsertRow=!0):$e(n)?(ue(n.autoInsertRow)?n.direction===di.horizontal?e.autoInsertRow=!1:e.autoInsertRow=n.autoInsertRow:e.autoInsertRow=!1,ue(n.direction)?e.directions=[n.direction]:e.directions=Object.keys(di)):typeof n=="string"?(e.directions=[n],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}he.getSingleton().register("modifyAutofillRange");he.getSingleton().register("beforeAutofill");he.getSingleton().register("afterAutofill");const zT="autofill",sK=20,oK=["fillHandle"],iK="insert_row_below",lK=200;class aK extends nt{static get PLUGIN_KEY(){return zT}static get PLUGIN_PRIORITY(){return sK}static get SETTING_KEYS(){return[zT,...oK]}constructor(e){super(e),this.eventManager=new It(this),this.addingStarted=!1,this.mouseDownOnCellCorner=!1,this.mouseDragOutside=!1,this.handleDraggedCells=0,this.directions=[],this.autoInsertRow=!1}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>this.onAfterCellCornerMouseDown(e)),this.addHook("afterOnCellCornerDblClick",e=>this.onCellCornerDblClick(e)),this.addHook("beforeOnCellMouseOver",(e,t)=>this.onBeforeCellMouseOver(t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:t,col:r}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),i=this.hot.runHooks("modifyCopyableRange",[{startRow:t,startCol:r,endRow:s,endCol:o}]),l=[],a=[],u=[];return P(i,c=>{for(let d=c.startRow;d<=c.endRow;d+=1)l.indexOf(d)===-1&&l.push(d);for(let d=c.startCol;d<=c.endCol;d+=1)a.indexOf(d)===-1&&a.push(d)}),P(l,c=>{const d=[];P(a,f=>{d.push(this.hot.getCopyableData(c,f))}),u.push(d)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,t,r,s]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),i=o.getTopStartCorner(),l=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const a=[i.row,i.col,l.row,l.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(i.row,e),Math.min(i.col,t),Math.max(l.row,r),Math.max(l.col,s)],a),{directionOfDrag:c,startOfDragCoords:d,endOfDragCoords:f}=nK(a,u,(m,p)=>this.hot._createCellCoords(m,p));if(d&&d.row>-1&&d.col>-1){const m=this.getSelectionData(),p=o.clone(),w=this.hot._createCellRange(d,d,f),M=this.hot.runHooks("beforeAutofill",m,p,w,c);if(M===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let S=M;const y=M;if(["up","left"].indexOf(c)>-1&&!(y.length===1&&y[0].length===0))if(S=[],c==="up"){const v=f.row-d.row+1,R=v%y.length;for(let I=0;I<v;I++)S.push(y[(I+(y.length-R))%y.length])}else{const v=f.col-d.col+1,R=v%y[0].length;for(let I=0;I<y.length;I++){S.push([]);for(let F=0;F<v;F++)S[I].push(y[I][(F+(y[I].length-R))%y[I].length])}}this.hot.populateFromArray(d.row,d.col,S,f.row,f.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",S,p,w,c),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const t=this.hot.getSelectedRangeLast(),r=t.getBottomEndCorner();let s=e;if(this.directions.includes(di.vertical)&&this.directions.includes(di.horizontal)){const o=t.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(s=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(s=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(di.vertical))s=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(di.horizontal))s=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(s)}showBorder(e){const t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(iK,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},lK)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&t[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const t=this.hot.getData(),r=this.hot.countRows();let s;for(let o=e[2]+1;o<r;o++){for(let a=e[1];a<=e[3];a++)if(t[o][a])return-1;const i=t[o][e[1]-1],l=t[o][e[3]+1];(i||l)&&(s=o)}return s}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ve(e,t=>Math.max(t,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return t===-1||t===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:t}=this.hot.rootDocument,r=Wt(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+_t(this.hot.table),s=Wt(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+st(this.hot.table);return e.clientY>r&&e.clientX<=s}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(e,"mousemove",t=>this.onMouseMove(t))}onCellCornerDblClick(){this.selectAdjacent()&&this.fillIn()}onAfterCellCornerMouseDown(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}onBeforeCellMouseOver(e){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(e),this.addNewRowIfNeeded())}onMouseUp(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}onMouseMove(e){const t=this.getIfMouseWasDraggedOutside(e);this.addingStarted===!1&&this.handleDraggedCells>0&&t?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=rK(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}const wh="autoRowSize",uK=40,cK="autoRowSize";class pu extends nt{static get PLUGIN_KEY(){return wh}static get PLUGIN_PRIORITY(){return uK}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),this.rowHeightsMap=void 0,this.headerHeight=null,this.ghostTable=new fA(this.hot),this.samplesGenerator=new kg((t,r)=>{let s;return t>=0?s=this.hot.getDataAtCell(t,r):t===-1&&(s=this.hot.getColHeader(r)),{value:s}}),this.firstCalculation=!0,this.inProgress=!1,this.measuredRows=0,this.rowHeightsMap=new $o,this.hot.rowIndexMapper.registerMap(cK,this.rowHeightsMap),this.addHook("beforeRowResize",(t,r,s)=>this.onBeforeRowResize(t,r,s))}isEnabled(){const e=this.hot.getSettings()[wh];return e===!0||$e(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("beforeChangeRender",t=>this.onBeforeChange(t)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",t=>this.onBeforeViewRender(t)),this.addHook("modifyRowHeight",(t,r)=>this.getRowHeight(r,t)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,t,r)=>this.onBeforeRowResize(e,t,r))}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=typeof e=="number"?{from:e,to:e}:e,o=typeof t=="number"?{from:t,to:t}:t;if(this.hot.getColHeader(0)!==null){const i=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(i.get(-1))}Ce(s.from,s.to,i=>{if(r||this.rowHeightsMap.getValueAtIndex(i)===null){const l=this.samplesGenerator.generateRowSamples(i,o);P(l,a=>{let[u,c]=a;return this.ghostTable.addRow(u,c)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((i,l)=>{i<0?this.headerHeight=l:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(i),l)})},!0),this.measuredRows=s.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=0;const r=this.hot.countRows()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){rf(s),this.inProgress=!1;return}this.calculateRowsHeight({from:t,to:Math.min(t+pu.CALCULATION_STEP,r)},e),t=t+pu.CALCULATION_STEP+1,t<r?s=Uv(o):(rf(s),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},i=this.getSyncCalculationLimit();this.firstCalculation&&i>=0&&(this.calculateRowsHeight({from:0,to:i},e),this.firstCalculation=!1,t=i+1),t<r?o():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const e=this.hot.getSettings()[wh],t=e&&Ht(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Ht(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllRowsHeight(){Uu(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const e=this.hot.getSettings()[wh];let t=pu.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return $e(e)&&(t=e.syncLimit,WI(t)?t=ax(r,t):t>>=0),Math.min(t,r)}getRowHeight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let s=t;return r!==null&&r>(t||0)&&(s=r),s}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){const{from:t,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{Ce(Math.min(t,r),Math.max(t,r),s=>{this.rowHeightsMap.setValueAtIndex(s,null)})},!0)}isNeedRecalculate(){return!!yr(this.rowHeightsMap.getValues().slice(0,this.measuredRows),e=>e===null).length}onBeforeViewRender(){const e=this.hot.renderCall,t=this.hot.getSettings().fixedRowsBottom,r=this.getFirstVisibleRow(),s=this.getLastVisibleRow();if(!(r===-1||s===-1)){if(this.calculateRowsHeight({from:r,to:s},void 0,e),t){const o=this.hot.countRows()-1;this.calculateRowsHeight({from:o-t,to:o})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}onBeforeRowMove(e,t){this.clearCacheByRange({from:e,to:t}),this.calculateAllRowsHeight()}onBeforeRowResize(e,t,r){let s=e;return r&&(this.calculateRowsHeight(t,void 0,!0),s=this.getRowHeight(t)),s}onAfterLoadData(){this.hot.view?this.recalculateAllRowsHeight():setTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()},0)}onBeforeChange(e){let t=null;e.length===1?t=e[0][0]:e.length>1&&(t={from:e[0][0],to:e[e.length-1][0]}),t!==null&&this.clearCacheByRange(t)}destroy(){this.ghostTable.clean(),super.destroy()}}const{getListWithInsertedItems:hK,getListWithRemovedItems:dK}=Mx("physicallyIndexed");class fK extends Fi{constructor(){super(e=>e)}insert(e,t){const r=iS(this.indexedValues,t);this.indexedValues=hK(r,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){const t=dK(this.indexedValues,e);this.indexedValues=oS(t,e),super.remove(e)}}const{getListWithInsertedItems:gK,getListWithRemovedItems:mK}=Mx("physicallyIndexed");class pK extends Fi{constructor(){super(e=>e)}insert(e,t){this.indexedValues=gK(this.indexedValues,e,t,(r,s)=>this.getNextValue(s)),super.insert(e,t)}remove(e){this.indexedValues=mK(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}const Cp="bindRowsWithHeaders",wK=210,CK="loose",yK=new Map([["loose",fK],["strict",pK]]);class vK extends nt{static get PLUGIN_KEY(){return Cp}static get PLUGIN_PRIORITY(){return wK}constructor(e){super(e),this.headerIndexes=null}isEnabled(){return!!this.hot.getSettings()[Cp]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[Cp];typeof e!="string"&&(e=CK);const t=yK.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",r=>this.onModifyRowHeader(r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}onModifyRowHeader(e){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(e))}destroy(){super.destroy()}}function SK(n,e,t){RK(n,e),e.set(n,t)}function RK(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yp(n,e,t){return e=bK(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function bK(n){var e=EK(n,"string");return typeof e=="symbol"?e:String(e)}function EK(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function YT(n,e){var t=gA(n,e,"get");return TK(n,t)}function TK(n,e){return e.get?e.get.call(n):e.value}function vp(n,e,t){var r=gA(n,e,"set");return MK(n,r,t),t}function gA(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function MK(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}const Sp="collapsibleColumns",_K=290,OK=["nestedHeaders"],qi="collapsibleIndicator",jT=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Qi=new WeakMap;class IK extends nt{constructor(){super(...arguments),yp(this,"nestedHeadersPlugin",null),yp(this,"eventManager",new It(this)),yp(this,"headerStateManager",null),SK(this,Qi,{writable:!0,value:null})}static get PLUGIN_KEY(){return Sp}static get PLUGIN_PRIORITY(){return _K}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Sp,...OK]}isEnabled(){return!!this.hot.getSettings()[Sp]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();t||ct("You need to configure the Nested Headers plugin in order to use collapsible headers."),vp(this,Qi,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>this.onInit()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("afterGetColHeader",function(){return e.onAfterGetColHeader(...arguments)}),this.addHook("beforeOnCellMouseDown",(r,s,o)=>this.onBeforeOnCellMouseDown(r,s,o)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(t=>({collapsible:t.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),vp(this,Qi,null),this.nestedHeadersPlugin=null,this.clearButtons(),super.disablePlugin()}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,s=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(i){i&&i.parentNode.removeChild(i)};Ce(0,e-1,i=>{const l=t.childNodes[i],a=r.childNodes[i],u=s?s.childNodes[i]:null;Ce(0,l.childNodes.length-1,c=>{let d=l.childNodes[c].querySelector(`.${qi}`);o(d),a&&a.childNodes[c]&&(d=a.childNodes[c].querySelector(`.${qi}`),o(d)),s&&u&&u.childNodes[c]&&(d=u.childNodes[c].querySelector(`.${qi}`),o(d))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const t=this.headerStateManager.mapNodes(r=>{const{collapsible:s,origColspan:o,headerLevel:i,columnIndex:l,isCollapsed:a}=r;if(s===!0&&o>1&&(a&&e==="expand"||!a&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(i),col:l}});this.toggleCollapsibleSection(t,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,t){if(!jT.has(t))throw new Error(`Unsupported action is passed (${t}).`);if(!Array.isArray(e))return;const r=yr(e,f=>{let{row:m}=f;return m<0});let s=r.length>0;P(r,f=>{var m;let{row:p,col:w}=f;const{collapsible:M,isCollapsed:S}=(m=this.headerStateManager.getHeaderSettings(p,w))!==null&&m!==void 0?m:{};if(!M||S&&t==="collapse"||!S&&t==="expand")return s=!1,!1});const o=[],i=[];s&&P(r,f=>{let{row:m,col:p}=f;const{colspanCompensation:w,affectedColumns:M,rollbackModification:S}=this.headerStateManager.triggerNodeModification(t,m,p);w>0&&(i.push(...M),o.push(S))});const l=this.getCollapsedColumns();let a=[];t==="collapse"?a=$I([...l,...i]):t==="expand"&&(a=yr(l,f=>!i.includes(f)));const u=jT.get(t);if(this.hot.runHooks(u.beforeHook,l,a,s)===!1){P(o,f=>{f()});return}this.hot.batchExecution(()=>{P(i,f=>{YT(this,Qi).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const d=this.getCollapsedColumns().length!==l.length;this.hot.runHooks(u.afterHook,l,a,s,d),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return YT(this,Qi).getHiddenIndexes()}onAfterGetColHeader(e,t,r){var s;const{collapsible:o,origColspan:i,isCollapsed:l}=(s=this.headerStateManager.getHeaderSettings(r,e))!==null&&s!==void 0?s:{},a=o&&i>1&&e>=this.hot.getSettings().fixedColumnsStart;let u=t.querySelector(`.${qi}`);if(a)u||(u=this.hot.rootDocument.createElement("div"),ee(u,qi),t.querySelector("div:first-child").appendChild(u)),He(u,["collapsed","expanded"]),l?(ee(u,"collapsed"),Ti(u,"+")):(ee(u,"expanded"),Ti(u,"-"));else{var c;(c=u)===null||c===void 0||c.remove()}}onBeforeOnCellMouseDown(e,t){Oe(e.target,qi)&&(Oe(e.target,"expanded")?(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"collapse")):Oe(e.target,"collapsed")&&(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"expand")),ds(e))}onInit(){this.updatePlugin()}onAfterLoadData(e,t){t||this.updatePlugin()}destroy(){vp(this,Qi,null),super.destroy()}}const xK=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],AK=!1,PK=!0,HK=!0;class DK{constructor(e,t){this.hot=e,this.sortingStates=new pg,this.sortEmptyCells=AK,this.indicator=PK,this.headerAction=HK,this.compareFunctionFactory=void 0,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){$e(e)&&Be(e,(t,r)=>{xK.includes(r)&&(this[r]=t)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var t;return(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||t===void 0?void 0:t.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(t=>{let[r]=t;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return $e(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(t=>{let[r,s]=t;return{column:this.hot.toVisualColumn(r),...s}})}getColumnSortState(e){const t=this.getSortOrderOfColumn(e);if(ue(t))return{column:e,sortOrder:t}}setSortStates(e){this.sortingStates.clear();for(let t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const cf="asc",hf="desc",kK="colHeader";function NK(n){if($e(n)===!1)return!1;const{column:e,sortOrder:t}=n;return Number.isInteger(e)&&[cf,hf].includes(t)}function LK(n){if(n.some(t=>NK(t)===!1))return!1;const e=n.map(t=>{let{column:r}=t;return r});return new Set(e).size===e.length}function GT(n){if(n!==hf)return n===cf?hf:cf}function KT(n){return n.querySelector(`.${kK}`)}function XT(n,e){if(n<0||!e.parentNode)return!1;const t=e.parentNode.parentNode.childNodes;return Array.from(t).indexOf(e.parentNode)-t.length===-1}function jC(n,e,t){return n===-1&&e>=0&&_i(t)===!1}const FK="ascending",VK="descending",mA="indicatorDisabled",pA="columnSorting",wA="sortAction",CA=new Map([[cf,FK],[hf,VK]]);function $K(n,e,t,r){const s=[pA];if(r&&s.push(wA),t===!1)return s.push(mA),s;const o=n.getSortOrderOfColumn(e);return ue(o)&&s.push(CA.get(o)),s}function BK(){return Array.from(CA.values()).concat(wA,mA,pA)}function yA(n,e,t){const r=e.locale;return function(s,o){const{sortEmptyCells:i}=t;return typeof s=="string"&&(s=s.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),s===o?us:Xt(s)?Xt(o)?us:i&&n==="asc"?Et:Tt:Xt(o)?i&&n==="asc"?Tt:Et:isNaN(s)&&!isNaN(o)?n==="asc"?Tt:Et:!isNaN(s)&&isNaN(o)||(isNaN(s)||isNaN(o)||(s=parseFloat(s),o=parseFloat(o)),s<o)?n==="asc"?Et:Tt:s>o?n==="asc"?Tt:Et:us}}const vA="default";function WK(n,e,t){return function(r,s){const o=parseFloat(r),i=parseFloat(s),{sortEmptyCells:l}=t;if(o===i||isNaN(o)&&isNaN(i))return us;if(l){if(Xt(r))return n==="asc"?Et:Tt;if(Xt(s))return n==="asc"?Tt:Et}return isNaN(o)?Tt:isNaN(i)?Et:o<i?n==="asc"?Et:Tt:o>i?n==="asc"?Tt:Et:us}}const UK="numeric";function zK(n,e,t){const r=e.checkedTemplate,s=e.uncheckedTemplate,{sortEmptyCells:o}=t;return function(i,l){const a=Xt(i),u=Xt(l),c=a?s:i,d=u?s:l,f=c===s||c===r,m=d===s||d===r;if(o===!1){if(a&&u===!1)return Tt;if(a===!1&&u)return Et}return f===!1&&m?n==="asc"?Et:Tt:f&&m===!1?n==="asc"?Tt:Et:f===!1&&m===!1?yA(n,e,t)(i,l):c===s&&d===r?n==="asc"?Et:Tt:c===r&&d===s?n==="asc"?Tt:Et:us}}const YK="checkbox";function jK(n,e,t){return function(r,s){const{sortEmptyCells:o}=t;if(r===s)return us;if(Xt(r))return Xt(s)?us:o&&n==="asc"?Et:Tt;if(Xt(s))return o&&n==="asc"?Tt:Et;const i=e.dateFormat,l=J(r,i),a=J(s,i);return l.isValid()?a.isValid()?a.isAfter(l)?n==="asc"?Et:Tt:a.isBefore(l)?n==="asc"?Tt:Et:us:Et:Tt}}const GK="date",{register:Ng,getItem:qT,hasItem:KK}=br("sorting.compareFunctionFactory"),{register:SA,getItem:XK}=br("sorting.mainSortComparator");function RA(n){return KK(n)?qT(n):qT(vA)}Ng(UK,WK);Ng(YK,zK);Ng(GK,jK);Ng(vA,yA);const us=0,Et=-1,Tt=1;function qK(n,e){const t=XK(e);for(var r=arguments.length,s=new Array(r>2?r-2:0),o=2;o<r;o++)s[o-2]=arguments[o];n.sort(t(...s))}function QK(n,e){return function(t,r){const[,...s]=t,[,...o]=r;return function(l){const a=n[l],u=e[l],c=s[l],d=o[l],f=u.columnSorting;return(f.compareFunctionFactory?f.compareFunctionFactory:RA(u.type))(a,u,f)(c,d)}(0)}}const GC="columnSorting",ZK=50,QT="append",JK="replace";SA(GC,QK);he.getSingleton().register("beforeColumnSort");he.getSingleton().register("afterColumnSort");class bA extends nt{static get PLUGIN_KEY(){return GC}static get PLUGIN_PRIORITY(){return ZK}constructor(e){super(e),this.columnStatesManager=null,this.columnMetaCache=null,this.pluginKey=GC,this.indexesSequenceCache=null}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new DK(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new $o(t=>{let r=this.hot.toVisualColumn(t);return r===null&&(r=t),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(t,r)=>this.onAfterGetColHeader(t,r)),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("afterOnCellMouseDown",(t,r)=>this.onAfterOnCellMouseDown(t,r)),this.addHook("afterInit",()=>this.loadOrSortBySettings()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.hot.view&&this.loadOrSortBySettings(),super.enablePlugin())}disablePlugin(){const e=(t,r)=>{const s=KT(r);XT(t,r)===!1||s===null||this.updateHeaderClasses(s)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,super.disablePlugin()}sort(e){const t=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),s=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",t,r,s)!==!1&&(t.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new _x),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),s&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",t,s?r:t,s),s&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return ue(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const t=this.hot.countCols();return LK(e)&&e.every(r=>{let{column:s}=r;return s<=t&&s>=0})}saveAllSortSettings(e){const t=this.columnStatesManager.getAllColumnsProperties(),r=s=>{let{column:o,...i}=s;return{column:this.hot.toPhysicalColumn(o),...i}};t.initialConfig=Ve(e,r),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const t=e.value,r=s=>{let{column:o,...i}=s;return{column:this.hot.toVisualColumn(o),...i}};return ue(t)&&Array.isArray(t.initialConfig)&&(t.initialConfig=Ve(t.initialConfig,r)),t}getColumnNextConfig(e){const t=this.columnStatesManager.getSortOrderOfColumn(e);if(ue(t)){const s=GT(t);return ue(s)?{column:e,sortOrder:s}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:GT()}}getNextSortConfig(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:QT;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),s=r!==-1,o=this.getSortConfig(),i=this.getColumnNextConfig(e);if(s){if(dt(i))return[...o.slice(0,r),...o.slice(r+1)];if(t===QT)return[...o.slice(0,r),...o.slice(r+1),i];if(t===JK)return[...o.slice(0,r),i,...o.slice(r+1)]}return ue(i)?o.concat(i):o}getPluginColumnConfig(e){if($e(e)){const t=e[this.pluginKey];if($e(t))return t}return{}}getMergedPluginSettings(e){const t=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),s=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(s);return Array.isArray(o.columns)?Object.assign(r,t,this.getPluginColumnConfig(o.columns[e])):ut(o.columns)?Object.assign(r,t,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,t)}getFirstCellSettings(e){const t=this.hot.getCellMeta(0,e),r=Object.create(t);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(e.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}const t=[],r=this.hot.countRows(),s=u=>Ve(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)t.push([this.hot.toPhysicalRow(u)].concat(s(u)));const o=Ve(t,u=>u[0]);qK(t,this.pluginKey,Ve(e,u=>u.sortOrder),Ve(e,u=>this.getFirstCellSettings(u.column)));for(let u=t.length;u<r;u+=1)t.push([u].concat(s(u)));const i=Ve(t,u=>u[0]),l=new Map(Ve(o,(u,c)=>[u,i[c]])),a=Ve(this.hot.rowIndexMapper.getIndexesSequence(),u=>l.has(u)?l.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(a)}loadOrSortBySettings(){const e=this.getAllSavedSortSettings();if($e(e))this.sortBySettings(e);else{const t=this.hot.getSettings()[this.pluginKey];this.sortBySettings(t)}}sortBySettings(e){if($e(e)){this.columnStatesManager.updateAllColumnsProperties(e);const t=e.initialConfig;(Array.isArray(t)||$e(t))&&this.sort(t)}else this.hot.render()}onAfterGetColHeader(e,t){const r=KT(t);if(XT(e,t)===!1||r===null)return;const s=this.getFirstCellSettings(e)[this.pluginKey],o=s.indicator,i=s.headerAction;this.updateHeaderClasses(r,this.columnStatesManager,e,o,i)}updateHeaderClasses(e){if(He(e,BK()),this.enabled!==!1){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];ee(e,$K(...r))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ue(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}onAfterLoadData(e){e===!0&&this.hot.view&&this.loadOrSortBySettings()}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&e.target.nodeName==="SPAN"}onBeforeOnCellMouseDown(e,t,r,s){jC(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(s.column=!0)}onAfterOnCellMouseDown(e,t){jC(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col)),this.sort(this.getColumnNextConfig(t.col)))}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}class e8{constructor(e,t){this.plugin=e,this.hot=this.plugin.hot,this.endpoints=[],this.settings=t,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const t=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),P(r,s=>{const o={};this.assignSetting(s,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(s,o,"reversedRowCoords",!1),this.assignSetting(s,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(s,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(s,o,"sourceColumn",s.destinationColumn),this.assignSetting(s,o,"type","sum"),this.assignSetting(s,o,"forceNumeric",!1),this.assignSetting(s,o,"suppressDataTypeErrors",!0),this.assignSetting(s,o,"suppressDataTypeErrors",!0),this.assignSetting(s,o,"customFunction",null),this.assignSetting(s,o,"readOnly",!0),this.assignSetting(s,o,"roundFloat",!1),t.push(o)}),t}assignSetting(e,t,r,s){if(r==="ranges"&&e[r]===void 0){t[r]=s;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(s instanceof Error)throw s;t[r]=s}else r==="destinationRow"&&t.reversedRowCoords?t[r]=this.hot.countRows()-e[r]-1:t[r]=e[r]}resetSetupBeforeStructureAlteration(e,t,r){if(this.settingsType!=="function")return;const s=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();P(o,i=>{s==="row"&&i.destinationRow>=t&&(e==="insert_row"?i.alterRowOffset=r:e==="remove_row"&&(i.alterRowOffset=-1*r)),s==="col"&&i.destinationColumn>=t&&(e==="insert_col"?i.alterColumnOffset=r:e==="remove_col"&&(i.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,t,r,s,o){let i=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const f=()=>(this.hot.removeHook("beforeViewRender",f),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",f);return}const l=e.indexOf("row")>-1?"row":"col",a=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,d=t;P(u,f=>{l==="row"&&f.destinationRow>=d&&(f.alterRowOffset=a*r),l==="col"&&f.destinationColumn>=d&&(f.alterColumnOffset=a*r)}),this.resetAllEndpoints(u,!c),c?P(u,f=>{this.extendEndpointRanges(f,d,s[0],s.length),this.recreatePhysicalRanges(f),this.clearOffsetInformation(f)}):P(u,f=>{this.shiftEndpointCoordinates(f,d)}),i&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,r,s){P(e.ranges,o=>{o[1]&&(t>=o[0]&&t<=o[1]?r>o[1]?o[1]+=s:r<o[0]&&(o[0]-=s):r>=o[0]&&r<=o[1]&&(o[1]-=s,t<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const t=e.ranges,r=[],s=[];P(t,o=>{const i=[];if(o[1])for(let l=o[0];l<=o[1];l++)i.push(this.hot.toPhysicalRow(l));else i.push(this.hot.toPhysicalRow(o[0]));s.push(i)}),P(s,o=>{let i=[];P(o,(l,a)=>{a===0?i.push(l):o[a]!==o[a-1]+1&&(i.push(o[a-1]),r.push(i),i=[],i.push(l)),a===o.length-1&&(i.push(l),r.push(i))})}),e.ranges=r}shiftEndpointCoordinates(e,t){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,P(e.ranges,r=>{P(r,(s,o)=>{s>=t&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(s=>{const o=s.alterRowOffset||0,i=s.alterColumnOffset||0;return s.destinationRow+o>=this.hot.countRows()||s.destinationColumn+i>=this.hot.countCols()})||(this.cellsToSetCache=[],P(e,s=>{this.resetEndpointValue(s,t)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],P(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const t=[];this.cellsToSetCache=[],P(e,(r,s,o)=>{`${r[2]||""}`!=`${r[3]}`&&P(this.getAllEndpoints(),(i,l)=>{this.hot.propToCol(o[s][1])===i.sourceColumn&&t.indexOf(l)===-1&&t.push(l)})}),P(t,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,s=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?r:0)),this.hot.toVisualColumn(e.destinationColumn+(t?s:0)),""])}setEndpointValue(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const i=this.hot.getCellMeta(o,e.destinationColumn);(t==="init"||i.readOnly!==e.readOnly)&&(i.readOnly=e.readOnly,i.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),r?this.hot.setDataAtCell(s,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([s,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){ct("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function Rp(n){return n==null||isNaN(n)}const bp="columnSummary",t8=220;class n8 extends nt{static get PLUGIN_KEY(){return bp}static get PLUGIN_PRIORITY(){return t8}constructor(e){super(e),this.endpoints=null}isEnabled(){return!!this.hot.getSettings()[bp]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[bp],this.endpoints=new e8(this,this.settings),this.addHook("afterInit",function(){return e.onAfterInit(...arguments)}),this.addHook("afterChange",function(){return e.onAfterChange(...arguments)}),this.addHook("beforeCreateRow",(t,r,s)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,r,null,s)),this.addHook("beforeCreateCol",(t,r,s)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,r,null,s)),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(t,r,s)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,r,null,s)),this.addHook("afterCreateCol",(t,r,s)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,r,null,s)),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){return e.onAfterRowMove(...arguments)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let t=0;return Be(e.ranges,r=>{t+=this.getPartialSum(r,e.sourceColumn)}),t}getPartialSum(e,t){let r=0,s=e[1]||e[0],o=null,i=0;do{if(o=this.getCellValue(s,t),o=Rp(o)?null:o,o!==null){const l=(`${o}`.split(".")[1]||[]).length||1;l>i&&(i=l)}r+=o||0,s-=1}while(s>=e[0]);return Math.round(r*10**i)/10**i}calculateMinMax(e,t){let r=null;return Be(e.ranges,s=>{const o=this.getPartialMinMax(s,e.sourceColumn,t);if(r===null&&o!==null&&(r=o),o!==null)switch(t){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,t,r){let s=null,o=e[1]||e[0],i;do{if(i=this.getCellValue(o,t),i=Rp(i)?null:i,s===null)s=i;else if(i!==null)switch(r){case"min":s=Math.min(s,i);break;case"max":s=Math.max(s,i);break}o-=1}while(o>=e[0]);return s}countEmpty(e,t){let r,s=0,o=e[1]||e[0];do r=this.getCellValue(o,t),r=Rp(r)?null:r,r===null&&(s+=1),o-=1;while(o>=e[0]);return s}countEntries(e){let t=0;const r=e.ranges;return Be(r,s=>{const o=s[1]===void 0?1:s[1]-s[0]+1,i=this.countEmpty(s,e.sourceColumn);t+=o,t-=i}),t}calculateAverage(e){const t=this.calculateSum(e),r=this.countEntries(e);return t/r}getCellValue(e,t){const r=this.hot.toVisualRow(e),s=this.hot.toVisualColumn(t);let o=this.hot.getSourceDataAtCell(e,t),i="";if(r!==null&&s!==null&&(i=this.hot.getCellMeta(r,s).className||""),i.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ot`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}onAfterInit(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}onAfterChange(e,t){e&&t!=="ColumnSummary.reset"&&t!=="ColumnSummary.set"&&t!=="loadData"&&this.endpoints.refreshChangedEndpoints(e)}onAfterRowMove(e,t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",t,e.length,e,this.pluginName)}}class Ol{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,t){this.rootDocument=e,this.isRtl=t,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}setPosition(e,t){this.editorStyle.left=`${e}px`,this.editorStyle.top=`${t}px`}setSize(e,t){if(e&&t){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${t}px`}}getSize(){return{width:st(this.getInputElement()),height:_t(this.getInputElement())}}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const t=this.getInputElement();t.readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return this.editorStyle.display==="block"}setValue(){const t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=t}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=this.rootDocument.createElement("div"),t=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),ee(this.container,Ol.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),ee(e,Ol.CLASS_EDITOR),ee(t,Ol.CLASS_INPUT),e.appendChild(t),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector(`.${Ol.CLASS_INPUT}`)}destroy(){const e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}const Fe="---------";function r8(){return{name:Fe}}function s8(n){return Ve(n,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function Ch(n){return Oe(n,"htSeparator")}function o8(n){return Oe(n,"htSubmenu")}function yh(n){return Oe(n,"htDisabled")}function vh(n){return Oe(n,"htSelectionDisabled")}function $i(n){const e=n.getSelected();return!e||e[0]<0?null:e}function i8(n,e){return n.indexOf(e)!==-1?n:`${n.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function l8(n,e){return n.indexOf(e)!==-1?n:`${n.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Qo(n,e){const t={};return P(n,r=>{r.forAll((s,o)=>{s>=0&&o>=0&&(t[s]||(t[s]=[]),t[s][o]=e(s,o))})}),t}function lo(n,e,t,r,s){P(n,o=>{o.forAll((i,l)=>{i>=0&&l>=0&&a8(i,l,e,t,r,s)})})}function a8(n,e,t,r,s,o){const i=s(n,e);let l=r;i.className&&(t==="vertical"?l=i8(i.className,r):l=l8(i.className,r)),o(n,e,"className",l)}function ts(n,e){let t=!1;return Array.isArray(n)&&P(n,r=>(r.forAll((s,o)=>{if(s>=0&&o>=0&&e(s,o))return t=!0,!1}),t)),t}function Is(n){return`<span class="selected">✓</span>${n}`}function u8(n,e){return!n.hidden||!(typeof n.hidden=="function"&&n.hidden.call(e))}function EA(n,e){const t=n.slice(0);for(let r=0;r<t.length&&t[r].name===e;)t.shift();return t}function c8(n,e){let t=n.slice(0);return t.reverse(),t=EA(t,e),t.reverse(),t}function h8(n){const e=[];return P(n,(t,r)=>{r>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)}),e}function d8(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Fe,t=n.slice(0);return t=EA(t,e),t=c8(t,e),t=h8(t),t}const f8=250,g8=250;class TA{constructor(e){this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},g8)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:f8;this.showDebounced=KI(t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)},e)}destroy(){this.clearLocalHooks()}}at(TA,An);const Ep="comments",m8=60,Sh=new WeakMap,Gr="comment",Zi="value",ZT="style",Rh="readOnly";class p8 extends nt{static get PLUGIN_KEY(){return Ep}static get PLUGIN_PRIORITY(){return m8}constructor(e){super(e),this.editor=null,this.displaySwitch=null,this.eventManager=null,this.range={},this.preventEditorAutoSwitch=!1,Sh.set(this,{tempEditorDimensions:{},cellBelowCursor:null})}isEnabled(){return!!this.hot.getSettings()[Ep]}enablePlugin(){this.enabled||(this.editor||(this.editor=new Ol(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new It(this)),this.displaySwitch||(this.displaySwitch=new TA(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,t,r,s,o,i)=>this.onAfterRenderer(e,i)),this.addHook("afterScrollHorizontally",()=>this.hide()),this.addHook("afterScrollVertically",()=>this.hide()),this.addHook("afterBeginEditing",()=>this.hide()),this.displaySwitch.addLocalHook("hide",()=>this.hide()),this.displaySwitch.addLocalHook("show",(e,t)=>this.showAtCell(e,t)),this.registerListeners(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin(),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}disablePlugin(){super.disablePlugin()}registerListeners(){const{rootDocument:e}=this.hot;this.eventManager.addEventListener(e,"mouseover",t=>this.onMouseOver(t)),this.eventManager.addEventListener(e,"mousedown",t=>this.onMouseDown(t)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",()=>this.onEditorBlur()),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",t=>this.onEditorMouseDown(t)),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",t=>this.onEditorMouseUp(t))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const t=Ci(e.target,"TD","TBODY");return!!(t&&Oe(t,"htCommentCell")&&Ci(t,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.editor.getInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const t=this.editor.getValue();let r="";e!=null?r=e:t!=null&&(r=t);const s=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(s,o,{[Zi]:r}),this.hot.render()}setCommentAtCell(e,t,r){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Gr),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(r)}getComment(){const e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,Zi)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,Zi)}show(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:e,col:t}}=this.range;if(e<0||e>this.hot.countSourceRows()-1||t<0||t>this.hot.countSourceCols()-1)return!1;const r=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(r[Gr]?r[Gr][Zi]:""),this.editor.show(),this.refreshEditor(!0),!0}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){this.editor.hide()}refreshEditor(){var e,t;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!this.editor.isVisible()))return;const{rowIndexMapper:s,columnIndexMapper:o}=this.hot,{row:i,col:l}=this.range.from;let a=s.getRenderableFromVisualIndex(i),u=o.getRenderableFromVisualIndex(l);const c=a===null;this.editor.setPosition(0,0),a===null&&(a=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(i,-1))),u===null&&(u=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(l,-1)));const d=a===null,f=u===null;a=(e=a)!==null&&e!==void 0?e:0,u=(t=u)!==null&&t!==void 0?t:0;const{rootWindow:m,view:{_wt:p}}=this.hot,{wtTable:w}=p,M=p.getCell({row:a,col:u},!0),S=this.getCommentMeta(i,l,ZT);S?this.editor.setSize(S.width,S.height):this.editor.resetSize();const y=f?0:w.getStretchedColumnWidth(u),v=c&&!d?_t(M):0,{left:R,top:I,width:F,height:L}=M.getBoundingClientRect(),{width:j,height:X}=this.editor.getSize(),{innerWidth:G,innerHeight:te}=this.hot.rootWindow,ie=this.hot.rootDocument.documentElement;let le=R+m.scrollX+y,me=I+m.scrollY+v;this.hot.isRtl()&&(le-=j+y),this.hot.isLtr()&&R+F+j>G?le=R+m.scrollX-j-1:this.hot.isRtl()&&le<-(ie.scrollWidth-ie.clientWidth)&&(le=R+m.scrollX+y+1),I+X>te&&(me-=X-L+1),this.editor.setPosition(le,me),this.editor.setReadOnlyState(this.getCommentMeta(i,l,Rh))}checkSelectionCommentsConsistency(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;let t=!1;const r=e.getTopStartCorner();return this.getCommentMeta(r.row,r.col,Zi)&&(t=!0),t}updateCommentMeta(e,t,r){const s=this.hot.getCellMeta(e,t)[Gr];let o;s?(o=_n(s),ug(o,r)):o=r,this.hot.setCellMeta(e,t,Gr,o)}getCommentMeta(e,t,r){const s=this.hot.getCellMeta(e,t);if(s[Gr])return s[Gr][r]}onMouseDown(e){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(e)){const t=Ci(e.target,"TD","TBODY");let r=null;t&&(r=this.hot.getCoords(t)),(!t||this.range.from&&r&&(this.range.from.row!==r.row||this.range.from.col!==r.col))&&this.hide()}}onMouseOver(e){const t=Sh.get(this),{rootDocument:r}=this.hot;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||Oe(e.target,"wtBorder")||t.cellBelowCursor===e.target||!this.editor))if(t.cellBelowCursor=r.elementFromPoint(e.clientX,e.clientY),this.targetIsCellWithComment(e)){const s=this.hot._createCellRange(this.hot.getCoords(e.target));this.displaySwitch.show(s)}else yi(e.target,r)&&!this.targetIsCommentTextArea(e)&&this.displaySwitch.hide()}onMouseUp(){this.preventEditorAutoSwitch=!1}onAfterRenderer(e,t){t[Gr]&&t[Gr][Zi]&&ee(e,t.commentedCellClassName)}onEditorBlur(){this.setComment()}onEditorMouseDown(e){const t=Sh.get(this);t.tempEditorDimensions={width:st(e.target),height:_t(e.target)}}onEditorMouseUp(e){const t=Sh.get(this),r=st(e.target),s=_t(e.target);(r!==t.tempEditorDimensions.width+1||s!==t.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[ZT]:{width:r,height:s}})}onContextMenuAddComment(){const e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:e.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}onContextMenuRemoveComment(){const e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,e.forAll((t,r)=>{t>=0&&r>=0&&this.removeCommentAtCell(t,r,!1)}),this.hot.render()}onContextMenuMakeReadOnly(){const e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,e.forAll((t,r)=>{if(t>=0&&r>=0){const s=!!this.getCommentMeta(t,r,Rh);this.updateCommentMeta(t,r,{[Rh]:!s})}})}addToContextMenu(e){const t=()=>this.hot.rowIndexMapper.getRenderableIndexesLength()>0&&this.hot.columnIndexMapper.getRenderableIndexesLength()>0;e.items.push({name:"---------"},{key:"commentsAddEdit",name:()=>this.checkSelectionCommentsConsistency()?this.hot.getTranslatedPhrase(IS):this.hot.getTranslatedPhrase(OS),callback:()=>this.onContextMenuAddComment(),disabled:()=>t()?!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner()):!0},{key:"commentsRemove",name(){return this.getTranslatedPhrase(xS)},callback:()=>this.onContextMenuRemoveComment(),disabled:()=>t()?!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner()):!0},{key:"commentsReadOnly",name(){let r=this.getTranslatedPhrase(AS);return ts(this.getSelectedRangeLast(),(o,i)=>{let l=this.getCellMeta(o,i)[Gr];if(l&&(l=l[Rh]),l)return!0})&&(r=Is(r)),r},callback:()=>this.onContextMenuMakeReadOnly(),disabled:()=>t()?!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner())||!this.checkSelectionCommentsConsistency():!0})}getDisplayDelaySetting(){const e=this.hot.getSettings()[Ep];if($e(e))return e.displayDelay}destroy(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),super.destroy()}}var JT=fO,w8=TypeError,C8=function(n,e){if(!delete n[e])throw new w8("Cannot delete property "+JT(e)+" of "+JT(n))},y8=Di,v8=zf,S8=Gf,R8=xO,b8=C8,E8=AO,T8=[].unshift(0)!==1,M8=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(n){return n instanceof TypeError}},_8=T8||!M8();y8({target:"Array",proto:!0,arity:1,forced:_8},{unshift:function(e){var t=v8(this),r=S8(t),s=arguments.length;if(s){E8(r+s);for(var o=r;o--;){var i=o+s;o in t?t[i]=t[o]:b8(t,i)}for(var l=0;l<s;l++)t[l]=arguments[l]}return R8(t,r+s)}});class MA{constructor(e){this.hot=e,this.commands={},this.commonCallback=null}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];const o=e.split(":"),i=o[0],l=o.length===2?o[1]:null;let a=this.commands[i];if(!a)throw new Error(`Menu command '${i}' not exists.`);if(l&&a.submenu&&(a=O8(l,a.submenu.items)),a.disabled===!0||typeof a.disabled=="function"&&a.disabled.call(this.hot)===!0||Ht(a,"submenu"))return;const u=[];typeof a.callback=="function"&&u.push(a.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),P(u,c=>c.apply(this.hot,r))}}function O8(n,e){let t;return P(e,r=>{const s=r.key?r.key.split(":"):null;if(Array.isArray(s)&&s[1]===n)return t=r,!1}),t}const ur="alignment";function I8(){return{key:ur,name(){return this.getTranslatedPhrase(PS)},disabled(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${ur}:left`,name(){let n=this.getTranslatedPhrase(HS);return ts(this.getSelectedRange(),(t,r)=>{const s=this.getCellMeta(t,r).className;if(s&&s.indexOf("htLeft")!==-1)return!0})&&(n=Is(n)),n},callback(){const n=this.getSelectedRange(),e=Qo(n,(s,o)=>this.getCellMeta(s,o).className),t="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,n,t,r),lo(n,t,r,(s,o)=>this.getCellMeta(s,o),(s,o,i,l)=>this.setCellMeta(s,o,i,l)),this.render()},disabled:!1},{key:`${ur}:center`,name(){let n=this.getTranslatedPhrase(DS);return ts(this.getSelectedRange(),(t,r)=>{const s=this.getCellMeta(t,r).className;if(s&&s.indexOf("htCenter")!==-1)return!0})&&(n=Is(n)),n},callback(){const n=this.getSelectedRange(),e=Qo(n,(s,o)=>this.getCellMeta(s,o).className),t="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,n,t,r),lo(n,t,r,(s,o)=>this.getCellMeta(s,o),(s,o,i,l)=>this.setCellMeta(s,o,i,l)),this.render()},disabled:!1},{key:`${ur}:right`,name(){let n=this.getTranslatedPhrase(kS);return ts(this.getSelectedRange(),(t,r)=>{const s=this.getCellMeta(t,r).className;if(s&&s.indexOf("htRight")!==-1)return!0})&&(n=Is(n)),n},callback(){const n=this.getSelectedRange(),e=Qo(n,(s,o)=>this.getCellMeta(s,o).className),t="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,n,t,r),lo(n,t,r,(s,o)=>this.getCellMeta(s,o),(s,o,i,l)=>this.setCellMeta(s,o,i,l)),this.render()},disabled:!1},{key:`${ur}:justify`,name(){let n=this.getTranslatedPhrase(NS);return ts(this.getSelectedRange(),(t,r)=>{const s=this.getCellMeta(t,r).className;if(s&&s.indexOf("htJustify")!==-1)return!0})&&(n=Is(n)),n},callback(){const n=this.getSelectedRange(),e=Qo(n,(s,o)=>this.getCellMeta(s,o).className),t="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,n,t,r),lo(n,t,r,(s,o)=>this.getCellMeta(s,o),(s,o,i,l)=>this.setCellMeta(s,o,i,l)),this.render()},disabled:!1},{name:Fe},{key:`${ur}:top`,name(){let n=this.getTranslatedPhrase(LS);return ts(this.getSelectedRange(),(t,r)=>{const s=this.getCellMeta(t,r).className;if(s&&s.indexOf("htTop")!==-1)return!0})&&(n=Is(n)),n},callback(){const n=this.getSelectedRange(),e=Qo(n,(s,o)=>this.getCellMeta(s,o).className),t="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,n,t,r),lo(n,t,r,(s,o)=>this.getCellMeta(s,o),(s,o,i,l)=>this.setCellMeta(s,o,i,l)),this.render()},disabled:!1},{key:`${ur}:middle`,name(){let n=this.getTranslatedPhrase(FS);return ts(this.getSelectedRange(),(t,r)=>{const s=this.getCellMeta(t,r).className;if(s&&s.indexOf("htMiddle")!==-1)return!0})&&(n=Is(n)),n},callback(){const n=this.getSelectedRange(),e=Qo(n,(s,o)=>this.getCellMeta(s,o).className),t="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,n,t,r),lo(n,t,r,(s,o)=>this.getCellMeta(s,o),(s,o,i,l)=>this.setCellMeta(s,o,i,l)),this.render()},disabled:!1},{key:`${ur}:bottom`,name(){let n=this.getTranslatedPhrase(VS);return ts(this.getSelectedRange(),(t,r)=>{const s=this.getCellMeta(t,r).className;if(s&&s.indexOf("htBottom")!==-1)return!0})&&(n=Is(n)),n},callback(){const n=this.getSelectedRange(),e=Qo(n,(s,o)=>this.getCellMeta(s,o).className),t="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,n,t,r),lo(n,t,r,(s,o)=>this.getCellMeta(s,o),(s,o,i,l)=>this.setCellMeta(s,o,i,l)),this.render()},disabled:!1}]}}}const Lg="clear_column";function x8(){return{key:Lg,name(){return this.getTranslatedPhrase(CS)},callback(n,e){const t=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,t,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){return $i(this)?!this.selection.isSelectedByColumnHeader():!0}}}const Ec="col_left";function A8(){return{key:Ec,name(){return this.getTranslatedPhrase(hS)},callback(){const n=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,n.col,1,"ContextMenu.columnLeft")},disabled(){return!this.isColumnModificationAllowed()||!$i(this)?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Tc="col_right";function P8(){return{key:Tc,name(){return this.getTranslatedPhrase(dS)},callback(){const n=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,n.col,1,"ContextMenu.columnRight")},disabled(){return!this.isColumnModificationAllowed()||!$i(this)?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Mc="make_read_only";function H8(){return{key:Mc,name(){let n=this.getTranslatedPhrase(wS);return ts(this.getSelectedRange(),(t,r)=>this.getCellMeta(t,r).readOnly)&&(n=Is(n)),n},callback(){const n=this.getSelectedRange(),e=ts(n,(t,r)=>this.getCellMeta(t,r).readOnly);P(n,t=>{t.forAll((r,s)=>{r>=0&&s>=0&&this.setCellMeta(r,s,"readOnly",!e)})}),this.render()},disabled(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Fg="redo";function D8(){return{key:Fg,name(){return this.getTranslatedPhrase(pS)},callback(){this.redo()},hidden(){const n=this.getPlugin("undoRedo");return!n||!n.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const _c="remove_col";function k8(){return{key:_c,name(){const n=this.getSelected();let e=0;if(n)if(n.length>1)e=1;else{const[,t,,r]=n[0];t-r!==0&&(e=1)}return this.getTranslatedPhrase(gS,e)},callback(){this.alter("remove_col",cG(this.getSelected()),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed()||!$i(this))return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Vg="remove_row";function N8(){return{key:Vg,name(){const n=this.getSelected();let e=0;if(n)if(n.length>1)e=1;else{const[t,,r]=n[0];t-r!==0&&(e=1)}return this.getTranslatedPhrase(fS,e)},callback(){this.alter("remove_row",hG(this.getSelected()),1,"ContextMenu.removeRow")},disabled(){if(!$i(this))return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const $g="row_above";function L8(){return{key:$g,name(){return this.getTranslatedPhrase(uS)},callback(){const n=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",n.row,1,"ContextMenu.rowAbove")},disabled(){return $i(this)?this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden(){return!this.getSettings().allowInsertRow}}}const Bg="row_below";function F8(){return{key:Bg,name(){return this.getTranslatedPhrase(cS)},callback(){const n=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",n.row,1,"ContextMenu.rowBelow")},disabled(){return $i(this)?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden(){return!this.getSettings().allowInsertRow}}}const ec="no_items";function V8(){return{key:ec,name(){return this.getTranslatedPhrase(aS)},disabled:!0,isCommand:!1}}const Wg="undo";function $8(){return{key:Wg,name(){return this.getTranslatedPhrase(mS)},callback(){this.undo()},hidden(){const n=this.getPlugin("undoRedo");return!n||!n.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const B8=[$g,Bg,Ec,Tc,Lg,Vg,_c,Wg,Fg,Mc,ur,Fe,ec],W8={[Fe]:r8,[ec]:V8,[$g]:L8,[Bg]:F8,[Ec]:A8,[Tc]:P8,[Lg]:x8,[Vg]:N8,[_c]:k8,[Wg]:$8,[Fg]:D8,[Mc]:H8,[ur]:I8};function _A(){const n={};return Be(W8,(e,t)=>{n[t]=e()}),n}class OA{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.hot=e,this.predefinedItems=_A(),this.defaultOrderPattern=t}setPredefinedItems(e){const t={};this.defaultOrderPattern.length=0,Be(e,(r,s)=>{let o="";r.name===Fe?(t[Fe]=r,o=Fe):isNaN(parseInt(s,10))?(r.key=r.key===void 0?s:r.key,t[s]=r,o=r.key):(t[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=t}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return U8(e,this.defaultOrderPattern,this.predefinedItems)}}function U8(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let s=n;return s&&s.items?s=s.items:Array.isArray(s)||(s=e),$e(s)?Be(s,(o,i)=>{let l=t[typeof o=="string"?o:i];l||(l=o),$e(o)?Ut(l,o):typeof l=="string"&&(l={name:l}),l.key===void 0&&(l.key=i),r.push(l)}):P(s,(o,i)=>{let l=t[o];!l&&B8.indexOf(o)>=0||(l||(l={name:o,key:`${i}`}),$e(o)&&Ut(l,o),l.key===void 0&&(l.key=i),r.push(l))}),r}class z8{constructor(e,t){const r=zu(t),s=Yl(t);let o,i,l,a,u,c;this.rootWindow=t,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),l=parseInt(e.left,10),u=e.height||0,c=e.width||0,i=o,a=l,o+=r,l+=s):this.type==="event"&&(o=parseInt(e.pageY,10),l=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,i=o-r,a=l-s),this.top=o,this.topRelative=i,this.left=l,this.leftRelative=a,this.scrollTop=r,this.scrollLeft=s,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let t="literal";return e instanceof Event&&(t="event"),t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}const e1=215,IA="menu",Y8=IA;class da{constructor(e,t){this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:e1,container:this.hot.rootDocument.documentElement},this.eventManager=new It(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"contextmenu",t=>this.onDocumentContextMenu(t)),e=Jd(e)}setMenuItems(e){this.menuItems=e}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[e]=t}isSubMenu(){return this.parentMenu!==null}open(){var e=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const t=KI(f=>this.openSubMenu(f),300),r=this.options.minWidth||e1;let s=!1,o=yr(this.menuItems,f=>(f.key===ec&&(s=!0),u8(f,this.hot)));if(o.length<1&&!s)o.push(_A()[ec]);else if(o.length===0)return;o=d8(o,Fe);let i=!1;const l={data:o,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(f){return ue(f)&&f<r?r:f},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:(f,m,p,w,M,S)=>this.menuItemRenderer(f,m,p,w,M,S)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:(f,m)=>{this.isAllSubMenusClosed()?t(m.row):this.openSubMenu(m.row)},rowHeights:f=>o[f].name===Fe?1:23,afterOnCellContextMenu:f=>{f.preventDefault(),KE()&&i&&this.hasSelectedItem()&&this.close(!0)},beforeOnCellMouseUp:f=>{this.hasSelectedItem()&&(i=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(f))},afterOnCellMouseUp:f=>{(!KE()||!_i(f))&&i&&this.hasSelectedItem()&&(is()||nx()?setTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new A0(this.container,l),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.addHook("afterSelection",function(){return e.onAfterSelection(...arguments)}),this.hotMenu.init(),this.hotMenu.listen();const a=this.hotMenu.getShortcutManager(),u=a.addContext(Y8),d={...{group:IA},runOnlyIf:f=>nf(f.target)===!1||this.container.contains(f.target)===!1};a.setActiveContextName("menu"),u.addShortcuts([{keys:[["Escape"]],callback:()=>{this.keyEvent=!0,this.close(),this.keyEvent=!1}},{keys:[["ArrowDown"]],callback:()=>{const f=this.hotMenu.getSelectedLast();this.keyEvent=!0,f?this.selectNextCell(f[0],f[1]):this.selectFirstCell(),this.keyEvent=!1}},{keys:[["ArrowUp"]],callback:()=>{const f=this.hotMenu.getSelectedLast();this.keyEvent=!0,f?this.selectPrevCell(f[0],f[1]):this.selectLastCell(),this.keyEvent=!1}},{keys:[["ArrowRight"]],callback:()=>{const f=this.hotMenu.getSelectedLast();if(this.keyEvent=!0,f){const m=this.openSubMenu(f[0]);m&&m.selectFirstCell()}this.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:()=>{const f=this.hotMenu.getSelectedLast();this.keyEvent=!0,f&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen()),this.keyEvent=!1}},{keys:[["Enter"]],callback:f=>{const m=this.hotMenu.getSelectedLast();this.keyEvent=!0,this.hotMenu.getSourceDataAtRow(m[0]).submenu||(this.executeCommand(f),this.close(!0)),this.keyEvent=!1}},{keys:[["PageUp"]],callback:()=>{const f=this.hotMenu.getSelectedLast();this.keyEvent=!0,f?this.hotMenu.selection.transformStart(-this.hotMenu.countVisibleRows(),0):this.selectFirstCell(),this.keyEvent=!1}},{keys:[["PageDown"]],callback:()=>{const f=this.hotMenu.getSelectedLast();this.keyEvent=!0,f?this.hotMenu.selection.transformStart(this.hotMenu.countVisibleRows(),0):this.selectLastCell(),this.keyEvent=!1}}],d),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(e&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}openSubMenu(e){if(!this.hotMenu)return!1;const t=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!t||!o8(t))return!1;const r=this.hotMenu.getSourceDataAtRow(e),s=new da(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return s.setMenuItems(r.submenu.items),s.open(),s.setPosition(t.getBoundingClientRect()),this.hotSubMenus[r.key]=s,s}closeSubMenu(e){const t=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[t.key];r&&(r.destroy(),delete this.hotSubMenus[t.key])}closeAllSubMenus(){P(this.hotMenu.getData(),(e,t)=>this.closeSubMenu(t))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),this.isCommandPassive(t))return;const r=this.hot.getSelectedRange(),s=r?s8(r):[];this.runLocalHooks("executeCommand",t.key,s,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,s,e)}isCommandPassive(e){const{isCommand:t,name:r,disabled:s,submenu:o}=e,i=s===!0||typeof s=="function"&&s.call(this.hot)===!0;return t===!1||r===Fe||i===!0||o}setPosition(e){const t=new z8(e,this.container.ownerDocument.defaultView);this.options.keepInViewport?(t.fitsBelow(this.container)?this.setPositionBelowCursor(t):t.fitsAbove(this.container)?this.setPositionAboveCursor(t):this.setPositionBelowCursor(t),this.hot.isLtr()?this.setHorizontalPositionForLtr(t):this.setHorizontalPositionForRtl(t)):(this.setPositionBelowCursor(t),this.setPositionOnRightOfCursor(t))}setHorizontalPositionForRtl(e){e.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(e):this.setPositionOnRightOfCursor(e)}setHorizontalPositionForLtr(e){e.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(e):this.setPositionOnLeftOfCursor(e)}setPositionAboveCursor(e){let t=this.offset.above+e.top-this.container.offsetHeight;this.isSubMenu()&&(t=e.top+e.cellHeight-this.container.offsetHeight+3),this.container.style.top=`${t}px`}setPositionBelowCursor(e){let t=this.offset.below+e.top+1;this.isSubMenu()&&(t=e.top-1),this.container.style.top=`${t}px`}setPositionOnRightOfCursor(e){let t=e.left;if(this.isSubMenu()){const{right:r}=this.parentMenu.container.getBoundingClientRect();t+=e.cellWidth+r-(e.left+e.cellWidth)}else t+=this.offset.right;this.container.style.left=`${t}px`}setPositionOnLeftOfCursor(e){let t=this.offset.left+e.left-this.container.offsetWidth;if(this.isSubMenu()){const{left:r}=this.parentMenu.container.getBoundingClientRect();t-=e.left-r}this.container.style.left=`${t}px`}selectFirstCell(){const e=this.hotMenu.getCell(0,0);Ch(e)||yh(e)||vh(e)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}selectLastCell(){const e=this.hotMenu.countRows()-1,t=this.hotMenu.getCell(e,0);Ch(t)||yh(t)||vh(t)?this.selectPrevCell(e,0):(this.hotMenu.selectCell(e,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(e,0,!0,!1))}selectNextCell(e,t){const r=e+1,s=r<this.hotMenu.countRows()?this.hotMenu.getCell(r,t):null;s&&(Ch(s)||yh(s)||vh(s)?this.selectNextCell(r,t):this.hotMenu.selectCell(r,t))}selectPrevCell(e,t){const r=e-1,s=r>=0?this.hotMenu.getCell(r,t):null;s&&(Ch(s)||yh(s)||vh(s)?this.selectPrevCell(r,t):this.hotMenu.selectCell(r,t))}menuItemRenderer(e,t,r,s,o,i){const l=e.getSourceDataAtRow(r),a=this.hot.rootDocument.createElement("div"),u=p=>Ht(p,"submenu"),c=p=>new RegExp(Fe,"i").test(p.name),d=p=>p.disabled===!0||typeof p.disabled=="function"&&p.disabled.call(this.hot)===!0,f=p=>p.disableSelection;let m=i;typeof m=="function"&&(m=m.call(this.hot)),hs(t),ee(a,"htItemWrapper"),t.appendChild(a),c(l)?ee(t,"htSeparator"):typeof l.renderer=="function"?(ee(t,"htCustomMenuRenderer"),t.appendChild(l.renderer(e,a,r,s,o,m))):ia(a,m),d(l)?(ee(t,"htDisabled"),this.eventManager.addEventListener(t,"mouseenter",()=>e.deselectCell())):f(l)?(ee(t,"htSelectionDisabled"),this.eventManager.addEventListener(t,"mouseenter",()=>e.deselectCell())):u(l)?(ee(t,"htSubmenu"),f(l)?this.eventManager.addEventListener(t,"mouseenter",()=>e.deselectCell()):this.eventManager.addEventListener(t,"mouseenter",()=>e.selectCell(r,s,void 0,void 0,!1,!1))):(He(t,["htSubmenu","htDisabled"]),f(l)?this.eventManager.addEventListener(t,"mouseenter",()=>e.deselectCell()):this.eventManager.addEventListener(t,"mouseenter",()=>e.selectCell(r,s,void 0,void 0,!1,!1)))}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const t=this.options.container.ownerDocument;let r=e,s;return r&&(ut(r)&&(r=r.call(this.hot),r===null||dt(r)?r="":r=r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,s=t.querySelector(`.${this.options.className}.${r}`)),s||(s=t.createElement("div"),ee(s,`htMenu ${this.options.className}`),r&&ee(s,r),this.options.container.appendChild(s)),s}blockMainTableCallbacks(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}releaseMainTableCallbacks(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}onAfterInit(){const{wtTable:e}=this.hotMenu.view._wt,t=this.hotMenu.getSettings().data,r=e.hider.style,s=e.holder.style,o=parseInt(r.width,10),i=Sn(t,(l,a)=>l+(a.name===Fe?1:26),0);s.width=`${o+3}px`,s.height=`${i+3}px`,r.height=s.height}onAfterSelection(e,t,r,s,o){this.keyEvent===!1&&(o.value=!0)}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!yi(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!yi(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Oe(e.target,"htCore")&&yi(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}at(da,An);const bh="contextMenu",j8=70;he.getSingleton().register("afterContextMenuDefaultOptions");he.getSingleton().register("beforeContextMenuShow");he.getSingleton().register("afterContextMenuShow");he.getSingleton().register("afterContextMenuHide");he.getSingleton().register("afterContextMenuExecute");class Ug extends nt{static get PLUGIN_KEY(){return bh}static get PLUGIN_PRIORITY(){return j8}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[$g,Bg,Fe,Ec,Tc,Fe,Vg,_c,Fe,Wg,Fg,Fe,Mc,Fe,ur]}constructor(e){super(e),this.eventManager=new It(this),this.commandExecutor=new MA(this.hot),this.itemsFactory=null,this.menu=null}isEnabled(){return!!this.hot.getSettings()[bh]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[bh];typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new da(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>this.onMenuBeforeOpen()),this.menu.addLocalHook("afterOpen",()=>this.onMenuAfterOpen()),this.menu.addLocalHook("afterClose",()=>this.onMenuAfterClose()),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return e.executeCommand.call(e,...s)}),this.addHook("afterOnCellContextMenu",r=>this.onAfterOnCellContextMenu(r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),super.disablePlugin()}open(e){if(!this.menu||(this.prepareMenuItems(),this.menu.open(),!this.menu.isOpened()))return;let t=0,r=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){const{frameElement:s}=this.hot.rootWindow,{top:o,left:i}=s.getBoundingClientRect();t=o-zu(e.view),r=i-Yl(e.view)}else t=-1*zu(this.menu.hotMenu.rootWindow),r=-1*Yl(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(e.pageY,10)+t,left:parseInt(e.pageX,10)+r})}close(){this.menu&&(this.menu.close(),this.itemsFactory=null)}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new OA(this.hot,Ug.DEFAULT_ITEMS);const e=this.hot.getSettings()[bh],t={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",t),this.itemsFactory.setPredefinedItems(t.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),P(r,s=>this.commandExecutor.registerCommand(s.key,s))}onAfterOnCellContextMenu(e){const t=this.hot.getSettings(),r=t.rowHeaders,s=t.colHeaders;function o(l){return l.nodeName==="TD"||l.parentNode.nodeName==="TD"}const i=e.target;this.close(),!Oe(i,"handsontableInput")&&(e.preventDefault(),e.stopPropagation(),!(!(r||s)&&!o(i)&&!(Oe(i,"current")&&Oe(i,"wtBorder")))&&this.open(e))}onMenuBeforeOpen(){this.hot.runHooks("beforeContextMenuShow",this)}onMenuAfterOpen(){this.hot.runHooks("afterContextMenuShow",this)}onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}Ug.SEPARATOR={name:Fe};function G8(n){return{key:"copy",name(){return this.getTranslatedPhrase(yS)},callback(){n.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function K8(n){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),t=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(RS,t)},callback(){n.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function X8(n){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),t=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(SS,t)},callback(){n.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function q8(n){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),t=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(vS,t)},callback(){n.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function Q8(n){return{key:"cut",name(){return this.getTranslatedPhrase(bS)},callback(){n.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}class Z8{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}}class J8{constructor(){this.clipboardData=new Z8}}class K0{constructor(e){this.rootDocument=e.defaultView?e:e.ownerDocument,this.mainElement=null,this.eventManager=new It(this),this.listenersCount=new WeakSet,this.container=e}useSecondaryElement(){const e=n5(this.container);this.listenersCount.has(e)||(this.listenersCount.add(e),t1(this.eventManager,e,this)),this.mainElement=e}setFocusableElement(e){this.listenersCount.has(e)||(this.listenersCount.add(e),t1(this.eventManager,e,this)),this.mainElement=e}getFocusableElement(){return this.mainElement}focus(){this.mainElement.value=" ",is()||gz(this.mainElement)}}at(K0,An);const df=new WeakMap;function e5(n){const e=new K0(n);let t=df.get(n);return t=isNaN(t)?0:t,df.set(n,t+1),e}function t5(n){n.eventManager.clear()}const Tp=(n,e)=>t=>e.runLocalHooks(n,t);function t1(n,e,t){n.addEventListener(e,"copy",Tp("copy",t)),n.addEventListener(e,"cut",Tp("cut",t)),n.addEventListener(e,"paste",Tp("paste",t))}const ff=new WeakMap;function n5(n){const e=ff.get(n);if(e)return e.parentElement||n.appendChild(e),e;const r=(n.defaultView?n:n.ownerDocument).createElement("textarea");return ff.set(n,r),r.setAttribute("data-hot-input",""),r.className="HandsontableCopyPaste",r.tabIndex=-1,r.autocomplete="off",r.wrap="hard",r.value=" ",n.appendChild(r),r}function n1(n){if(!(n instanceof K0))return;let e=df.get(n.container);if(e=isNaN(e)?0:e,e>0&&(e-=1),t5(n),e<=0){e=0;const t=ff.get(n.container);t&&t.parentNode&&(t.parentNode.removeChild(t),ff.delete(n.container)),n.mainElement=null}df.set(n.container,e)}function r1(n,e){xA(n,e),e.add(n)}function Ji(n,e,t){xA(n,e),e.set(n,t)}function xA(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Eh(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function bn(n,e){var t=AA(n,e,"get");return r5(n,t)}function r5(n,e){return e.get?e.get.call(n):e.value}function el(n,e,t){var r=AA(n,e,"set");return s5(n,r,t),t}function AA(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function s5(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var eo=new WeakMap,Mp=new WeakMap,Ha=new WeakMap,KC=new WeakMap,XC=new WeakMap,Da=new WeakMap,Th=new WeakSet,s1=new WeakSet;class o5{constructor(e){let{countRows:t,countColumns:r,rowsLimit:s,columnsLimit:o,countColumnHeaders:i}=e;r1(this,s1),r1(this,Th),Ji(this,eo,{writable:!0,value:void 0}),Ji(this,Mp,{writable:!0,value:void 0}),Ji(this,Ha,{writable:!0,value:void 0}),Ji(this,KC,{writable:!0,value:void 0}),Ji(this,XC,{writable:!0,value:void 0}),Ji(this,Da,{writable:!0,value:void 0}),el(this,Mp,t),el(this,Ha,r),el(this,KC,s),el(this,XC,o),el(this,Da,i)}setSelectedRange(e){el(this,eo,e)}getCellsRange(){if(bn(this,Mp).call(this)===0||bn(this,Ha).call(this)===0)return null;const{row:e,col:t}=bn(this,eo).getTopStartCorner(),{row:r,col:s}=bn(this,eo).getBottomEndCorner(),o=Eh(this,s1,i5).call(this,e,r),i=Eh(this,Th,_p).call(this,t,s);return{isRangeTrimmed:r!==o||s!==i,startRow:e,startCol:t,endRow:o,endCol:i}}getMostBottomColumnHeadersRange(){if(bn(this,Ha).call(this)===0||bn(this,Da).call(this)===0)return null;const{col:e}=bn(this,eo).getTopStartCorner(),{col:t}=bn(this,eo).getBottomEndCorner(),r=Eh(this,Th,_p).call(this,e,t);return{isRangeTrimmed:t!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(bn(this,Ha).call(this)===0||bn(this,Da).call(this)===0)return null;const{col:e}=bn(this,eo).getTopStartCorner(),{col:t}=bn(this,eo).getBottomEndCorner(),r=Eh(this,Th,_p).call(this,e,t);return{isRangeTrimmed:t!==r,startRow:-bn(this,Da).call(this),startCol:e,endRow:-1,endCol:r}}}function _p(n,e){return Math.min(e,Math.max(n+bn(this,XC).call(this)-1,n))}function i5(n,e){return Math.min(e,Math.max(n+bn(this,KC).call(this)-1,n))}function PA(n){const e=[],t=[];return P(n,r=>{const s=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);Ce(s,o,a=>{e.indexOf(a)===-1&&e.push(a)});const i=Math.min(r.startCol,r.endCol),l=Math.max(r.startCol,r.endCol);Ce(i,l,a=>{t.indexOf(a)===-1&&t.push(a)})}),{rows:e,columns:t}}function l5(n,e){HA(n,e),e.add(n)}function Zo(n,e,t){HA(n,e),e.set(n,t)}function HA(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tl(n,e,t){return e=a5(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function a5(n){var e=u5(n,"string");return typeof e=="symbol"?e:String(e)}function u5(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function c5(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function Wn(n,e){var t=DA(n,e,"get");return h5(n,t)}function h5(n,e){return e.get?e.get.call(n):e.value}function vs(n,e,t){var r=DA(n,e,"set");return d5(n,r,t),t}function DA(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function d5(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}he.getSingleton().register("afterCopyLimit");he.getSingleton().register("modifyCopyableRange");he.getSingleton().register("beforeCut");he.getSingleton().register("afterCut");he.getSingleton().register("beforePaste");he.getSingleton().register("afterPaste");he.getSingleton().register("beforeCopy");he.getSingleton().register("afterCopy");const Mh="copyPaste",f5=80,g5=["fragmentSelection"],o1=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var Op=new WeakMap,Ip=new WeakMap,xp=new WeakMap,nl=new WeakMap,_h=new WeakMap,Oh=new WeakMap,rl=new WeakMap,i1=new WeakSet;class m5 extends nt{constructor(){super(...arguments),l5(this,i1),tl(this,"columnsLimit",1/0),tl(this,"rowsLimit",1/0),tl(this,"pasteMode","overwrite"),tl(this,"uiContainer",this.hot.rootDocument.body),Zo(this,Op,{writable:!0,value:!1}),Zo(this,Ip,{writable:!0,value:!1}),Zo(this,xp,{writable:!0,value:!1}),Zo(this,nl,{writable:!0,value:"cells-only"}),Zo(this,_h,{writable:!0,value:!1}),Zo(this,Oh,{writable:!0,value:!1}),Zo(this,rl,{writable:!0,value:new o5({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),tl(this,"copyableRanges",[]),tl(this,"focusableElement",void 0)}static get PLUGIN_KEY(){return Mh}static get SETTING_KEYS(){return[Mh,...g5]}static get PLUGIN_PRIORITY(){return f5}isEnabled(){return!!this.hot.getSettings()[Mh]}enablePlugin(){if(this.enabled)return;const{[Mh]:e}=this.hot.getSettings();if(typeof e=="object"){var t,r;this.pasteMode=(t=e.pasteMode)!==null&&t!==void 0?t:this.pasteMode,this.rowsLimit=isNaN(e.rowsLimit)?this.rowsLimit:e.rowsLimit,this.columnsLimit=isNaN(e.columnsLimit)?this.columnsLimit:e.columnsLimit,vs(this,Op,!!e.copyColumnHeaders),vs(this,Ip,!!e.copyColumnGroupHeaders),vs(this,xp,!!e.copyColumnHeadersOnly),this.uiContainer=(r=e.uiContainer)!==null&&r!==void 0?r:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",s=>this.onAfterContextMenuDefaultOptions(s)),this.addHook("afterOnCellMouseUp",()=>this.onAfterOnCellMouseUp()),this.addHook("afterSelectionEnd",()=>this.onAfterSelectionEnd()),this.addHook("beforeKeyDown",()=>this.onBeforeKeyDown()),this.focusableElement=e5(this.uiContainer),this.focusableElement.addLocalHook("copy",s=>this.onCopy(s)).addLocalHook("cut",s=>this.onCut(s)).addLocalHook("paste",s=>this.onPaste(s)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),super.updatePlugin()}disablePlugin(){this.focusableElement&&n1(this.focusableElement),super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";vs(this,nl,e),vs(this,_h,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){vs(this,Oh,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}getRangedCopyableData(e){return gu(this.getRangedData(e))}getRangedData(e){const t=[],{rows:r,columns:s}=PA(e);return P(r,o=>{const i=[];P(s,l=>{o<0?i.push(this.hot.getColHeader(l,o)):i.push(this.hot.getCopyableData(o,l))}),t.push(i)}),t}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!t)return;const r=new J8;e&&r.clipboardData.setData("text/plain",e),t&&r.clipboardData.setData("text/html",t),this.getOrCreateFocusableElement(),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;Wn(this,rl).setSelectedRange(e);const t=new Map([["headers",null],["cells",null]]);Wn(this,nl)==="column-headers-only"?t.set("headers",Wn(this,rl).getMostBottomColumnHeadersRange()):(Wn(this,nl)==="with-column-headers"?t.set("headers",Wn(this,rl).getMostBottomColumnHeadersRange()):Wn(this,nl)==="with-column-group-headers"&&t.set("headers",Wn(this,rl).getAllColumnHeadersRange()),t.set("cells",Wn(this,rl).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter(s=>s!==null).map(s=>{let{startRow:o,startCol:i,endRow:l,endCol:a}=s;return{startRow:o,startCol:i,endRow:l,endCol:a}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=t.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:s,startCol:o,endRow:i,endCol:l}=r;this.hot.runHooks("afterCopyLimit",i-s+1,l-o+1,this.rowsLimit,this.columnsLimit)}}getOrCreateFocusableElement(){var e;const t=(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA;t?this.focusableElement.setFocusableElement(t):this.focusableElement.useSecondaryElement()}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,s=e[0].length,o=[],{row:i,col:l}=t.getTopStartCorner(),{row:a,col:u}=t.getBottomEndCorner();let c=i,d=l,f=i,m=l;for(;o.length<r||c<=a;){const{skipRowOnPaste:p,visualRow:w}=this.hot.getCellMeta(c,l);if(c=w+1,p===!0)continue;f=w,d=l;const M=[],S=o.length%r;for(;M.length<s||d<=u;){const{skipColumnOnPaste:y,visualCol:v}=this.hot.getCellMeta(i,d);if(d=v+1,y===!0)continue;m=v;const R=M.length%s;M.push(e[S][R])}o.push(M)}return this.hot.populateFromArray(i,l,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[i,l,f,m]}onCopy(e){if(!this.hot.isListening()&&!Wn(this,_h)||this.isEditorOpened())return;this.setCopyableText(),vs(this,_h,!1);const t=this.getRangedData(this.copyableRanges),r=c5(this,i1,p5).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",t,this.copyableRanges,r)){const o=gu(t);if(e&&e.clipboardData){const i=JE(t,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[o1,i].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.runHooks("afterCopy",t,this.copyableRanges,r)}vs(this,nl,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!Wn(this,Oh)||this.isEditorOpened())return;this.setCopyableText(),vs(this,Oh,!1);const t=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",t,this.copyableRanges)){const s=gu(t);if(e&&e.clipboardData){const o=JE(t,this.hot.rootDocument);e.clipboardData.setData("text/plain",s),e.clipboardData.setData("text/html",[o1,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",t,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened())return;e&&e.preventDefault&&e.preventDefault();let t;if(e&&typeof e.clipboardData<"u"){const l=Dv(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});l&&/(<table)|(<TABLE)/g.test(l)?t=Xz(l,this.hot.rootDocument).data:t=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(t=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof t=="string"&&(t=fG(t)),t&&t.length===0||this.hot.runHooks("beforePaste",t,this.copyableRanges)===!1)return;const[r,s,o,i]=this.populateValues(t);this.hot.selectCell(r,s,Math.min(this.hot.countRows()-1,o),Math.min(this.hot.countCols()-1,i)),this.hot.runHooks("afterPaste",t,this.copyableRanges)}onAfterContextMenuDefaultOptions(e){e.items.push({name:"---------"},G8(this)),Wn(this,Op)&&e.items.push(q8(this)),Wn(this,Ip)&&e.items.push(X8(this)),Wn(this,xp)&&e.items.push(K8(this)),e.items.push(Q8(this))}onAfterOnCellMouseUp(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}onAfterSelectionEnd(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&cz())&&(this.setCopyableText(),this.focusableElement.focus()))}onBeforeKeyDown(){if(!this.hot.isListening()||this.isEditorOpened())return;const e=this.hot.rootDocument.activeElement,t=this.hot.getActiveEditor();!t||e!==this.focusableElement.getFocusableElement()&&e!==t.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}destroy(){this.focusableElement&&(n1(this.focusableElement),this.focusableElement=null),super.destroy()}}function p5(n){const{rows:e}=PA(n);let t=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)t+=1;return{columnHeadersCount:t}}function kA(n,e){return`border_row${n}col${e}`}function Qa(){return{width:1,color:"#000"}}function ks(){return{hide:!0}}function w5(){return{width:1,color:"#000",cornerVisible:!1}}function Ap(n){if(ue(n.start)||ue(n.left)){var e;n.start=(e=n.start)!==null&&e!==void 0?e:n.left}if(ue(n.end)||ue(n.right)){var t;n.end=(t=n.end)!==null&&t!==void 0?t:n.right}return delete n.left,delete n.right,n}function ka(n){return ue(n.start)&&(n.left=n.start),ue(n.end)&&(n.right=n.end),n}function Pp(n,e){return{id:kA(n,e),border:w5(),row:n,col:e,top:ks(),bottom:ks(),start:ks(),end:ks()}}function C5(n,e){return Ht(e,"border")&&e.border&&(n.border=e.border),Ht(e,"top")&&ue(e.top)&&(e.top?($e(e.top)||(e.top=Qa()),n.top=e.top):(e.top=ks(),n.top=e.top)),Ht(e,"bottom")&&ue(e.bottom)&&(e.bottom?($e(e.bottom)||(e.bottom=Qa()),n.bottom=e.bottom):(e.bottom=ks(),n.bottom=e.bottom)),Ht(e,"start")&&ue(e.start)&&(e.start?($e(e.start)||(e.start=Qa()),n.start=e.start):(e.start=ks(),n.start=e.start)),Ht(e,"end")&&ue(e.end)&&(e.end?($e(e.end)||(e.end=Qa()),n.end=e.end):(e.end=ks(),n.end=e.end)),n}function zs(n,e){let t=!1;return P(n.getSelectedRange(),r=>{r.forAll((s,o)=>{if(s<0||o<0)return;const i=n.getCellMeta(s,o).borders;if(i)if(e){if(!Ht(i[e],"hide")||i[e].hide===!1)return t=!0,!1}else return t=!0,!1})}),t}function zg(n){return`<span class="selected">✓</span>${n}`}function y5(n){return n.some(e=>ue(e.left)||ue(e.right))}function v5(n){return n.some(e=>ue(e.start)||ue(e.end))}const S5=new Map([["left","start"],["right","end"]]);function R5(n){var e;return(e=S5.get(n))!==null&&e!==void 0?e:n}function b5(n){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(US);return zs(this,"bottom")&&(e=zg(e)),e},callback(e,t){const r=zs(this,"bottom");n.prepareBorder(t,"bottom",r)}}}function E5(n){const e=n.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(zS);return zs(this,e)&&(t=zg(t)),t},callback(t,r){const s=zs(this,e);n.prepareBorder(r,e,s)}}}function T5(n){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(YS)},callback(e,t){n.prepareBorder(t,"noBorders")},disabled(){return!zs(this)}}}function M5(n){const e=n.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(WS);return zs(this,e)&&(t=zg(t)),t},callback(t,r){const s=zs(this,e);n.prepareBorder(r,e,s)}}}function _5(n){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(BS);return zs(this,"top")&&(e=zg(e)),e},callback(e,t){const r=zs(this,"top");n.prepareBorder(t,"top",r)}}}function O5(n,e,t){return e=I5(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function I5(n){var e=x5(n,"string");return typeof e=="symbol"?e:String(e)}function x5(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Ih="customBorders",A5=90;class P5 extends nt{constructor(){super(...arguments),O5(this,"savedBorders",[])}static get PLUGIN_KEY(){return Ih}static get PLUGIN_PRIORITY(){return A5}isEnabled(){return!!this.hot.getSettings()[Ih]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>this.onAfterContextMenuDefaultOptions(e)),this.addHook("init",()=>this.onAfterInit()),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let r=["top","bottom","start","end"],s=null;t&&(this.checkSettingsCohesion([t]),r=Object.keys(t),s=Ap(t));const o=Xl(e),i=qu(o);P(e,l=>{const[a,u,c,d]=i(l);for(let f=a;f<=c;f+=1)for(let m=u;m<=d;m+=1)P(r,p=>{this.prepareBorderFromCustomAdded(f,m,s,R5(p))})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const t=Xl(e),r=qu(t),s=[];return P(e,o=>{const[i,l,a,u]=r(o);for(let c=i;c<=a;c+=1)for(let d=l;d<=u;d+=1)P(this.savedBorders,f=>{f.row===c&&f.col===d&&s.push(ka(f))})}),s}clearBorders(e){e?this.setBorders(e):(P(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);const s=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,s,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:s})}prepareBorderFromCustomAdded(e,t,r,s){const o=this.hot.countRows(),i=this.hot.countCols();if(e>=o||t>=i)return;let l=Pp(e,t);r&&(l=C5(l,r),P(this.hot.selection.highlight.customSelections,a=>{if(l.id===a.settings.id)return Object.assign(a.settings,r),l.id=a.settings.id,l.top=a.settings.top,l.bottom=a.settings.bottom,l.start=a.settings.start,l.end=a.settings.end,!1})),this.hot.setCellMeta(e,t,"borders",ka(l)),this.insertBorderIntoSettings(l,s)}prepareBorderFromCustomAddedRange(e,t){const r=Math.min(e.to.row,this.hot.countRows()-1),s=Math.min(e.to.col,this.hot.countCols()-1);Ce(e.from.row,r,o=>{Ce(e.from.col,s,i=>{const l=Pp(o,i);let a=0;o===e.from.row&&Ht(t,"top")&&(a+=1,l.top=t.top),o===e.to.row&&Ht(t,"bottom")&&(a+=1,l.bottom=t.bottom),i===e.from.col&&Ht(t,"start")&&(a+=1,l.start=t.start),i===e.to.col&&Ht(t,"end")&&(a+=1,l.end=t.end),a>0&&(this.hot.setCellMeta(o,i,"borders",ka(l)),this.insertBorderIntoSettings(l))})})}removeAllBorders(e,t){const r=kA(e,t);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,r,s){let o=this.hot.getCellMeta(e,t).borders;!o||o.border===void 0?o=Pp(e,t):o=Ap(o),s?(o[r]=ks(),this.countHide(o)===4?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(o,r,s)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,t,"borders",ka(o)))):(o[r]=Qa(),this.checkCustomSelectionsFromContextMenu(o,r,s)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,t,"borders",ka(o)))}prepareBorder(e,t,r){P(e,s=>{let{start:o,end:i}=s;if(o.row===i.row&&o.col===i.col)t==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,t,r);else switch(t){case"noBorders":Ce(o.col,i.col,l=>{Ce(o.row,i.row,a=>{this.removeAllBorders(a,l)})});break;case"top":Ce(o.col,i.col,l=>{this.setBorder(o.row,l,t,r)});break;case"bottom":Ce(o.col,i.col,l=>{this.setBorder(i.row,l,t,r)});break;case"start":Ce(o.row,i.row,l=>{this.setBorder(l,o.col,t,r)});break;case"end":Ce(o.row,i.row,l=>{this.setBorder(l,i.col,t,r)});break}})}createCustomBorders(e){P(e,t=>{const r=Ap(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,r):this.prepareBorderFromCustomAdded(t.row,t.col,r)})}countHide(e){const{top:t,bottom:r,start:s,end:o}=e;return Sn([t,r,s,o],(l,a)=>{let u=l;return a&&a.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const t=Ve(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}clearNullCellRange(){P(this.hot.selection.highlight.customSelections,(e,t)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1})}hideBorders(){P(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const t=Ve(this.savedBorders,r=>r.id).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}checkSavedBorders(e){let t=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),t=!0):P(this.savedBorders,(s,o)=>{if(e.id===s.id)return this.savedBorders[o]=e,t=!0,!1}),t}checkCustomSelectionsFromContextMenu(e,t,r){let s=!1;return P(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id)return Be(o.instanceBorders,i=>{i.toggleHiddenClass(t,r)}),s=!0,!1}),s}checkCustomSelections(e,t,r){const s=this.countHide(e);let o=!1;return s===4?(this.removeAllBorders(e.row,e.col),o=!0):P(this.hot.selection.highlight.customSelections,i=>{if(e.id===i.settings.id)return i.visualCellRange=t,i.commit(),r&&Be(i.instanceBorders,l=>{l.changeBorderStyle(r,e)}),o=!0,!1}),o}changeBorderSettings(){const e=this.hot.getSettings()[Ih];if(Array.isArray(e)){const t=_n(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const t=y5(e),r=v5(e);if(t&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}onAfterContextMenuDefaultOptions(e){this.hot.getSettings()[Ih]&&e.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase($S)},disabled(){return this.selection.isSelectedByCorner()},submenu:{items:[_5(this),M5(this),b5(this),E5(this),T5(this)]}})}onAfterInit(){this.changeBorderSettings()}destroy(){super.destroy()}}const l1="dragToScroll",H5=100;class D5 extends nt{static get PLUGIN_KEY(){return l1}static get PLUGIN_PRIORITY(){return H5}constructor(e){super(e),this.eventManager=new It(this),this.boundaries=null,this.callback=null,this.listening=!1}isEnabled(){return!!this.hot.getSettings()[l1]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>this.setupListening(e)),this.addHook("afterOnCellCornerMouseDown",e=>this.setupListening(e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(e){this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let r=0,s=0;t<this.boundaries.top?s=t-this.boundaries.top:t>this.boundaries.bottom&&(s=t-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,s)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mousemove",r=>this.onMouseMove(r)),t=Jd(t)}unregisterEvents(){this.eventManager.clear()}setupListening(e){if(_i(e))return;const t=this.hot.view._wt.wtTable.holder;t!==this.hot.rootWindow&&(this.setBoundaries(t.getBoundingClientRect()),this.setCallback((r,s)=>{r<0?t.scrollLeft-=50:r>0&&(t.scrollLeft+=50),s<0?t.scrollTop-=20:s>0&&(t.scrollTop+=20)}),this.listen())}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}he.getSingleton().register("afterDropdownMenuDefaultOptions");he.getSingleton().register("beforeDropdownMenuShow");he.getSingleton().register("afterDropdownMenuShow");he.getSingleton().register("afterDropdownMenuHide");he.getSingleton().register("afterDropdownMenuExecute");const Hp="dropdownMenu",k5=230,Dp="changeType";class Yg extends nt{static get PLUGIN_KEY(){return Hp}static get PLUGIN_PRIORITY(){return k5}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Ec,Tc,Fe,_c,Fe,Lg,Fe,Mc,Fe,ur]}constructor(e){super(e),this.eventManager=new It(this),this.commandExecutor=new MA(this.hot),this.itemsFactory=null,this.menu=null,this.hot.addHook("afterGetColHeader",(t,r)=>this.onAfterGetColHeader(t,r))}isEnabled(){return this.hot.getSettings()[Hp]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new OA(this.hot,Yg.DEFAULT_ITEMS);const t=this.hot.getSettings()[Hp],r={items:this.itemsFactory.getItems(t)};this.registerEvents(),typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const s=this.itemsFactory.getItems(t);this.menu&&this.menu.destroy(),this.menu=new da(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",s),this.menu.setMenuItems(s),this.menu.addLocalHook("beforeOpen",()=>this.onMenuBeforeOpen()),this.menu.addLocalHook("afterOpen",()=>this.onMenuAfterOpen()),this.menu.addLocalHook("afterClose",()=>this.onMenuAfterClose()),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];return e.executeCommand.call(e,...i)}),P(s,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),super.disablePlugin()}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>this.onTableClick(e))}open(e){this.menu&&(this.menu.open(),e.width&&this.menu.setOffset("left",e.width),this.menu.setPosition(e))}close(){this.menu&&this.menu.close()}executeCommand(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}onTableClick(e){if(e.stopPropagation(),Oe(e.target,Dp)&&!this.menu.isOpened()){let t=0,r=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){const{frameElement:o}=this.hot.rootWindow,{top:i,left:l}=o.getBoundingClientRect();t=i,r=l}const s=e.target.getBoundingClientRect();this.open({left:s.left+r,top:s.top+e.target.offsetHeight+3+t,width:s.width,height:s.height})}}onAfterGetColHeader(e,t){const r=t.parentNode;if(!r)return;const s=r.parentNode.childNodes,o=Array.prototype.indexOf.call(s,r);if(e<0||o!==s.length-1)return;const i=t.querySelector(`.${Dp}`);if(this.enabled&&i)return;if(!this.enabled){i&&i.parentNode.removeChild(i);return}const l=this.hot.rootDocument.createElement("button");l.className=Dp,l.type="button",l.onclick=function(){return!1},t.firstChild.insertBefore(l,t.firstChild.firstChild)}onMenuBeforeOpen(){this.hot.runHooks("beforeDropdownMenuShow",this)}onMenuAfterOpen(){this.hot.runHooks("afterDropdownMenuShow",this)}onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}Yg.SEPARATOR={name:Fe};class N5{constructor(e){this.hot=e,this.options={}}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:t,endRow:r,endCol:s}=this._getDataRange(),o=this.options,i=[];return Ce(e,r,l=>{const a=[];!o.exportHiddenRows&&this._isHiddenRow(l)||(Ce(t,s,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||a.push(this.hot.getDataAtCell(l,u))}),i.push(a))}),i}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:t,endRow:r}=this._getDataRange(),s=this.hot.getRowHeader();Ce(t,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(s[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:t,endCol:r}=this._getDataRange(),s=this.hot.getColHeader();Ce(t,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(s[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,t=this.hot.countRows()-1;let[r=0,s=0,o=t,i=e]=this.options.range;return r=Math.max(r,0),s=Math.max(s,0),o=Math.min(o,t),i=Math.min(i,e),{startRow:r,startCol:s,endRow:o,endCol:i}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}class X0{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,t){this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let t=Fn(this.constructor.DEFAULT_OPTIONS);const r=new Date;return t=Ut(Fn(X0.DEFAULT_OPTIONS),t),t=Ut(t,e),t.filename=UI(t.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),t}}const L5="\r",F5='"',V5=`
`;class $5 extends X0{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,t=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const s=r.length>0,o=this.dataProvider.getRowHeaders(),i=o.length>0;let l=e.bom?"\uFEFF":"";return s&&(r=Ve(r,a=>this._escapeCell(a,!0)),i&&(l+=e.columnDelimiter),l+=r.join(e.columnDelimiter),l+=e.rowDelimiter),P(t,(a,u)=>{u>0&&(l+=e.rowDelimiter),i&&(l+=this._escapeCell(o[u])+e.columnDelimiter),l+=a.map(c=>this._escapeCell(c)).join(e.columnDelimiter)}),l}_escapeCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=Lt(e);return r!==""&&(t||r.indexOf(L5)>=0||r.indexOf(F5)>=0||r.indexOf(V5)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`),r}}const B5="csv",qC={[B5]:$5};function W5(n,e,t){return typeof qC[n]=="function"?new qC[n](e,t):null}const U5="exportFile",z5=240;class Y5 extends nt{static get PLUGIN_KEY(){return U5}static get PLUGIN_PRIORITY(){return z5}isEnabled(){return!0}exportAsString(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,t).export()}exportAsBlob(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}downloadFile(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:s}=this.hot,o=this._createTypeFormatter(e,t),i=this._createBlob(o),l=s.URL||s.webkitURL,a=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(a.download!==void 0){const c=l.createObjectURL(i);a.style.display="none",a.setAttribute("href",c),a.setAttribute("download",u),r.body.appendChild(a),a.dispatchEvent(new MouseEvent("click")),r.body.removeChild(a),setTimeout(()=>{l.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(i,u)}_createTypeFormatter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!qC[e])throw new Error(`Export format type "${e}" is not supported.`);return W5(e,new N5(this.hot),t)}_createBlob(e){let t=null;return typeof Blob<"u"&&(t=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),t}}class Oc{constructor(e,t){let{id:r,stateless:s=!0}=t;this.hot=e,this.id=r,this.elements=[],this.hidden=!1,this.stateId=`Filters.component.${this.id}`,this.state=s?null:this.hot.columnIndexMapper.registerMap(this.stateId,new pg)}reset(){P(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),P(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}at(Oc,An);const tc={};function ko(n,e){if(!tc[n])throw Error(`Filter condition "${n}" does not exist.`);const{condition:t,descriptor:r}=tc[n];let s=e;return r.inputValuesDecorator&&(s=r.inputValuesDecorator(s)),function(o){return t.apply(o.meta.instance,[].concat([o],[s]))}}function fi(n){if(!tc[n])throw Error(`Filter condition "${n}" does not exist.`);return tc[n].descriptor}function Ft(n,e,t){t.key=n,tc[n]={condition:e,descriptor:t}}const Qt="none";function j5(){return!0}Ft(Qt,j5,{name:wg,inputsCount:0,showOperators:!1});const wu="empty";function G5(n){return Xt(n.value)}Ft(wu,G5,{name:ZS,inputsCount:0,showOperators:!0});const gd="not_empty";function K5(n,e){return!ko(wu,e)(n)}Ft(gd,K5,{name:JS,inputsCount:0,showOperators:!0});const Cu="eq";function X5(n,e){let[t]=e;return Lt(n.value).toLocaleLowerCase(n.meta.locale)===Lt(t)}Ft(Cu,X5,{name:e0,inputsCount:1,showOperators:!0});const md="neq";function q5(n,e){return!ko(Cu,e)(n)}Ft(md,q5,{name:t0,inputsCount:1,showOperators:!0});const NA="gt";function Q5(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value>r}Ft(NA,Q5,{name:i0,inputsCount:1,showOperators:!0});const LA="gte";function Z5(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value>=r}Ft(LA,Z5,{name:l0,inputsCount:1,showOperators:!0});const FA="lt";function J5(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value<r}Ft(FA,J5,{name:a0,inputsCount:1,showOperators:!0});const VA="lte";function e9(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value<=r}Ft(VA,e9,{name:u0,inputsCount:1,showOperators:!0});const q0="date_after";function t9(n,e){let[t]=e;const r=J(n.value,n.meta.dateFormat),s=J(t,n.meta.dateFormat);return!r.isValid()||!s.isValid()?!1:r.diff(s)>=0}Ft(q0,t9,{name:d0,inputsCount:1,showOperators:!0});const Q0="date_before";function n9(n,e){let[t]=e;const r=J(n.value,n.meta.dateFormat),s=J(t,n.meta.dateFormat);return!r.isValid()||!s.isValid()?!1:r.diff(s)<=0}Ft(Q0,n9,{name:f0,inputsCount:1,showOperators:!0});const gf="between";function r9(n,e){let[t,r]=e,s=t,o=r;if(n.meta.type==="numeric"){const i=parseFloat(s,10),l=parseFloat(o,10);s=Math.min(i,l),o=Math.max(i,l)}else if(n.meta.type==="date"){const i=ko(Q0,[o]),l=ko(q0,[s]);return i(n)&&l(n)}return n.value>=s&&n.value<=o}Ft(gf,r9,{name:c0,inputsCount:2,showOperators:!0});const $A="not_between";function s9(n,e){return!ko(gf,e)(n)}Ft($A,s9,{name:h0,inputsCount:2,showOperators:!0});const BA="begins_with";function o9(n,e){let[t]=e;return Lt(n.value).toLocaleLowerCase(n.meta.locale).startsWith(Lt(t))}Ft(BA,o9,{name:n0,inputsCount:1,showOperators:!0});const WA="ends_with";function i9(n,e){let[t]=e;return Lt(n.value).toLocaleLowerCase(n.meta.locale).endsWith(Lt(t))}Ft(WA,i9,{name:r0,inputsCount:1,showOperators:!0});const Z0="contains";function l9(n,e){let[t]=e;return Lt(n.value).toLocaleLowerCase(n.meta.locale).indexOf(Lt(t))>=0}Ft(Z0,l9,{name:s0,inputsCount:1,showOperators:!0});const UA="not_contains";function a9(n,e){return!ko(Z0,e)(n)}Ft(UA,a9,{name:o0,inputsCount:1,showOperators:!0});const zA="date_tomorrow";function u9(n){const e=J(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(J().subtract(-1,"days").startOf("day"),"d"):!1}Ft(zA,u9,{name:m0,inputsCount:0});const YA="date_today";function c9(n){const e=J(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(J().startOf("day"),"d"):!1}Ft(YA,c9,{name:g0,inputsCount:0});const jA="date_yesterday";function h9(n){const e=J(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(J().subtract(1,"days").startOf("day"),"d"):!1}Ft(jA,h9,{name:p0,inputsCount:0});ej();function d9(n,e){let t=n;return t===""&&(t=`(${e})`),t}const QC=new Set([1]).has(1),f9=QC&&typeof Array.from=="function";function Ic(n){let e=n;return QC&&(e=new Set(e)),function(t){let r;return QC?r=e.has(t):r=!!~e.indexOf(t),r}}function GA(n){return n??""}function ZC(n){let e=n;return f9?e=Array.from(new Set(e)):e=$I(e),e=e.sort((t,r)=>typeof t=="number"&&typeof r=="number"?t-r:t===r?0:t>r?1:-1),e}function a1(n,e,t,r){const s=[],o=n===e;let i;return o||(i=Ic(e)),P(n,l=>{let a=!1;(o||i(l))&&(a=!0);const u={checked:a,value:l,visualValue:d9(l,t)};r&&r(u),s.push(u)}),s}const gi="by_value";function g9(n,e){let[t]=e;return t(n.value)}Ft(gi,g9,{name:"By value",inputsCount:0,inputValuesDecorator(n){let[e]=n;return[Ic(e)]},showOperators:!1});const nc={};function m9(n){if(!nc[n])throw Error(`Operation with id "${n}" does not exist.`);const e=nc[n].func;return function(t,r){return e(t,r)}}function p9(n){return nc[n].name}function J0(n,e,t){nc[n]={name:e,func:t}}const Ao="conjunction",w9=y0;function C9(n,e){return n.every(t=>t.func(e))}J0(Ao,w9,C9);const mf="disjunction",y9=Cg;function v9(n,e){return n.some(t=>t.func(e))}J0(mf,y9,v9);const eR="disjunctionWithExtraCondition",S9=Cg;function R9(n,e){if(n.length<3)throw Error("Operation doesn't work on less then three conditions.");return n.slice(0,n.length-1).some(t=>t.func(e))&&n[n.length-1].func(e)}J0(eR,S9,R9);const b9="numeric",KA="text",E9="date",u1={[b9]:[Qt,Fe,wu,gd,Fe,Cu,md,Fe,NA,LA,FA,VA,gf,$A],[KA]:[Qt,Fe,wu,gd,Fe,Cu,md,Fe,BA,WA,Fe,Z0,UA],[E9]:[Qt,Fe,wu,gd,Fe,Cu,md,Fe,Q0,q0,gf,Fe,zA,YA,jA]};function T9(n){const e=[];let t=n;return u1[t]||(t=KA),P(u1[t],r=>{let s;r===Fe?s={name:Fe}:s=Fn(fi(r)),e.push(s)}),e}const kp="built",Np="building",c1=["click","input","keydown","keypress","keyup","focus","blur","change"];let Fs=class XA{static get DEFAULTS(){return Fn({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,t){this.hot=e,this.eventManager=new It(this),this.options=Ut(XA.DEFAULTS,t),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Np?this._element:this.buildState===kp?(this.update(),this._element):(this.buildState=Np,this.build(),this.buildState=kp,this._element)}isBuilt(){return this.buildState===kp}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Pn)?this.hot.getTranslatedPhrase(e):e}build(){const e=(t,r)=>{this.eventManager.addEventListener(t,r,s=>this.runLocalHooks(r,s,this))};if(this.buildState||(this.buildState=Np),this.options.className&&ee(this._element,this.options.className),this.options.children.length)P(this.options.children,t=>this._element.appendChild(t.element));else if(this.options.wrapIt){const t=this.hot.rootDocument.createElement(this.options.tagName);Be(this.options,(r,s)=>{t[s]!==void 0&&s!=="className"&&s!=="tagName"&&s!=="children"&&(t[s]=this.translateIfPossible(r))}),this._element.appendChild(t),P(c1,r=>e(t,r))}else P(c1,t=>e(this._element,t))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};at(Fs,An);const xh=new WeakMap;class Po extends Fs{static get DEFAULTS(){return Fn({placeholder:"",type:"text",tagName:"input"})}constructor(e,t){super(e,Ut(Po.DEFAULTS,t)),xh.set(this,{}),this.registerHooks()}registerHooks(){this.addLocalHook("click",()=>this.onClick()),this.addLocalHook("keyup",e=>this.onKeyup(e))}build(){super.build();const e=xh.get(this),t=this.hot.rootDocument.createElement("div");e.input=this._element.firstChild,ee(this._element,"htUIInput"),ee(t,"htUIInputIcon"),this._element.appendChild(t),this.update()}update(){if(!this.isBuilt())return;const e=xh.get(this).input;e.type=this.options.type,e.placeholder=this.translateIfPossible(this.options.placeholder),e.value=this.translateIfPossible(this.options.value)}focus(){this.isBuilt()&&xh.get(this).input.focus()}onClick(){}onKeyup(e){this.options.value=e.target.value}}const Ah=new WeakMap;class pf extends Fs{static get DEFAULTS(){return Fn({className:"htUISelect",wrapIt:!1})}constructor(e,t){super(e,Ut(pf.DEFAULTS,t)),Ah.set(this,{}),this.menu=null,this.items=[],this.registerHooks()}registerHooks(){this.addLocalHook("click",()=>this.onClick())}setItems(e){this.items=this.translateNames(e),this.menu&&this.menu.setMenuItems(this.items)}translateNames(e){return P(e,t=>{t.name=this.translateIfPossible(t.name)}),e}build(){super.build(),this.menu=new da(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);const e=new Fs(this.hot,{className:"htUISelectCaption"}),t=new Fs(this.hot,{className:"htUISelectDropdown"}),r=Ah.get(this);r.caption=e,r.captionElement=e.element,r.dropdown=t,P([e,t],s=>this._element.appendChild(s.element)),this.menu.addLocalHook("select",s=>this.onMenuSelect(s)),this.menu.addLocalHook("afterClose",()=>this.onMenuClosed()),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=this.menu.hot.getTranslatedPhrase(wg),Ah.get(this).captionElement.textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}))}closeOptions(){this.menu&&this.menu.close()}onMenuSelect(e){e.name!==Fe&&(this.options.value=e,this.update(),this.runLocalHooks("select",this.options.value))}onMenuClosed(){this.runLocalHooks("afterClose")}onClick(){this.openOptions()}destroy(){this.menu&&(this.menu.destroy(),this.menu=null);const{caption:e,dropdown:t}=Ah.get(this);e&&e.destroy(),t&&t.destroy(),super.destroy()}}class Lp extends Oc{constructor(e,t){super(e,{id:t.id,stateless:!1}),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new pf(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new Po(this.hot,{placeholder:T0})),this.elements.push(new Po(this.hot,{placeholder:M0})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>this.onConditionSelect(e)),this.getSelectElement().addLocalHook("afterClose",()=>this.onSelectUIClosed()),P(this.getInputElements(),e=>{e.addLocalHook("keydown",t=>this.onInputKeyDown(t))})}setState(e){if(this.reset(),!e)return;const t=Fn(e.command);t.name.startsWith(xt)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),P(e.args,(r,s)=>{if(s>t.inputsCount-1)return!1;const o=this.getInputElement(s);o.setValue(r),o[t.inputsCount>s?"show":"hide"](),s||setTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||fi(Qt),t=[];return P(this.getInputElements(),(r,s)=>{e.inputsCount>s&&t.push(r.getValue())}),{command:e,args:t}}updateState(e,t){const r=fi(e?e.name:Qt);this.state.setValueAtIndex(t,{command:r,args:e?e.args:[]}),e||P(this.getInputElements(),s=>s.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof pf)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Po)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,r,s,o,i)=>{ee(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&ee(t.parentNode,"border");const l=this.hot.rootDocument.createElement("div");return ee(l,"htFiltersMenuLabel"),l.textContent=i,t.appendChild(l),t.parentNode.hasAttribute("ghost-table")||P(this.elements,a=>t.appendChild(a.element)),t}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let t=[fi(Qt)];if(e!==null){const{visualIndex:r}=e;t=T9(this.hot.getDataType(0,r,this.hot.countRows(),r))}P(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}onConditionSelect(e){P(this.getInputElements(),(t,r)=>{t[e.inputsCount>r?"show":"hide"](),r===0&&setTimeout(()=>t.focus(),10)}),this.runLocalHooks("change",e)}onSelectUIClosed(){this.runLocalHooks("afterClose")}onInputKeyDown(e){Gu(e.keyCode,"ENTER")?(this.runLocalHooks("accept"),ds(e)):Gu(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),ds(e))}}const Ph=new WeakMap;class wf extends Fs{static get DEFAULTS(){return Fn({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,t){super(e,Ut(wf.DEFAULTS,t)),Ph.set(this,{})}build(){super.build();const e=Ph.get(this);e.input=this._element.firstChild;const t=this.hot.rootDocument.createElement("label");t.textContent=this.translateIfPossible(this.options.label.textContent),t.htmlFor=this.translateIfPossible(this.options.label.htmlFor),e.label=t,this._element.appendChild(t),this.update()}update(){if(!this.isBuilt())return;const e=Ph.get(this);e.input.checked=this.options.checked,e.label.textContent=this.translateIfPossible(this.options.label.textContent)}isChecked(){return this.options.checked}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=e,this.update()}focus(){this.isBuilt()&&Ph.get(this).input.focus()}}const h1=0;class M9 extends Oc{constructor(e,t){super(e,{id:t.id,stateless:!1}),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(ee(t.parentNode,"htFiltersMenuOperators"),t.parentNode.hasAttribute("ghost-table")||P(this.elements,r=>t.appendChild(r.element)),t)}}buildOperatorsElement(){const e=[Ao,mf];P(e,t=>{const r=new wf(this.hot,{name:"operator",label:{htmlFor:t,textContent:p9(t)},value:t,checked:t===e[h1],id:t});r.addLocalHook("change",s=>this.onRadioInputChange(s)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(ot`Radio button with index ${e} doesn't exist.`);P(this.elements,(t,r)=>{t.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(t=>t instanceof wf&&t.isChecked());return e?e.getValue():Ao}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&P(this.elements,t=>{t.setChecked(t.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ao,t=arguments.length>1?arguments[1]:void 0,r=e;r===eR&&(r=mf),this.state.setValueAtIndex(t,r)}reset(){this.setChecked(h1)}onRadioInputChange(e){this.setState(e.target.value)}}const Fp=new WeakMap;class Cf extends Fs{static get DEFAULTS(){return Fn({href:"#",tagName:"a"})}constructor(e,t){super(e,Ut(Cf.DEFAULTS,t)),Fp.set(this,{})}build(){super.build();const e=Fp.get(this);e.link=this._element.firstChild}update(){this.isBuilt()&&(Fp.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}const _9=new WeakMap,O9="multipleSelect.itemBox";class yf extends Fs{static get DEFAULTS(){return Fn({className:"htUIMultipleSelect",value:[]})}constructor(e,t){super(e,Ut(yf.DEFAULTS,t)),_9.set(this,{}),this.searchInput=new Po(this.hot,{placeholder:E0,className:"htUIMultipleSelectSearch"}),this.selectAllUI=new Cf(this.hot,{textContent:v0,className:"htUISelectAll"}),this.clearAllUI=new Cf(this.hot,{textContent:S0,className:"htUIClearAll"}),this.items=[],this.itemsBox=null,this.registerHooks()}registerHooks(){this.searchInput.addLocalHook("keydown",e=>this.onInputKeyDown(e)),this.searchInput.addLocalHook("input",e=>this.onInput(e)),this.selectAllUI.addLocalHook("click",e=>this.onSelectAllClick(e)),this.clearAllUI.addLocalHook("click",e=>this.onClearAllClick(e))}setItems(e){this.items=e,this.itemsBox&&this.itemsBox.loadData(this.items)}setLocale(e){this.locale=e}getLocale(){return this.locale}getItems(){return[...this.items]}getValue(){return x9(this.items)}isSelectedAllValues(){return this.items.length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,t=e.createElement("div"),r=new Fs(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(r.element),this._element.appendChild(t);const s=o=>{if(!this._element)return;this.itemsBox&&this.itemsBox.destroy(),ee(o,"htUIMultipleSelectHot"),this.itemsBox=new this.hot.constructor(o,{data:this.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(a,u,c,d,f,m)=>{a.title=m.instance.getDataAtRowProp(u,m.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>this.itemsBox.container.scrollWidth-en(e),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"}),this.itemsBox.init(),this.itemsBox.getShortcutManager().getContext("grid").addShortcut({keys:[["Escape"]],callback:a=>{this.runLocalHooks("keydown",a,this)},group:O9})};s(t),setTimeout(()=>s(t),100)}reset(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}update(){this.isBuilt()&&(this.itemsBox.loadData(I9(this.items,this.options.value)),super.update())}destroy(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,super.destroy()}onInput(e){const t=e.target.value.toLocaleLowerCase(this.getLocale());let r;t===""?r=[...this.items]:r=yr(this.items,s=>`${s.value}`.toLocaleLowerCase(this.getLocale()).indexOf(t)>=0),this.itemsBox.loadData(r)}onInputKeyDown(e){this.runLocalHooks("keydown",e,this),XI(Gu,e.keyCode)("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(ds(e),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}onSelectAllClick(e){const t=[];e.preventDefault(),P(this.itemsBox.getSourceData(),(r,s)=>{r.checked=!0,t.push(yT(r,s)[0])}),this.itemsBox.setSourceDataAtCell(t)}onClearAllClick(e){const t=[];e.preventDefault(),P(this.itemsBox.getSourceData(),(r,s)=>{r.checked=!1,t.push(yT(r,s)[0])}),this.itemsBox.setSourceDataAtCell(t)}}function I9(n,e){const t=Ic(e);return Ve(n,r=>(r.checked=t(r.value),r))}function x9(n){const e=[];return P(n,t=>{t.checked&&e.push(t.value)}),e}class A9 extends Oc{constructor(e,t){super(e,{id:t.id,stateless:!1}),this.name=t.name,this.elements.push(new yf(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>this.onInputKeyDown(e))}setState(e){if(this.reset(),e&&e.command.key===gi){const t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?Qt:gi},args:[e.getValue()],itemsSnapshot:t}}updateState(e){const t=(r,s,o,i,l)=>{const[a]=yr(s,d=>d.name===gi),u={},c=this.hot.getTranslatedPhrase(lf);if(a){const d=ZC(Ve(i(r,l),w=>w.value));o&&(a.args[0]=o);const f=[],m=a1(d,a.args[0],c,w=>{w.checked&&f.push(w.value)}),p=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,p).locale,u.args=[f],u.command=fi(gi),u.itemsSnapshot=m}else u.args=[],u.command=fi(Qt);this.state.setValueAtIndex(r,u)};t(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&t(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof yf)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,r,s,o,i)=>{ee(t.parentNode,"htFiltersMenuValue");const l=this.hot.rootDocument.createElement("div");return ee(l,"htFiltersMenuLabel"),l.textContent=i,t.appendChild(l),t.parentNode.hasAttribute("ghost-table")||P(this.elements,a=>t.appendChild(a.element)),t}}}reset(){const e=this.hot.getTranslatedPhrase(lf),t=ZC(this._getColumnVisibleValues()),r=a1(t,t,e);this.getMultipleSelectElement().setItems(r),super.reset(),this.getMultipleSelectElement().setValue(t);const s=this.hot.getPlugin("filters").getSelectedColumn();s!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,s.visualIndex).locale)}onInputKeyDown(e){Gu(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),ds(e))}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Ve(this.hot.getDataAtCol(e.visualIndex),t=>GA(t))}}class yu extends Oc{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,t){super(e,{id:t.id,stateless:!0}),this.name=t.name,this.elements.push(new Po(this.hot,{type:"button",value:R0,className:"htUIButton htUIButtonOK",identifier:yu.BUTTON_OK})),this.elements.push(new Po(this.hot,{type:"button",value:b0,className:"htUIButton htUIButtonCancel",identifier:yu.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){P(this.elements,e=>{e.addLocalHook("click",(t,r)=>this.onButtonClick(t,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(ee(t.parentNode,"htFiltersMenuActionBar"),t.parentNode.hasAttribute("ghost-table")||P(this.elements,r=>t.appendChild(r.element)),t)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}onButtonClick(e,t){t.options.identifier===yu.BUTTON_OK?this.accept():this.cancel()}}const d1="ConditionCollection.filteringStates";class tR{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.hot=e,this.isMapRegistrable=t,this.filteringStates=new pg,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(d1,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,t){var r;const s=this.filteringStates.getValueAtIndex(t),o=(r=s==null?void 0:s.conditions)!==null&&r!==void 0?r:[],i=s==null?void 0:s.operation;return this.isMatchInConditions(o,e,i)}isMatchInConditions(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ao;return e.length?m9(r)(e,t):!0}addCondition(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ao,s=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,i=Ve(t.args,c=>typeof c=="string"?c.toLocaleLowerCase(o):c),l=t.name||t.command.key;this.runLocalHooks("beforeAdd",e);const a=this.getOperation(e);if(a){if(a!==r)throw Error(ot`The column of index ${e} has been already applied with a \`${a}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(dt(nc[r]))throw new Error(ot`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:l,args:i,func:ko(l,i)}]},s):u.push({name:l,args:i,func:ko(l,i)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var t,r;return(t=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&t!==void 0?t:[]}getOperation(e){var t;return(t=this.filteringStates.getValueAtIndex(e))===null||t===void 0?void 0:t.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[t]=e;return t})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return Sn(this.filteringStates.getEntries(),(e,t)=>{let[r,{operation:s,conditions:o}]=t;return e.push({column:r,operation:s,conditions:Ve(o,i=>{let{name:l,args:a}=i;return{name:l,args:a}})}),e},[])}importAllConditions(e){this.clean(),P(e,t=>{P(t.conditions,r=>this.addCondition(t.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){const r=this.getConditions(e);return t?r.some(s=>s.name===t):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(d1),this.filteringStates=null,this.clearLocalHooks()}}at(tR,An);class qA{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];this.conditionCollection=e,this.columnDataFactory=t}filter(){let e=[];return P(this.conditionCollection.getFilteredColumns(),(t,r)=>{let s=this.columnDataFactory(t);r&&(s=this._getIntersectData(s,e)),e=this.filterByColumn(t,s)}),e}filterByColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return P(t,s=>{s!==void 0&&this.conditionCollection.isMatch(s,e)&&r.push(s)}),r}_getIntersectData(e,t){const r=[];return P(t,s=>{const o=s.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}class QA{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];this.hot=e,this.conditionCollection=t,this.columnDataFactory=r,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",s=>this._onConditionBeforeModify(s)),this.conditionCollection.addLocalHook("afterRemove",s=>this.updateStatesAtColumn(s)),this.conditionCollection.addLocalHook("afterAdd",s=>this.updateStatesAtColumn(s)),this.conditionCollection.addLocalHook("beforeClean",()=>this._onConditionBeforeClean()),this.conditionCollection.addLocalHook("afterClean",()=>this._onConditionAfterClean())}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,P(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}_onConditionBeforeModify(e){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(e)}updateStatesAtColumn(e,t){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const s=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const i=s.slice(0,o),l=s.slice(o);l.length&&l[0].column===e&&l.shift();const a=pz(function(c,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const m=new tR(r.hot,!1),p=[].concat(c,f);m.importAllConditions(p);const w=r.columnDataFactory(d);let M;m.isEmpty()?M=w:M=new qA(m,y=>r.columnDataFactory(y)).filter(),M=Ve(M,y=>y.meta.visualRow);const S=Ic(M);return m.destroy(),yr(w,y=>S(y.meta.visualRow))})(i),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:l,filteredRowsFactory:a,conditionArgsChange:t})}_onConditionBeforeClean(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}_onConditionAfterClean(){P(this.latestOrderStack,e=>{this.updateStatesAtColumn(e)})}destroy(){this.clearLocalHooks(),Be(this,(e,t)=>{this[t]=null})}}at(QA,An);const f1="filters",P9=250;class H9 extends nt{static get PLUGIN_KEY(){return f1}static get PLUGIN_PRIORITY(){return P9}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),this.eventManager=new It(this),this.dropdownMenuPlugin=null,this.conditionCollection=null,this.conditionUpdateObserver=null,this.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),this.filtersRowsMap=null,this.hot.addHook("afterGetColHeader",(t,r)=>this.onAfterGetColHeader(t,r))}isEnabled(){return!!this.hot.getSettings()[f1]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Sc),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,t=e&&e.uiContainer||this.hot.rootDocument.body,r=i=>(i.addLocalHook("accept",()=>this.onActionBarSubmit("accept")),i.addLocalHook("cancel",()=>this.onActionBarSubmit("cancel")),i.addLocalHook("change",l=>this.onComponentChange(i,l)),i),s=()=>`${this.hot.getTranslatedPhrase(w0)}:`,o=()=>`${this.hot.getTranslatedPhrase(C0)}:`;if(!this.components.get("filter_by_condition")){const i=new Lp(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:t});i.addLocalHook("afterClose",()=>this.onSelectUIClosed()),this.components.set("filter_by_condition",r(i))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new M9(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const i=new Lp(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:t});i.addLocalHook("afterClose",()=>this.onSelectUIClosed()),this.components.set("filter_by_condition2",r(i))}this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new A9(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new yu(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new tR(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new QA(this.hot,this.conditionCollection,i=>this.getDataMapAtColumn(i)),this.conditionUpdateObserver.addLocalHook("update",i=>this.updateComponents(i))),this.components.forEach(i=>i.show()),this.addHook("beforeDropdownMenuSetItems",i=>this.onBeforeDropdownMenuSetItems(i)),this.addHook("afterDropdownMenuDefaultOptions",i=>this.onAfterDropdownMenuDefaultOptions(i)),this.addHook("afterDropdownMenuShow",()=>this.onAfterDropdownMenuShow()),this.addHook("afterDropdownMenuHide",()=>this.onAfterDropdownMenuHide()),this.addHook("afterChange",i=>this.onAfterChange(i)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((t,r)=>{t.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}super.disablePlugin()}addCondition(e,t,r){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Ao;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:t},args:r},s)}removeConditions(e){const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}filter(){const e=this._createDataFilter(),t=!this.conditionCollection.isEmpty();let r=[];const s=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",s)!==!1)if(t){const i=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),r=Ve(e.filter(),a=>a.meta.visualRow);const l=Ic(r);Ce(this.hot.countSourceRows()-1,a=>{l(a)||i.push(a)}),P(i,a=>{this.filtersRowsMap.setValueAtIndex(a,!0)})},!0),r.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",s),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}getSelectedColumn(){var e;const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}clearColumnSelection(){const e=this.getSelectedColumn();e!==null&&this.hot.selectCell(0,e.visualIndex)}getDataMapAtColumn(e){const t=this.hot.toVisualColumn(e),r=[];return P(this.hot.getSourceDataAtCol(t),(s,o)=>{var i;const{row:l,col:a,visualCol:u,visualRow:c,type:d,instance:f,dateFormat:m,locale:p}=this.hot.getCellMeta(o,t),w=(i=this.hot.getDataAtCell(this.hot.toVisualRow(o),t))!==null&&i!==void 0?i:s;r.push({meta:{row:l,col:a,visualCol:u,visualRow:c,type:d,instance:f,dateFormat:m,locale:p},value:GA(w)})}),r}onAfterChange(e){e&&P(e,t=>{const[,r]=t,s=this.hot.propToCol(r);this.conditionCollection.hasConditions(s)&&this.updateValueComponentCondition(s)})}updateValueComponentCondition(e){const t=this.hot.getDataAtCol(e),r=ZC(t);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var t;const r=(t=this.getSelectedColumn())===null||t===void 0?void 0:t.physicalIndex;e.forEach(s=>{s.isHidden()||s.restoreState(r)}),this.updateDependentComponentsVisibility()}onAfterDropdownMenuShow(){this.restoreComponents(Array.from(this.components.values()))}onAfterDropdownMenuHide(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}onBeforeDropdownMenuSetItems(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",()=>{this.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}onAfterDropdownMenuDefaultOptions(e){e.items.push({name:Fe}),this.components.forEach(t=>{e.items.push(t.getMenuItemDescriptor())})}getOperationBasedOnArguments(e,t,r,s){let o=e;return o===mf&&t.command.key!==Qt&&r.command.key!==Qt&&s.command.key!==Qt?o=eR:s.command.key!==Qt&&(t.command.key===Qt||r.command.key===Qt)&&(o=Ao),o}onActionBarSubmit(e){var t;if(e==="accept"){const s=this.getSelectedColumn();if(s===null){var r;(r=this.dropdownMenuPlugin)===null||r===void 0||r.close();return}const{physicalIndex:o}=s,i=this.components.get("filter_by_condition").getState(),l=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),u=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),i,l,a);this.conditionUpdateObserver.groupChanges();let c=this.conditionCollection.getColumnStackPosition(o);c===-1&&(c=void 0),this.conditionCollection.removeConditions(o),i.command.key!==Qt&&(this.conditionCollection.addCondition(o,i,u,c),l.command.key!==Qt&&this.conditionCollection.addCondition(o,l,u,c)),a.command.key!==Qt&&this.conditionCollection.addCondition(o,a,u,c),this.conditionUpdateObserver.flush(),this.components.forEach(d=>d.saveState(o)),this.filtersRowsMap.clear(),this.filter()}(t=this.dropdownMenuPlugin)===null||t===void 0||t.close()}onComponentChange(e,t){this.updateDependentComponentsVisibility(),e.constructor===Lp&&!t.inputsCount&&this.setListeningDropdownMenu()}onSelectUIClosed(){this.setListeningDropdownMenu()}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:t}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...r):this.hideComponents(...r)}onAfterGetColHeader(e,t){const r=this.hot.toPhysicalColumn(e);this.enabled&&this.conditionCollection.hasConditions(r)?ee(t,"htFiltersActive"):He(t,"htFiltersActive")}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new qA(e,t=>this.getDataMapAtColumn(t))}updateComponents(e){var t;if(!((t=this.dropdownMenuPlugin)!==null&&t!==void 0&&t.enabled))return;const{editedConditionStack:{conditions:r,column:s}}=e,o=r.filter(l=>l.name===gi),i=r.filter(l=>l.name!==gi);if(o.length>=2||i.length>=3)ct(ot`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const l=this.conditionCollection.getOperation(s);this.components.get("filter_by_condition").updateState(i[0],s),this.components.get("filter_by_condition2").updateState(i[1],s),this.components.get("filter_operators").updateState(l,s),this.components.get("filter_by_value").updateState(e)}}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const t=this.dropdownMenuPlugin.menu;for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return P(s,i=>{P(t.menuItems,(l,a)=>{l.key===i.getMenuItemDescriptor().key&&e.push(a)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,s=r.getPlugin("hiddenRows");for(var o=arguments.length,i=new Array(o>1?o-1:0),l=1;l<o;l++)i[l-1]=arguments[l];const a=this.getIndexesOfComponents(...i);e?s.showRows(a):s.hideRows(a),r.render()}hideComponents(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach((e,t)=>{e!==null&&(e.destroy(),this.components.set(t,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}const ZA="internal-use-in-handsontable",JC={licenseKey:ZA,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function JA(n){var e;return{maxColumns:n.maxColumns,maxRows:n.maxRows,language:(e=n[fn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function eP(n){return Object.keys(n).reduce((e,t)=>(t!=="hyperformula"&&(e[t]=n[t]),e),{})}function D9(n){var e;const t=n[fn],r=eP(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),s=JA(n);return{...JC,...r,...s}}function k9(n){var e;const t=n[fn],r=eP(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),s=JA(n);return{...r,...s}}function N9(n,e){return Object.keys(e).some(t=>e[t]!==void 0&&e[t]!==n[t])}function jg(){const n="engine_relationship",e=br(fn);return e.hasItem(n)||e.register(n,new Map),e.getItem(n)}function nR(){const n="shared_engine_usage",e=br(fn);return e.hasItem(n)||e.register(n,new Map),e.getItem(n)}function L9(n){const e=n.getSettings(),t=e[fn],r=t==null?void 0:t.engine;if(t===!0||dt(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var s;return F9((s=r.hyperformula)!==null&&s!==void 0?s:r,e,n)}else if(typeof r=="object"&&dt(r.hyperformula)){const o=jg(),i=nR().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(n),i&&i.push(n.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:ZA}),(r.getConfig().leapYear1900!==JC.leapYear1900||Lv(r.getConfig().nullDate,JC.nullDate)===!1)&&ct(ot`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function F9(n,e,t){const r=e[fn],s=D9(e),o=jg(),i=nR();V9(n,r.functions),$9(n,r.language);const l=n.buildEmpty(s);return o.set(l,[t]),i.set(l,[t.guid]),B9(l,r.namedExpressions),l.on("sheetAdded",()=>{l.rebuildAndRecalculate()}),l.on("sheetRemoved",()=>{l.rebuildAndRecalculate()}),l}function g1(n){var e;const t=jg(),r=t.size===0?[]:Array.from((e=t.get(n))!==null&&e!==void 0?e:[]);return new Map(r.map(s=>[s.getPlugin("formulas").sheetId,s]))}function m1(n,e){if(n){const t=jg(),r=t.get(n),s=nR(),o=s.get(n);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&t.delete(n)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(s.delete(n),n.destroy()))}}function V9(n,e){e&&e.forEach(t=>{const{name:r,plugin:s,translations:o}=t;try{n.registerFunction(r,s,o)}catch(i){ct(i.message)}})}function $9(n,e){if(e){const{langCode:t}=e;try{n.registerLanguage(t,e)}catch(r){ct(r.message)}}}function B9(n,e){e&&(n.suspendEvaluation(),e.forEach(t=>{const{name:r,expression:s,scope:o,options:i}=t;try{n.addNamedExpression(r,s,o,i)}catch(l){ct(l.message)}}),n.resumeEvaluation())}function W9(n,e){return(dt(e)||!n.doesSheetExist(e))&&(e=n.addSheet(e)),e}const tP="DD/MM/YYYY";function nP(n){return typeof n=="string"&&n.charAt(0)==="'"&&n.charAt(1)==="="}function U9(n){return nP(n)?n.substr(1):n}function z9(n){return typeof n=="string"&&n.startsWith("=")}function Vp(n,e){return typeof n=="string"&&e==="date"}function p1(n,e){return J(n,e,!0).isValid()}function w1(n,e){return J(n,e,!0).format(tP)}function Y9(n,e){return J(n,tP,!0).format(e)}function C1(n,e){const r=new Date(Date.UTC(0,0,n+-1));return J(r).format(e)}function Jo(n,e,t){j9(n,e),e.set(n,t)}function j9(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gt(n,e){var t=rP(n,e,"get");return G9(n,t)}function G9(n,e){return e.get?e.get.call(n):e.value}function to(n,e,t){var r=rP(n,e,"set");return K9(n,r,t),t}function rP(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function K9(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var Na=new WeakMap,no=new WeakMap,Un=new WeakMap,Hh=new WeakMap,$p=new WeakMap,Bp=new WeakMap,Dh=new WeakMap;class y1{constructor(e,t,r){Jo(this,Na,{writable:!0,value:void 0}),Jo(this,no,{writable:!0,value:void 0}),Jo(this,Un,{writable:!0,value:void 0}),Jo(this,Hh,{writable:!0,value:[]}),Jo(this,$p,{writable:!0,value:[]}),Jo(this,Bp,{writable:!0,value:void 0}),Jo(this,Dh,{writable:!0,value:[]}),to(this,Na,e),to(this,no,t),to(this,Un,r)}setRemovedHfIndexes(e){return to(this,Dh,e.map(t=>{const r=gt(this,no).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(r)})),gt(this,Dh)}getRemovedHfIndexes(){return gt(this,Dh)}getHfIndexFromVisualIndex(e){const t=gt(this,no).getIndexesSequence(),r=gt(this,no).getNotTrimmedIndexes();return t.indexOf(r[e])}syncMoves(e){const r=`move${Lr(gt(this,Na))}s`;gt(this,Un).getEngine().batch(()=>{e.forEach(s=>{const o=s.from!==s.to,i=s.from+1!==s.to;o&&i&&gt(this,Un).getEngine()[r](gt(this,Un).getSheetId(),s.from,1,s.to)})})}storeMovesInformation(e,t,r){r!==!1&&(to(this,$p,e.map(s=>this.getHfIndexFromVisualIndex(s))),to(this,Bp,this.getHfIndexFromVisualIndex(t)))}getMoveLine(e,t){const r=gt(this,no).getNumberOfIndexes(),s=Array.from(Array(r).keys()).filter(i=>e.includes(i)===!1);if(t===0){var o;return(o=s[t])!==null&&o!==void 0?o:0}return s[t-1]+1}getInitiallyCalculatedMoves(e,t){let r=this.getMoveLine(e,t);const s=[];return e.forEach(o=>{const i={from:o,to:r};s.forEach(l=>{const a=l.from>l.to,u=l.to<=i.from;l.from>i.from&&u&&a&&(i.from+=1)}),i.from>=r&&(r+=1),s.push(i)}),s}adjustedCalculatedMoves(e){return e.forEach((t,r)=>{e.slice(r+1).forEach(o=>{const i=o.from<o.to;o.from>t.from&&i&&(o.from-=1)})}),e}calculateAndSyncMoves(e,t){if(gt(this,Un).isPerformingUndoRedo()||e===!1||t===!1)return;const r=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(gt(this,$p),gt(this,Bp)));gt(this,Un).getSheetId()===null?gt(this,Un).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${Lr(gt(this,Na))}Order`;return t=>{if(gt(this,Un).isPerformingUndoRedo())return;const r=gt(this,no).getIndexesSequence();if(t==="update"){const s=gt(this,Hh).map(a=>r.indexOf(a)),o=gt(this,Un).getEngine().getSheetDimensions(gt(this,Un).getSheetId());let i;gt(this,Na)==="row"?i=o.height:i=o.width;const l=s.length;for(let a=l;a<i;a+=1)s.push(a);gt(this,Un).getEngine()[e](gt(this,Un).getSheetId(),s)}to(this,Hh,r)}}init(){to(this,Hh,gt(this,no).getIndexesSequence())}}function ei(n,e,t){X9(n,e),e.set(n,t)}function X9(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ss(n,e){var t=sP(n,e,"get");return q9(n,t)}function q9(n,e){return e.get?e.get.call(n):e.value}function ti(n,e,t){var r=sP(n,e,"set");return Q9(n,r,t),t}function sP(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function Q9(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var kh=new WeakMap,Nh=new WeakMap,Wp=new WeakMap,Up=new WeakMap,zp=new WeakMap,Yp=new WeakMap,jp=new WeakMap;class Z9{constructor(e,t,r){ei(this,kh,{writable:!0,value:void 0}),ei(this,Nh,{writable:!0,value:void 0}),ei(this,Wp,{writable:!0,value:void 0}),ei(this,Up,{writable:!0,value:!1}),ei(this,zp,{writable:!0,value:!1}),ei(this,Yp,{writable:!0,value:null}),ei(this,jp,{writable:!0,value:null}),ti(this,kh,new y1("row",e,this)),ti(this,Nh,new y1("column",t,this)),ti(this,Wp,r)}getForAxis(e){return e==="row"?Ss(this,kh):Ss(this,Nh)}setPerformUndo(e){ti(this,Up,e)}setPerformRedo(e){ti(this,zp,e)}isPerformingUndoRedo(){return Ss(this,Up)||Ss(this,zp)}getSheetId(){return Ss(this,jp)}getEngine(){return Ss(this,Yp)}getPostponeAction(){return Ss(this,Wp)}setupSyncEndpoint(e,t){ti(this,Yp,e),ti(this,jp,t),Ss(this,kh).init(),Ss(this,Nh).init()}}function sl(n,e,t){return e=J9(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function J9(n){var e=e7(n,"string");return typeof e=="symbol"?e:String(e)}function e7(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Gp(n,e,t){t7(n,e),e.set(n,t)}function t7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ro(n,e,t){var r=oP(n,e,"set");return n7(n,r,t),t}function n7(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function ol(n,e){var t=oP(n,e,"get");return r7(n,t)}function oP(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function r7(n,e){return e.get?e.get.call(n):e.value}const fn="formulas",s7=["maxRows","maxColumns","language"],o7=260;he.getSingleton().register("afterNamedExpressionAdded");he.getSingleton().register("afterNamedExpressionRemoved");he.getSingleton().register("afterSheetAdded");he.getSingleton().register("afterSheetRemoved");he.getSingleton().register("afterSheetRenamed");he.getSingleton().register("afterFormulasValuesUpdate");const il=n=>n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto";var Rs=new WeakMap,Kp=new WeakMap,La=new WeakMap;class i7 extends nt{constructor(){var e;super(...arguments),e=this,Gp(this,Rs,{writable:!0,value:!1}),Gp(this,Kp,{writable:!0,value:!1}),Gp(this,La,{writable:!0,value:[["valuesUpdated",function(){return e.onEngineValuesUpdated(...arguments)}],["namedExpressionAdded",function(){return e.onEngineNamedExpressionsAdded(...arguments)}],["namedExpressionRemoved",function(){return e.onEngineNamedExpressionsRemoved(...arguments)}],["sheetAdded",function(){return e.onEngineSheetAdded(...arguments)}],["sheetRenamed",function(){return e.onEngineSheetRenamed(...arguments)}],["sheetRemoved",function(){return e.onEngineSheetRemoved(...arguments)}]]}),sl(this,"staticRegister",br("formulas")),sl(this,"engine",null),sl(this,"sheetName",null),sl(this,"indexSyncer",null),sl(this,"rowAxisSyncer",null),sl(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return fn}static get PLUGIN_PRIORITY(){return o7}static get SETTING_KEYS(){return[fn,...s7]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[fn]}enablePlugin(){var e,t=this;if(!this.enabled){if(this.engine=(e=L9(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){ct("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&(this.sheetName=r)}this.addHook("beforeLoadData",function(){return t.onBeforeLoadData(...arguments)}),this.addHook("afterLoadData",function(){return t.onAfterLoadData(...arguments)}),this.addHook("beforeUpdateData",function(){return t.onBeforeLoadData(...arguments)}),this.addHook("afterUpdateData",function(){return t.onAfterLoadData(...arguments)}),this.addHook("modifyData",function(){return t.onModifyData(...arguments)}),this.addHook("modifySourceData",function(){return t.onModifySourceData(...arguments)}),this.addHook("beforeValidate",function(){return t.onBeforeValidate(...arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return t.onAfterSetSourceDataAtCell(...arguments)}),this.addHook("afterSetDataAtCell",function(){return t.onAfterSetDataAtCell(...arguments)}),this.addHook("afterSetDataAtRowProp",function(){return t.onAfterSetDataAtCell(...arguments)}),this.addHook("beforeCreateRow",function(){return t.onBeforeCreateRow(...arguments)}),this.addHook("beforeCreateCol",function(){return t.onBeforeCreateCol(...arguments)}),this.addHook("afterCreateRow",function(){return t.onAfterCreateRow(...arguments)}),this.addHook("afterCreateCol",function(){return t.onAfterCreateCol(...arguments)}),this.addHook("beforeRemoveRow",function(){return t.onBeforeRemoveRow(...arguments)}),this.addHook("beforeRemoveCol",function(){return t.onBeforeRemoveCol(...arguments)}),this.addHook("afterRemoveRow",function(){return t.onAfterRemoveRow(...arguments)}),this.addHook("afterRemoveCol",function(){return t.onAfterRemoveCol(...arguments)}),this.indexSyncer=new Z9(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,s,o,i)=>{this.rowAxisSyncer.storeMovesInformation(r,s,i)}),this.hot.addHook("beforeColumnMove",(r,s,o,i)=>{this.columnAxisSyncer.storeMovesInformation(r,s,i)}),this.hot.addHook("afterRowMove",(r,s,o,i,l)=>{this.rowAxisSyncer.calculateAndSyncMoves(i,l)}),this.hot.addHook("afterColumnMove",(r,s,o,i,l)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,l)}),this.hot.addHook("beforeColumnFreeze",(r,s)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,s)}),this.hot.addHook("afterColumnFreeze",(r,s)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.hot.addHook("beforeColumnUnfreeze",(r,s)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,s)}),this.hot.addHook("afterColumnUnfreeze",(r,s)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.addHook("afterCellMetaReset",function(){return t.onAfterCellMetaReset(...arguments)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){return t.onAfterDetachChild(...arguments)}),this.addHook("beforeAutofill",function(){return t.onBeforeAutofill(...arguments)}),ol(this,La).forEach(r=>{let[s,o]=r;return this.engine.on(s,o)}),super.enablePlugin()}}disablePlugin(){ol(this,La).forEach(e=>{let[t,r]=e;return this.engine.off(t,r)}),m1(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const t=k9(this.hot.getSettings());N9(this.engine.getConfig(),t)&&this.engine.updateConfig(t);const r=this.hot.getSettings()[fn];if(ue(r)&&ue(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const s=this.hot.getSettings()[fn].sheetName;s&&this.engine.doesSheetExist(s)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(s??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){ol(this,La).forEach(e=>{var t;let[r,s]=e;return(t=this.engine)===null||t===void 0?void 0:t.off(r,s)}),ro(this,La,null),m1(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if(ue(t)&&!p3(t))return ct("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return ct("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(r),t),r}catch(r){return ct(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){$v(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,`${Lr(fn)}.switchSheet`)}getCellType(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const s=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(t);return s!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(s=>{var o;const i=s==null||(o=s.address)===null||o===void 0?void 0:o.sheet;i!==void 0&&(r.has(i)||r.add(i))}),g1(this.engine).forEach((s,o)=>{if((t||o!==this.sheetId)&&r.has(o)){var i;s.render(),(i=s.view)===null||i===void 0||i.adjustElementsSize()}})}validateDependentCells(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var i;const{row:l,col:a,sheet:u}=(i=o==null?void 0:o.address)!==null&&i!==void 0?i:{};return ue(u)?`${u}:${l}x${a}`:""},s=new Set(t.map(o=>r(o)));e.forEach(o=>{var i,l;const{row:a,col:u}=(i=o.address)!==null&&i!==void 0?i:{};if(ue(a)===!1||ue(u)===!1||a>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(l=o.address)===null||l===void 0?void 0:l.sheet,d=r(o);if(c!==void 0&&!s.has(d)){const f=g1(this.engine).get(c);if(!f)return;f.validateCell(f.getDataAtCell(a,u),f.getCellMeta(a,u),()=>{})}})}syncChangeWithEngine(e,t,r){const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(s)){ct(`Not possible to set cell data at ${JSON.stringify(s)}`);return}const o=this.hot.getCellMeta(e,t);return Vp(r,o.type)&&(p1(r,o.dateFormat)?r=w1(r,o.dateFormat):z9(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(s,r)}onBeforeValidate(e,t,r){const s=this.hot.propToCol(r);if(this.isFormulaCellType(t,s)){const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId},i=this.hot.getCellMeta(t,s);let l=this.engine.getCellValue(o);return i.type==="date"&&Nn(l)&&(l=C1(l,i.dateFormat)),typeof l=="object"&&l!==null?l.value:l}return e}onBeforeAutofill(e,t,r){const{row:s,col:o}=t.getTopStartCorner(),{row:i,col:l}=t.getBottomEndCorner(),{row:a,col:u}=r.getTopStartCorner(),{row:c,col:d}=r.getBottomEndCorner(),f={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId}},m={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(d),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(m)===!1)return!1;const p=this.engine.getFillRangeData(f,m),{row:w,col:M}=f.start,{row:S,col:y}=f.end,v=S-w+1,R=y-M+1;for(let I=0;I<p.length;I+=1)for(let F=0;F<p[I].length;F+=1){const L=p[I][F],j=I%v,X=F%R,G=this.hot.getCellMeta(j,X);Vp(L,G.type)&&(L.startsWith("'")?p[I][F]=L.slice(1):this.isFormulaCellType(j,X,this.sheetId)===!1&&(p[I][F]=Y9(L,G.dateFormat)))}return p}onBeforeLoadData(e,t){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Lr(fn))||ro(this,Kp,dt(this.hot.getSettings().data))}onAfterCellMetaReset(){const e=this.hot.getSourceDataArray();let t=!1;e.forEach((r,s)=>{r.forEach((o,i)=>{const l=this.hot.getCellMeta(s,i),a=l.dateFormat;Vp(o,l.type)&&(t=!0,p1(o,a)?e[s][i]=w1(o,a):this.isFormulaCellType(s,i)===!1&&(e[s][i]=`'${o}`))})}),t===!0&&(ro(this,Rs,!0),this.engine.setSheetContent(this.sheetId,e),ro(this,Rs,!1))}onAfterLoadData(e,t){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Lr(fn)))if(this.sheetName=W9(this.engine,this.hot.getSettings()[fn].sheetName),ol(this,Kp))this.switchSheet(this.sheetName);else{const s=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,s)){ro(this,Rs,!0);const o=this.engine.setSheetContent(this.sheetId,s);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),ro(this,Rs,!1)}}}onModifyData(e,t,r,s){if(s!=="get"||ol(this,Rs)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const o=this.hot.toVisualRow(e);if(o===null||t===null)return;if(!this.isFormulaCellType(o,t)&&this.getCellType(o,t)!=="ARRAY"){nP(r.value)&&(r.value=U9(r.value));return}const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};let a=this.engine.getCellValue(l);const u=this.hot.getCellMeta(o,t);u.type==="date"&&Nn(a)&&(a=C1(a,u.dateFormat));const c=typeof a=="object"&&a!==null?a.value:a;r.value=c}onModifySourceData(e,t,r,s){if(s!=="get"||ol(this,Rs)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const o=this.hot.toVisualRow(e),i=this.hot.propToCol(t);if(o===null||i===null||!this.isFormulaCellType(o,i)&&this.getCellType(o,i)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId};r.value=this.engine.getCellSerialized(u)}onAfterSetDataAtCell(e,t){if(il(t))return;const r=[],s=[],o=this.engine.batch(()=>{e.forEach(i=>{let[l,a,,u]=i;const c=this.hot.propToCol(a),d=this.hot.toPhysicalRow(l),f=this.hot.toPhysicalColumn(c),m={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId};d!==null&&f!==null?this.syncChangeWithEngine(l,c,u):r.push([l,c,u]),s.push({address:m})})});r.length&&this.hot.addHookOnce("afterChange",()=>{const i=this.engine.batch(()=>{r.forEach(l=>{let[a,u,c]=l;this.syncChangeWithEngine(a,u,c)})});this.renderDependentSheets(i,!0)}),this.renderDependentSheets(o),this.validateDependentCells(o,s)}onAfterSetSourceDataAtCell(e,t){if(il(t))return;const r=[],s=[];e.forEach(o=>{let[i,l,,a]=o;const u=this.hot.propToCol(l);if(!Nn(u))return;const c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(c)){ct(`Not possible to set source cell data at ${JSON.stringify(c)}`);return}s.push({address:c}),r.push(...this.engine.setCellContents(c,a))}),this.renderDependentSheets(r),this.validateDependentCells(r,s)}onBeforeCreateRow(e,t){let r=this.rowAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countRows()&&(r=e),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[r,t]))return!1}onBeforeCreateCol(e,t){let r=this.columnAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countCols()&&(r=e),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[r,t]))return!1}onBeforeRemoveRow(e,t,r){return this.rowAxisSyncer.setRemovedHfIndexes(r).every(i=>this.engine.isItPossibleToRemoveRows(this.sheetId,[i,1]))===!1?!1:void 0}onBeforeRemoveCol(e,t,r){return this.columnAxisSyncer.setRemovedHfIndexes(r).every(i=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[i,1]))===!1?!1:void 0}onAfterCreateRow(e,t,r){if(il(r))return;const s=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(s)}onAfterCreateCol(e,t,r){if(il(r))return;const s=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(s)}onAfterRemoveRow(e,t,r,s){if(il(s))return;const o=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),i=this.engine.batch(()=>{o.forEach(l=>{this.engine.removeRows(this.sheetId,[l,1])})});this.renderDependentSheets(i)}onAfterRemoveCol(e,t,r,s){if(il(s))return;const o=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),i=this.engine.batch(()=>{o.forEach(l=>{this.engine.removeColumns(this.sheetId,[l,1])})});this.renderDependentSheets(i)}onAfterDetachChild(e,t,r){var s;ro(this,Rs,!0);const o=this.hot.getSourceDataArray(r,0,r+(((s=t.__children)===null||s===void 0?void 0:s.length)||0),this.hot.countSourceCols());ro(this,Rs,!1),o.forEach((i,l)=>{i.forEach((a,u)=>{this.engine.setCellContents({col:u,row:r+l,sheet:this.sheetId},[[a]])})})}onEngineValuesUpdated(e){this.hot.runHooks("afterFormulasValuesUpdate",e)}onEngineNamedExpressionsAdded(e,t){this.hot.runHooks("afterNamedExpressionAdded",e,t)}onEngineNamedExpressionsRemoved(e,t){this.hot.runHooks("afterNamedExpressionRemoved",e,t)}onEngineSheetAdded(e){this.hot.runHooks("afterSheetAdded",e)}onEngineSheetRenamed(e,t){this.hot.runHooks("afterSheetRenamed",e,t)}onEngineSheetRemoved(e,t){this.hot.runHooks("afterSheetRemoved",e,t)}}function l7(n){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[,r,,s]=e;r-s!==0&&(t=1)}return this.getTranslatedPhrase(KS,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,t.col),0),s=Math.max(e.col,t.col),o=[];for(let a=r;a<=s;a+=1)o.push(a);n.hideColumns(o);const i=o[o.length-1],l=this.columnIndexMapper.getNearestNotHiddenIndex(i,1,!0);Number.isInteger(l)&&l>=0?this.selectColumns(l):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function a7(n){const e=[];return{key:"hidden_columns_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(XS,t)},callback(){var t,r;if(e.length===0)return;let s=e[0],o=e[e.length-1];s=(t=this.columnIndexMapper.getNearestNotHiddenIndex(s-1,-1))!==null&&t!==void 0?t:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,n.showColumns(e),this.render(),this.view.adjustElementsSize(!0),o-s+1===this.countCols()||this.selectColumns(s,o)},disabled:!1,hidden(){const t=Ve(n.getHiddenColumns(),d=>this.toPhysicalColumn(d));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),s=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,i=this.columnIndexMapper,l=i.getRenderableFromVisualIndex(s),a=i.getRenderableFromVisualIndex(o),u=i.getNotTrimmedIndexes(),c=[];if(s!==o){const d=o-s+1,f=a-l+1;if(d>f){const m=u.slice(s,o+1);c.push(...m.filter(p=>t.includes(p)))}}else if(l===0&&l<s)c.push(...u.slice(0,s));else if(l===null)c.push(...u.slice(0,this.countCols()));else{const d=this.countCols()-1,f=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(d,-1));a===f&&d>o&&c.push(...u.slice(o+1))}return P(c,d=>{e.push(this.toVisualColumn(d))}),e.length===0}}}function v1(n,e,t){u7(n,e),e.set(n,t)}function u7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zn(n,e){var t=iP(n,e,"get");return c7(n,t)}function c7(n,e){return e.get?e.get.call(n):e.value}function Fa(n,e,t){var r=iP(n,e,"set");return h7(n,r,t),t}function iP(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function h7(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}he.getSingleton().register("beforeHideColumns");he.getSingleton().register("afterHideColumns");he.getSingleton().register("beforeUnhideColumns");he.getSingleton().register("afterUnhideColumns");const Xp="hiddenColumns",d7=310;var Kr=new WeakMap,Xr=new WeakMap;class f7 extends nt{constructor(){super(...arguments),v1(this,Kr,{writable:!0,value:{}}),v1(this,Xr,{writable:!0,value:null})}static get PLUGIN_KEY(){return Xp}static get PLUGIN_PRIORITY(){return d7}isEnabled(){return!!this.hot.getSettings()[Xp]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[Xp];$e(t)&&(Fa(this,Kr,t),dt(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),Fa(this,Xr,new mg),zn(this,Xr).addLocalHook("init",()=>this.onMapInit()),this.hot.columnIndexMapper.registerMap(this.pluginName,zn(this,Xr)),this.addHook("afterContextMenuDefaultOptions",function(){return e.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetCellMeta",(r,s,o)=>this.onAfterGetCellMeta(r,s,o)),this.addHook("modifyColWidth",(r,s)=>this.onModifyColWidth(r,s)),this.addHook("afterGetColHeader",function(){return e.onAfterGetColHeader(...arguments)}),this.addHook("modifyCopyableRange",r=>this.onModifyCopyableRange(r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Fa(this,Kr,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const t=this.getHiddenColumns(),r=this.isValidConfig(e);let s=t;const o=zn(this,Xr).getValues().slice(),i=e.length>0;if(r&&i){const a=e.map(u=>this.hot.toPhysicalColumn(u));P(a,u=>{o[u]=!1}),s=Sn(o,(u,c,d)=>(c&&u.push(this.hot.toVisualColumn(d)),u),[])}this.hot.runHooks("beforeUnhideColumns",t,s,r&&i)!==!1&&(r&&i&&zn(this,Xr).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,s,r&&i,r&&s.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.showColumns(t)}hideColumns(e){const t=this.getHiddenColumns(),r=this.isValidConfig(e);let s=t;r&&(s=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideColumns",t,s,r)!==!1&&(r&&this.hot.batchExecution(()=>{P(e,i=>{zn(this,Xr).setValueAtIndex(this.hot.toPhysicalColumn(i),!0)})},!0),this.hot.runHooks("afterHideColumns",t,s,r,r&&s.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.hideColumns(t)}getHiddenColumns(){return Ve(zn(this,Xr).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return zn(this,Xr).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const t=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<t):!1}resetCellsMeta(){P(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}onModifyColWidth(e,t){if(this.isHidden(t))return 0;if(zn(this,Kr).indicators&&(this.isHidden(t+1)||this.isHidden(t-1))&&typeof e=="number"&&this.hot.hasColHeaders())return e+15}onAfterGetCellMeta(e,t,r){if(zn(this,Kr).copyPasteEnabled===!1&&this.isHidden(t)&&(r.skipColumnOnPaste=!0),this.isHidden(t-1))r.className=r.className||"",r.className.indexOf("afterHiddenColumn")===-1&&(r.className+=" afterHiddenColumn");else if(r.className){const s=r.className.split(" ");if(s.length>0){const o=s.indexOf("afterHiddenColumn");o>-1&&s.splice(o,1),r.className=s.join(" ")}}}onModifyCopyableRange(e){if(zn(this,Kr).copyPasteEnabled)return e;const t=[],r=(s,o,i,l)=>{t.push({startRow:s,endRow:o,startCol:i,endCol:l})};return P(e,s=>{let o=!0,i=0;Ce(s.startCol,s.endCol,l=>{this.isHidden(l)?(o||r(s.startRow,s.endRow,i,l-1),o=!0):(o&&(i=l),l===s.endCol&&r(s.startRow,s.endRow,i,l),o=!1)})}),t}onAfterGetColHeader(e,t){if(!zn(this,Kr).indicators||e<0)return;const r=[];e>=1&&this.isHidden(e-1)&&r.push("afterHiddenColumn"),e<this.hot.countCols()-1&&this.isHidden(e+1)&&r.push("beforeHiddenColumn"),ee(t,r)}onAfterContextMenuDefaultOptions(e){e.items.push({name:Fe},l7(this),a7(this))}onMapInit(){Array.isArray(zn(this,Kr).columns)&&this.hideColumns(zn(this,Kr).columns)}destroy(){Fa(this,Kr,null),Fa(this,Xr,null),super.destroy()}}function g7(n){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[r,,s]=e;r-s!==0&&(t=1)}return this.getTranslatedPhrase(qS,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,t.row),0),s=Math.max(e.row,t.row),o=[];for(let a=r;a<=s;a+=1)o.push(a);n.hideRows(o);const i=o[o.length-1],l=this.rowIndexMapper.getNearestNotHiddenIndex(i,1,!0);Number.isInteger(l)&&l>=0?this.selectRows(l):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function m7(n){const e=[];return{key:"hidden_rows_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(QS,t)},callback(){var t,r;if(e.length===0)return;let s=e[0],o=e[e.length-1];s=(t=this.rowIndexMapper.getNearestNotHiddenIndex(s-1,-1))!==null&&t!==void 0?t:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,n.showRows(e),this.render(),this.view.adjustElementsSize(!0),o-s+1===this.countRows()||this.selectRows(s,o)},disabled:!1,hidden(){const t=Ve(n.getHiddenRows(),d=>this.toPhysicalRow(d));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),s=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,i=this.rowIndexMapper,l=i.getRenderableFromVisualIndex(s),a=i.getRenderableFromVisualIndex(o),u=i.getNotTrimmedIndexes(),c=[];if(s!==o){const d=o-s+1,f=a-l+1;if(d>f){const m=u.slice(s,o+1);c.push(...m.filter(p=>t.includes(p)))}}else if(l===0&&l<s)c.push(...u.slice(0,s));else if(l===null)c.push(...u.slice(0,this.countRows()));else{const d=this.countRows()-1,f=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(d,-1));a===f&&d>o&&c.push(...u.slice(o+1))}return P(c,d=>{e.push(this.toVisualRow(d))}),e.length===0}}}function S1(n,e,t){p7(n,e),e.set(n,t)}function p7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lr(n,e){var t=lP(n,e,"get");return w7(n,t)}function w7(n,e){return e.get?e.get.call(n):e.value}function Va(n,e,t){var r=lP(n,e,"set");return C7(n,r,t),t}function lP(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function C7(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}he.getSingleton().register("beforeHideRows");he.getSingleton().register("afterHideRows");he.getSingleton().register("beforeUnhideRows");he.getSingleton().register("afterUnhideRows");const qp="hiddenRows",y7=320;var bs=new WeakMap,qr=new WeakMap;class v7 extends nt{constructor(){super(...arguments),S1(this,bs,{writable:!0,value:{}}),S1(this,qr,{writable:!0,value:null})}static get PLUGIN_KEY(){return qp}static get PLUGIN_PRIORITY(){return y7}isEnabled(){return!!this.hot.getSettings()[qp]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[qp];$e(t)&&(Va(this,bs,t),dt(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),Va(this,qr,new mg),lr(this,qr).addLocalHook("init",()=>this.onMapInit()),this.hot.rowIndexMapper.registerMap(this.pluginName,lr(this,qr)),this.addHook("afterContextMenuDefaultOptions",function(){return e.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetCellMeta",(r,s,o)=>this.onAfterGetCellMeta(r,s,o)),this.addHook("modifyRowHeight",(r,s)=>this.onModifyRowHeight(r,s)),this.addHook("afterGetRowHeader",function(){return e.onAfterGetRowHeader(...arguments)}),this.addHook("modifyCopyableRange",r=>this.onModifyCopyableRange(r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),Va(this,bs,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const t=this.getHiddenRows(),r=this.isValidConfig(e);let s=t;const o=lr(this,qr).getValues().slice(),i=e.length>0;if(r&&i){const a=e.map(u=>this.hot.toPhysicalRow(u));P(a,u=>{o[u]=!1}),s=Sn(o,(u,c,d)=>(c&&u.push(this.hot.toVisualRow(d)),u),[])}this.hot.runHooks("beforeUnhideRows",t,s,r&&i)!==!1&&(r&&i&&lr(this,qr).setValues(o),this.hot.runHooks("afterUnhideRows",t,s,r&&i,r&&s.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.showRows(t)}hideRows(e){const t=this.getHiddenRows(),r=this.isValidConfig(e);let s=t;r&&(s=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideRows",t,s,r)!==!1&&(r&&this.hot.batchExecution(()=>{P(e,i=>{lr(this,qr).setValueAtIndex(this.hot.toPhysicalRow(i),!0)})},!0),this.hot.runHooks("afterHideRows",t,s,r,r&&s.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.hideRows(t)}getHiddenRows(){return Ve(lr(this,qr).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return lr(this,qr).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const t=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<t):!1}resetCellsMeta(){P(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}onModifyRowHeight(e,t){return this.isHidden(t)?0:e}onAfterGetCellMeta(e,t,r){if(lr(this,bs).copyPasteEnabled===!1&&this.isHidden(e)&&(r.skipRowOnPaste=!0),this.isHidden(e-1))r.className=r.className||"",r.className.indexOf("afterHiddenRow")===-1&&(r.className+=" afterHiddenRow");else if(r.className){const s=r.className.split(" ");if(s.length>0){const o=s.indexOf("afterHiddenRow");o>-1&&s.splice(o,1),r.className=s.join(" ")}}}onModifyCopyableRange(e){if(lr(this,bs).copyPasteEnabled)return e;const t=[],r=(s,o,i,l)=>{t.push({startRow:s,endRow:o,startCol:i,endCol:l})};return P(e,s=>{let o=!0,i=0;Ce(s.startRow,s.endRow,l=>{this.isHidden(l)?(o||r(i,l-1,s.startCol,s.endCol),o=!0):(o&&(i=l),l===s.endRow&&r(i,l,s.startCol,s.endCol),o=!1)})}),t}onAfterGetRowHeader(e,t){if(!lr(this,bs).indicators||e<0)return;const r=[];e>=1&&this.isHidden(e-1)&&r.push("afterHiddenRow"),e<this.hot.countRows()-1&&this.isHidden(e+1)&&r.push("beforeHiddenRow"),ee(t,r)}onAfterContextMenuDefaultOptions(e){e.items.push({name:Fe},g7(this),m7(this))}onMapInit(){Array.isArray(lr(this,bs).rows)&&this.hideRows(lr(this,bs).rows)}destroy(){Va(this,bs,null),Va(this,qr,null),super.destroy()}}function S7(n){return{key:"freeze_column",name(){return this.getTranslatedPhrase(ES)},callback(e,t){const[{start:{col:r}}]=t;n.freezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}}function R7(n){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(TS)},callback(e,t){const[{start:{col:r}}]=t;n.unfreezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}}he.getSingleton().register("beforeColumnFreeze");he.getSingleton().register("afterColumnFreeze");he.getSingleton().register("beforeColumnUnfreeze");he.getSingleton().register("afterColumnUnfreeze");const R1="manualColumnFreeze",b7=110,$a=new WeakMap;class E7 extends nt{static get PLUGIN_KEY(){return R1}static get PLUGIN_PRIORITY(){return b7}constructor(e){super(e),$a.set(this,{afterFirstUse:!1})}isEnabled(){return!!this.hot.getSettings()[R1]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>this.addContextMenuEntry(e)),this.addHook("beforeColumnMove",(e,t)=>this.onBeforeColumnMove(e,t)),super.enablePlugin())}disablePlugin(){const e=$a.get(this);e.afterFirstUse=!1,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const t=$a.get(this),r=this.hot.getSettings(),s=r.fixedColumnsStart<this.hot.countCols()&&e>r.fixedColumnsStart-1;t.afterFirstUse||(t.afterFirstUse=!0),this.hot.runHooks("beforeColumnFreeze",e,s)!==!1&&(s&&(this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsStart),r._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,s))}unfreezeColumn(e){const t=$a.get(this),r=this.hot.getSettings(),s=r.fixedColumnsStart>0&&e<=r.fixedColumnsStart-1;t.afterFirstUse||(t.afterFirstUse=!0),this.hot.runHooks("beforeColumnUnfreeze",e,s)!==!1&&(s&&(r._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,s))}addContextMenuEntry(e){e.items.push({name:"---------"},S7(this),R7(this))}onBeforeColumnMove(e,t){if($a.get(this).afterFirstUse){const s=this.hot.getSettings().fixedColumnsStart;if(t<s||e.some(o=>o<s))return!1}}}const Qp=0,b1=1,E1=2,ll="px";let aP=class{constructor(e){this.hot=e,this._element=null,this.state=Qp,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=E1}build(){this.state===Qp&&(this._element=this.hot.rootDocument.createElement("div"),this.state=b1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Qp}isAppended(){return this.state===E1}isBuilt(){return this.state>=b1}setPosition(e,t){Nn(e)&&(this._element.style.top=e+ll),Nn(t)&&(this._element.style[this.inlineProperty]=t+ll)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){Nn(e)&&(this._element.style.width=e+ll),Nn(t)&&(this._element.style.height=t+ll)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){Nn(e)&&(this._element.style.marginTop=e+ll),Nn(t)&&(this._element.style[`margin${Lr(this.inlineProperty)}`]=t+ll)}getOffset(){const e=this._element.style,t=`margin${Lr(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}};const T7="ht__manualColumnMove--backlight";let M7=class extends aP{build(){super.build(),ee(this._element,T7)}};const _7="ht__manualColumnMove--guideline";let O7=class extends aP{build(){super.build(),ee(this._element,_7)}};he.getSingleton().register("beforeColumnMove");he.getSingleton().register("afterColumnMove");const Zp="manualColumnMove",I7=120,so=new WeakMap,T1="ht__manualColumnMove",Lh="show-ui",Jp="on-moving--columns",ew="after-selection--columns";class x7 extends nt{static get PLUGIN_KEY(){return Zp}static get PLUGIN_PRIORITY(){return I7}constructor(e){super(e),so.set(this,{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),this.eventManager=new It(this),this.backlight=new M7(e),this.guideline=new O7(e)}isEnabled(){return!!this.hot.getSettings()[Zp]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return e.onBeforeOnCellMouseOver(...arguments)}),this.addHook("afterScrollVertically",()=>this.onAfterScrollVertically()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.buildPluginUI(),this.registerEvents(),ee(this.hot.rootElement,T1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){He(this.hot.rootElement,T1),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){const r=so.get(this),s=r.cachedDropIndex,o=this.isMovePossible(e,t),i=this.hot.runHooks("beforeColumnMove",e,t,s,o);if(r.cachedDropIndex=void 0,i===!1)return;o&&this.hot.columnIndexMapper.moveIndexes(e,t);const l=o&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,s,o,l),l}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){const r=this.countFinalIndex(e,t),s=so.get(this);return s.cachedDropIndex=t,this.moveColumns(e,r)}isMovePossible(e,t){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),s=e.length+t>r,o=t<0,i=e.some(a=>a<0),l=e.some(a=>a>=r);return!(s||o||i||l)}isColumnOrderChanged(e,t){return e.some((r,s)=>r-s!==t)}countFinalIndex(e,t){const r=Sn(e,(s,o)=>(o<t&&(s+=1),s),0);return t-r}getColumnsWidth(e,t){const r=this.hot.columnIndexMapper;let s=0;for(let o=e;o<=t;o+=1){const i=r.getRenderableFromVisualIndex(o);o<0?s+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:i!==null&&(s+=this.hot.view._wt.wtTable.getStretchedColumnWidth(i)||0)}return s}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Zp];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,t){const r=[];return Ce(e,t,s=>{r.push(s)}),r}refreshPositions(){const e=so.get(this),t=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(e.hoveredColumn)&&t>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(t-1,-1));const r=this.hot.view._wt.wtTable,s=this.hot.view._wt.wtOverlays.scrollableElement,o=typeof s.scrollX=="number"?s.scrollX:s.scrollLeft;let i=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,e.hoveredColumn-1);const l=r.hider.offsetWidth,a=r.TBODY.offsetLeft,u=this.backlight.getOffset().start,c=this.backlight.getSize().width;let d=0,f=0;if(this.hot.isRtl()){const w=this.hot.rootWindow,M=st(this.hot.rootElement),S=w.innerWidth-e.rootElementOffset-M;f=w.innerWidth-e.target.eventPageX-S-(s.scrollX===void 0?o:0)}else f=e.target.eventPageX-(e.rootElementOffset-(s.scrollX===void 0?o:0));if(e.hasRowHeaders&&(d=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(e.hoveredColumn)&&(i+=o),i+=d,e.hoveredColumn<0)e.fixedColumnsStart>0?e.target.col=0:e.target.col=t>0?t-1:t;else if(e.target.TD.offsetWidth/2+i<=f){const w=e.hoveredColumn>=e.countCols?e.countCols-1:e.hoveredColumn;e.target.col=w+1,i+=e.target.TD.offsetWidth}else e.target.col=e.hoveredColumn;let m=f,p=i;f+c+u>=l?m=l-c-u:f+u<a+d&&(m=a+d+Math.abs(u)),i>=l-1?p=l-1:p===0?p=1:s.scrollX!==void 0&&e.hoveredColumn<e.fixedColumnsStart&&(p-=e.rootElementOffset<=s.scrollX?e.rootElementOffset:0),this.backlight.setPosition(null,m),this.guideline.setPosition(null,p)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>this.onMouseMove(t)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp())}unregisterEvents(){this.eventManager.clear()}onBeforeOnCellMouseDown(e,t,r,s){const o=this.hot.view._wt.wtTable,i=this.hot.selection.isSelectedByColumnHeader(),l=this.hot.getSelectedRangeLast(),a=so.get(this),u=Oe(e.target,"sortAction");if(!l||!i||a.pressed||e.button!==0||u){a.pressed=!1,a.columnsToMove.length=0,He(this.hot.rootElement,[Jp,Lh]);return}const c=this.guideline.isBuilt()&&!this.guideline.isAppended(),d=this.backlight.isBuilt()&&!this.backlight.isAppended();c&&d&&(this.guideline.appendTo(o.hider),this.backlight.appendTo(o.hider));const{from:f,to:m}=l,p=Math.min(f.col,m.col),w=Math.max(f.col,m.col);if(t.row<0&&t.col>=p&&t.col<=w){s.column=!0,a.pressed=!0,a.target.eventPageX=e.pageX,a.target.eventOffsetX=e.offsetX,a.hoveredColumn=t.col,a.target.TD=r,a.target.col=t.col,a.columnsToMove=this.prepareColumnsToMoving(p,w),a.hasRowHeaders=!!this.hot.getSettings().rowHeaders,a.countCols=this.hot.countCols(),a.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,a.rootElementOffset=Wt(this.hot.rootElement).left;const M=a.hasRowHeaders?-1:0,S=o.holder.scrollTop+o.getColumnHeaderHeight(0)+1,y=t.col<a.fixedColumnsStart,v=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),R=Math.abs(e.offsetX-(this.hot.isRtl()?e.target.offsetWidth:0)),I=this.getColumnsWidth(p,t.col-1)+R,F=this.getColumnsWidth(M,p-1)+(y?v:0)+I;this.backlight.setPosition(S,F),this.backlight.setSize(this.getColumnsWidth(p,w),o.hider.offsetHeight-S),this.backlight.setOffset(null,-I),ee(this.hot.rootElement,Jp)}else He(this.hot.rootElement,ew),a.pressed=!1,a.columnsToMove.length=0}onMouseMove(e){const t=so.get(this);if(t.pressed){if(e.target===this.backlight.element){const r=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(r)})}t.target.eventPageX=e.pageX,this.refreshPositions()}}onBeforeOnCellMouseOver(e,t,r,s){const o=this.hot.getSelectedRangeLast(),i=so.get(this);!o||!i.pressed||(i.columnsToMove.indexOf(t.col)>-1?He(this.hot.rootElement,Lh):ee(this.hot.rootElement,Lh),s.row=!0,s.column=!0,s.cell=!0,i.hoveredColumn=t.col,i.target.TD=r)}onMouseUp(){const e=so.get(this),t=e.target.col,r=e.columnsToMove.length;if(e.hoveredColumn=void 0,e.pressed=!1,e.backlightWidth=0,He(this.hot.rootElement,[Jp,Lh,ew]),this.hot.selection.isSelectedByColumnHeader()&&ee(this.hot.rootElement,ew),r<1||t===void 0)return;const s=e.columnsToMove[0],o=this.hot.toPhysicalColumn(s),i=this.dragColumns(e.columnsToMove,t);if(e.columnsToMove.length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const l=this.hot.toVisualColumn(o),a=l+r-1;this.hot.selectColumns(l,a)}}onAfterScrollVertically(){const e=this.hot.view._wt.wtTable,t=e.getColumnHeaderHeight(0)+1,r=e.holder.scrollTop,s=t+r;this.backlight.setPosition(s),this.backlight.setSize(null,e.hider.offsetHeight-s)}buildPluginUI(){this.backlight.build(),this.guideline.build()}onAfterLoadData(){this.moveBySettingsOrLoad()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}const Fh="manualColumnResize",A7=130,M1="manualColumnWidths",tw=new WeakMap;class P7 extends nt{static get PLUGIN_KEY(){return Fh}static get PLUGIN_PRIORITY(){return A7}constructor(e){super(e);const{rootDocument:t}=this.hot;this.currentTH=null,this.currentCol=null,this.selectedCols=[],this.currentWidth=null,this.newSize=null,this.startY=null,this.startWidth=null,this.startOffset=null,this.handle=t.createElement("DIV"),this.guide=t.createElement("DIV"),this.eventManager=new It(this),this.pressed=null,this.isTriggeredByRMB=!1,this.dblclick=0,this.autoresizeTimeout=null,this.columnWidthsMap=void 0,tw.set(this,{config:void 0}),ee(this.handle,"manualColumnResizer"),ee(this.guide,"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Fh]}enablePlugin(){this.enabled||(this.columnWidthsMap=new $o,this.columnWidthsMap.addLocalHook("init",()=>this.onMapInit()),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",(e,t)=>this.onModifyColWidth(e,t)),this.addHook("beforeStretchingColumnWidth",(e,t)=>this.onBeforeStretchingColumnWidth(e,t)),this.addHook("beforeColumnResize",(e,t,r)=>this.onBeforeColumnResize(e,t,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const e=tw.get(this);e.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",M1,this.columnWidthsMap.getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",M1,e),e.value}setManualSize(e,t){const r=Math.max(t,20),s=this.hot.toPhysicalColumn(e);return this.columnWidthsMap.setValueAtIndex(s,r),r}clearManualSize(e){const t=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(t,null)}onMapInit(){const e=tw.get(this),t=this.hot.getSettings()[Fh],r=this.loadManualColumnWidths();typeof r<"u"?this.hot.batchExecution(()=>{r.forEach((s,o)=>{this.columnWidthsMap.setValueAtIndex(o,s)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((s,o)=>{this.columnWidthsMap.setValueAtIndex(o,s)})},!0),e.config=t):t===!0&&Array.isArray(e.config)&&this.hot.batchExecution(()=>{e.config.forEach((s,o)=>{this.columnWidthsMap.setValueAtIndex(o,s)})},!0)}setupHandlePosition(e){if(!e.parentNode)return;this.currentTH=e;const{_wt:t}=this.hot.view,r=t.wtTable.getCoords(this.currentTH),s=r.col;if(s<0)return;const o=_t(this.currentTH),i=this.currentTH.getBoundingClientRect(),l=s<t.getSetting("fixedColumnsStart");let a;l&&(a=t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),a||(a=t.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s),this.selectedCols=[];const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();P(c,d=>{const f=d.getTopStartCorner().col,m=d.getBottomEndCorner().col;Ce(f,m,p=>{this.selectedCols.includes(p)||this.selectedCols.push(p)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=a.start-6,this.startWidth=parseInt(i.width,10),this.handle.style.top=`${a.top}px`,this.handle.style[this.inlineDir]=`${this.startOffset+this.startWidth}px`,this.handle.style.height=`${o}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style[this.inlineDir]=`${this.startOffset+this.currentWidth}px`}setupGuidePosition(){const e=parseInt(_t(this.handle),10),t=parseInt(this.handle.style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);ee(this.handle,"active"),ee(this.guide,"active"),this.guide.style.top=`${t}px`,this.refreshGuidePosition(),this.guide.style.height=`${r-e}px`,this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}hideHandleAndGuide(){He(this.handle,"active"),He(this.guide,"active")}checkIfColumnHeader(e){return!!Ci(e,["THEAD"],this.hot.rootElement)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}onMouseOver(e){if(!GI(e.target)&&this.isTriggeredByRMB!==!0&&this.checkIfColumnHeader(e.target)){const t=this.getClosestTHParent(e.target);if(!t)return;const r=t.getAttribute("colspan");t&&(r===null||r==="1")&&(this.pressed||this.setupHandlePosition(t))}}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(r,s)=>{const o=this.hot.runHooks("beforeColumnResize",this.newSize,r,!0);o!==void 0&&(this.newSize=o),this.hot.getSettings().stretchH==="all"?this.clearManualSize(r):this.setManualSize(r,this.newSize),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,r,!0),s&&e()};this.dblclick>=2&&(this.selectedCols.length>1?(P(this.selectedCols,s=>{t(s)}),e()):P(this.selectedCols,s=>{t(s,!0)})),this.dblclick=0,this.autoresizeTimeout=null}onMouseDown(e){Oe(e.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(()=>this.afterMouseDownTimeout(),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=e.pageX,this.newSize=this.startWidth)}onMouseMove(e){if(this.pressed){const t=(e.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+t,P(this.selectedCols,r=>{this.newSize=this.setManualSize(r,this.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}onMouseUp(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(r,s)=>{this.hot.runHooks("beforeColumnResize",this.newSize,r,!1),s&&e(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,r,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth&&(this.selectedCols.length>1?(P(this.selectedCols,s=>{t(s)}),e()):P(this.selectedCols,s=>{t(s,!0)})),this.setupHandlePosition(this.currentTH))}onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate(()=>{this.isTriggeredByRMB=!1})}bindEvents(){const{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",r=>this.onMouseOver(r)),this.eventManager.addEventListener(t,"mousedown",r=>this.onMouseDown(r)),this.eventManager.addEventListener(e,"mousemove",r=>this.onMouseMove(r)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(this.handle,"contextmenu",()=>this.onContextMenu())}onModifyColWidth(e,t){let r=e;if(this.enabled){const s=this.hot.toPhysicalColumn(t),o=this.columnWidthsMap.getValueAtIndex(s);this.hot.getSettings()[Fh]&&o&&(r=o)}return r}onBeforeStretchingColumnWidth(e,t){let r=this.columnWidthsMap.getValueAtIndex(t);return r===null&&(r=e),r}onBeforeColumnResize(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}destroy(){super.destroy()}}const nw=0,_1=1,O1=2,al="px";let uP=class{constructor(e){this.hot=e,this._element=null,this.state=nw}appendTo(e){e.appendChild(this._element),this.state=O1}build(){this.state===nw&&(this._element=this.hot.rootDocument.createElement("div"),this.state=_1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=nw}isAppended(){return this.state===O1}isBuilt(){return this.state>=_1}setPosition(e,t){e!==void 0&&(this._element.style.top=e+al),t!==void 0&&(this._element.style.left=t+al)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+al),t&&(this._element.style.height=t+al)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+al),t&&(this._element.style.marginLeft=t+al)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const H7="ht__manualRowMove--backlight";class D7 extends uP{build(){super.build(),ee(this._element,H7)}}const k7="ht__manualRowMove--guideline";class N7 extends uP{build(){super.build(),ee(this._element,k7)}}he.getSingleton().register("beforeRowMove");he.getSingleton().register("afterRowMove");const rw="manualRowMove",L7=140,oo=new WeakMap,I1="ht__manualRowMove",Vh="show-ui",sw="on-moving--rows",ow="after-selection--rows";class F7 extends nt{static get PLUGIN_KEY(){return rw}static get PLUGIN_PRIORITY(){return L7}constructor(e){super(e),oo.set(this,{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),this.eventManager=new It(this),this.backlight=new D7(e),this.guideline=new N7(e)}isEnabled(){return!!this.hot.getSettings()[rw]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return e.onBeforeOnCellMouseOver(...arguments)}),this.addHook("afterScrollHorizontally",()=>this.onAfterScrollHorizontally()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.buildPluginUI(),this.registerEvents(),ee(this.hot.rootElement,I1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){He(this.hot.rootElement,I1),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){const r=oo.get(this),s=r.cachedDropIndex,o=this.isMovePossible(e,t),i=this.hot.runHooks("beforeRowMove",e,t,s,o);if(r.cachedDropIndex=void 0,i===!1)return;o&&this.hot.rowIndexMapper.moveIndexes(e,t);const l=o&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,s,o,l),l}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){const r=this.countFinalIndex(e,t),s=oo.get(this);return s.cachedDropIndex=t,this.moveRows(e,r)}isMovePossible(e,t){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),s=e.length+t>r,o=t<0,i=e.some(a=>a<0),l=e.some(a=>a>=r);return!(s||o||i||l)}isRowOrderChanged(e,t){return e.some((r,s)=>r-s!==t)}countFinalIndex(e,t){const r=Sn(e,(s,o)=>(o<t&&(s+=1),s),0);return t-r}getRowsHeight(e,t){const r=this.hot.rowIndexMapper;let s=0;for(let o=e;o<=t;o++){const i=r.getRenderableFromVisualIndex(o);i!==null&&(s+=this.hot.view._wt.wtTable.getRowHeight(i)||23)}return s}moveBySettingsOrLoad(){const e=this.hot.getSettings()[rw];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;const{from:r,to:s}=e,o=Math.min(r.row,s.row),i=Math.max(r.row,s.row);return Ce(o,i,l=>{t.push(l)}),t}refreshPositions(){const e=oo.get(this),t=e.target.coords,r=this.hot.view.getFirstFullyVisibleRow(),s=this.hot.view.getLastFullyVisibleRow(),o=this.hot.countRows();this.isFixedRowTop(t.row)&&r>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r-1,-1)),this.isFixedRowBottom(t.row)&&s<o&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(s+1,1),void 0,!0);const i=this.hot.view._wt.wtTable,l=e.target.TD,a=this.hot.rootElement,u=Wt(a),c=jl(a),d=i.holder.scrollTop;let f;this.hot.rootWindow===c?f=c.scrollY:f=c.scrollTop;const m=u.top-f,p=e.target.eventPageY-m+d,w=i.hider.offsetHeight,M=i.TBODY.offsetTop,S=this.backlight.getOffset().top,y=this.backlight.getSize().height,v=l.offsetHeight/2,R=l.offsetHeight;let I=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row-1);const F=p>=I+v;this.isFixedRowTop(t.row)&&(I+=i.holder.scrollTop),t.row<0?e.target.row=r>0?r-1:r:F?(e.target.row=t.row+1,I+=t.row===0?R-1:R):e.target.row=t.row;let L=p,j=I;p+y+S>=w?L=w-y-S:p+S<M&&(L=M+Math.abs(S)),I>=w-1&&(j=w-1),this.backlight.setPosition(L),this.guideline.setPosition(j)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>this.onMouseMove(t)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp())}unregisterEvents(){this.eventManager.clear()}onBeforeOnCellMouseDown(e,t,r,s){const{wtTable:o,wtViewport:i}=this.hot.view._wt,l=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast(),u=oo.get(this);if(!a||!l||u.pressed||e.button!==0){u.pressed=!1,u.rowsToMove.length=0,He(this.hot.rootElement,[sw,Vh]);return}const c=this.guideline.isBuilt()&&!this.guideline.isAppended(),d=this.backlight.isBuilt()&&!this.backlight.isAppended();c&&d&&(this.guideline.appendTo(o.hider),this.backlight.appendTo(o.hider));const{from:f,to:m}=a,p=Math.min(f.row,m.row),w=Math.max(f.row,m.row);if(t.col<0&&t.row>=p&&t.row<=w){s.row=!0,u.pressed=!0,u.target.eventPageY=e.pageY,u.target.coords=t,u.target.TD=r,u.rowsToMove=this.prepareRowsToMoving();const M=o.holder.scrollLeft+i.getRowHeaderWidth();this.backlight.setPosition(null,M),this.backlight.setSize(o.hider.offsetWidth-M,this.getRowsHeight(p,w)),this.backlight.setOffset((this.getRowsHeight(p,t.row-1)+e.offsetY)*-1,null),ee(this.hot.rootElement,sw),this.refreshPositions()}else He(this.hot.rootElement,ow),u.pressed=!1,u.rowsToMove.length=0}onMouseMove(e){const t=oo.get(this);if(t.pressed){if(e.target===this.backlight.element){const r=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,r)})}t.target.eventPageY=e.pageY,this.refreshPositions()}}onBeforeOnCellMouseOver(e,t,r,s){const o=this.hot.getSelectedRangeLast(),i=oo.get(this);!o||!i.pressed||(i.rowsToMove.indexOf(t.row)>-1?He(this.hot.rootElement,Vh):ee(this.hot.rootElement,Vh),s.row=!0,s.column=!0,s.cell=!0,i.target.coords=t,i.target.TD=r)}onMouseUp(){const e=oo.get(this),t=e.target.row,r=e.rowsToMove.length;if(e.pressed=!1,e.backlightHeight=0,He(this.hot.rootElement,[sw,Vh,ow]),this.hot.selection.isSelectedByRowHeader()&&ee(this.hot.rootElement,ow),r<1||t===void 0)return;const s=e.rowsToMove[0],o=this.hot.toPhysicalRow(s),i=this.dragRows(e.rowsToMove,t);if(e.rowsToMove.length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const l=this.hot.toVisualRow(o),a=l+r-1;this.hot.selectRows(l,a)}}onAfterScrollHorizontally(){const e=this.hot.view._wt.wtTable,t=this.hot.view._wt.wtViewport.getRowHeaderWidth(),r=e.holder.scrollLeft,s=t+r;this.backlight.setPosition(null,s),this.backlight.setSize(e.hider.offsetWidth-s)}buildPluginUI(){this.backlight.build(),this.guideline.build()}onAfterLoadData(){this.moveBySettingsOrLoad()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}const $h="manualRowResize",V7=30,x1="manualRowHeights",iw=new WeakMap;class $7 extends nt{static get PLUGIN_KEY(){return $h}static get PLUGIN_PRIORITY(){return V7}constructor(e){super(e);const{rootDocument:t}=this.hot;this.currentTH=null,this.currentRow=null,this.selectedRows=[],this.currentHeight=null,this.newSize=null,this.startY=null,this.startHeight=null,this.startOffset=null,this.handle=t.createElement("DIV"),this.guide=t.createElement("DIV"),this.eventManager=new It(this),this.pressed=null,this.isTriggeredByRMB=!1,this.dblclick=0,this.autoresizeTimeout=null,this.rowHeightsMap=void 0,iw.set(this,{config:void 0}),ee(this.handle,"manualRowResizer"),ee(this.guide,"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[$h]}enablePlugin(){this.enabled||(this.rowHeightsMap=new $o,this.rowHeightsMap.addLocalHook("init",()=>this.onMapInit()),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",(e,t)=>this.onModifyRowHeight(e,t)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const e=iw.get(this);e.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",x1,this.rowHeightsMap.getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",x1,e),e.value}setManualSize(e,t){const r=this.hot.toPhysicalRow(e),s=Math.max(t,dg.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(r,s),s}setupHandlePosition(e){this.currentTH=e;const{view:t}=this.hot,{_wt:r}=t,s=r.wtTable.getCoords(this.currentTH),o=s.row;if(o<0)return;const i=st(this.currentTH),l=this.currentTH.getBoundingClientRect(),a=o<r.getSetting("fixedRowsTop"),u=o>=t.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;a?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),this.selectedRows=[];const d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&d){const f=this.hot.getSelectedRange();P(f,m=>{const p=m.getTopStartCorner().row,w=m.getBottomStartCorner().row;Ce(p,w,M=>{this.selectedRows.includes(M)||this.selectedRows.push(M)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=c.top-6,this.startHeight=parseInt(l.height,10),this.handle.style.top=`${this.startOffset+this.startHeight}px`,this.handle.style[this.inlineDir]=`${c.start}px`,this.handle.style.width=`${i}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style.top=`${this.startOffset+this.currentHeight}px`}setupGuidePosition(){const e=parseInt(st(this.handle),10),t=parseInt(this.handle.style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);ee(this.handle,"active"),ee(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]=`${t}px`,this.guide.style.width=`${r-e}px`,this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style.top=this.handle.style.top}hideHandleAndGuide(){He(this.handle,"active"),He(this.guide,"active")}checkIfRowHeader(e){var t;return Ci(e,["TH"],this.hot.rootElement)&&((t=e.parentNode)===null||t===void 0||(t=t.parentNode)===null||t===void 0?void 0:t.tagName)==="TBODY"}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const t=this.hot.view._wt.wtTable.getRowHeight(e);return t!==void 0&&this.newSize<t?t:this.newSize}onMouseOver(e){if(!GI(e.target)&&this.isTriggeredByRMB!==!0&&this.checkIfRowHeader(e.target)){const t=this.getClosestTHParent(e.target);t&&(this.pressed||this.setupHandlePosition(t))}}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(r,s)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&(this.newSize=o),this.setManualSize(r,this.newSize),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),s&&e()};this.dblclick>=2&&(this.selectedRows.length>1?(P(this.selectedRows,s=>{t(s)}),e()):P(this.selectedRows,s=>{t(s,!0)})),this.dblclick=0,this.autoresizeTimeout=null}onMouseDown(e){Oe(e.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(()=>this.afterMouseDownTimeout(),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=e.pageY,this.newSize=this.startHeight)}onMouseMove(e){this.pressed&&(this.currentHeight=this.startHeight+(e.pageY-this.startY),P(this.selectedRows,t=>{this.newSize=this.setManualSize(t,this.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}onMouseUp(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(r,s)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!1),s&&e(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight&&(this.selectedRows.length>1?(P(this.selectedRows,s=>{t(s)}),e()):P(this.selectedRows,s=>{t(s,!0)})),this.setupHandlePosition(this.currentTH))}onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate(()=>{this.isTriggeredByRMB=!1})}bindEvents(){const{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>this.onMouseOver(r)),this.eventManager.addEventListener(e,"mousedown",r=>this.onMouseDown(r)),this.eventManager.addEventListener(t,"mousemove",r=>this.onMouseMove(r)),this.eventManager.addEventListener(t,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(this.handle,"contextmenu",()=>this.onContextMenu())}onModifyRowHeight(e,t){let r=e;if(this.enabled){const s=this.hot.toPhysicalRow(t),o=this.rowHeightsMap.getValueAtIndex(s);this.hot.getSettings()[$h]&&o&&(r=o)}return r}onMapInit(){const e=iw.get(this),t=this.hot.getSettings()[$h],r=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof r<"u"?r.forEach((s,o)=>{this.rowHeightsMap.setValueAtIndex(o,s)}):Array.isArray(t)?(t.forEach((s,o)=>{this.rowHeightsMap.setValueAtIndex(o,s)}),e.config=t):t===!0&&Array.isArray(e.config)&&e.config.forEach((s,o)=>{this.rowHeightsMap.setValueAtIndex(o,s)})},!0)}destroy(){super.destroy()}}class es{constructor(e,t,r,s,o,i){this.row=e,this.col=t,this.rowspan=r,this.colspan=s,this.removed=!1,this.cellCoordsFactory=o,this.cellRangeFactory=i}static NEGATIVE_VALUES_WARNING(e){return ot`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return ot`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return ot`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return ot`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return e.colspan===1&&e.rowspan===1}static containsZeroSpan(e){return e.colspan===0||e.rowspan===0}static isOutOfBounds(e,t,r){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const t=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){const r=e[0]||e[1],s=t+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",i=e[0]?"col":"row",l=Math.min(t,s),a=Math.max(t,s),u=this[i],c=this[i]+this[o]-1;if(u>=t&&(this[i]+=r),r>0)t<=c&&t>u&&(this[o]+=r);else if(r<0){if(l<=u&&a>=c)return this.removed=!0,!1;if(u>=l&&u<=a){const d=a-u+1,f=Math.abs(r)-d;this[i]-=f+r,this[o]-=d}else if(u<=l&&c>=a)this[o]+=r;else if(u<=l&&c>=l&&c<a){const d=c-l+1;this[o]-=d}}return!0}isFarther(e,t){return e?t==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:t==="up"?e.row>this.row:t==="right"?e.col+e.colspan-1<this.col+this.colspan-1:t==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}function ey(n,e,t,r){e?e.row===t&&e.col===r?(n.setAttribute("rowspan",e.rowspan.toString()),n.setAttribute("colspan",e.colspan.toString())):(n.removeAttribute("rowspan"),n.removeAttribute("colspan"),n.style.display="none"):(n.removeAttribute("rowspan"),n.removeAttribute("colspan"),n.style.display="")}class rR{constructor(e){this.plugin=e,this.mergedCells=[],this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return ot`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,t){const r=this.mergedCells;let s=!1;return P(r,o=>o.row<=e&&o.row+o.rowspan-1>=e&&o.col<=t&&o.col+o.colspan-1>=t?(s=o,!1):!0),s}getByRange(e){const t=this.mergedCells;let r=!1;return P(t,s=>s.row<=e.from.row&&s.row+s.rowspan-1>=e.to.row&&s.col<=e.from.col&&s.col+s.colspan-1>=e.to.col?(r=s,r):!0),r}getWithinRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCells,s=[];let o=e;if(!o.includesRange){const i=this.hot._createCellCoords(o.from.row,o.from.col),l=this.hot._createCellCoords(o.to.row,o.to.col);o=this.hot._createCellRange(i,i,l)}return P(r,i=>{const l=this.hot._createCellCoords(i.row,i.col),a=this.hot._createCellCoords(i.row+i.rowspan-1,i.col+i.colspan-1),u=this.hot._createCellRange(l,l,a);t?o.overlaps(u)&&s.push(i):o.includesRange(u)&&s.push(i)}),s.length?s:!1}add(e){const t=this.mergedCells,r=e.row,s=e.col,o=e.rowspan,i=e.colspan,l=new es(r,s,o,i,this.hot._createCellCoords,this.hot._createCellRange),a=this.get(r,s),u=this.isOverlapping(l);return!a&&!u?(this.hot&&l.normalize(this.hot),t.push(l),l):(ct(rR.IS_OVERLAPPING_WARNING(l)),!1)}remove(e,t){const r=this.mergedCells,s=this.get(e,t),o=s?this.mergedCells.indexOf(s):-1;return s&&o!==-1?(r.splice(o,1),s):!1}clear(){const e=this.mergedCells,t=[],r=[];P(e,s=>{const o=this.hot.getCell(s.row,s.col);o&&t.push([o,this.get(s.row,s.col),s.row,s.col])}),this.mergedCells.length=0,P(t,(s,o)=>{Ce(0,s.rowspan-1,i=>{Ce(0,s.colspan-1,l=>{if(l!==0||i!==0){const a=this.hot.getCell(s.row+i,s.col+l);a&&r.push([a,null,null,null])}})}),t[o][1]=null}),P(t,s=>{ey(...s)}),P(r,s=>{ey(...s)})}isOverlapping(e){const t=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));let r=!1;return P(this.mergedCells,s=>this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(s.row,s.col),this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1)).overlaps(t)?(r=!0,!1):!0),r}isFirstRenderableMergedCell(e,t){const r=this.get(e,t);return r&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1)===t}getFirstRenderableCoords(e,t){const r=this.get(e,t);if(!r||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);const s=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(s,o)}shiftCollections(e,t,r){const s=[0,0];switch(e){case"right":s[0]+=r;break;case"left":s[0]-=r;break;case"down":s[1]+=r;break;case"up":s[1]-=r;break}P(this.mergedCells,o=>{o.shift(s,t)}),AC(this.mergedCells.length-1,0,o=>{const i=this.mergedCells[o];i&&i.removed&&this.mergedCells.splice(this.mergedCells.indexOf(i),1)})}}class B7{constructor(e){this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const t=this.mergedCellsCollection.get(e[0],e[1]);t&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}}getDirection(e,t){let r=null;return t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?r="down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?r="up":t[1]===e[1]&&t[2]===e[2]?r="right":r="left",r}snapDragArea(e,t,r,s){const o=t.slice(0),i=this.getAutofillSize(e,t,r),[l,a,u,c]=e,f=["up","down"].indexOf(r)>-1?u-l+1:c-a+1,m=Math.floor(i/f)*f,p=i-m,w=this.getFarthestCollection(e,t,r,s);if(w){if(r==="down"){const M=w.row+w.rowspan-l-p;o[2]+M>=this.plugin.hot.countRows()?o[2]-=p:o[2]+=p?M:0}else if(r==="right"){const M=w.col+w.colspan-a-p;o[3]+M>=this.plugin.hot.countCols()?o[3]-=p:o[3]+=p?M:0}else if(r==="up"){const M=u-p-w.row+1;o[0]+M<0?o[0]+=p:o[0]-=p?M:0}else if(r==="left"){const M=c-p-w.col+1;o[1]+M<0?o[1]+=p:o[1]-=p?M:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:s,fillSize:i,dragArea:o,cycleLength:f}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),Ut(this.currentFillData,e)}getAutofillSize(e,t,r){const[s,o,i,l]=e,[a,u,c,d]=t;switch(r){case"up":return s-a;case"down":return c-i;case"left":return o-u;case"right":return d-l;default:return null}}getDragArea(e,t,r){const[s,o,i,l]=e,[a,u,c,d]=t;switch(r){case"up":return[a,u,s-1,l];case"down":return[i+1,o,c,l];case"left":return[a,u,i,o-1];case"right":return[s,l+1,c,d];default:return null}}getFarthestCollection(e,t,r,s){const[o,i,l,a]=e,u=["up","down"].indexOf(r)>-1,c=u?l:a,d=u?o:i,f=this.getAutofillSize(e,t,r),m=u?l-o+1:a-i+1,p=Math.floor(f/m)*m,w=f-p;let M=null,S=null,y=null;switch(r){case"up":M="includesVertically",y=c-w+1;break;case"left":M="includesHorizontally",y=c-w+1;break;case"down":M="includesVertically",y=d+w-1;break;case"right":M="includesHorizontally",y=d+w-1;break}return P(s,v=>{v[M](y)&&v.isFarther(S,r)&&(S=v)}),S}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const t=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,s=this.currentFillData.dragDirection,o=(u,c)=>{switch(s){case"up":return u.row-c>=t.from.row;case"down":return u.row+u.rowspan-1+c<=t.to.row;case"left":return u.col-c>=t.from.column;case"right":return u.col+u.colspan-1+c<=t.to.column;default:return null}};let i=0,l=null,a=1;do for(let u=0;u<r.length;u+=1){if(l=r[u],i=a*this.currentFillData.cycleLength,o(l,i))switch(s){case"up":this.plugin.mergedCellsCollection.add({row:l.row-i,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:l.row+i,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col-i,colspan:l.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col+i,colspan:l.colspan});break}u===r.length-1&&(a+=1)}while(o(l,i));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const t={min:null,max:null},r={min:null,max:null};return P(e,s=>{const o=s[0],i=this.plugin.hot.propToCol(s[1]);(t.min===null||o<t.min)&&(t.min=o),(t.max===null||o>t.max)&&(t.max=o),(r.min===null||i<r.min)&&(r.min=i),(r.max===null||i>r.max)&&(r.max=i)}),{from:{row:t.min,column:r.min},to:{row:t.max,column:r.max}}}dragAreaOverlapsCollections(e,t,r){const s=this.getDragArea(e,t,r),[o,i,l,a]=s,u=this.plugin.hot._createCellCoords(o,i),c=this.plugin.hot._createCellCoords(l,a),d=this.plugin.hot._createCellRange(u,u,c);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}class W7{constructor(e){this.plugin=e,this.hot=e.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}snapDelta(e,t,r){const s=t.to,o=s.row+e.row,i=s.col+e.col;e.row?this.jumpOverMergedCell(e,r,o):e.col&&this.jumpOverMergedCell(e,r,i)}jumpOverMergedCell(e,t,r){let s=e.row||e.col,o=null,i=null,l=null;e.row?(o=t.includesVertically(r),i=t.row,l=t.getLastRow()):e.col&&(o=t.includesHorizontally(r),i=t.col,l=t.getLastColumn()),s!==0&&(s>0?o&&r!==i&&(s+=l-r+1):o&&r!==l&&(s-=r-i+1),e.row?e.row=s:e.col&&(e.col=s))}getUpdatedSelectionRange(e,t){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+t.row,e.to.col+t.col))}getSelectedMergedCellClassName(e,t,r,s){const o=Math.min(r[0],r[2]),i=Math.min(r[1],r[3]),l=Math.max(r[0],r[2]),a=Math.max(r[1],r[3]);if(s===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t))return;const c=this.plugin.mergedCellsCollection.get(e,t);if(!c)return;const d=c.getLastRow(),f=c.getLastColumn();if(o<=c.row&&i<=c.col&&l>=d&&a>=f)return`${this.fullySelectedMergedCellClassName}-${s}`;if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,t){const r=[];if(!t||!e)return!1;for(let s=0;s<e.rowspan;s+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+s,e.col+o));for(let s=0;s<r.length;s+=1){const o=[];for(let i=0;i<t.length;i+=1)o[i]=t[i].includes(r[s]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let t=0;t<=7;t+=1)e.push(`${this.fullySelectedMergedCellClassName}-${t}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function U7(n){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const t=n.mergedCellsCollection.get(e[0],e[1]);if(t.row===e[0]&&t.col===e[1]&&t.row+t.rowspan-1===e[2]&&t.col+t.colspan-1===e[3])return this.getTranslatedPhrase(_S)}return this.getTranslatedPhrase(MS)},callback(){n.toggleMergeOnSelection()},disabled(){const e=this.getSelectedLast();return e?es.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}he.getSingleton().register("beforeMergeCells");he.getSingleton().register("afterMergeCells");he.getSingleton().register("beforeUnmergeCells");he.getSingleton().register("afterUnmergeCells");const Za="mergeCells",z7=150,A1=new WeakMap,P1=Za;class Y7 extends nt{static get PLUGIN_KEY(){return Za}static get PLUGIN_PRIORITY(){return z7}constructor(e){super(e),A1.set(this,{lastDesiredCoords:null}),this.mergedCellsCollection=null,this.autofillCalculations=null,this.selectionCalculations=null}isEnabled(){return!!this.hot.getSettings()[Za]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new rR(this),this.autofillCalculations=new B7(this),this.selectionCalculations=new W7(this),this.addHook("afterInit",function(){return e.onAfterInit(...arguments)}),this.addHook("modifyTransformStart",function(){return e.onModifyTransformStart(...arguments)}),this.addHook("afterModifyTransformStart",function(){return e.onAfterModifyTransformStart(...arguments)}),this.addHook("modifyTransformEnd",function(){return e.onModifyTransformEnd(...arguments)}),this.addHook("modifyGetCellCoords",function(){return e.onModifyGetCellCoords(...arguments)}),this.addHook("beforeSetRangeStart",function(){return e.onBeforeSetRangeStart(...arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return e.onBeforeSetRangeStart(...arguments)}),this.addHook("beforeSetRangeEnd",function(){return e.onBeforeSetRangeEnd(...arguments)}),this.addHook("afterIsMultipleSelection",function(){return e.onAfterIsMultipleSelection(...arguments)}),this.addHook("afterRenderer",function(){return e.onAfterRenderer(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return e.addMergeActionsToContextMenu(...arguments)}),this.addHook("afterGetCellMeta",function(){return e.onAfterGetCellMeta(...arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return e.onAfterViewportRowCalculatorOverride(...arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return e.onAfterViewportColumnCalculatorOverride(...arguments)}),this.addHook("modifyAutofillRange",function(){return e.onModifyAutofillRange(...arguments)}),this.addHook("afterCreateCol",function(){return e.onAfterCreateCol(...arguments)}),this.addHook("afterRemoveCol",function(){return e.onAfterRemoveCol(...arguments)}),this.addHook("afterCreateRow",function(){return e.onAfterCreateRow(...arguments)}),this.addHook("afterRemoveRow",function(){return e.onAfterRemoveRow(...arguments)}),this.addHook("afterChange",function(){return e.onAfterChange(...arguments)}),this.addHook("beforeDrawBorders",function(){return e.onBeforeDrawAreaBorders(...arguments)}),this.addHook("afterDrawSelection",function(){return e.onAfterDrawSelection(...arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return e.onBeforeRemoveCellClassNames(...arguments)}),this.addHook("beforeUndoStackChange",(t,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[Za];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!ex())return;const e=[];let t=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:s,rowspan:o}=r;for(let i=s+1;i<s+o;i++)t.push(i)}),t=[...new Set(t)],t.forEach(r=>{const s=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const i=o.getRow(s);i&&(i.style.background=Yu(i,"backgroundColor").replace(")",", 0.99)"),e.push(i))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{r.style.background=Yu(r,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){let t=!0;return e?(es.containsNegativeValues(e)?(ct(es.NEGATIVE_VALUES_WARNING(e)),t=!1):es.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(ct(es.IS_OUT_OF_BOUNDS_WARNING(e)),t=!1):es.isSingleCell(e)?(ct(es.IS_SINGLE_CELL(e)),t=!1):es.containsZeroSpan(e)&&(ct(es.ZERO_SPAN_WARNING(e)),t=!1),t):!1}generateFromSettings(e){if(Array.isArray(e)){const t=[];if(P(e,r=>{if(!this.validateSetting(r))return;const s=this.hot._createCellCoords(r.row,r.col),o=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1),i=this.hot._createCellRange(s,s,o);this.mergeRange(i,!0,!0),Ce(r.row,r.row+r.rowspan-1,l=>{Ce(r.col,r.col+r.colspan-1,a=>{l===r.row&&a===r.col||t.push([l,a,null])})})}),t.length===0)return;this.hot.setDataAtCell(t)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}toggleMergeOnSelection(){const e=this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:r}=e;this.toggleMerge(e),this.hot.selectCell(t.row,t.col,r.row,r.col,!1)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:t,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,r.row,r.col,!1)}mergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=e.getTopStartCorner(),o=e.getBottomEndCorner(),i={row:s.row,col:s.col,rowspan:o.row-s.row+1,colspan:o.col-s.col+1},l=[];let a=null;return this.canMergeRange(i,t)?(this.hot.runHooks("beforeMergeCells",e,t),Ce(0,i.rowspan-1,c=>{Ce(0,i.colspan-1,d=>{let f=null;l[c]||(l[c]=[]),c===0&&d===0?f=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(i.row),this.hot.toPhysicalColumn(i.col)):this.hot.setCellMeta(i.row+c,i.col+d,"hidden",!0),l[c][d]=f})}),this.hot.setCellMeta(i.row,i.col,"spanned",!0),this.mergedCellsCollection.add(i)?(r?a=[i.row,i.col,l]:this.hot.populateFromArray(i.row,i.col,l,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,i,t),a):!0):!1}unmergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r&&(this.hot.runHooks("beforeUnmergeCells",e,t),P(r,s=>{this.mergedCellsCollection.remove(s.row,s.col),Ce(0,s.rowspan-1,o=>{Ce(0,s.colspan-1,i=>{this.hot.removeCellMeta(s.row+o,s.col+i,"hidden"),this.hot.removeCellMeta(s.row+o,s.col+i,"copyable")})}),this.hot.removeCellMeta(s.row,s.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){const t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,r,s){const o=this.hot._createCellCoords(e,t),i=this.hot._createCellCoords(r,s);this.mergeRange(this.hot._createCellRange(o,o,i))}unmerge(e,t,r,s){const o=this.hot._createCellCoords(e,t),i=this.hot._createCellCoords(r,s);this.unmergeRange(this.hot._createCellRange(o,o,i))}onAfterInit(){this.generateFromSettings(this.hot.getSettings()[Za]),this.hot.render()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{this.toggleMerge(this.hot.getSelectedRangeLast()),this.hot.render()},runOnlyIf:r=>!r.altKey,group:P1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(P1)}onAfterIsMultipleSelection(e){if(e){const t=this.mergedCellsCollection.mergedCells,r=this.hot.getSelectedRangeLast();for(let s=0;s<t.length;s+=1)if(r.from.row===t[s].row&&r.from.col===t[s].col&&r.to.row===t[s].row+t[s].rowspan-1&&r.to.col===t[s].col+t[s].colspan-1)return!1}return e}onModifyTransformStart(e){const t=A1.get(this),r=this.hot.getSelectedRangeLast();let s={row:e.row,col:e.col},o=null;const i=this.hot._createCellCoords(r.highlight.row,r.highlight.col),l=this.mergedCellsCollection.get(i.row,i.col);if(t.lastDesiredCoords||(t.lastDesiredCoords=this.hot._createCellCoords(null,null)),l){const u=this.hot._createCellCoords(l.row,l.col),c=this.hot._createCellCoords(l.row+l.rowspan-1,l.col+l.colspan-1);this.hot._createCellRange(u,u,c).includes(t.lastDesiredCoords)||(t.lastDesiredCoords=this.hot._createCellCoords(null,null)),s.row=t.lastDesiredCoords.row?t.lastDesiredCoords.row-i.row:s.row,s.col=t.lastDesiredCoords.col?t.lastDesiredCoords.col-i.col:s.col,e.row>0?s.row=l.row+l.rowspan-1-i.row+e.row:e.row<0&&(s.row=i.row-l.row+e.row),e.col>0?s.col=l.col+l.colspan-1-i.col+e.col:e.col<0&&(s.col=i.col-l.col+e.col)}o=this.hot._createCellCoords(r.highlight.row+s.row,r.highlight.col+s.col);const a=this.mergedCellsCollection.get(o.row,o.col);if(a){const u=this.mergedCellsCollection.getFirstRenderableCoords(a.row,a.col);t.lastDesiredCoords=o,s={row:u.row-i.row,col:u.col-i.col}}s.row!==0&&(e.row=s.row),s.col!==0&&(e.col=s.col)}onModifyTransformEnd(e){const t=this.hot.getSelectedRangeLast(),r=Fn(e),s=this.selectionCalculations.getUpdatedSelectionRange(t,e);let o=Fn(r);const i=this.mergedCellsCollection.getWithinRange(s,!0);do o=Fn(r),this.selectionCalculations.getUpdatedSelectionRange(t,r),P(i,l=>{this.selectionCalculations.snapDelta(r,t,l)});while(r.row!==o.row||r.col!==o.col);e.row=r.row,e.col=r.col}onModifyGetCellCoords(e,t){if(e<0||t<0)return;const r=this.mergedCellsCollection.get(e,t);if(!r)return;const{row:s,col:o,colspan:i,rowspan:l}=r;return[s,o,s+l-1,o+i-1]}addMergeActionsToContextMenu(e){e.items.push({name:"---------"},U7(this))}onAfterRenderer(e,t,r){const s=this.mergedCellsCollection.get(t,r),o=$e(s)?Fn(s):void 0;if($e(o)){const{rowIndexMapper:i,columnIndexMapper:l}=this.hot,{row:a,col:u,colspan:c,rowspan:d}=o,[f,m]=this.translateMergedCellToRenderable(a,d,u,c),p=i.getRenderableFromVisualIndex(t),w=l.getRenderableFromVisualIndex(r),M=f-p+1,S=m-w+1;o.row=i.getNearestNotHiddenIndex(o.row,1),o.col=l.getNearestNotHiddenIndex(o.col,1),o.rowspan=Math.min(o.rowspan,M),o.colspan=Math.min(o.colspan,S)}ey(e,o,t,r)}onBeforeSetRangeStart(e){if(this.mergedCellsCollection.isFirstRenderableMergedCell(e.row,e.col)){const t=this.mergedCellsCollection.get(e.row,e.col);[e.row,e.col]=[t.row,t.col]}}onBeforeSetRangeEnd(e){const t=this.hot.getSelectedRangeLast();t.highlight=this.hot._createCellCoords(t.highlight.row,t.highlight.col),t.to=e;let r=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{r=!1;for(let s=0;s<this.mergedCellsCollection.mergedCells.length;s+=1){const i=this.mergedCellsCollection.mergedCells[s].getRange();t.expandByRange(i)&&(e.row=t.to.row,e.col=t.to.col,r=!0)}}while(r)}onAfterGetCellMeta(e,t,r){const s=this.mergedCellsCollection.get(e,t);s&&(s.row!==e||s.col!==t?r.copyable=!1:(r.rowspan=s.rowspan,r.colspan=s.colspan))}onAfterViewportRowCalculatorOverride(e){const t=this.hot.countCols();this.modifyViewportRowStart(e,t),this.modifyViewportRowEnd(e,t)}modifyViewportRowStart(e,t){const r=this.hot.rowIndexMapper,s=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<t;o+=1){const i=this.mergedCellsCollection.get(s,o);if($e(i)){const l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(i.row,1));if(l<e.startRow){e.startRow=l,this.modifyViewportRowStart(e,t);return}}}}modifyViewportRowEnd(e,t){const r=this.hot.rowIndexMapper,s=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<t;o+=1){const i=this.mergedCellsCollection.get(s,o);if($e(i)){const l=i.row+i.rowspan-1,a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(l,-1));if(a>e.endRow){e.endRow=a,this.modifyViewportRowEnd(e,t);return}}}}onAfterViewportColumnCalculatorOverride(e){const t=this.hot.countRows();this.modifyViewportColumnStart(e,t),this.modifyViewportColumnEnd(e,t)}modifyViewportColumnStart(e,t){const r=this.hot.columnIndexMapper,s=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<t;o+=1){const i=this.mergedCellsCollection.get(o,s);if($e(i)){const l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(i.col,1));if(l<e.startColumn){e.startColumn=l,this.modifyViewportColumnStart(e,t);return}}}}modifyViewportColumnEnd(e,t){const r=this.hot.columnIndexMapper,s=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<t;o+=1){const i=this.mergedCellsCollection.get(o,s);if($e(i)){const l=i.col+i.colspan-1,a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(l,-1));if(a>e.endColumn){e.endColumn=a,this.modifyViewportColumnEnd(e,t);return}}}}translateMergedCellToRenderable(e,t,r,s){const{rowIndexMapper:o,columnIndexMapper:i}=this.hot;let l,a;t===0?l=o.getNearestNotHiddenIndex(e,1):l=o.getNearestNotHiddenIndex(e+t-1,-1),s===0?a=i.getNearestNotHiddenIndex(r,1):a=i.getNearestNotHiddenIndex(r+s-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(l):e,c=r>=0?i.getRenderableFromVisualIndex(a):r;return[u,c]}onModifyAutofillRange(e,t){this.autofillCalculations.correctSelectionAreaSize(t);const r=this.autofillCalculations.getDirection(t,e);let s=e;if(this.autofillCalculations.dragAreaOverlapsCollections(t,s,r))return s=t,s;const o=this.mergedCellsCollection.getWithinRange({from:{row:t[0],col:t[1]},to:{row:t[2],col:t[3]}});return o&&(s=this.autofillCalculations.snapDragArea(t,s,r,o)),s}onAfterCreateCol(e,t){this.mergedCellsCollection.shiftCollections("right",e,t)}onAfterRemoveCol(e,t){this.mergedCellsCollection.shiftCollections("left",e,t)}onAfterCreateRow(e,t,r){r!=="auto"&&this.mergedCellsCollection.shiftCollections("down",e,t)}onAfterRemoveRow(e,t){this.mergedCellsCollection.shiftCollections("up",e,t)}onAfterChange(e,t){t==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(e)}onBeforeDrawAreaBorders(e,t){if(t&&t==="area"){const r=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getWithinRange(r);P(s,o=>{r.getBottomEndCorner().row===o.getLastRow()&&r.getBottomEndCorner().col===o.getLastColumn()&&(e[2]=o.row,e[3]=o.col)})}}onAfterModifyTransformStart(e,t,r){if(!this.enabled)return;const s=this.mergedCellsCollection.get(e.row,e.col);if(!s)return;const o=t>0,i=t<0,l=r<0,a=r>0,u=s.row+s.rowspan-1===this.hot.countRows()-1,c=s.row===0,d=s.col+s.colspan-1===this.hot.countCols()-1,f=s.col===0;(o&&u||i&&c||a&&d||l&&f)&&(e.row=s.row,e.col=s.col)}onAfterDrawSelection(e,t,r,s){if(r)return this.selectionCalculations.getSelectedMergedCellClassName(e,t,r,s)}onBeforeRemoveCellClassNames(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}function j7(n,e){return function(t,r){const[,...s]=t,[,...o]=r;return function i(l){const a=n[l],u=e[l],c=s[l],d=o[l],f=u.multiColumnSorting,p=(f.compareFunctionFactory?f.compareFunctionFactory:RA(u.type))(a,u,f)(c,d);if(p===us){const w=l+1;if(typeof e[w]<"u")return i(w)}return p}(0)}}function H1(){ct(ot`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const cP="sort";function G7(n,e,t){const r=[];return t===!1||n.isColumnSorted(e)&&n.getNumberOfSortedColumns()>1&&r.push(`${cP}-${n.getIndexOfColumnInSortQueue(e)+1}`),r}function K7(n){const e=n.className.split(" "),t=new RegExp(`^${cP}-[0-9]{1,2}$`);return e.filter(r=>t.test(r))}const ty="multiColumnSorting",X7=170,q7="append",D1="columnSorting";SA(ty,j7);class Q7 extends bA{static get PLUGIN_KEY(){return ty}static get PLUGIN_PRIORITY(){return X7}constructor(e){super(e),this.pluginKey=ty}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[D1]&&H1(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];super.updateHeaderClasses(e,...r),He(e,K7(e)),this.enabled!==!1&&ee(e,G7(...r))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[D1]&&H1(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,t){jC(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,q7))):this.sort(this.getColumnNextConfig(t.col)))}}const Z7="multipleSelectionHandles",J7=160;class eX extends nt{static get PLUGIN_KEY(){return Z7}static get PLUGIN_PRIORITY(){return J7}constructor(e){super(e),this.dragged=[],this.eventManager=null,this.lastSetCell=null}isEnabled(){return is()}enablePlugin(){this.enabled||(this.eventManager||(this.eventManager=new It(this)),this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:t}=this.hot;function r(s){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(s);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(t,"touchstart",s=>{let o;if(Oe(s.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},s.preventDefault(),!1;if(Oe(s.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},s.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchend",s=>{if(Oe(s.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,s.preventDefault(),!1;if(Oe(s.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,s.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchmove",s=>{const{rootDocument:o}=this.hot;let i,l,a,u,c,d;if(e.dragged.length===0)return;const f=o.elementFromPoint(s.touches[0].clientX,s.touches[0].clientY);!f||f===e.lastSetCell||((f.nodeName==="TD"||f.nodeName==="TH")&&(i=e.hot.getCoords(f),i.col===-1&&(i.col=0),l=e.hot.getSelectedRangeLast(),a=l.getWidth(),u=l.getHeight(),c=l.getDirection(),a===1&&u===1&&e.hot.selection.setRangeEnd(i),d=e.getCurrentRangeCoords(l,i,e.touchStartRange.direction,c,e.dragged[0]),d.start!==null&&e.hot.selection.setRangeStart(d.start),e.hot.selection.setRangeEnd(d.end),e.lastSetCell=f),s.preventDefault())})}getCurrentRangeCoords(e,t,r,s,o){const i=e.getTopStartCorner(),l=e.getBottomEndCorner(),a=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(s){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(a.row,t.col)}:c={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,i.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(l.row,t.col),end:this.hot._createCellCoords(t.row,i.col)});break}break;case"NW-SE":switch(s){case"NE-SW":o==="top"?c={start:t,end:a}:c.end=t;break;case"NW-SE":o==="top"?c={start:t,end:l}:c.end=t;break;case"SE-NW":o==="top"?c={start:t,end:i}:c.end=t;break;case"SW-NE":o==="top"?c={start:t,end:u}:c.end=t;break}break;case"SW-NE":switch(s){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(t.row,i.col),end:this.hot._createCellCoords(a.row,t.col)}:c={start:this.hot._createCellCoords(i.row,t.col),end:this.hot._createCellCoords(t.row,l.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,l.col)}:c={start:this.hot._createCellCoords(t.row,i.col),end:this.hot._createCellCoords(i.row,t.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(t.row,u.col),end:this.hot._createCellCoords(i.row,t.col)}:o==="top"&&(c={start:a,end:t});break}break;case"SE-NW":switch(s){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=t);break;case"SE-NW":o==="top"?c.end=t:c={start:t,end:i};break}break}return c}isDragged(){return this.dragged.length>0}}function ny(){let{label:n="",colspan:e=1,origColspan:t=1,collapsible:r=!1,crossHiddenColumns:s=[],isCollapsed:o=!1,isHidden:i=!1,isRoot:l=!1,isPlaceholder:a=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:n,colspan:e,origColspan:t,collapsible:r,isCollapsed:o,crossHiddenColumns:s,isHidden:i,isRoot:l,isPlaceholder:a}}function hP(){return{label:"",isPlaceholder:!0}}function tX(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const t=[];if(e===0)return t;P(n,s=>{const o=[];let i=0;t.push(o),P(s,l=>{const a=ny();if($e(l)){const{label:c,colspan:d}=l;a.label=Lt(c),typeof d=="number"&&d>1&&(a.colspan=d,a.origColspan=d)}else a.label=Lt(l);i+=a.origColspan;let u=!1;if(i>=e&&(a.colspan=a.origColspan-(i-e),a.origColspan=a.colspan,u=!0),o.push(a),a.colspan>1)for(let c=0;c<a.colspan-1;c++)o.push(hP());return!u})});const r=Math.max(...Ve(t,s=>s.length));return P(t,s=>{if(s.length<r){const o=Ve(new Array(r-s.length),()=>ny());s.splice(s.length,0,...o)}}),t}function lw(n,e,t){nX(n,e),e.set(n,t)}function nX(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Or(n,e){var t=dP(n,e,"get");return rX(n,t)}function rX(n,e){return e.get?e.get.call(n):e.value}function Ba(n,e,t){var r=dP(n,e,"set");return sX(n,r,t),t}function dP(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function sX(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}const k1=["label","collapsible"];var Es=new WeakMap,ni=new WeakMap,aw=new WeakMap;class oX{constructor(){lw(this,Es,{writable:!0,value:[]}),lw(this,ni,{writable:!0,value:0}),lw(this,aw,{writable:!0,value:1/0})}setColumnsLimit(e){Ba(this,aw,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Ba(this,Es,tX(e,Or(this,aw))),Ba(this,ni,Or(this,Es).length)}getData(){return Or(this,Es)}mergeWith(e){P(e,t=>{let{row:r,col:s,...o}=t;const i=this.getHeaderSettings(r,s);i!==null&&Ut(i,o,k1)})}map(e){P(Or(this,Es),t=>{P(t,r=>{const s=e({...r});$e(s)&&Ut(r,s,k1)})})}getHeaderSettings(e,t){var r;if(e>=Or(this,ni)||e<0)return null;const s=Or(this,Es)[e];return t>=s.length?null:(r=s[t])!==null&&r!==void 0?r:null}getHeadersSettings(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const s=[];if(e>=Or(this,ni)||e<0)return s;const o=Or(this,Es)[e];let i=0;for(let l=t;l<o.length;l++){const a=o[l];if(a.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(i+=a.colspan,s.push(a),a.colspan>1&&(l+=a.colspan-1),i===r)break;if(i>r)throw new Error("The last column settings cannot overlap the other header layers")}return s}getLayersCount(){return Or(this,ni)}getColumnsCount(){return Or(this,ni)>0?Or(this,Es)[0].length:0}clear(){Ba(this,Es,[]),Ba(this,ni,0)}}function uw(n,e,t){return e=iX(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function iX(n){var e=lX(n,"string");return typeof e=="symbol"?e:String(e)}function lX(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const aX="DF-pre-order";function fP(n,e){let t=n.call(e,this);for(let r=0;r<this.childs.length;r++){if(t===!1)return!1;t=fP.call(this.childs[r],n,e)}return t}const uX="DF-post-order";function gP(n,e){for(let t=0;t<this.childs.length;t++)if(gP.call(this.childs[t],n,e)===!1)return!1;return n.call(e,this)}const mP="BF";function cX(n,e){const t=[this];function r(){if(t.length===0)return;const s=t.shift();t.push(...s.childs),n.call(e,s)!==!1&&r()}r()}const hX=mP,N1=new Map([[aX,fP],[uX,gP],[mP,cX]]);class vf{constructor(e){uw(this,"data",{}),uw(this,"parent",null),uw(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const t=new vf({...e.data});for(let r=0;r<e.childs.length;r++)t.addChild(this.cloneTree(e.childs[r]));return t}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}walkDown(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:hX;if(!N1.has(t))throw new Error(`Traversal strategy "${t}" does not exist`);N1.get(t).call(this,e,this)}walkUp(e){const t=this,r=s=>{e.call(t,s)!==!1&&s.parent!==null&&r(s.parent)};r(this)}}function cw(n,e,t){dX(n,e),e.set(n,t)}function dX(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rn(n,e){var t=pP(n,e,"get");return fX(n,t)}function fX(n,e){return e.get?e.get.call(n):e.value}function gX(n,e,t){var r=pP(n,e,"set");return mX(n,r,t),t}function pP(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function mX(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var ul=new WeakMap,ri=new WeakMap,cl=new WeakMap;class pX{constructor(e){cw(this,ul,{writable:!0,value:new Map}),cw(this,ri,{writable:!0,value:new Map}),cw(this,cl,{writable:!0,value:null}),gX(this,cl,e)}getRoots(){return Array.from(Rn(this,ul).values())}getRootByColumn(e){let t;return Rn(this,ri).has(e)&&(t=Rn(this,ul).get(Rn(this,ri).get(e))),t}getNode(e,t){const r=this.getRootByColumn(t);if(!r)return;const s=t-Rn(this,ri).get(t);let o=0,i;return r.walkDown(l=>{const{data:{origColspan:a,headerLevel:u}}=l;if(e===u){if(s>=o&&s<=o+a-1)return i=l,i.data.isRoot=t===i.data.columnIndex,!1;o+=a}}),i}rebuildTreeIndex(){let e=0;Rn(this,ri).clear(),P(Rn(this,ul),t=>{let[,{data:{colspan:r}}]=t;for(let s=e;s<e+r;s++)Rn(this,ri).set(s,e);e+=r})}buildTree(){this.clear();const e=Rn(this,cl).getColumnsCount();let t=0;for(;t<e;){const r=Rn(this,cl).getHeaderSettings(0,t),s=new vf;Rn(this,ul).set(t,s),this.buildLeaves(s,t,0,r.origColspan),t+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,t,r){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=Rn(this,cl).getHeadersSettings(r,t,s);r+=1,P(o,i=>{const l={...i,headerLevel:r-1,columnIndex:t};let a;r===1?(e.data=l,a=e):(a=new vf(l),e.addChild(a)),r<Rn(this,cl).getLayersCount()&&this.buildLeaves(a,t,r,i.origColspan),t+=i.origColspan})}clear(){Rn(this,ul).clear(),Rn(this,ri).clear()}}function wP(n,e){n.walkDown(t=>{let{data:r,childs:s}=t;if(!r.isHidden&&(e(r.columnIndex),s.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function Sf(n,e){let{childs:t}=n;if(t.length!==0)return t[0].data[e]}function Rf(n){return Sf(n,"origColspan")===n.data.origColspan}function sR(n){const{data:e,childs:t}=n;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Rf(n))return sR(t[0]);e.isCollapsed=!1;const s=t.slice(1),o=new Set;let i=0;if(s.length>0)P(s,l=>{l.replaceTreeWith(l.data.clonedTree),l.data.clonedTree=null;const a=l.data;i+=a.colspan,wP(l,u=>{o.add(u)})});else{const{colspan:l,origColspan:a,columnIndex:u}=e;i=a-l;for(let c=1;c<a;c++)o.add(u+c)}return n.walkUp(l=>{const{data:a}=l;a.colspan+=i,a.colspan>=a.origColspan?(a.colspan=a.origColspan,a.isCollapsed=!1):Rf(l)&&(a.isCollapsed=Sf(l,"isCollapsed"))}),{rollbackModification:()=>oR(n),affectedColumns:Array.from(o),colspanCompensation:i}}function oR(n){var e;const{data:t,childs:r}=n;if(t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Rf(n))return oR(r[0]);t.isCollapsed=!0;const o=r.slice(1),i=new Set;if(o.length>0)P(o,a=>{wP(a,u=>{i.add(u)}),a.data.clonedTree=a.cloneTree(),a.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:a,columnIndex:u}=t;for(let c=1;c<a;c++){const d=u+c;i.add(d)}}const l=t.colspan-((e=Sf(n,"colspan"))!==null&&e!==void 0?e:1);return n.walkUp(a=>{const{data:u}=a;u.colspan-=l,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):Rf(a)&&(u.isCollapsed=Sf(a,"isCollapsed"))}),{rollbackModification:()=>sR(n),affectedColumns:Array.from(i),colspanCompensation:l}}function wX(n,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(n.childs.length>0)throw new Error(ot`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:t}=n.data;if(t.includes(e))return;let r=!1;n.walkUp(s=>{const{data:{collapsible:o}}=s;if(o)return r=!0,!1}),!r&&n.walkUp(s=>{const{data:o}=s;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function CX(n,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(n.childs.length>0)throw new Error(ot`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:t}=n.data;if(!t.includes(e))return;let r=!1;n.walkUp(s=>{const{data:{collapsible:o}}=s;if(o)return r=!0,!1}),!r&&n.walkUp(s=>{const{data:o}=s;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const L1=new Map([["collapse",oR],["expand",sR],["hide-column",wX],["show-column",CX]]);function yX(n,e,t){if(!L1.has(n))throw new Error(`The node modifier action ("${n}") does not exist.`);return L1.get(n)(e,t)}function Bh(n){const e=[];return P(n,t=>{t.walkDown(r=>{const s=r.data,{origColspan:o,columnIndex:i,headerLevel:l,crossHiddenColumns:a}=s,u=SX(e,l);let c=!1;for(let d=i;d<i+o;d++)if(a.includes(d)||c)u.push(hP());else{const m=vX(s);m.isRoot=!0,u.push(m),c=!0}})}),e}function vX(n){const{crossHiddenColumns:e,...t}=ny(n);return t}function SX(n,e){let t;return Array.isArray(n[e])?t=n[e]:(t=[],n[e]=t),t}function hw(n,e,t){RX(n,e),e.set(n,t)}function RX(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wa(n,e,t){var r=CP(n,e,"set");return bX(n,r,t),t}function bX(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function At(n,e){var t=CP(n,e,"get");return EX(n,t)}function CP(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function EX(n,e){return e.get?e.get.call(n):e.value}var Qr=new WeakMap,Yn=new WeakMap,si=new WeakMap;class TX{constructor(){hw(this,Qr,{writable:!0,value:new oX}),hw(this,Yn,{writable:!0,value:new pX(At(this,Qr))}),hw(this,si,{writable:!0,value:[[]]})}setState(e){At(this,Qr).setData(e);let t=!1;try{At(this,Yn).buildTree()}catch{At(this,Yn).clear(),At(this,Qr).clear(),t=!0}return Wa(this,si,Bh(At(this,Yn).getRoots())),t}setColumnsLimit(e){At(this,Qr).setColumnsLimit(e)}mergeStateWith(e){const t=Ve(e,r=>{let{row:s,...o}=r;return{row:s<0?this.rowCoordsToLevel(s):s,...o}});At(this,Qr).mergeWith(t),At(this,Yn).buildTree(),Wa(this,si,Bh(At(this,Yn).getRoots()))}mapState(e){At(this,Qr).map(e),At(this,Yn).buildTree(),Wa(this,si,Bh(At(this,Yn).getRoots()))}mapNodes(e){return Sn(At(this,Yn).getRoots(),(t,r)=>(r.walkDown(s=>{const o=e(s.data);o!==void 0&&t.push(o)}),t),[])}triggerNodeModification(e,t,r){t<0&&(t=this.rowCoordsToLevel(t));const s=At(this,Yn).getNode(t,r);let o;return s&&(o=yX(e,s,r),Wa(this,si,Bh(At(this,Yn).getRoots()))),o}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){if(e>=0)return null;const t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}levelToRowCoords(e){if(e<0)return null;const t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}getHeaderSettings(e,t){var r,s;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(s=At(this,si)[e])===null||s===void 0?void 0:s[t])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,t){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=At(this,Yn).getNode(e,t);return r?{...r.data}:null}findLeftMostColumnIndex(e,t){var r;const{isRoot:s}=(r=this.getHeaderSettings(e,t))!==null&&r!==void 0?r:{isRoot:!0};if(s)return t;let o=t-1;for(;o>=0;){var i;const{isRoot:l}=(i=this.getHeaderSettings(e,o))!==null&&i!==void 0?i:{isRoot:!0};if(l)break;o-=1}return o}getLayersCount(){return At(this,Qr).getLayersCount()}getColumnsCount(){return At(this,Qr).getColumnsCount()}clear(){Wa(this,si,[]),At(this,Qr).clear(),At(this,Yn).clear()}}function Ua(n,e,t){return e=MX(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function MX(n){var e=_X(n,"string");return typeof e=="symbol"?e:String(e)}function _X(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class OX{constructor(e,t){Ua(this,"hot",void 0),Ua(this,"nestedHeaderSettingsGetter",void 0),Ua(this,"layersCount",0),Ua(this,"container",void 0),Ua(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),t=e.length;this.widthsMap.clear();for(let r=0;r<t;r++){const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),o=this.hot.toPhysicalColumn(s);this.widthsMap.setValueAtIndex(o,e[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:t,columnIndexMapper:r}=this.hot,s=t.createDocumentFragment(),o=t.createElement("table"),i=!!this.hot.getSettings().dropdownMenu,l=r.getRenderableIndexesLength();for(let a=0;a<this.layersCount;a++){const u=t.createElement("tr");for(let c=0;c<l;c++){let d=r.getVisualFromRenderableIndex(c);d===null&&(d=c);const f=t.createElement("th"),m=this.nestedHeaderSettingsGetter(a,d);if(m&&(!m.isPlaceholder||m.isHidden)){let p=m.label;i&&(p+='<button class="changeType"></button>'),ia(f,p),f.colSpan=m.colspan,u.appendChild(f)}}o.appendChild(u)}s.appendChild(o),e.appendChild(s)}clear(){this.widthsMap.clear(),this.container=null}}function F1(n,e,t){return e=IX(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function IX(n){var e=xX(n,"string");return typeof e=="symbol"?e:String(e)}function xX(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function V1(n,e,t){AX(n,e),e.set(n,t)}function AX(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wh(n,e,t){var r=yP(n,e,"set");return PX(n,r,t),t}function PX(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function Rt(n,e){var t=yP(n,e,"get");return HX(n,t)}function yP(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function HX(n,e){return e.get?e.get.call(n):e.value}const $1="nestedHeaders",DX=280;var Dt=new WeakMap,io=new WeakMap;class kX extends nt{constructor(){super(...arguments),V1(this,Dt,{writable:!0,value:new TX}),V1(this,io,{writable:!0,value:null}),F1(this,"ghostTable",new OX(this.hot,(e,t)=>this.getHeaderSettings(e,t))),F1(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return $1}static get PLUGIN_PRIORITY(){return DX}isEnabled(){return!!this.hot.getSettings()[$1]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();(!Array.isArray(t)||!Array.isArray(t[0]))&&ct(ot`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>this.onInit()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("afterOnCellMouseDown",function(){return e.onAfterOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return e.onBeforeOnCellMouseOver(...arguments)}),this.addHook("afterGetColumnHeaderRenderers",r=>this.onAfterGetColumnHeaderRenderers(r)),this.addHook("modifyColWidth",function(){return e.onModifyColWidth(...arguments)}),this.addHook("modifyColumnHeaderValue",function(){return e.onModifyColumnHeaderValue(...arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return e.onBeforeHighlightingColumnHeader(...arguments)}),this.addHook("beforeCopy",function(){return e.onBeforeCopy(...arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return e.onAfterViewportColumnCalculatorOverride(...arguments)}),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Rt(this,Dt).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Rt(this,Dt).setState(e)),this.detectedOverlappedHeaders&&ct(ot`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((t,r)=>{const s=t===!0?"hide-column":"show-column";Rt(this,Dt).triggerColumnModification(s,r)}),!Rt(this,io)&&this.enabled&&Wh(this,io,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(t=>{t.forEach(r=>{let{op:s,index:o,newValue:i}=r;if(s==="replace"){const l=i===!0?"hide-column":"show-column";Rt(this,Dt).triggerColumnModification(l,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Rt(this,Dt).clear(),Rt(this,io).unsubscribe(),Wh(this,io,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Rt(this,Dt)}getLayersCount(){return Rt(this,Dt).getLayersCount()}getHeaderSettings(e,t){return Rt(this,Dt).getHeaderSettings(e,t)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,t=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,s=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let i=0;i<t;i++){const l=r.childNodes[i];if(!l)break;const a=s.childNodes[i],u=o?o.childNodes[i]:null;for(let c=0,d=l.childNodes.length;c<d;c++)l.childNodes[c].removeAttribute("colspan"),He(l.childNodes[c],"hiddenHeader"),a&&a.childNodes[c]&&(a.childNodes[c].removeAttribute("colspan"),He(a.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),He(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var t=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(s,o)=>{var i;const{columnIndexMapper:l,view:a}=this.hot;let u=l.getVisualFromRenderableIndex(s);u===null&&(u=s),o.removeAttribute("colspan"),He(o,"hiddenHeader");const{colspan:c,isHidden:d,isPlaceholder:f}=(i=Rt(this,Dt).getHeaderSettings(e,u))!==null&&i!==void 0?i:{label:""};if(f||d)ee(o,"hiddenHeader");else if(c>1){var m,p;const{wtOverlays:w}=a._wt,M=(m=w.topInlineStartCornerOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(o),S=(p=w.inlineStartOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(o),y=M||S?Math.min(c,r-s):c;y>1&&o.setAttribute("colspan",y)}this.hot.view.appendColHeader(u,o,function(){return t.getColumnHeaderValue(...arguments)},e)}}getColumnHeaderValue(e,t){var r;const{isHidden:s,isPlaceholder:o}=(r=Rt(this,Dt).getHeaderSettings(t,e))!==null&&r!==void 0?r:{};return o||s?"":this.hot.getColHeader(e,t)}onBeforeHighlightingColumnHeader(e,t,r){const s=Rt(this,Dt).getHeaderTreeNodeData(t,e);if(!s)return e;const{classNames:o,columnCursor:i,selectionType:l,selectionWidth:a}=r,{isRoot:u,colspan:c}=Rt(this,Dt).getHeaderSettings(t,e);if(l===Rc){if(!u)return s.columnIndex}else l===yg&&(c>a-i||!u)&&(o.length=0);return e}onBeforeCopy(e,t,r){let{columnHeadersCount:s}=r;if(s!==0)for(let i=0;i<t.length;i++){const{startRow:l,startCol:a,endRow:u,endCol:c}=t[i],d=u-l+1,f=a-c+1;if(l>=0||f===1)break;for(let m=a;m<=c;m++)for(let p=l;p<=u;p++){var o;const w=d+p,M=m-a;if(M===0)continue;((o=Rt(this,Dt).getHeaderTreeNodeData(p,m))===null||o===void 0?void 0:o.isRoot)===!1&&(e[w][M]="")}}}onBeforeOnCellMouseDown(e,t,r,s){this._getHeaderTreeNodeDataByCoords(t)&&(s.column=!0)}onAfterOnCellMouseDown(e,t){const r=this._getHeaderTreeNodeDataByCoords(t);if(!r)return;const{selection:s}=this.hot,o=s.isSelected()?s.getSelectedRange().current():null,i=[],{columnIndex:l,origColspan:a}=r,u=!s.inInSelection(t);e.shiftKey&&o?t.col<o.from.col?i.push(o.getTopEndCorner().col,l,t.row):t.col>o.from.col?i.push(o.getTopStartCorner().col,l+a-1,t.row):i.push(l,l+a-1,t.row):(Vv(e)||_i(e)&&u)&&i.push(l,l+a-1,t.row),s.selectColumns(...i)}onBeforeOnCellMouseOver(e,t,r,s){if(!this.hot.view.isMouseDown())return;const o=this._getHeaderTreeNodeDataByCoords(t);if(!o)return;const{columnIndex:i,origColspan:l}=o,a=this.hot.getSelectedRangeLast(),u=a.getTopStartCorner(),c=a.getBottomEndCorner(),{from:d}=a;s.column=!0,s.cell=!0;const f=[];t.col<d.col?f.push(c.col,i):t.col>d.col?f.push(u.col,i+l-1):f.push(i,i+l-1),this.hot.selectColumns(...f)}onAfterGetColumnHeaderRenderers(e){e.length=0;for(let t=0;t<Rt(this,Dt).getLayersCount();t++)e.push(this.headerRendererFactory(t))}onAfterViewportColumnCalculatorOverride(e){const t=Rt(this,Dt).getLayersCount();let r=e.startColumn,s=!!t;for(let o=0;o<t;o++){const i=Rt(this,Dt).findLeftMostColumnIndex(o,e.startColumn),l=this.hot.columnIndexMapper.getRenderableFromVisualIndex(i);if(i>=0&&(s=!1),Nn(l)&&l<e.startColumn){r=l;break}}e.startColumn=s?Rt(this,Dt).getHeaderTreeNodeData(0,r).columnIndex:r}onModifyColWidth(e,t){const r=this.ghostTable.getWidth(t);return e>r?e:r}onModifyColumnHeaderValue(e,t,r){var s;const{label:o}=(s=Rt(this,Dt).getHeaderTreeNodeData(r,t))!==null&&s!==void 0?s:{label:""};return o}onInit(){this.updatePlugin()}onAfterLoadData(e,t){t||this.updatePlugin()}destroy(){Wh(this,Dt,null),Rt(this,io)!==null&&(Rt(this,io).unsubscribe(),Wh(this,io,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Rt(this,Dt).getHeaderTreeNodeData(e.row,e.col)}}class NX{constructor(e,t){this.hot=t,this.data=null,this.plugin=e,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Ce(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,t,r){this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&P(e.__children,s=>{this.cacheNode(s,t+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,t,r,s){let o=!1,i=t;if(isNaN(i)&&i.end)return i;let l=e;return l||(l={__children:this.data},o=!0,i-=1),r!=null&&i===r?{result:l,end:!0}:s!=null&&l===s?{result:i,end:!0}:(i+=1,l.__children&&P(l.__children,a=>{if(this.parentReference.set(a,o?null:l),i=this.readTreeNodes(a,i,r,s),isNaN(i)&&i.end)return!1}),i)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Be(this.data[0],(t,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;isNaN(e)?t=e:t=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(t):r.__children.indexOf(t)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(P(r.__children,s=>{t+=1,s.__children&&(t+=this.countChildren(s))}),t)}getRowParent(e){let t;return isNaN(e)?t=e:t=this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let t=null;return isNaN(e)?t=e:t=this.getDataObject(e),t?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return isNaN(t)||(t=this.getDataObject(t)),!!(t.__children&&t.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,t){var r;return((r=e.__children)===null||r===void 0?void 0:r[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var t;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((t=r.__children)===null||t===void 0?void 0:t.length)!==0}addChild(e,t){let r=t;this.hot.runHooks("beforeAddChild",e,r);let s=null;e&&(s=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",s+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const i=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(i,1),this.hot.runHooks("afterCreateRow",i,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,t,r){let s=r,o;if(s||(s=this.mockNode()),this.hot.runHooks("beforeAddChild",e,s,t),e){const l=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",l,1),e.__children.splice(t,null,s),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(l,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",l,1),o=l}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[t]);s=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,s,t)}addSibling(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),s=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(t){case"below":this.addChildAtIndex(s,o+1,null);break;case"above":this.addChildAtIndex(s,o,null);break}}detachFromParent(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const s=[];Array.isArray(e)?(Ce(e[0],e[2],f=>{const m=this.translateTrimmedRow(f);s.push(this.getDataObject(m))}),Ce(0,s.length-2,f=>{this.detachFromParent(s[f],!1)}),r=s[s.length-1]):r=e;const o=this.getRowIndex(r),i=this.countChildren(r),l=this.getRowIndexWithinParent(r),a=this.getRowParent(r),u=this.getRowParent(a),c=this.getRowIndex(u);let d=null;if(this.hot.runHooks("beforeDetachChild",a,r),l!=null){const f=Array.from(new Array(o+i+1).keys()).splice(-1*(i+1));if(this.hot.runHooks("beforeRemoveRow",o,i+1,f,this.plugin.pluginName),a.__children.splice(l,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,i+1,f,this.plugin.pluginName),u){d=c+this.countChildren(u);const m=this.getChild(u,this.countChildren(u)-1),p=this.getRowIndex(m);this.hot.runHooks("beforeCreateRow",p+1,i+1,this.plugin.pluginName),u.__children.push(r)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,i+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,i+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",a,r,this.getRowIndex(r)),t&&this.hot.render()}filterData(e,t,r){const s=[];P(r,o=>{s.push(this.getDataObject(o))}),P(s,o=>{const i=this.getRowIndexWithinParent(o),l=this.getRowParent(o);l===null?this.data.splice(i,1):l.__children.splice(i,1)}),this.rewriteCache()}spliceData(e,t,r){const s=this.getDataObject(e-1);let o=null,i=e;s&&s.__children&&s.__children.length===0?(o=s,i=0):e<this.countAllRows()&&(o=this.getRowParent(e),i=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(i,t,...r):o.__children.splice(i,t):r?this.data.splice(i,t,...r):this.data.splice(i,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,r=null;do r=this.getRowParent(r),r!==null&&(t=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,r,s){const o=t===this.hot.countRows(),i=this.getRowParent(e),l=this.getRowIndexWithinParent(e),a=i.__children.slice(l,l+1),u=e>t;let c=o?this.getRowParent(t-1):this.getRowParent(t);c==null&&(c=this.getRowParent(t-1)),c==null&&(c=this.getDataObject(t-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(t),c.__children=[]);const d=o||r||s?c.__children.length:this.getRowIndexWithinParent(t),f=i===c;c.__children.splice(d,0,a[0]),i.__children.splice(l+(u&&f?1:0),1),this.syncRowWithRawSource(i),f||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}class iR{constructor(e,t){this.hot=t,this.plugin=e}}class ns extends iR{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,t){super(e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,t){const r=this.hot.toPhysicalRow(e),s=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),i=t.getElementsByTagName("DIV")[0],l=i.querySelector("span.rowHeader"),a=i.querySelectorAll('[class^="ht_nesting"]');if(P(a,u=>{u&&i.removeChild(u)}),ee(t,ns.CSS_CLASSES.indicatorContainer),s){const{rootDocument:u}=this.hot,c=l.cloneNode(!0);i.innerHTML="",Ce(0,s-1,()=>{const d=u.createElement("SPAN");ee(d,ns.CSS_CLASSES.emptyIndicator),i.appendChild(d)}),i.appendChild(c)}if(this.dataManager.hasChildren(o)){const u=this.hot.rootDocument.createElement("DIV");ee(t,ns.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?ee(u,`${ns.CSS_CLASSES.button} ${ns.CSS_CLASSES.expandButton}`):ee(u,`${ns.CSS_CLASSES.button} ${ns.CSS_CLASSES.collapseButton}`),i.appendChild(u)}}updateRowHeaderWidth(e){let t=e;t||(t=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*t+25),this.hot.render()}}class LX extends iR{constructor(e,t){var r;super(e,t),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,s)},shiftStash:function(s,o){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),P(r.lastCollapsedRows,(l,a)=>{l>=s&&l<o&&(r.lastCollapsedRows[a]=l+i)})},applyStash:function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,s),r.lastCollapsedRows=void 0},trimStash:(s,o)=>{Ce(s,s+o-1,i=>{const l=this.lastCollapsedRows.indexOf(i);l>-1&&this.lastCollapsedRows.splice(l,1)})}}}collapseChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];let o=null,i=null,l=null;return isNaN(e)?(o=e,i=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),i=e),this.dataManager.hasChildren(o)&&P(o.__children,a=>{s.push(this.dataManager.getRowIndex(a))}),l=this.collapseRows(s,!0,!1),r&&this.trimRows(l),t&&this.renderAndAdjust(),this.collapsedRows.indexOf(i)===-1&&this.collapsedRows.push(i),l}collapseMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];P(e,o=>{s.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(s),t&&this.renderAndAdjust()}collapseRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],t)}collapseRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=[];return P(e,o=>{s.push(o),t&&this.collapseChildRows(o,s)}),r&&this.trimRows(s),s}collapseChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const s=this.dataManager.getDataObject(e);P(s.__children,o=>{const i=this.dataManager.getRowIndex(o);t.push(i),this.collapseChildRows(i,t)})}r&&this.trimRows(t)}expandRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],t)}expandRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=[];return P(e,o=>{s.push(o),t&&this.expandChildRows(o,s)}),r&&this.untrimRows(s),s}expandChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const s=this.dataManager.getDataObject(e);P(s.__children,o=>{if(!this.isAnyParentCollapsed(o)){const i=this.dataManager.getRowIndex(o);t.push(i),this.expandChildRows(i,t)}})}r&&this.untrimRows(t)}expandChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];let o=null,i=null,l=null;return isNaN(e)?(o=e,i=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),i=e),this.collapsedRows.splice(this.collapsedRows.indexOf(i),1),this.dataManager.hasChildren(o)&&P(o.__children,a=>{const u=this.dataManager.getRowIndex(a);s.push(u)}),l=this.expandRows(s,!0,!1),r&&this.untrimRows(l),t&&this.renderAndAdjust(),l}expandMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];P(e,o=>{s.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(s),t&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),t=[];P(e,r=>{this.dataManager.hasChildren(r)&&t.push(r)}),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),t=[];P(e,r=>{this.dataManager.hasChildren(r)&&t.push(r)}),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{P(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{P(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)})},!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return t===null&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&P(t.__children,s=>{const o=this.dataManager.getRowIndex(s);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let t=e;for(;t!==null;){t=this.dataManager.getRowParent(t);const r=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,t){if(t.col>=0)return;const r=this.translateTrimmedRow(t.row);Oe(e.target,ns.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),ds(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}const B1=new WeakMap;class FX extends iR{constructor(e,t){super(e,t),B1.set(this,{row_above:(r,s)=>{const o=s[s.length-1];this.dataManager.addSibling(o.start.row,"above")},row_below:(r,s)=>{const o=s[s.length-1];this.dataManager.addSibling(o.start.row,"below")}}),this.dataManager=this.plugin.dataManager}appendOptions(e){const t=[{key:"add_child",name(){return this.getTranslatedPhrase(jS)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),s=this.dataManager.getDataObject(r);this.dataManager.addChild(s)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(GS)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),s=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(s)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return Ce(0,e.items.length-1,r=>{if(r===0)return P(t,(s,o)=>{e.items.splice(r+o,0,s)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){const t=B1.get(this);return Ce(0,e.items.length-1,r=>{const s=t[e.items[r].key];s!=null&&(e.items[r].callback=s)}),e}}class VX{constructor(e){this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,t,r,s){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:r,movePossible:s}))return!1;this.movedToCollapsed=!1;const i=r===this.hot.countRows(),l=i?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let a=!0;const u=e.map(p=>{if(!a)return!1;const w=this.dataManager.translateTrimmedRow(p);return a=this.shouldAllowMoving(w,l),w}),c=u.indexOf(l)===-1;if(!a||!c)return!1;const d=this.getBaseParent(u),f=this.getTargetParent(i,l),m=d===f;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(f),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,l,m),this.moveRows(u,l,f),this.dataManager.rewriteCache(),this.moveCellsMeta(u,l),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,r,s,s&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:t,finalIndex:r,dropIndex:s,movePossible:o}=e;let i=!1;return dt(s)&&(ct(ot`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",t,r,s,o,!1),i=!0),i}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||t===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let r=this.dataManager.getRowParent(e?t-1:t);return r==null&&(r=this.dataManager.getRowParent(t-1)),r}shiftCollapsibleParentsLocations(e,t,r){r||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,r){const s=t===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,t,this.movedToCollapsed,s)})})}moveCellsMeta(e,t){const r=[],s=Math.max(...e)<t;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(s?r.length:0),0,...r)}selectCells(e,t){const r=e.length;let s=0,o=0,i=null,l=null;if(this.movedToCollapsed){let a=null;e[r-1]<t?a=this.dataManager.translateTrimmedRow(t-r):a=this.dataManager.translateTrimmedRow(t);const u=this.dataManager.getRowParent(a===null?this.hot.countSourceRows()-1:a-1),c=this.dataManager.getRowIndex(u);s=this.dataManager.untranslateTrimmedRow(c),o=s}else e[r-1]<t?(o=t-1,s=o-r+1):(s=t,o=s+r-1);i=this.hot.selection,l=this.hot.countCols()-1,i.setRangeStart(this.hot._createCellCoords(s,0)),i.setRangeEnd(this.hot._createCellCoords(o,l),!0)}isRowOrderChanged(e,t){return e.some((r,s)=>r-s!==t)}}const dw="nestedRows",$X=300,Ts=new WeakMap,BX="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";class WX extends nt{static get PLUGIN_KEY(){return dw}static get PLUGIN_PRIORITY(){return $X}constructor(e){super(e),this.dataManager=null,this.headersUI=null,this.collapsedRowsMap=null,Ts.set(this,{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1})}isEnabled(){return!!this.hot.getSettings()[dw]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Sc),this.dataManager=new NX(this,this.hot),this.collapsingUI=new LX(this,this.hot),this.headersUI=new ns(this,this.hot),this.contextMenuUI=new FX(this,this.hot),this.rowMoveController=new VX(this),this.addHook("afterInit",function(){return e.onAfterInit(...arguments)}),this.addHook("beforeViewRender",function(){return e.onBeforeViewRender(...arguments)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){return e.onFilterData(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return e.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetRowHeader",function(){return e.onAfterGetRowHeader(...arguments)}),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeRemoveRow",function(){return e.onBeforeRemoveRow(...arguments)}),this.addHook("afterRemoveRow",function(){return e.onAfterRemoveRow(...arguments)}),this.addHook("beforeAddChild",function(){return e.onBeforeAddChild(...arguments)}),this.addHook("afterAddChild",function(){return e.onAfterAddChild(...arguments)}),this.addHook("beforeDetachChild",function(){return e.onBeforeDetachChild(...arguments)}),this.addHook("afterDetachChild",function(){return e.onAfterDetachChild(...arguments)}),this.addHook("modifyRowHeaderWidth",function(){return e.onModifyRowHeaderWidth(...arguments)}),this.addHook("afterCreateRow",function(){return e.onAfterCreateRow(...arguments)}),this.addHook("beforeRowMove",function(){return e.onBeforeRowMove(...arguments)}),this.addHook("beforeLoadData",t=>this.onBeforeLoadData(t)),this.addHook("beforeUpdateData",t=>this.onBeforeLoadData(t)),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}onBeforeRowMove(e,t,r,s){return this.rowMoveController.onBeforeRowMove(e,t,r,s)}disableCoreAPIModifiers(){const e=Ts.get(this);e.skipCoreAPIModifiers=!0}enableCoreAPIModifiers(){const e=Ts.get(this);e.skipCoreAPIModifiers=!1}onBeforeOnCellMouseDown(e,t,r){this.collapsingUI.toggleState(e,t,r)}onModifyRowData(e){if(!Ts.get(this).skipCoreAPIModifiers)return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!Ts.get(this).skipCoreAPIModifiers)return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,r){return Ts.get(this).skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,t,r),!1)}onFilterData(e,t,r){const s=Ts.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(r[0],t),this.collapsingUI.collapsedRowsStash.shiftStash(r[0],null,-1*t),this.dataManager.filterData(e,t,r),s.skipRender=!0,this.dataManager.getData().slice()}onAfterContextMenuDefaultOptions(e){return this.contextMenuUI.appendOptions(e)}onAfterGetRowHeader(e,t){this.headersUI.appendLevelIndicators(e,t)}onModifyRowHeaderWidth(e){return this.headersUI.rowHeaderWidthCache||e}onAfterRemoveRow(e,t,r,s){if(s===this.pluginName)return;const o=Ts.get(this);setTimeout(()=>{o.skipRender=null,this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()},0)}onBeforeRemoveRow(e,t,r){const s=Array.from(r.reduce((o,i)=>{if(this.dataManager.isParent(i)){const l=this.dataManager.getDataObject(i).__children;return o.add(i),Array.isArray(l)&&l.forEach(a=>o.add(this.dataManager.getRowIndex(a))),o}return o.add(i)},new Set));r.length=0,r.push(...s)}onBeforeAddChild(){this.collapsingUI.collapsedRowsStash.stash()}onAfterAddChild(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}onBeforeDetachChild(){this.collapsingUI.collapsedRowsStash.stash()}onAfterDetachChild(e,t,r){this.collapsingUI.collapsedRowsStash.shiftStash(r,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}onAfterCreateRow(){this.dataManager.rewriteCache()}onAfterInit(){const e=Math.max(...this.dataManager.cache.levels);e>0&&this.headersUI.updateRowHeaderWidth(e)}onBeforeViewRender(e,t){Ts.get(this).skipRender&&(t.skipRender=!0)}destroy(){super.destroy()}onBeforeLoadData(e){if(!w3(e)){$v(BX),this.hot.getSettings()[dw]=!1,this.disablePlugin();return}this.dataManager.setData(e),this.dataManager.rewriteCache()}}class UX{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;this.rootWindow=t,this.prefix=e,this.savedKeys=[],this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(t)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){const r=typeof e>"u"?t:e,s=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return s===null?void 0:JSON.parse(s)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){P(this.savedKeys,(e,t)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[t]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),t=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=t||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}he.getSingleton().register("persistentStateSave");he.getSingleton().register("persistentStateLoad");he.getSingleton().register("persistentStateReset");const W1="persistentState",zX=0;class YX extends nt{static get PLUGIN_KEY(){return W1}static get PLUGIN_PRIORITY(){return zX}constructor(e){super(e),this.storage=void 0}isEnabled(){return!!this.hot.getSettings()[W1]}enablePlugin(){this.enabled||(this.storage||(this.storage=new UX(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,t)=>this.saveValue(e,t)),this.addHook("persistentStateLoad",(e,t)=>this.loadValue(e,t)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}const fw="search",jX=190,GX="htSearchResult",KX=function(n,e,t,r,s){n.getCellMeta(e,t).isSearchResult=s},XX=function(n,e,t){return dt(n)||n===null||!n.toLocaleLowerCase||n.length===0||dt(e)||e===null?!1:e.toString().toLocaleLowerCase(t.locale).indexOf(n.toLocaleLowerCase(t.locale))!==-1};class qX extends nt{static get PLUGIN_KEY(){return fw}static get PLUGIN_PRIORITY(){return jX}constructor(e){super(e),this.callback=KX,this.queryMethod=XX,this.searchResultClass=GX}isEnabled(){return this.hot.getSettings()[fw]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[fw];this.updatePluginSettings(t),this.addHook("beforeRenderer",function(){return e.onBeforeRenderer(...arguments)}),super.enablePlugin()}disablePlugin(){var e=this;const t=function(){return e.onBeforeRenderer(...arguments)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",t)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const s=this.hot.countRows(),o=this.hot.countCols(),i=[],l=this.hot;return Ce(0,s-1,a=>{Ce(0,o-1,u=>{const c=this.hot.getDataAtCell(a,u),d=this.hot.getCellMeta(a,u),f=d.search.callback||t,p=(d.search.queryMethod||r)(e,c,d);if(p){const w={row:a,col:u,data:c};i.push(w)}f&&f(l,a,u,c,p)})}),i}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){$e(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}onBeforeRenderer(e,t,r,s,o,i){const l=i.className||[];let a=[];typeof l=="string"?a=l.split(" "):a.push(...l),this.isEnabled()&&i.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),i.className=a.join(" ")}destroy(){super.destroy()}}const QX="touchScroll",ZX=200;class JX extends nt{static get PLUGIN_KEY(){return QX}static get PLUGIN_PRIORITY(){return ZX}static get SETTING_KEYS(){return!0}constructor(e){super(e),this.scrollbars=[],this.clones=[],this.lockedCollection=!1,this.freezeOverlays=!1}isEnabled(){return yx()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>this.onAfterViewRender()),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>this.onBeforeTouchScroll()),this.addHook("afterMomentumScroll",()=>this.onAfterMomentumScroll())}onAfterViewRender(){if(this.lockedCollection)return;const{topOverlay:e,bottomOverlay:t,inlineStartOverlay:r,topInlineStartCornerOverlay:s,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),t.clone&&this.scrollbars.push(t),this.scrollbars.push(r),s&&this.scrollbars.push(s),o&&o.clone&&this.scrollbars.push(o),this.clones=[],e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),s&&this.clones.push(s.clone.wtTable.holder.parentNode),o&&o.clone&&this.clones.push(o.clone.wtTable.holder.parentNode)}onBeforeTouchScroll(){this.freezeOverlays=!0,P(this.clones,e=>{ee(e,"hide-tween")})}onAfterMomentumScroll(){this.freezeOverlays=!1,P(this.clones,e=>{He(e,"hide-tween"),ee(e,"show-tween")}),this.hot._registerTimeout(()=>{P(this.clones,e=>{He(e,"show-tween")})},400),P(this.scrollbars,e=>{e.refresh(),e.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}const Uh="trimRows",eq=330;class tq extends nt{static get PLUGIN_KEY(){return Uh}static get PLUGIN_PRIORITY(){return eq}constructor(e){super(e),this.trimmedRowsMap=null}isEnabled(){return!!this.hot.getSettings()[Uh]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Sc),this.trimmedRowsMap.addLocalHook("init",()=>this.onMapInit()),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[Uh];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),P(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const t=this.getTrimmedRows(),r=this.isValidConfig(e);let s=t;r&&(s=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeTrimRow",t,s,r)!==!1&&(r&&this.hot.batchExecution(()=>{P(e,i=>{this.trimmedRowsMap.setValueAtIndex(i,!0)})},!0),this.hot.runHooks("afterTrimRow",t,s,r,r&&s.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.trimRows(t)}untrimRows(e){const t=this.getTrimmedRows(),r=this.isValidConfig(e);let s=t;const o=this.trimmedRowsMap.getValues().slice(),i=e.length>0;r&&i&&(P(e,a=>{o[a]=!1}),s=Sn(o,(a,u,c)=>(u&&a.push(c),a),[])),this.hot.runHooks("beforeUntrimRow",t,s,r&&i)!==!1&&(r&&i&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",t,s,r&&i,r&&s.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const t=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<t)}onMapInit(){const e=this.hot.getSettings()[Uh];Array.isArray(e)&&this.hot.batchExecution(()=>{P(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0)}destroy(){super.destroy()}}const vP="undoRedo",nq="undoRedo";function ce(n){const e=this;this.instance=n,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,n.addHook("afterChange",function(t,r){const s=t&&t.length;if(!s||!t.find(l=>{const[,,a,u]=l;return a!==u}))return;const i=()=>{const l=t.reduce((u,c)=>(u.push([...c]),u),[]);P(l,u=>{u[1]=n.propToCol(u[1])});const a=s>1?this.getSelected():[[l[0][0],l[0][1]]];return new ce.ChangeAction(l,a)};e.done(i,r)}),n.addHook("afterCreateRow",(t,r,s)=>{e.done(()=>new ce.CreateRowAction(t,r),s)}),n.addHook("beforeRemoveRow",(t,r,s,o)=>{const i=()=>{const l=n.toPhysicalRow(t),a=_n(e.instance.getSourceData(l,0,l+r-1,e.instance.countSourceCols()-1));return new ce.RemoveRowAction(l,a,n.getSettings().fixedRowsBottom,n.getSettings().fixedRowsTop,n.rowIndexMapper.getIndexesSequence())};e.done(i,o)}),n.addHook("afterCreateCol",(t,r,s)=>{e.done(()=>new ce.CreateColumnAction(t,r),s)}),n.addHook("beforeRemoveCol",(t,r,s,o)=>{const i=()=>{const l=e.instance.getSourceDataArray(),a=(e.instance.countCols()+t)%e.instance.countCols(),u=[],c=[],d=[];Ce(l.length-1,p=>{const w=[],M=l[p];Ce(a,a+(r-1),S=>{w.push(M[n.toPhysicalColumn(S)])}),u.push(w)}),Ce(r-1,p=>{d.push(n.toPhysicalColumn(a+p))}),Array.isArray(n.getSettings().colHeaders)&&Ce(r-1,p=>{c.push(n.getSettings().colHeaders[n.toPhysicalColumn(a+p)]||null)});const f=n.columnIndexMapper.getIndexesSequence(),m=n.rowIndexMapper.getIndexesSequence();return new ce.RemoveColumnAction(a,d,u,c,f,m,n.getSettings().fixedColumnsStart)};e.done(i,o)}),n.addHook("beforeCellAlignment",(t,r,s,o)=>{e.done(()=>new ce.CellAlignmentAction(t,r,s,o))}),n.addHook("beforeFilter",t=>{e.done(()=>new ce.FiltersAction(t))}),n.addHook("beforeRowMove",(t,r)=>{t!==!1&&e.done(()=>new ce.RowMoveAction(t,r))}),n.addHook("beforeMergeCells",(t,r)=>{r||e.done(()=>new ce.MergeCellsAction(n,t))}),n.addHook("afterUnmergeCells",(t,r)=>{r||e.done(()=>new ce.UnmergeCellsAction(n,t))}),n.addHook("afterInit",()=>{e.init()})}ce.prototype.done=function(n,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const r=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",r,e)===!1)return;const o=n(),i=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",i),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice())};ce.prototype.undo=function(){if(this.isUndoAvailable()){const n=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",n);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice());const t=_n(e);if(this.instance.runHooks("beforeUndo",t)===!1)return;this.ignoreNewActions=!0;const s=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,()=>{s.ignoreNewActions=!1,s.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",t)}};ce.prototype.redo=function(){if(this.isRedoAvailable()){const n=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",n);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",n,this.undoneActions.slice());const t=_n(e);if(this.instance.runHooks("beforeRedo",t)===!1)return;this.ignoreNewActions=!0;const s=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,()=>{s.ignoreNewActions=!1,s.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",t)}};ce.prototype.isUndoAvailable=function(){return this.doneActions.length>0};ce.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};ce.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};ce.prototype.isEnabled=function(){return this.enabled};ce.prototype.enable=function(){if(this.isEnabled())return;const n=this.instance;this.enabled=!0,oq(n),this.registerShortcuts(),n.addHook("afterChange",SP)};ce.prototype.disable=function(){if(!this.isEnabled())return;const n=this.instance;this.enabled=!1,iq(n),this.unregisterShortcuts(),n.removeHook("afterChange",SP)};ce.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};ce.Action=function(){};ce.Action.prototype.undo=function(){};ce.Action.prototype.redo=function(){};ce.ChangeAction=function(n,e){this.changes=n,this.selected=e,this.actionType="change"};Vo(ce.ChangeAction,ce.Action);ce.ChangeAction.prototype.undo=function(n,e){const t=_n(this.changes),r=n.countEmptyRows(!0),s=n.countEmptyCols(!0);for(let o=0,i=t.length;o<i;o++)t[o].splice(3,1);n.addHookOnce("afterChange",e),n.setDataAtCell(t,null,null,"UndoRedo.undo");for(let o=0,i=t.length;o<i;o++){const[l,a]=t[o];n.getSettings().minSpareRows&&l+1+n.getSettings().minSpareRows===n.countRows()&&r===n.getSettings().minSpareRows&&(n.alter("remove_row",parseInt(l+1,10),n.getSettings().minSpareRows),n.undoRedo.doneActions.pop()),n.getSettings().minSpareCols&&a+1+n.getSettings().minSpareCols===n.countCols()&&s===n.getSettings().minSpareCols&&(n.alter("remove_col",parseInt(a+1,10),n.getSettings().minSpareCols),n.undoRedo.doneActions.pop())}n.selectCells(this.selected,!1,!1)};ce.ChangeAction.prototype.redo=function(n,e){const t=_n(this.changes);for(let r=0,s=t.length;r<s;r++)t[r].splice(2,1);n.addHookOnce("afterChange",e),n.setDataAtCell(t,null,null,"UndoRedo.redo"),this.selected&&n.selectCells(this.selected,!1,!1)};ce.CreateRowAction=function(n,e){this.index=n,this.amount=e,this.actionType="insert_row"};Vo(ce.CreateRowAction,ce.Action);ce.CreateRowAction.prototype.undo=function(n,e){const t=n.countRows(),r=n.getSettings().minSpareRows;this.index>=t&&this.index-r<t&&(this.index-=r),n.addHookOnce("afterRemoveRow",e),n.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};ce.CreateRowAction.prototype.redo=function(n,e){n.addHookOnce("afterCreateRow",e),n.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};ce.RemoveRowAction=function(n,e,t,r,s){this.index=n,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=t,this.fixedRowsTop=r,this.rowIndexesSequence=s};Vo(ce.RemoveRowAction,ce.Action);ce.RemoveRowAction.prototype.undo=function(n,e){const t=n.getSettings(),r=[];t.fixedRowsBottom=this.fixedRowsBottom,t.fixedRowsTop=this.fixedRowsTop,this.data.forEach((s,o)=>{Object.keys(s).forEach(i=>{const l=parseInt(i,10);r.push([this.index+o,isNaN(l)?i:l,s[i]])})}),n.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),n.addHookOnce("afterViewRender",e),n.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),n.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};ce.RemoveRowAction.prototype.redo=function(n,e){n.addHookOnce("afterRemoveRow",e),n.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};ce.CreateColumnAction=function(n,e){this.index=n,this.amount=e,this.actionType="insert_col"};Vo(ce.CreateColumnAction,ce.Action);ce.CreateColumnAction.prototype.undo=function(n,e){n.addHookOnce("afterRemoveCol",e),n.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};ce.CreateColumnAction.prototype.redo=function(n,e){n.addHookOnce("afterCreateCol",e),n.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};ce.RemoveColumnAction=function(n,e,t,r,s,o,i){this.index=n,this.indexes=e,this.data=t,this.amount=this.data[0].length,this.headers=r,this.columnPositions=s.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=i};Vo(ce.RemoveColumnAction,ce.Action);ce.RemoveColumnAction.prototype.undo=function(n,e){const t=n.getSettings();t.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),s=(u,c,d)=>d[this.indexes.indexOf(r[c])],o=this.data.length,i=[];for(let u=0;u<o;u++)i.push(Ve(this.data[u],s));const l=Ve(this.headers,s),a=[];n.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),P(n.getSourceDataArray(),(u,c)=>{P(r,(d,f)=>{u[d]=i[c][f],a.push([c,d,u[d]])})}),n.setSourceDataAtCell(a,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&P(l,(u,c)=>{n.getSettings().colHeaders[r[c]]=u}),n.batchExecution(()=>{n.rowIndexMapper.setIndexesSequence(this.rowPositions),n.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),n.addHookOnce("afterViewRender",e),n.render()};ce.RemoveColumnAction.prototype.redo=function(n,e){n.addHookOnce("afterRemoveCol",e),n.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};ce.CellAlignmentAction=function(n,e,t,r){this.stateBefore=n,this.range=e,this.type=t,this.alignment=r};ce.CellAlignmentAction.prototype.undo=function(n,e){P(this.range,t=>{t.forAll((r,s)=>{r>=0&&s>=0&&n.setCellMeta(r,s,"className",this.stateBefore[r][s]||" htLeft")})}),n.addHookOnce("afterViewRender",e),n.render()};ce.CellAlignmentAction.prototype.redo=function(n,e){lo(this.range,this.type,this.alignment,(t,r)=>n.getCellMeta(t,r),(t,r,s,o)=>n.setCellMeta(t,r,s,o)),n.addHookOnce("afterViewRender",e),n.render()};ce.FiltersAction=function(n){this.conditionsStack=n,this.actionType="filter"};Vo(ce.FiltersAction,ce.Action);ce.FiltersAction.prototype.undo=function(n,e){const t=n.getPlugin("filters");n.addHookOnce("afterViewRender",e),t.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),t.filter()};ce.FiltersAction.prototype.redo=function(n,e){const t=n.getPlugin("filters");n.addHookOnce("afterViewRender",e),t.conditionCollection.importAllConditions(this.conditionsStack),t.filter()};class rq extends ce.Action{constructor(e,t){super(),this.cellRange=t;const r=this.cellRange.getTopStartCorner(),s=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(r.row,r.col,s.row,s.col)}undo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.unmergeRange(this.cellRange,!0);const s=this.cellRange.getTopStartCorner();e.populateFromArray(s.row,s.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.mergeRange(this.cellRange)}}ce.MergeCellsAction=rq;class sq extends ce.Action{constructor(e,t){super(),this.cellRange=t}undo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.mergeRange(this.cellRange,!0)}redo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.unmergeRange(this.cellRange,!0),e.render()}}ce.UnmergeCellsAction=sq;ce.RowMoveAction=function(n,e){this.rows=n.slice(),this.finalIndex=e,this.actionType="row_move"};Vo(ce.RowMoveAction,ce.Action);ce.RowMoveAction.prototype.undo=function(n,e){const t=n.getPlugin("manualRowMove"),r=[].concat(this.rows),s=r.filter(l=>l>this.finalIndex),o=r.filter(l=>l<=this.finalIndex),i=s.sort((l,a)=>a-l).concat(o.sort((l,a)=>l-a));n.addHookOnce("afterViewRender",e);for(let l=0;l<i.length;l+=1){const a=n.toVisualRow(i[l]);t.moveRow(a,i[l])}n.render(),n.deselectCell(),n.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};ce.RowMoveAction.prototype.redo=function(n,e){const t=n.getPlugin("manualRowMove");n.addHookOnce("afterViewRender",e),t.moveRows(this.rows.slice(),this.finalIndex),n.render(),n.deselectCell(),n.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};ce.prototype.init=function(){const n=this.instance.getSettings().undo,e=typeof n>"u"||n;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};ce.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),r={runOnlyIf:s=>!s.altKey,group:vP};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)};ce.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(vP)};function SP(n,e){const t=this;if(e==="loadData")return t.undoRedo.clear()}function oq(n){n.undo=function(){return n.undoRedo.undo()},n.redo=function(){return n.undoRedo.redo()},n.isUndoAvailable=function(){return n.undoRedo.isUndoAvailable()},n.isRedoAvailable=function(){return n.undoRedo.isRedoAvailable()},n.clearUndo=function(){return n.undoRedo.clear()}}function iq(n){delete n.undo,delete n.redo,delete n.isUndoAvailable,delete n.isRedoAvailable,delete n.clearUndo}const xc=he.getSingleton();xc.add("afterUpdateSettings",function(){var n;(n=this.getPlugin("undoRedo"))===null||n===void 0||n.init()});xc.register("beforeUndo");xc.register("afterUndo");xc.register("beforeRedo");xc.register("afterRedo");ce.PLUGIN_KEY=nq;ce.SETTING_KEYS=!0;function lq(){Xe(mu),Xe(aK),Xe(pu),Xe(vK),Xe(IK),Xe(bA),Xe(n8),Xe(p8),Xe(Ug),Xe(m5),Xe(P5),Xe(D5),Xe(Yg),Xe(Y5),Xe(H9),Xe(i7),Xe(f7),Xe(v7),Xe(E7),Xe(x7),Xe(P7),Xe(F7),Xe($7),Xe(Y7),Xe(Q7),Xe(eX),Xe(kX),Xe(WX),Xe(YX),Xe(qX),Xe(JX),Xe(tq),Xe(ce)}function aq(){a6(),b6(),A6(),K6(),lq()}aq();function uq(){const n=vu.useRef(null),e=o=>{if(o.shiftKey){o.preventDefault();const i=n.current.hotInstance.rootElement.querySelector(".ht_master .wtHolder");if(i){const l=o.deltaY*2;i.scrollLeft+=l}}};vu.useEffect(()=>{let o=null;const i=setTimeout(()=>{n.current&&n.current.hotInstance&&(o=n.current.hotInstance.rootElement.querySelector(".ht_master .wtHolder"),o&&o.addEventListener("wheel",e,{passive:!1}))},0);return()=>{clearTimeout(i),o&&o.removeEventListener("wheel",e)}},[]);const s={data:[["Tesla","Model S Plaid",2023,"电动","特斯拉灰",129990,"美国","是","1020hp",2162,1.99,322,637,null],["Porsche","Taycan Turbo S",2023,"电动","保时捷红",187400,"德国","是","750hp",2295,2.6,260,412,null],["BMW","i7 xDrive60",2023,"电动","矿石白",119300,"德国","是","536hp",2640,4.5,240,590,null],["Mercedes","EQS 580 4MATIC",2023,"电动","曜岩黑",125900,"德国","是","516hp",2585,4.1,210,770,null],["Audi","e-tron GT RS",2023,"电动","金属蓝",143900,"德国","是","637hp",2347,3.1,250,472,null],["Lucid","Air Dream Edition",2023,"电动","星云白",169e3,"美国","是","1111hp",2339,2.5,270,830,null],["Toyota","Crown Hybrid Max",2023,"混动","曜石黑",52350,"日本","否","340hp",1845,5.7,209,null,6.7],["Honda","Legend Hybrid",2023,"混动","水晶银",48500,"日本","否","377hp",1960,6,210,null,7],["Lexus","LS 500h",2023,"混动","深蓝宝石",111100,"日本","是","354hp",2265,5.4,250,null,6.6],["Genesis","G90",2023,"汽油","墨玉黑",89e3,"韩国","是","375hp",2185,5.3,250,null,10.1],["Bentley","Flying Spur",2023,"汽油","宾利绿",227025,"英国","是","542hp",2437,4,333,null,14.3],["Rolls-Royce","Ghost",2023,"汽油","英伦白",343e3,"英国","是","563hp",2550,4.3,250,null,15]],columns:[{title:"品牌",type:"text",width:120},{title:"型号",type:"text",width:160},{title:"年份",type:"numeric",width:80},{title:"动力类型",type:"text",width:100},{title:"颜色",type:"text",width:120},{title:"价格 ($)",type:"numeric",numericFormat:{pattern:"$0,0",culture:"en-US"},width:120},{title:"产地",type:"text",width:100},{title:"豪华品牌",type:"text",width:100},{title:"最大功率",type:"text",width:100},{title:"重量 (kg)",type:"numeric",width:100},{title:"0-60加速 (秒)",type:"numeric",width:100},{title:"最高速度 (km/h)",type:"numeric",width:120},{title:"续航里程 (km)",type:"numeric",width:120},{title:"耗油量 (L/100km)",type:"numeric",width:120}],colHeaders:!0,rowHeaders:!0,height:600,width:"100%",licenseKey:"non-commercial-and-evaluation",stretchH:"none",className:"custom-table-style",rowHeights:35,autoColumnSize:!1,manualColumnResize:!0,fixedColumnsStart:1,readOnly:!0};return ao.jsxs("div",{className:"custom-table",children:[ao.jsx("h1",{children:"豪华汽车数据表"}),ao.jsx("p",{className:"scroll-hint",children:"提示：按住 Shift + 鼠标滚轮可以左右滚动"}),ao.jsx("div",{className:"table-container",children:ao.jsx("div",{className:"striped-table",children:ao.jsx(rA,{ref:n,...s})})})]})}gw.createRoot(document.getElementById("root")).render(ao.jsx($t.StrictMode,{children:ao.jsx(uq,{})}))});export default cq();
